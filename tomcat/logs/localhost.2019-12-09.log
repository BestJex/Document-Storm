09-Dec-2019 11:35:28.478 SEVERE [http-nio-8080-exec-12] org.apache.catalina.core.ApplicationDispatcher.invoke Servlet.service() for servlet com.passer.web.servlet.TranslateServlet threw exception
 java.io.IOException: Server returned HTTP response code: 413 for URL: https://translate.google.cn/translate_a/single?client=webapp&sl=auto&tl=zh-CN&hl=zh-CN&dt=at&dt=bd&dt=ex&dt=ld&dt=md&dt=qca&dt=rw&dt=rm&dt=ss&dt=t&source=bh&ssel=0&tsel=0&kc=1&tk=492773.110737&q=OptaPlanner+User+Guide%0AThe+OptaPlanner+Team%0AVersion+7.10.0.Final%0ATable+of+Contents%0A1.+OptaPlanner+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A01%0A1.1.+What+is+OptaPlanner%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A01%0A1.2.+What+is+a+Planning+Problem%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A02%0A1.2.1.+A+Planning+Problem+is+NP-complete+or+NP-hard+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.2.2.+A+Planning+Problem+Has+%28Hard+and+Soft%29+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.2.3.+A+Planning+Problem+Has+a+Huge+Search+Space+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.3.+Requirements.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A05%0A1.4.+Governance+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.1.+Status+of+OptaPlanner+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.2.+Release+Notes+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.3.+Backwards+Compatibility+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.4.+Community+and+Support+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A07%0A1.4.5.+Relationship+with+Drools+and+jBPM+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A07%0A1.5.+Download+and+Run+the+Examples.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A08%0A1.5.1.+Get+the+Release+zip+and+Run+the+Examples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A08%0A1.5.2.+Run+the+Webexamples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A010%0A1.5.3.+Run+the+Examples+in+an+IDE+%28IntelliJ%2C+Eclipse%2C+NetBeans%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A011%0A1.5.4.+Use+OptaPlanner+with+Maven%2C+Gradle%2C+Ivy%2C+Buildr+or+ANT+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A012%0A1.5.5.+Build+OptaPlanner+from+Source+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A013%0A2.+Getting+Started%3A+A+Cloud+Balancing+Demonstration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.+Cloud+Balancing+Tutorial+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A017%0A2.2.+Using+the+Domain+Model.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A017%0A2.2.1.+Domain+Model+Design+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A018%0A2.2.2.+Domain+Model+Implementation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A019%0A2.3.+Run+the+Cloud+Balancing+Hello+World+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A021%0A2.4.+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A023%0A2.5.+Score+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A024%0A2.5.1.+Easy+Java+Score+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A025%0A2.5.2.+Drools+Score+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A027%0A2.6.+Beyond+this+Tutorial.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A029%0A3.+Use+Cases+and+Examples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A030%0A3.1.+Examples+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A030%0A3.2.+N+Queens.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A034%0A3.2.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A034%0A3.2.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A035%0A3.2.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A035%0A3.3.+Cloud+Balancing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A037%0A3.4.+Traveling+Salesman+%28TSP+-+Traveling+Salesman+Problem%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.3.+Problem+Difficulty.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.5.+Dinner+Party+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.5.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.5.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.6.+Tennis+Club+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.7.+Meeting+Scheduling+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A041%0A3.7.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A041%0A3.7.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.+Course+Timetabling+%28ITC+2007+Track+3+-+Curriculum+Course+Scheduling%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A043%0A3.8.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A043%0A3.9.+Machine+Reassignment+%28Google+ROADEF+2012%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A044%0A3.9.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A044%0A3.9.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A045%0A3.9.3.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A046%0A3.9.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A047%0A3.10.+Vehicle+Routing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A048%0A3.10.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A048%0A3.10.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A050%0A3.10.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A050%0A3.10.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A054%0A3.11.+Project+Job+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A059%0A3.11.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A059%0A3.11.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A060%0A3.12.+Hospital+Bed+Planning+%28PAS+-+Patient+Admission+Scheduling%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A061%0A3.12.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A061%0A3.12.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A063%0A3.12.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A063%0A3.13.+Task+assigning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A064%0A3.13.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A064%0A3.13.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.13.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.13.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.14.+Exam+Timetabling+%28ITC+2007+track+1+-+Examination%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A066%0A3.14.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A066%0A3.14.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A068%0A3.14.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A068%0A3.15.+Nurse+Rostering+%28INRC+2010%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A069%0A3.15.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A069%0A3.15.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A071%0A3.15.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A071%0A3.15.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.+Traveling+Tournament+Problem+%28TTP%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A075%0A3.17.+Cheap+Time+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A076%0A3.17.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A076%0A3.17.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A077%0A3.18.+Investment+Asset+Class+Allocation+%28Portfolio+Optimization%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.18.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.18.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.+Conference+Scheduling+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A082%0A3.19.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A082%0A3.20.+Rock+Tour+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A3.20.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A3.20.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A4.+Planner+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.1.+Solver+Configuration+by+XML.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.2.+Solver+Configuration+by+Java+API+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A086%0A4.2.3.+Annotations+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A087%0A4.2.4.+Custom+Properties+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.+Model+a+Planning+Problem.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.1.+Is+This+Class+a+Problem+Fact+or+Planning+Entity%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.2.+Problem+Fact+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A090%0A4.3.3.+Planning+Entity+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A091%0A4.3.4.+Planning+Variable+%28genuine%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A094%0A4.3.5.+Planning+Value+and+Planning+Value+Range+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A096%0A4.3.6.+Planning+Problem+and+Planning+Solution.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0104%0A4.4.+Use+the+Solver+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.1.+The+Solver+Interface+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.2.+Solving+a+Problem.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.3.+Environment+Mode%3A+Are+There+Bugs+in+my+Code%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0115%0A4.4.4.+Logging+Level%3A+What+is+the+Solver+Doing%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0117%0A4.4.5.+Random+Number+Generator+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0120%0A5.+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.+Score+Terminology+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.1.+What+is+a+Score%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.2.+Formalize+the+Business+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.3.+Score+Constraint+Signum+%28Positive+or+Negative%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0123%0A5.1.4.+Score+Constraint+Weight+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0124%0A5.1.5.+Score+Constraint+Level+%28hard%2C+soft%2C+%E2%80%A6%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0125%0A5.1.6.+Pareto+Scoring+%28AKA+Multi-objective+Optimization+Scoring%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0127%0A5.1.7.+Combining+Score+Techniques+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0129%0A5.1.8.+Score+interface+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0129%0A5.1.9.+Avoid+Floating+Point+Numbers+in+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0130%0A5.2.+Choose+a+Score+Type+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.1.+SimpleScore+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.2.+HardSoftScore+%28Recommended%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.3.+HardMediumSoftScore+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.4.+BendableScore.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0133%0A5.2.5.+Implementing+a+Custom+Score.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0133%0A5.3.+Calculate+the+Score+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.1.+Score+Calculation+Types+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.2.+Easy+Java+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.3.+Incremental+Java+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0136%0A5.3.4.+Drools+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0141%0A5.3.5.+InitializingScoreTrend.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0147%0A5.3.6.+Invalid+Score+Detection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.+Score+Calculation+Performance+Tricks+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.1.+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.2.+Score+Calculation+Speed+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0149%0A5.4.3.+Incremental+Score+Calculation+%28with+Deltas%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0149%0A5.4.4.+Avoid+Calling+Remote+Services+During+Score+Calculation.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0151%0A5.4.5.+Pointless+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0151%0A5.4.6.+Built-in+Hard+Constraint+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.7.+Other+Score+Calculation+Performance+Tricks.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.8.+Score+Trap.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.9.+stepLimit+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0154%0A5.4.10.+Fairness+Score+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0154%0A5.5.+Explaining+the+Score%3A+Which+Constraints+Are+Broken%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0156%0A5.5.1.+Using+Score+Calculation+Outside+the+Solver+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0157%0A5.5.2.+Constraint+Match+Total%3A+Break+down+the+Score+by+Constraint+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0158%0A5.5.3.+Indictment+Heat+Map%3A+Visualize+the+Hot+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0159%0A5.6.+Testing+score+constraints+with+JUnit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0159%0A6.+Shadow+Variable+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0162%0A6.1.+Introduction.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0162%0A6.2.+Bi-directional+Variable+%28Inverse+Relation+Shadow+Variable%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0163%0A6.3.+Anchor+Shadow+Variable+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0165%0A6.4.+Custom+VariableListener+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0166%0A6.5.+VariableListener+triggering+order+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0168%0A7.+Optimization+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0171%0A7.1.+Search+Space+Size+in+the+Real+World+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0171%0A7.2.+Does+Planner+Find+the+Optimal+Solution%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0172%0A7.3.+Architecture+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0173%0A7.4.+Optimization+Algorithms+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0174%0A7.5.+Which+Optimization+Algorithms+Should+I+Use%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0176%0A7.6.+Power+tweaking+or+default+parameter+values.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0177%0A7.7.+Solver+Phase.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0177%0A7.8.+Scope+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0179%0A7.9.+Termination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0180%0A7.9.1.+TimeMillisSpentTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0181%0A7.9.2.+UnimprovedTimeMillisSpentTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0182%0A7.9.3.+BestScoreTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0183%0A7.9.4.+BestScoreFeasibleTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0183%0A7.9.5.+StepCountTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.6.+UnimprovedStepCountTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.7.+ScoreCalculationCountTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.8.+Combining+Multiple+Terminations+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0185%0A7.9.9.+Asynchronous+Termination+from+Another+Thread+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0185%0A7.10.+SolverEventListener+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0186%0A7.11.+Custom+Solver+Phase+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0186%0A7.12.+No+Change+Solver+Phase+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0188%0A7.13.+Multithreaded+Solving+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0189%0A7.13.1.+Custom+Thread+Factory+%28WildFly%2C+Android%2C+GAE%2C+%E2%80%A6%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0190%0A7.13.2.+Multithreaded+Incremental+Solving.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0190%0A8.+Move+and+Neighborhood+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.+Move+and+Neighborhood+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.1.+What+is+a+Move%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.2.+What+is+a+MoveSelector%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0194%0A8.1.3.+Subselecting+of+Entities%2C+Values+and+Other+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0194%0A8.2.+Generic+MoveSelectors+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0195%0A8.2.1.+changeMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0196%0A8.2.2.+swapMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0197%0A8.2.3.+pillarChangeMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0199%0A8.2.4.+pillarSwapMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0201%0A8.2.5.+tailChainSwapMoveSelector+or+2-opt+%28chained+variables+only%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0203%0A8.2.6.+subChainChangeMoveSelector+%28chained+variables+only%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0204%0A8.2.7.+subChainSwapMoveSelector+%28chained+variables+only%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0205%0A8.3.+Combining+Multiple+MoveSelectors.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0206%0A8.3.1.+unionMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0206%0A8.3.2.+cartesianProductMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0208%0A8.4.+EntitySelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0209%0A8.5.+ValueSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0209%0A8.6.+General+Selector+Features+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0210%0A8.6.1.+CacheType%3A+Create+Moves+Ahead+of+Time+or+Just+In+Time.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0210%0A8.6.2.+SelectionOrder%3A+Original%2C+Sorted%2C+Random%2C+Shuffled+or+Probabilistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0211%0A8.6.3.+Recommended+Combinations+of+CacheType+and+SelectionOrder+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0212%0A8.6.4.+Filtered+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0215%0A8.6.5.+Sorted+Selection.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0218%0A8.6.6.+Probabilistic+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0222%0A8.6.7.+Limited+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0223%0A8.6.8.+Mimic+Selection+%28Record%2FReplay%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0223%0A8.6.9.+Nearby+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0224%0A8.7.+Custom+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0227%0A8.7.1.+Which+Move+Types+Might+be+Missing+in+my+Implementation%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0227%0A8.7.2.+Custom+Moves+Introduction.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0228%0A8.7.3.+The+Interface+Move+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0228%0A8.7.4.+MoveListFactory%3A+the+Easy+Way+to+Generate+Custom+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0232%0A8.7.5.+MoveIteratorFactory%3A+Generate+Custom+Moves+Just+in+Time.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0233%0A9.+Exhaustive+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.+Brute+Force.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.1.+Algorithm+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.+Branch+And+Bound.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.1.+Algorithm+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0237%0A9.4.+Scalability+of+Exhaustive+Search.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0239%0A10.+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.+First+Fit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.+First+Fit+Decreasing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0244%0A10.4.+Weakest+Fit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.4.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.4.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.+Weakest+Fit+Decreasing.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.+Strongest+Fit.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.7.+Strongest+Fit+Decreasing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.7.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.7.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.8.+Allocate+Entity+From+Queue.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.3.+Multiple+Entity+Classes+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0249%0A10.8.4.+Pick+Early+Type+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0250%0A10.9.+Allocate+To+Value+From+Queue+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0251%0A10.9.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0251%0A10.9.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.+Cheapest+Insertion+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0253%0A10.11.+Regret+Insertion+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.11.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.11.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.+Allocate+From+Pool.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.13.+Scaling+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0255%0A10.13.1.+InitializingScoreTrend+shortcuts+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0255%0A10.13.2.+Scaling+Multiple+Planning+Variables+in+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0256%0A10.13.3.+Other+Scaling+Techniques+in+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0258%0A11.+Local+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.+Local+Search+Concepts.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.1.+Step+by+Step+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.2.+Decide+the+Next+Step+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0261%0A11.2.3.+Acceptor+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0263%0A11.2.4.+Forager+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0263%0A11.3.+Hill+Climbing+%28Simple+Local+Search%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0265%0A11.3.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0265%0A11.3.2.+Stuck+in+Local+Optima+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0266%0A11.3.3.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0266%0A11.4.+Tabu+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0267%0A11.4.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0267%0A11.4.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0268%0A11.5.+Simulated+Annealing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.5.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.5.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.6.+Late+Acceptance+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0271%0A11.6.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0271%0A11.6.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0272%0A11.7.+Step+Counting+Hill+Climbing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.7.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.7.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.8.+Strategic+Oscillation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.8.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.8.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.9.+Variable+Neighborhood+Descent+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.9.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.9.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.10.+Using+a+Custom+Termination%2C+MoveSelector%2C+EntitySelector%2C+ValueSelector+or+Acceptor+.+.+%C2%A0276%0A12.+Evolutionary+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.2.+Evolutionary+Strategies.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.3.+Genetic+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A13.+Hyperheuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0278%0A13.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0278%0A14.+Partitioned+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0279%0A14.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0279%0A14.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0280%0A14.3.+Partitioning+a+Solution+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0281%0A14.3.1.+Custom+SolutionPartitioner+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0281%0A14.4.+Runnable+Part+Thread+Limit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0283%0A15.+Benchmarking+and+Tweaking.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.1.+Find+the+Best+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.+Benchmark+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.1.+Add+a+Dependency+on+optaplanner-benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.2.+Run+a+Simple+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0287%0A15.2.3.+Configure+and+Run+an+Advanced+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0287%0A15.2.4.+SolutionFileIO%3A+Input+And+Output+Of+Solution+Files+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0289%0A15.2.5.+Warming+Up+The+HotSpot+Compiler+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0291%0A15.2.6.+Benchmark+Blueprint%3A+A+Predefined+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0292%0A15.2.7.+Write+The+Output+Solution+Of+Benchmark+Runs.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.2.8.+Benchmark+Logging+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.3.+Benchmark+Report+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.3.1.+HTML+Report+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0294%0A15.3.2.+Ranking+The+Solvers+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0294%0A15.4.+Summary+Statistics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0295%0A15.4.1.+Best+Score+Summary+%28Graph+And+Table%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0295%0A15.4.2.+Best+Score+Scalability+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0296%0A15.4.3.+Best+Score+Distribution+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0296%0A15.4.4.+Winning+Score+Difference+Summary+%28Graph+And+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.5.+Worst+Score+Difference+Percentage+%28ROI%29+Summary+%28Graph+and+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.6.+Score+Calculation+Speed+Summary+%28Graph+and+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.7.+Time+Spent+Summary+%28Graph+And+Table%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.4.8.+Time+Spent+Scalability+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.4.9.+Best+Score+Per+Time+Spent+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.+Statistic+Per+Dataset+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.1.+Enable+A+Problem+Statistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.2.+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0299%0A15.5.3.+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0301%0A15.5.4.+Score+Calculation+Speed+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0302%0A15.5.5.+Best+Solution+Mutation+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0303%0A15.5.6.+Move+Count+Per+Step+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0304%0A15.5.7.+Memory+Use+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0305%0A15.6.+Statistic+Per+Single+Benchmark+%28Graph+And+CSV%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0306%0A15.6.1.+Enable+A+Single+Statistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0306%0A15.6.2.+Constraint+Match+Total+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0307%0A15.6.3.+Constraint+Match+Total+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0308%0A15.6.4.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0309%0A15.6.5.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0310%0A15.7.+Advanced+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0311%0A15.7.1.+Benchmarking+Performance+Tricks+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0311%0A15.7.2.+Statistical+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0312%0A15.7.3.+Template+Based+Benchmarking+And+Matrix+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0313%0A15.7.4.+Benchmark+Report+Aggregation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0315%0A16.+Repeated+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.1.+Introduction+to+Repeated+Planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.2.+Backup+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.3.+Overconstrained+Planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0319%0A16.3.1.+Overconstrained+Planning+with+Nullable+Variables+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0319%0A16.3.2.+Overconstrained+Planning+with+Virtual+Values+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0320%0A16.4.+Continuous+Planning+%28Windowed+Planning%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0321%0A16.4.1.+Immovable+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0324%0A16.4.2.+Nonvolatile+Replanning+to+Minimize+Disruption+%28Semi-movable+Planning+Entities%29.+.+.+%C2%A0326%0A16.5.+Real-time+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0327%0A16.5.1.+ProblemFactChange+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0328%0A16.5.2.+Daemon%3A+solve%28%29+Does+Not+Return+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0332%0A17.+Integration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.+Persistent+Storage.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.1.+Database%3A+JPA+and+Hibernate.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.2.+XML+or+JSON%3A+XStream+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0338%0A17.2.3.+XML+or+JSON%3A+JAXB.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0339%0A17.2.4.+JSON%3A+Jackson.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0340%0A17.3.+SOA+and+ESB+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.3.1.+Camel+and+Karaf+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.+Other+Environments+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.1.+JBoss+Modules%2C+WildFly+and+JBoss+EAP+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.2.+Spring+Boot.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0344%0A17.4.3.+Java+Platform+Module+System+%28Jigsaw%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0344%0A17.4.4.+OSGi+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0345%0A17.4.5.+Android+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0345%0A17.5.+Integration+with+Human+Planners+%28Politics%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0346%0A17.6.+Sizing+Hardware+and+Software.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0348%0A18.+Design+Patterns.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.1.+Design+Patterns+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.2.+Domain+Modeling+Guide.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.3.+Assigning+Time+to+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0354%0A18.3.1.+Timeslot+Pattern%3A+Assign+to+a+Fixed-Length+Timeslot.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0356%0A18.3.2.+TimeGrain+Pattern%3A+Assign+to+a+Starting+TimeGrain+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0356%0A18.3.3.+Chained+Through+Time+Pattern%3A+Assign+in+a+Chain+that+Determines+Starting+Time.+.+.+.+%C2%A0357%0A18.4.+Multi-stage+planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0358%0A19.+Development+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0359%0A19.1.+Methodology+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0359%0A19.2.+Development+guidelines+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0360%0AChapter+1.+OptaPlanner+Introduction%0A1.1.+What+is+OptaPlanner%3F%0AEvery+organization+faces+planning+problems%3A+providing+products+or+services+with+a+limited+set+of%0Aconstrained+resources+%28employees%2C+assets%2C+time+and+money%29.+OptaPlanner+optimizes+such+planning%0Ato+do+more+business+with+less+resources.+This+is+known+as+Constraint+Satisfaction+Programming%0A%28which+is+part+of+the+Operations+Research+discipline%29.%0AOptaPlanner+is+a+lightweight%2C+embeddable+constraint+satisfaction+engine+which+optimizes+planning%0Aproblems.+It+solves+use+cases+such+as%3A%0A%E2%80%A2+Employee+shift+rostering%3A+timetabling+nurses%2C+repairmen%2C+%E2%80%A6%0A%E2%80%A2+Agenda+scheduling%3A+scheduling+meetings%2C+appointments%2C+maintenance+jobs%2C+advertisements%2C+%E2%80%A6%0A%E2%80%A2+Educational+timetabling%3A+scheduling+lessons%2C+courses%2C+exams%2C+conference+presentations%2C+%E2%80%A6%0A%E2%80%A2+Vehicle+routing%3A+planning+vehicle+routes+%28trucks%2C+trains%2C+boats%2C+airplanes%2C+%E2%80%A6%29+for+moving+freight%0Aand%2For+passengers+through+multiple+destinations+using+known+mapping+tools+%E2%80%A6%0A%E2%80%A2+Bin+packing%3A+filling+containers%2C+trucks%2C+ships%2C+and+storage+warehouses+with+items%2C+but+also%0Apacking+information+across+computer+resources%2C+as+in+cloud+computing+%E2%80%A6%0A%E2%80%A2+Job+shop+scheduling%3A+planning+car+assembly+lines%2C+machine+queue+planning%2C+workforce+task%0Aplanning%2C+%E2%80%A6%0A%E2%80%A2+Cutting+stock%3A+minimizing+waste+while+cutting+paper%2C+steel%2C+carpet%2C+%E2%80%A6%0A%E2%80%A2+Sport+scheduling%3A+planning+games+and+training+schedules+for+football+leagues%2C+baseball+leagues%2C%0A%E2%80%A6%0A%E2%80%A2+Financial+optimization%3A+investment+portfolio+optimization%2C+risk+spreading%2C+%E2%80%A6%0A1%0A1.2.+What+is+a+Planning+Problem%3F%0A2%0AA+planning+problem+has+an+optimal+goal%2C+based+on+limited+resources+and+under+specific+constraints.%0AOptimal+goals+can+be+any+number+of+things%2C+such+as%3A%0A%E2%80%A2+Maximized+profits+-+the+optimal+goal+results+in+the+highest+possible+profit.%0A%E2%80%A2+Minimized+ecological+footprint+-+the+optimal+goal+has+the+least+amount+of+environmental+impact.%0A%E2%80%A2+Maximized+satisfaction+for+employees+or+customers+-+the+optimal+goal+prioritizes+the+needs+of%0Aemployees+or+customers.%0AThe+ability+to+achieve+these+goals+relies+on+the+number+of+resources+available%2C+such+as%3A%0A%E2%80%A2+The+number+of+people.%0A%E2%80%A2+Amount+of+time.%0A%E2%80%A2+Budget.%0A%E2%80%A2+Physical+assets%2C+for+example%2C+machinery%2C+vehicles%2C+computers%2C+buildings%2C+etc.%0ASpecific+constraints+related+to+these+resources+must+also+be+taken+into+account%2C+such+as+the+number%0Aof+hours+a+person+works%2C+their+ability+to+use+certain+machines%2C+or+compatibility+between+pieces+of%0Aequipment.%0AOptaPlanner+helps+JavaTM+programmers+solve+constraint+satisfaction+problems+efficiently.+Under+the%0Ahood%2C+it+combines+optimization+heuristics+and+metaheuristics+with+very+efficient+score+calculation.%0A3%0A1.2.1.+A+Planning+Problem+is+NP-complete+or+NP-hard%0AAll+the+use+cases+above+are+probably+NP-complete%2FNP-hard%2C+which+means+in+layman%E2%80%99s+terms%3A%0A%E2%80%A2+It%E2%80%99s+easy+to+verify+a+given+solution+to+a+problem+in+reasonable+time.%0A%E2%80%A2+There+is+no+silver+bullet+to+find+the+optimal+solution+of+a+problem+in+reasonable+time+%28*%29.%0A%28*%29+At+least%2C+none+of+the+smartest+computer+scientists+in+the+world+have+found+such%0Aa+silver+bullet+yet.+But+if+they+find+one+for+1+NP-complete+problem%2C+it+will+work+for%0A%EF%81%9A+every+NP-complete+problem.%0AIn+fact%2C+there%E2%80%99s+a+%24+1%2C000%2C000+reward+for+anyone+that+proves+if+such+a+silver+bullet%0Aactually+exists+or+not.%0AThe+implication+of+this+is+pretty+dire%3A+solving+your+problem+is+probably+harder+than+you+anticipated%2C%0Abecause+the+two+common+techniques+won%E2%80%99t+suffice%3A%0A%E2%80%A2+A+Brute+Force+algorithm+%28even+a+smarter+variant%29+will+take+too+long.%0A%E2%80%A2+A+quick+algorithm%2C+for+example+in+bin+packing%2C+putting+in+the+largest+items+first%2C+will+return+a%0Asolution+that+is+far+from+optimal.%0ABy+using+advanced+optimization+algorithms%2C+OptaPlanner+does+find+a+good+solution+in%0Areasonable+time+for+such+planning+problems.%0A1.2.2.+A+Planning+Problem+Has+%28Hard+and+Soft%29+Constraints%0AUsually%2C+a+planning+problem+has+at+least+two+levels+of+constraints%3A%0A%E2%80%A2+A+%28negative%29+hard+constraint+must+not+be+broken.+For+example%3A+1+teacher+can+not+teach+2+different%0Alessons+at+the+same+time.%0A%E2%80%A2+A+%28negative%29+soft+constraint+should+not+be+broken+if+it+can+be+avoided.+For+example%3A+Teacher+A%0Adoes+not+like+to+teach+on+Friday+afternoon.%0ASome+problems+have+positive+constraints+too%3A%0A%E2%80%A2+A+positive+soft+constraint+%28or+reward%29+should+be+fulfilled+if+possible.+For+example%3A+Teacher+B+likes%0Ato+teach+on+Monday+morning.%0ASome+basic+problems+%28such+as+N+queens%29+only+have+hard+constraints.+Some+problems+have+three+or%0Amore+levels+of+constraints%2C+for+example+hard%2C+medium+and+soft+constraints.%0AThese+constraints+define+the+score+calculation+%28AKA+fitness+function%29+of+a+planning+problem.+Each%0Asolution+of+a+planning+problem+can+be+graded+with+a+score.+With+OptaPlanner%2C+score+constraints%0Aare+written+in+an+Object+Oriented+language%2C+such+as+JavaTM+code+or+Drools+rules.+Such+code+is%0Aeasy%2C+flexible+and+scalable.%0A1.2.3.+A+Planning+Problem+Has+a+Huge+Search+Space%0AA+planning+problem+has+a+number+of+solutions.+There+are+several+categories+of+solutions%3A%0A4%0A%E2%80%A2+A+possible+solution+is+any+solution%2C+whether+or+not+it+breaks+any+number+of+constraints.+Planning%0Aproblems+tend+to+have+an+incredibly+large+number+of+possible+solutions.+Many+of+those+solutions%0Aare+worthless.%0A%E2%80%A2+A+feasible+solution+is+a+solution+that+does+not+break+any+%28negative%29+hard+constraints.+The+number%0Aof+feasible+solutions+tends+to+be+relative+to+the+number+of+possible+solutions.+Sometimes+there%0Aare+no+feasible+solutions.+Every+feasible+solution+is+a+possible+solution.%0A%E2%80%A2+An+optimal+solution+is+a+solution+with+the+highest+score.+Planning+problems+tend+to+have+1+or+a%0Afew+optimal+solutions.+There+is+always+at+least+1+optimal+solution%2C+even+in+the+case+that+there+are%0Ano+feasible+solutions+and+the+optimal+solution+isn%E2%80%99t+feasible.%0A%E2%80%A2+The+best+solution+found+is+the+solution+with+the+highest+score+found+by+an+implementation+in+a%0Agiven+amount+of+time.+The+best+solution+found+is+likely+to+be+feasible+and%2C+given+enough+time%2C+it%E2%80%99s%0Aan+optimal+solution.%0ACounterintuitively%2C+the+number+of+possible+solutions+is+huge+%28if+calculated+correctly%29%2C+even+with+a%0Asmall+dataset.+As+you+can+see+in+the+examples%2C+most+instances+have+a+lot+more+possible+solutions%0Athan+the+minimal+number+of+atoms+in+the+known+universe+%2810%5E80%29.+Because+there+is+no+silver+bullet%0Ato+find+the+optimal+solution%2C+any+implementation+is+forced+to+evaluate+at+least+a+subset+of+all+those%0Apossible+solutions.%0AOptaPlanner+supports+several+optimization+algorithms+to+efficiently+wade+through+that+incredibly%0Alarge+number+of+possible+solutions.+Depending+on+the+use+case%2C+some+optimization+algorithms%0Aperform+better+than+others%2C+but+it%E2%80%99s+impossible+to+tell+in+advance.+With+OptaPlanner%2C+it+is+easy+to%0Aswitch+the+optimization+algorithm%2C+by+changing+the+solver+configuration+in+a+few+lines+of+XML+or%0Acode.%0A1.3.+Requirements%0AOptaPlanner+is+open+source+software%2C+released+under+the+Apache+Software+License+2.0.+This+license%0Ais+very+liberal+and+allows+reuse+for+commercial+purposes.+Read+the+layman%E2%80%99s+explanation.%0AOptaPlanner+is+100%25+pure+JavaTM+and+runs+on+any+JVM+8+or+higher.+It+integrates+very+easily+with%0Aother+JavaTM+technologies.+OptaPlanner+is+available+in+the+Maven+Central+Repository.%0APlanner+works+on+any+Java+Virtual+Machine+and+is+compatible+with+Standard+Java%2C+Enterprise+Java%2C%0Aand+all+JVM+languages.%0A5%0A1.4.+Governance%0A1.4.1.+Status+of+OptaPlanner%0AOptaPlanner+is+stable%2C+reliable+and+scaleable.+It+has+been+heavily+tested+with+unit%2C+integration%2C+and%0Astress+tests%2C+and+is+used+in+production+throughout+the+world.+One+example+handles+over+50+000%0Avariables+with+5000+variables+each%2C+multiple+constraint+types+and+billions+of+possible+constraint%0Amatches.%0A1.4.2.+Release+Notes%0AWe+release+every+month.+Read+the+release+notes+of+each+release+on+our+website.%0A1.4.3.+Backwards+Compatibility%0AOptaPlanner+separates+its+API+and+implementation%3A%0A%E2%80%A2+Public+API%3A+All+classes+in+the+package+namespace+org.optaplanner.core.api+are+100%25%0Abackwards+compatible+in+future+releases+%28especially+minor+and+hotfix+releases%29.+In+rare%0Acircumstances%2C+if+the+major+version+number+changes%2C+a+few+specific+classes+might+have+a+few%0Abackwards+incompatible+changes%2C+but+those+will+be+clearly+documented+in+the+upgrade+recipe.%0A%E2%80%A2+XML+configuration%3A+The+XML+solver+configuration+is+backwards+compatible+for+all+elements%2C%0Aexcept+for+elements+that+require+the+use+of+non+public+API+classes.+The+XML+solver+configuration%0A6%0Ais+defined+by+the+classes+in+the+package+namespace+org.optaplanner.core.config.%0A%E2%80%A2+Implementation+classes%3A+All+classes+in+the+package+namespace+org.optaplanner.core.impl+are%0Anot+backwards+compatible%3A+they+will+change+in+future+major+or+minor+releases+%28but+probably+not%0Ain+hotfix+releases%29.+The+upgrade+recipe+describes+every+such+relevant+change+and+on+how+to%0Aquickly+deal+with+it+when+upgrading+to+a+newer+version.%0AThis+documentation+covers+some+impl+classes+too.+Those+documented+impl+classes%0Aare+reliable+and+safe+to+use+%28unless+explicitly+marked+as+experimental+in+this%0A%EF%81%9A+documentation%29%2C+but+we%E2%80%99re+just+not+entirely+comfortable+yet+to+write+their%0Asignatures+in+stone.%0A1.4.4.+Community+and+Support%0AFor+news+and+articles%2C+check+our+blog%2C+twitter+%28including+Geoffrey%E2%80%99s+twitter%29+and+facebook.%0AIf+you%E2%80%99re+happy+with+OptaPlanner%2C+make+us+happy+by+posting+a+tweet+or+blog+article+about+it.%0APublic+questions+are+welcome+on+here.+Bugs+and+feature+requests+are+welcome+in+our+issue+tracker.%0APull+requests+are+very+welcome+on+GitHub+and+get+priority+treatment%21+By+open+sourcing+your%0Aimprovements%2C+you+%27ll+benefit+from+our+peer+review+and+from+our+improvements+made+on+top+of%0Ayour+improvements.%0ARed+Hat+sponsors+OptaPlanner+development+by+employing+the+core+team.+For+enterprise+support%0Aand+consulting%2C+take+a+look+at+these+services.%0A1.4.5.+Relationship+with+Drools+and+jBPM%0AOptaPlanner+is+part+of+the+KIE+group+of+projects.+It+releases+regularly+%28often+once+or+twice+per%0Amonth%29+together+with+the+Drools+rule+engine+and+the+jBPM+workflow+engine.%0A7%0ASee+the+architecture+overview+to+learn+more+about+the+optional+integration+with+Drools.%0A1.5.+Download+and+Run+the+Examples%0A1.5.1.+Get+the+Release+zip+and+Run+the+Examples%0ATo+try+it+now%3A%0A1.+Download+a+release+zip+of+OptaPlanner+from+the+OptaPlanner+website+and+unzip+it.%0A2.+Open+the+directory+examples+and+run+the+script.%0ALinux+or+Mac%3A%0A%24+cd+examples%0A%24+.%2FrunExamples.sh%0AWindows%3A%0A%24+cd+examples%0A%24+runExamples.bat%0A8%0AThe+Examples+GUI+application+will+open.+Pick+an+example+to+try+it+out%3A%0A9%0AOptaPlanner+itself+has+no+GUI+dependencies.+It+runs+just+as+well+on+a+server+or+a%0A%EF%81%9A+mobile+JVM+as+it+does+on+the+desktop.%0A1.5.2.+Run+the+Webexamples%0ABesides+the+GUI+examples%2C+there+are+also+a+set+of+webexamples+to+try+out.+The+webexamples+include%3A%0A%E2%80%A2+Vehicle+routing%3A+calculating+the+shortest+possible+route+to+pick+up+all+items+required+for+a%0Anumber+of+different+customers+using+either+Leaflet+or+Google+Maps+visualizations.%0A%E2%80%A2+Cloud+balancing%3A+Assigning+processes+across+computers+with+different+specifications+and+costs.%0APrerequisites%0AThe+webexamples+require+several+JEE+APIs+to+run%2C+such+as%3A%0A%E2%80%A2+Servlet%0A%E2%80%A2+JAX-RS%0A%E2%80%A2+CDI%0AThese+are+not+required+for+Planner+itself.%0ARunning+the+Webexamples+on+a+JEE+Application+Server%0A1.+Download+a+JEE+application+server%2C+such+as+JBoss+EAP+or+WildFly+and+unzip+it.%0A10%0A2.+Download+a+release+zip+of+OptaPlanner+from+the+OptaPlanner+website+and+unzip+it.%0A3.+Open+the+directory+webexamples+and+deploy+the+optaplanner-webexamples-*.war+file+on+the+JEE%0Aapplication+server.%0AIf+using+JBoss+EAP+in+standalone+mode%2C+this+can+be+done+by+adding+the+optaplanner-webexamples-%0A.war+file+to+the+jboss-eap-%2Fstandalone%2Fdeployments+folder.%0A4.+Open+the+following+address+in+a+web+browser%3A+http%3A%2F%2Flocalhost%3A8080%2Foptaplanner-webexamples-%0A*%2F+%28replace+the+*+with+the+actual+version%29.%0ADeploying+Webexamples+on+a+Servlet+Container%0ATo+successfully+deploy+the+webexamples+on+a+servlet+container+%28such+as+Jetty+or+Tomcat%29+instead+of%0Aon+a+real+JEE+application+server+%28such+as+WildFly%29%3A%0A1.+Add+the+missing+implementation+libraries+%28for+example+RestEasy+and+Weld%29+in+the+optaplanner-%0Awebexamples-*.war+manually.%0A2.+Deploy+the+optaplanner-webexamples-*.war+on+the+servlet+container.%0APick+an+example+to+try+it+out%2C+such+as+the+Vehicle+Routing+example%3A%0A1.5.3.+Run+the+Examples+in+an+IDE+%28IntelliJ%2C+Eclipse%2C+NetBeans%29%0ATo+run+the+examples+in+your+favorite+IDE%3A%0A11%0A%E2%80%A2+In+IntelliJ+IDEA%2C+NetBeans+or+a+non-vanilla+Eclipse%3A%0A1.+Open+the+file+examples%2Fsources%2Fpom.xml+as+a+new+project%2C+the+maven+integration+will+take%0Acare+of+the+rest.%0A2.+Run+the+examples+from+the+project.%0A%E2%80%A2+In+a+vanilla+Eclipse+%28which+lacks+the+M2Eclipse+plugin%29%3A%0A1.+Open+a+new+project+for+the+directory+examples%2Fsources+.%0A2.+Add+all+the+jars+to+the+classpath+from+the+directory+binaries+and+the+directory%0Aexamples%2Fbinaries+%2C+except+for+the+file+examples%2Fbinaries%2Foptaplanner-examples-*.jar+.%0A3.+Add+the+Java+source+directory+src%2Fmain%2Fjava+and+the+Java+resources+directory%0Asrc%2Fmain%2Fresources+.%0A4.+Create+a+run+configuration%3A%0A%E2%96%AA+Main+class%3A+org.optaplanner.examples.app.OptaPlannerExamplesApp%0A%E2%96%AA+VM+parameters+%28optional%29%3A+-Xmx512M+-server%0Aa.+To+run+a+specific+example+directly+and+skip+the+example+selection+window%2C+run+its+App%0Aclass+%28for+example+CloudBalancingApp%29+instead+of+OptaPlannerExamplesApp.%0A5.+Run+that+run+configuration.%0A1.5.4.+Use+OptaPlanner+with+Maven%2C+Gradle%2C+Ivy%2C+Buildr+or+ANT%0AThe+OptaPlanner+jars+are+also+available+in+the+central+maven+repository+%28and+also+in+the+JBoss%0Amaven+repository%29.%0AIf+you+use+Maven%2C+add+a+dependency+to+optaplanner-core+in+your+project%E2%80%99s+pom.xml+%3A%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eoptaplanner-core%3C%2FartifactId%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AThis+is+similar+for+Gradle%2C+Ivy+and+Buildr.+To+identify+the+latest+version%2C+check+the+central+maven%0Arepository.%0ABecause+you+might+end+up+using+other+OptaPlanner+modules+too%2C+it%E2%80%99s+recommended+to+import+the%0Aoptaplanner-bom+in+Maven%E2%80%99s+dependencyManagement+so+the+OptaPlanner+version+is+specified+only+once%3A%0A12%0A%C2%A0+%3CdependencyManagement%3E%0A%C2%A0+++%3Cdependencies%3E%0A%C2%A0+++++%3Cdependency%3E%0A%C2%A0+++++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++++%3CartifactId%3Eoptaplanner-bom%3C%2FartifactId%3E%0A%C2%A0+++++++%3Ctype%3Epom%3C%2Ftype%3E%0A%C2%A0+++++++%3Cversion%3E...%3C%2Fversion%3E%0A%C2%A0+++++++%3Cscope%3Eimport%3C%2Fscope%3E%0A%C2%A0+++++%3C%2Fdependency%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fdependencies%3E%0A%C2%A0+%3C%2FdependencyManagement%3E%0AIf+you%E2%80%99re+still+using+ANT+%28without+Ivy%29%2C+copy+all+the+jars+from+the+download+zip%E2%80%99s+binaries+directory+in%0Ayour+classpath.%0AThe+download+zip%E2%80%99s+binaries+directory+contains+far+more+jars+then+optaplanner-core%0Aactually+uses.+It+also+contains+the+jars+used+by+other+modules%2C+such+as+optaplanner-%0A%EF%81%9A+benchmark.%0ACheck+the+maven+repository+pom.xml+files+to+determine+the+minimal+dependency%0Aset+of+a+specific+module+%28for+a+specific+version%29.%0A1.5.5.+Build+OptaPlanner+from+Source%0APrerequisites%0A%E2%80%A2+Set+up+Git.%0A%E2%80%A2+Authenticate+on+GitHub+using+either+HTTPS+or+SSH.%0A%E2%97%A6+See+GitHub+for+more+information+about+setting+up+and+authenticating+Git.%0A%E2%80%A2+Set+up+Maven.%0ABuild+and+run+the+examples+from+source.%0A1.+Clone+optaplanner+from+GitHub+%28or+alternatively%2C+download+the+zipball%29%3A%0A%24+git+clone+https%3A%2F%2Fgithub.com%2Fkiegroup%2Foptaplanner.git%0A...%0A2.+Build+it+with+Maven%3A%0A%24+cd+optaplanner%0A%24+mvn+clean+install+-DskipTests%0A...%0A13%0AThe+first+time%2C+Maven+might+take+a+long+time%2C+because+it+needs+to+download%0A%EF%81%9A+jars.%0A3.+Run+the+examples%3A%0A%24+cd+optaplanner-examples%0A%24+mvn+exec%3Ajava%0A...%0A4.+Edit+the+sources+in+your+favorite+IDE.%0Aa.+Optional%3A+use+a+Java+profiler.%0A14%0AChapter+2.+Getting+Started%3A+A+Cloud%0ABalancing+Demonstration%0A2.1.+Cloud+Balancing+Tutorial%0A2.1.1.+Problem+Description%0ASuppose+your+company+owns+a+number+of+cloud+computers+and+needs+to+run+a+number+of%0Aprocesses+on+those+computers.+Assign+each+process+to+a+computer.%0AThe+following+hard+constraints+must+be+fulfilled%3A%0A%E2%80%A2+Every+computer+must+be+able+to+handle+the+minimum+hardware+requirements+of+the+sum+of+its%0Aprocesses%3A%0A%E2%97%A6+CPU+capacity%3A+The+CPU+power+of+a+computer+must+be+at+least+the+sum+of+the+CPU+power%0Arequired+by+the+processes+assigned+to+that+computer.%0A%E2%97%A6+Memory+capacity%3A+The+RAM+memory+of+a+computer+must+be+at+least+the+sum+of+the+RAM%0Amemory+required+by+the+processes+assigned+to+that+computer.%0A%E2%97%A6+Network+capacity%3A+The+network+bandwidth+of+a+computer+must+be+at+least+the+sum+of+the%0Anetwork+bandwidth+required+by+the+processes+assigned+to+that+computer.%0AThe+following+soft+constraints+should+be+optimized%3A%0A%E2%80%A2+Each+computer+that+has+one+or+more+processes+assigned%2C+incurs+a+maintenance+cost+%28which+is%0Afixed+per+computer%29.%0A%E2%97%A6+Cost%3A+Minimize+the+total+maintenance+cost.%0AThis+problem+is+a+form+of+bin+packing.+The+following+is+a+simplified+example%2C+in+which+we+assign%0Afour+processes+to+two+computers+with+two+constraints+%28CPU+and+RAM%29+with+a+simple+algorithm%3A%0A15%0AThe+simple+algorithm+used+here+is+the+First+Fit+Decreasing+algorithm%2C+which+assigns+the+bigger%0Aprocesses+first+and+assigns+the+smaller+processes+to+the+remaining+space.+As+you+can+see%2C+it+is+not%0Aoptimal%2C+as+it+does+not+leave+enough+room+to+assign+the+yellow+process+D.%0APlanner+does+find+the+more+optimal+solution+by+using+additional%2C+smarter+algorithms.+It+also+scales%3A%0Aboth+in+data+%28more+processes%2C+more+computers%29+and+constraints+%28more+hardware+requirements%2C%0Aother+constraints%29.+So+let%E2%80%99s+see+how+Planner+can+be+used+in+this+scenario.%0AHere%E2%80%99s+an+executive+summary+of+this+example+and+an+advanced+implementation+with+more%0Aconstraints%3A%0A16%0A2.1.2.+Problem+Size%0ATable+1.+Cloud+Balancing+Problem+Size%0AProblem+Size+Computers+Processes+Search+Space%0A2computers-6processes+2+6+64%0A3computers-9processes+3+9+10%5E4%0A4computers-+4+12+10%5E7%0A012processes%0A100computers-+100+300+10%5E600%0A300processes%0A200computers-+200+600+10%5E1380%0A600processes%0A400computers-+400+1200+10%5E3122%0A1200processes%0A800computers-+800+2400+10%5E6967%0A2400processes%0A2.2.+Using+the+Domain+Model%0A17%0A2.2.1.+Domain+Model+Design%0AUsing+a+domain+model+helps+determine+which+classes+are+planning+entities+and+which+of+their%0Aproperties+are+planning+variables.+It+also+helps+to+simplify+contraints%2C+improve+performance%2C+and%0Aincrease+flexibility+for+future+needs.%0A1.+Draw+a+class+diagram+of+your+domain+model.%0A2.+Normalize+it+to+remove+duplicate+data.%0A3.+Write+down+some+sample+instances+for+each+class.%0A%E2%97%A6+Computer%3A+represents+a+computer+with+certain+hardware+and+maintenance+costs.%0AIn+this+example%2C+the+sample+instances+for+the+Computer+class+are%3A+cpuPower%2C+memory%2C%0AnetworkBandwidth%2C+cost.%0A%E2%97%A6+Process%3A+represents+a+process+with+a+demand.+Needs+to+be+assigned+to+a+Computer+by+Planner.%0ASample+instances+for+Process+are%3A+requiredCpuPower%2C+requiredMemory%2C+and%0ArequiredNetworkBandwidth.%0A%E2%97%A6+CloudBalance%3A+represents+a+problem.+Contains+every+Computer+and+Process+for+a+certain+data%0Aset.%0AThe+sample+instance+for+CloudBalance+is+score.%0A4.+Determine+which+relationships+%28or+fields%29+change+during+planning.%0A%E2%97%A6+Planning+entity%3A+the+class+%28or+classes%29+that+changes+during+solving.+In+this+example%2C+it+is+the%0Aclass+Process.%0A%E2%97%A6+Planning+variable%3A+the+property+%28or+properties%29+of+a+planning+entity+class+that+changes+during%0Asolving.+In+this+example%2C+it+is+the+property+computer+on+the+class+Process.%0A%E2%97%A6+Planning+solution%3A+the+class+that+represents+a+data+set+and+contains+all+planning+entities.+In%0Athis+example+that+is+the+class+CloudBalance.%0AIn+the+UML+class+diagram+below%2C+the+Planner+concepts+are+already+annotated%3A%0A18%0A2.2.2.+Domain+Model+Implementation%0A2.2.2.1.+The+Computer+Class%0AThe+Computer+class+is+a+POJO+%28Plain+Old+Java+Object%29.+Usually%2C+you+will+have+more+of+this+kind+of%0Aclasses+with+input+data.%0AExample+1.+CloudComputer.java%0Apublic+class+CloudComputer+...+%7B%0A%C2%A0+++private+int+cpuPower%3B%0A%C2%A0+++private+int+memory%3B%0A%C2%A0+++private+int+networkBandwidth%3B%0A%C2%A0+++private+int+cost%3B%0A%C2%A0+++...+%2F%2F+getters%0A%7D%0A2.2.2.2.+The+Process+Class%0AThe+Process+class+is+particularly+important.+It+is+the+class+that+is+modified+during+solving.%0A19%0AWe+need+to+tell+Planner+that+it+can+change+the+property+computer.+To+do+this%3A+.+Annotate+the+class%0Awith+%40PlanningEntity.+.+Annotate+the+getter+getComputer%28%29+with+%40PlanningVariable.%0AOf+course%2C+the+property+computer+needs+a+setter+too%2C+so+Planner+can+change+it+during+solving.%0AExample+2.+CloudProcess.java%0A%40PlanningEntity%28...%29%0Apublic+class+CloudProcess+...+%7B%0A%C2%A0+++private+int+requiredCpuPower%3B%0A%C2%A0+++private+int+requiredMemory%3B%0A%C2%A0+++private+int+requiredNetworkBandwidth%3B%0A%C2%A0+++private+CloudComputer+computer%3B%0A%C2%A0+++...+%2F%2F+getters%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22computerRange%22%7D%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setComputer%28CloudComputer+computer%29+%7B%0A%C2%A0+++++++computer+%3D+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+************************************************************************%0A%C2%A0+++%2F%2F+Complex+methods%0A%C2%A0+++%2F%2F+************************************************************************%0A%C2%A0+++...%0A%7D%0A%E2%80%A2+Planner+needs+to+know+which+values+it+can+choose+from+to+assign+to+the+property+computer.%0AThose+values+are+retrieved+from+the+method+CloudBalance.getComputerList%28%29+on+the+planning%0Asolution%2C+which+returns+a+list+of+all+computers+in+the+current+data+set.%0A%E2%80%A2+The+%40PlanningVariable%27s+valueRangeProviderRefs+parameter+on+CloudProcess.getComputer%28%29+needs%0Ato+match+with+the+%40ValueRangeProvider%27s+id+on+CloudBalance.getComputerList%28%29.%0A%EF%81%9A+Instead+of+getter+annotations%2C+it+is+also+possible+to+use+field+annotations.%0A2.2.2.3.+The+CloudBalance+Class%0AThe+CloudBalance+class+has+a+%40PlanningSolution+annotation.%0A%E2%80%A2+It+holds+a+list+of+all+computers+and+processes.%0A20%0A%E2%80%A2+It+represents+both+the+planning+problem+and+%28if+it%E2%80%99s+initialized%29+the+planning+solution.%0A1.+Planner+needs+to+retrieve+the+collection+of+processes+that+it+can+change%2C+therefore+we%0Aannotate+the+getter+getProcessList%28%29+with+%40PlanningEntityCollectionProperty.%0A2.+The+CloudBalance+class+also+has+a+%40PlanningScore+annotated+property+score%2C+which+is+the+Score%0Aof+that+solution+in+its+current+state.+Planner+automatically+updates+it+when+it+calculates+a%0AScore+for+a+solution+instance+and+therefore+it+needs+a+setter.%0A3.+Especially+for+score+calculation+with+Drools%2C+the+property+computerList+needs+to+be+annotated%0Awith+a+%40ProblemFactCollectionProperty+so+the+computers+are+known+to+it.%0AExample+3.+CloudBalance.java%0A%40PlanningSolution%0Apublic+class+CloudBalance+...+%7B%0A%C2%A0+++private+List%3CCloudComputer%3E+computerList%3B%0A%C2%A0+++private+List%3CCloudProcess%3E+processList%3B%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22computerRange%22%29%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CCloudComputer%3E+getComputerList%28%29+%7B%0A%C2%A0+++++++return+computerList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40PlanningEntityCollectionProperty%0A%C2%A0+++public+List%3CCloudProcess%3E+getProcessList%28%29+%7B%0A%C2%A0+++++++return+processList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+HardSoftScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28HardSoftScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A2.3.+Run+the+Cloud+Balancing+Hello+World%0A1.+Download+and+configure+the+examples+in+your+preferred+IDE.%0A21%0A2.+Create+a+run+configuration+with+the+following+main+class%3A%0Aorg.optaplanner.examples.cloudbalancing.app.CloudBalancingHelloWorld%0ABy+default%2C+the+Cloud+Balancing+Hello+World+is+configured+to+run+for+120+seconds.%0AIt+will+execute+the+following+code%3A%0AExample+4.+CloudBalancingHelloWorld.java%0Apublic+class+CloudBalancingHelloWorld+%7B%0A%C2%A0+++public+static+void+main%28String%5B%5D+args%29+%7B%0A%C2%A0+++++++%2F%2F+Build+the+Solver%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%3B%0A%C2%A0+++++++Solver%3CCloudBalance%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0A%C2%A0+++++++%2F%2F+Load+a+problem+with+400+computers+and+1200+processes%0A%C2%A0+++++++CloudBalance+unsolvedCloudBalance+%3D+new+CloudBalancingGenerator%28%29%0A.createCloudBalance%28400%2C+1200%29%3B%0A%C2%A0+++++++%2F%2F+Solve+the+problem%0A%C2%A0+++++++CloudBalance+solvedCloudBalance+%3D+solver.solve%28unsolvedCloudBalance%29%3B%0A%C2%A0+++++++%2F%2F+Display+the+result%0A%C2%A0+++++++System.out.println%28%22%5CnSolved+cloudBalance+with+400+computers+and+1200%0Aprocesses%3A%5Cn%22%0A%C2%A0+++++++++++++++%2B+toDisplayString%28solvedCloudBalance%29%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0AThe+code+example+does+the+following%3A%0A1.+Build+the+Solver+based+on+a+solver+configuration+%28in+this+case+an+XML+file%2C%0AcloudBalancingSolverConfig.xml%2C+from+the+classpath%29.%0ABuilding+the+Solver+is+the+most+complicated+part+of+this+procedure.+For+more+detail%2C+see+Solver%0AConfiguration.%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%3B%0A%C2%A0+++++++Solver+solver%3CCloudBalance%3E+%3D+solverFactory.buildSolver%28%29%3B%0A22%0A2.+Load+the+problem.%0ACloudBalancingGenerator+generates+a+random+problem%3A+you+will+replace+this+with+a+class+that%0Aloads+a+real+problem%2C+for+example+from+a+database.%0A%C2%A0+++++++CloudBalance+unsolvedCloudBalance+%3D+new+CloudBalancingGenerator%28%29%0A.createCloudBalance%28400%2C+1200%29%3B%0A3.+Solve+the+problem.%0A%C2%A0+++++++CloudBalance+solvedCloudBalance+%3D+solver.solve%28unsolvedCloudBalance%29%3B%0A4.+Display+the+result.%0A%C2%A0+++++++System.out.println%28%22%5CnSolved+cloudBalance+with+400+computers+and+1200%0Aprocesses%3A%5Cn%22%0A%C2%A0+++++++++++++++%2B+toDisplayString%28solvedCloudBalance%29%29%3B%0A2.4.+Solver+Configuration%0ATake+a+look+at+the+solver+configuration%3A%0AExample+5.+cloudBalancingSolverConfig.xml%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Domain+model+configuration+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+%3C%21--+Score+configuration+--%3E%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.C%0AloudBalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%21--%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.%0Adrl%3C%2FscoreDrl%3E--%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A%C2%A0+%3C%21--+Optimization+algorithms+configuration+--%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E30%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%3C%2Fsolver%3E%0A23%0AThis+solver+configuration+consists+of+three+parts%3A%0A1.+Domain+model+configuration%3A+What+can+Planner+change%3F%0AWe+need+to+make+Planner+aware+of+our+domain+classes.+In+this+configuration%2C+it+will%0Aautomatically+scan+all+classes+in+your+classpath+%28for+a+%40PlanningEntity+or+%40PlanningSolution%0Aannotation%29%3A%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A2.+Score+configuration%3A+How+should+Planner+optimize+the+planning+variables%3F+What+is+our+goal%3F%0ASince+we+have+hard+and+soft+constraints%2C+we+use+a+HardSoftScore.+But+we+need+to+tell+Planner%0Ahow+to+calculate+the+score%2C+depending+on+our+business+requirements.+Further+down%2C+we+will%0Alook+into+two+alternatives+to+calculate+the+score%3A+using+an+easy+Java+implementation%2C+or+using%0ADrools+DRL.%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.Cl%0AoudBalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%21--%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.d%0Arl%3C%2FscoreDrl%3E--%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A3.+Optimization+algorithms+configuration%3A+How+should+Planner+optimize+it%3F%0AIn+this+case%2C+we+use+the+default+optimization+algorithms+%28because+no+explicit+optimization%0Aalgorithms+are+configured%29+for+30+seconds%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E30%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0APlanner+should+get+a+good+result+in+seconds+%28and+even+in+less+than+15+milliseconds+with+real-%0Atime+planning%29%2C+but+the+more+time+it+has%2C+the+better+the+result+will+be.+Advanced+use+cases+might%0Ause+a+different+termination+criteria+than+a+hard+time+limit.%0AThe+default+algorithms+will+already+easily+surpass+human+planners+and+most+in-house%0Aimplementations.+Use+the+Benchmarker+to+power+tweak+to+get+even+better+results.%0A2.5.+Score+Configuration%0APlanner+will+search+for+the+Solution+with+the+highest+Score.+This+example+uses+a+HardSoftScore%2C%0Awhich+means+Planner+will+look+for+the+solution+with+no+hard+constraints+broken+%28fulfill+hardware%0A24%0Arequirements%29+and+as+little+as+possible+soft+constraints+broken+%28minimize+maintenance+cost%29.%0AOf+course%2C+Planner+needs+to+be+told+about+these+domain-specific+score+constraints.+There+are+several%0Aways+to+implement+such+a+score+function%3A%0A%E2%80%A2+Easy+Java%0A%E2%80%A2+Incremental+Java%0A%E2%80%A2+Drools%0A2.5.1.+Easy+Java+Score+Configuration%0AOne+way+to+define+a+score+function+is+to+implement+the+interface+EasyScoreCalculator+in+plain+Java.%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.Cloud%0ABalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AJust+implement+the+calculateScore%28Solution%29+method+to+return+a+HardSoftScore+instance.%0AExample+6.+CloudBalancingEasyScoreCalculator.java%0A25%0Apublic+class+CloudBalancingEasyScoreCalculator+implements+EasyScoreCalculator%0A%3CCloudBalance%3E+%7B%0A%C2%A0+++%2F**%0A%C2%A0++++*+A+very+simple+implementation.+The+double+loop+can+easily+be+removed+by%0Ausing+Maps+as+shown+in%0A%C2%A0++++*+%7B%40link%0ACloudBalancingMapBasedEasyScoreCalculator%23calculateScore%28CloudBalance%29%7D.%0A%C2%A0++++*%2F%0A%C2%A0+++public+HardSoftScore+calculateScore%28CloudBalance+cloudBalance%29+%7B%0A%C2%A0+++++++int+hardScore+%3D+0%3B%0A%C2%A0+++++++int+softScore+%3D+0%3B%0A%C2%A0+++++++for+%28CloudComputer+computer+%3A+cloudBalance.getComputerList%28%29%29+%7B%0A%C2%A0+++++++++++int+cpuPowerUsage+%3D+0%3B%0A%C2%A0+++++++++++int+memoryUsage+%3D+0%3B%0A%C2%A0+++++++++++int+networkBandwidthUsage+%3D+0%3B%0A%C2%A0+++++++++++boolean+used+%3D+false%3B%0A%C2%A0+++++++++++%2F%2F+Calculate+usage%0A%C2%A0+++++++++++for+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++++++if+%28computer.equals%28process.getComputer%28%29%29%29+%7B%0A%C2%A0+++++++++++++++++++cpuPowerUsage+%2B%3D+process.getRequiredCpuPower%28%29%3B%0A%C2%A0+++++++++++++++++++memoryUsage+%2B%3D+process.getRequiredMemory%28%29%3B%0A%C2%A0+++++++++++++++++++networkBandwidthUsage+%2B%3D+process.getRequiredNetworkBandwidth%28%0A%29%3B%0A%C2%A0+++++++++++++++++++used+%3D+true%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+Hard+constraints%0A%C2%A0+++++++++++int+cpuPowerAvailable+%3D+computer.getCpuPower%28%29+-+cpuPowerUsage%3B%0A%C2%A0+++++++++++if+%28cpuPowerAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+cpuPowerAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++int+memoryAvailable+%3D+computer.getMemory%28%29+-+memoryUsage%3B%0A%C2%A0+++++++++++if+%28memoryAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+memoryAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++int+networkBandwidthAvailable+%3D+computer.getNetworkBandwidth%28%29+-%0AnetworkBandwidthUsage%3B%0A%C2%A0+++++++++++if+%28networkBandwidthAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+networkBandwidthAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+Soft+constraints%0A%C2%A0+++++++++++if+%28used%29+%7B%0A%C2%A0+++++++++++++++softScore+-%3D+computer.getCost%28%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+HardSoftScore.valueOf%28hardScore%2C+softScore%29%3B%0A%C2%A0+++%7D%0A26%0A%7D%0AEven+if+we+optimize+the+code+above+to+use+Maps+to+iterate+through+the+processList+only+once%2C+it+is+still%0Aslow+because+it+does+not+do+incremental+score+calculation.+To+fix+that%2C+either+use+incremental+Java%0Ascore+calculation+or+Drools+score+calculation.%0A2.5.2.+Drools+Score+Configuration%0ADrools+score+calculation+uses+incremental+calculation%2C+where+every+score+constraint+is+written+as%0Aone+or+more+score+rules.%0AUsing+the+Drools+rule+engine+for+score+calculation%2C+allows+you+to+integrate+with+other+Drools%0Atechnologies%2C+such+as+decision+tables+%28XLS+or+web+based%29%2C+the+KIE+Workbench%2C+%E2%80%A6%0APrerequisite+To+use+the+Drools+rule+engine+as+a+score+function%2C+simply+add+a+scoreDrl+resource+in%0Athe+classpath%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.drl%3C%0A%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A1.+We+want+to+make+sure+that+all+computers+have+enough+CPU%2C+RAM+and+network+bandwidth+to%0Asupport+all+their+processes%2C+so+we+make+these+hard+constraints%3A%0A27%0AExample+7.+cloudBalancingScoreRules.drl+-+Hard+Constraints%0A...%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudBalance%3B%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudComputer%3B%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudProcess%3B%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%2F%2F+Hard+constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0Arule+%22requiredCpuPowerTotal%22%0A%C2%A0+++when%0A%C2%A0+++++++%24computer+%3A+CloudComputer%28%24cpuPower+%3A+cpuPower%29%0A%C2%A0+++++++accumulate%28%0A%C2%A0+++++++++++CloudProcess%28%0A%C2%A0+++++++++++++++computer+%3D%3D+%24computer%2C%0A%C2%A0+++++++++++++++%24requiredCpuPower+%3A+requiredCpuPower%29%3B%0A%C2%A0+++++++++++%24requiredCpuPowerTotal+%3A+sum%28%24requiredCpuPower%29%3B%0A%C2%A0+++++++++++%24requiredCpuPowerTotal+%3E+%24cpuPower%0A%C2%A0+++++++%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addHardConstraintMatch%28kcontext%2C+%24cpuPower+-%0A%24requiredCpuPowerTotal%29%3B%0Aend%0Arule+%22requiredMemoryTotal%22%0A%C2%A0+++...%0Aend%0Arule+%22requiredNetworkBandwidthTotal%22%0A%C2%A0+++...%0Aend%0A2.+If+those+constraints+are+met%2C+we+want+to+minimize+the+maintenance+cost%2C+so+we+add+that+as+a+soft%0Aconstraint%3A%0A28%0AExample+8.+cloudBalancingScoreRules.drl+-+Soft+Constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%2F%2F+Soft+constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0Arule+%22computerCost%22%0A%C2%A0+++when%0A%C2%A0+++++++%24computer+%3A+CloudComputer%28%24cost+%3A+cost%29%0A%C2%A0+++++++exists+CloudProcess%28computer+%3D%3D+%24computer%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-+%24cost%29%3B%0Aend%0A2.6.+Beyond+this+Tutorial%0ANow+that+this+simple+example+works%2C+try+going+further.+Enrich+the+domain+model+and+add+extra%0Aconstraints+such+as+these%3A%0A%E2%80%A2+Each+Process+belongs+to+a+Service.+A+computer+might+crash%2C+so+processes+running+the+same%0Aservice+should+be+assigned+to+different+computers.%0A%E2%80%A2+Each+Computer+is+located+in+a+Building.+A+building+might+burn+down%2C+so+processes+of+the+same%0Aservices+should+be+assigned+to+computers+in+different+buildings.%0A29%0AChapter+3.+Use+Cases+and+Examples%0A3.1.+Examples+Overview%0APlanner+has+several+examples.+In+this+manual+we+explain+mainly+using+the+n+queens+example+and%0Acloud+balancing+example.+So+it+is+advisable+to+read+at+least+those+sections.%0AThe+Competition%3F+column+in+the+following+table+identifies+an+example+as+being+either+realistic+or%0Aunrealistic.+A+realistic+competition+is+an+official%2C+independent+competition%3A%0A%E2%80%A2+that+clearly+defines+a+real-word+use+case.%0A%E2%80%A2+with+real-world+constraints.%0A%E2%80%A2+with+multiple%2C+real-world+datasets.%0A%E2%80%A2+that+expects+reproducible+results+within+a+specific+time+limit+on+specific+hardware.%0A%E2%80%A2+that+has+had+serious+participation+from+the+academic+and%2For+enterprise+Operations+Research%0Acommunity.%0AThese+realistic+competitions+provide+an+objective+comparison+of+Planner+with+competitive+software%0Aand+academic+research.%0AThe+source+code+of+all+these+examples+is+available+in+the+distribution+zip+under+examples%2Fsources%0Aand+also+in+git+under+optaplanner%2Foptaplanner-examples.%0ATable+2.+Examples+Overview%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0AN+queens+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+256+%E2%80%A2+Pointless+None%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%28cheatable%29256%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E616%0ACloud+balancing+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2400+%E2%80%A2+No+%E2%80%A2+Real-time%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+planning800%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E6967%0ATraveling+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+980+%E2%80%A2+Unrealistic+%E2%80%A2+Real-time%0Asalesman%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+980+%E2%80%A2+TSP+web+planning%0Avariable+%E2%80%A2+Search+space%0A%E2%87%90+10%5E2504%0A30%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0ADinner+party+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+144+%E2%80%A2+Unrealistic+%E2%80%A2+Decision+Table%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+spreadsheet72%0A%28XLS%29+for+score%0A%E2%80%A2+Search+space+constraints%0A%E2%87%90+10%5E310%0ATennis+club+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+72+%E2%80%A2+No+%E2%80%A2+Fairness+score%0Ascheduling%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+constraints7%0A%E2%80%A2+Search+space+%E2%80%A2+Immovable%0A%E2%87%90+entities10%5E60%0AMeeting+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+10+%E2%80%A2+No+%E2%80%A2+TimeGrain%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+pattern320%0Aand+%E2%87%90+5%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E320%0ACourse+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+434+%E2%80%A2+Realistic+%E2%80%A2+Immovable%0Atimetabling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+ITC+2007+track+entities25%0Aand+%E2%87%90+20+3%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E1171%0AMachine+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+50000+%E2%80%A2+Nearly+%E2%80%A2+Real-time%0Areassignment%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+realistic+planning5000%0A%E2%80%A2+Search+space+%E2%80%A2+ROADEF+2012%0A%E2%87%90+10%5E184948%0AVehicle+routing+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2740+%E2%80%A2+Unrealistic+%E2%80%A2+Shadow%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+2795+%E2%80%A2+VRP+web+variable%0Avariable+%E2%80%A2+Search+space+%E2%80%A2+Real-time%0A%E2%80%A2+1+shadow+%E2%87%90+planning10%5E8380%0Aentity+class+%E2%80%A2+Nearby%0A%E2%97%A6+1+selection%0Aautomatic+%E2%80%A2+Real+road%0Ashadow+distances%0Avariable%0A31%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0AVehicle+routing+%E2%80%A2+All+of+Vehicle+%E2%80%A2+Entity+%E2%87%90+2740+%E2%80%A2+Unrealistic+%E2%80%A2+All+of+Vehicle%0Awith+time+routing%0Awindows+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+VRP+web%0Arouting%0A2795%0A%E2%80%A2+1+shadow+%E2%80%A2+Search+space+%E2%80%A2+Custom%0Avariable+%E2%87%90+VariableListen10%5E8380%0Aer%0AProject+job+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+640+%E2%80%A2+Nearly+%E2%80%A2+Bendable%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%3F+and+realistic+score%0A%E2%97%A6+1+shadow+%E2%87%90+%3F+%E2%80%A2+MISTA+2013+%E2%80%A2+Custom%0Avariable+%E2%80%A2+Search+space+VariableListen%0A%E2%87%90+er%3F%0A%E2%80%A2+ValueRangeFa%0Actory%0AHospital+bed+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2750+%E2%80%A2+Unrealistic+%E2%80%A2+Overconstrain%0Aplanning%0A%E2%97%A6+1+nullable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Kaho+PAS+ed+planning471%0Avariable+%E2%80%A2+Search+space%0A%E2%87%90+10%5E6851%0ATask+assigning+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+500+%E2%80%A2+No+%E2%80%A2+Bendable%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+score520%0Avariable+%E2%80%A2+Search+space+%E2%80%A2+Chained%0A%E2%97%A6+1+shadow+%E2%87%90+through+time10%5E1168%0Avariable+pattern%0A%E2%80%A2+1+shadow+%E2%80%A2+Custom%0Aentity+class+VariableListen%0Aer%0A%E2%97%A6+1%0Aautomatic+%E2%80%A2+Continuous%0Ashadow+planning%0Avariable+%E2%80%A2+Real-time%0Aplanning%0AExam+timetabling+%E2%80%A2+2+entity+classes+%E2%80%A2+Entity+%E2%87%90+1096+%E2%80%A2+Realistic+%E2%80%A2+Custom%0A%28same+%E2%80%A2+Value+%E2%87%90+80+%E2%80%A2+ITC+2007+track+VariableListen%0Ahierarchy%29+and+%E2%87%90+1+er49%0A%E2%97%A6+2+variables+%E2%80%A2+Search+space%0A%E2%87%90+10%5E3374%0A32%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0ANurse+rostering+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+752+%E2%80%A2+Realistic+%E2%80%A2+Continuous%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+INRC+2010+planning50%0A%E2%80%A2+Search+space+%E2%80%A2+Real-time%0A%E2%87%90+planning10%5E1277%0ATraveling+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+1560+%E2%80%A2+Unrealistic+%E2%80%A2+Custom%0Atournament%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+TTP+MoveListFacto78%0Ary%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E2301%0ACheap+time+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+500+%E2%80%A2+Nearly+%E2%80%A2+Field%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+realistic+annotations100%0Aand+%E2%87%90+288+%E2%80%A2+ICON+Energy+%E2%80%A2+ValueRangeFa%0A%E2%80%A2+Search+space+ctory%0A%E2%87%90+10%5E20078%0AInvestment+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+11+%E2%80%A2+No+%E2%80%A2+ValueRangeFa%0A%E2%80%A2+1+variable+%E2%80%A2+Value+%3D+ctory1000+%E2%80%A2+Defined+by+us%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E4%0AConference+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+216+%E2%80%A2+No%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+18+%E2%80%A2+Defined+by+us%0Aand+%E2%87%90+20%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E552%0ARock+Tour+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+47+%E2%80%A2+No%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+48+%E2%80%A2+Defined+by+us%0Avariable+%E2%80%A2+Search+space%0A%E2%97%A6+4+shadow+%E2%87%90+10%5E59%0Avariables%0A%E2%80%A2+1+shadow%0Aentity+class%0A%E2%97%A6+1%0Aautomatic%0Ashadow%0Avariable%0A33%0A3.2.+N+Queens%0A3.2.1.+Problem+Description%0APlace+n+queens+on+a+n+sized+chessboard+so+that+no+two+queens+can+attack+each+other.+The+most%0Acommon+n+queens+puzzle+is+the+eight+queens+puzzle%2C+with+n+%3D+8%3A%0AConstraints%3A%0A%E2%80%A2+Use+a+chessboard+of+n+columns+and+n+rows.%0A%E2%80%A2+Place+n+queens+on+the+chessboard.%0A%E2%80%A2+No+two+queens+can+attack+each+other.+A+queen+can+attack+any+other+queen+on+the+same%0Ahorizontal%2C+vertical+or+diagonal+line.%0AThis+documentation+heavily+uses+the+four+queens+puzzle+as+the+primary+example.%0AA+proposed+solution+could+be%3A%0A34%0AFigure+1.+A+Wrong+Solution+for+the+Four+Queens+Puzzle%0AThe+above+solution+is+wrong+because+queens+A1+and+B0+can+attack+each+other+%28so+can+queens+B0+and%0AD0%29.+Removing+queen+B0+would+respect+the+%22no+two+queens+can+attack+each+other%22+constraint%2C+but%0Awould+break+the+%22place+n+queens%22+constraint.%0ABelow+is+a+correct+solution%3A%0AFigure+2.+A+Correct+Solution+for+the+Four+Queens+Puzzle%0AAll+the+constraints+have+been+met%2C+so+the+solution+is+correct.%0ANote+that+most+n+queens+puzzles+have+multiple+correct+solutions.+We+will+focus+on+finding+a+single%0Acorrect+solution+for+a+given+n%2C+not+on+finding+the+number+of+possible+correct+solutions+for+a+given+n.%0A3.2.2.+Problem+Size%0A4queens+++has+++4+queens+with+a+search+space+of++++256.%0A8queens+++has+++8+queens+with+a+search+space+of+++10%5E7.%0A16queens++has++16+queens+with+a+search+space+of++10%5E19.%0A32queens++has++32+queens+with+a+search+space+of++10%5E48.%0A64queens++has++64+queens+with+a+search+space+of+10%5E115.%0A256queens+has+256+queens+with+a+search+space+of+10%5E616.%0AThe+implementation+of+the+n+queens+example+has+not+been+optimized+because+it+functions+as+a%0Abeginner+example.+Nevertheless%2C+it+can+easily+handle+64+queens.+With+a+few+changes+it+has+been%0Ashown+to+easily+handle+5000+queens+and+more.%0A3.2.3.+Domain+Model%0AThis+example+uses+the+domain+model+to+solve+the+four+queens+problem.%0A1.+Creating+a+Domain+Model+A+good+domain+model+will+make+it+easier+to+understand+and+solve%0A35%0Ayour+planning+problem.%0AThis+is+the+domain+model+for+the+n+queens+example%3A%0Apublic+class+Column+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0Apublic+class+Row+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0Apublic+class+Queen+%7B%0A%C2%A0+++private+Column+column%3B%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++public+int+getAscendingDiagonalIndex%28%29+%7B...%7D%0A%C2%A0+++public+int+getDescendingDiagonalIndex%28%29+%7B...%7D%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0A2.+Calculating+the+Search+Space.%0AA+Queen+instance+has+a+Column+%28for+example%3A+0+is+column+A%2C+1+is+column+B%2C+%E2%80%A6%29+and+a+Row+%28its+row%2C%0Afor+example%3A+0+is+row+0%2C+1+is+row+1%2C+%E2%80%A6%29.%0AThe+ascending+diagonal+line+and+the+descending+diagonal+line+can+be+calculated+based+on+the%0Acolumn+and+the+row.%0AThe+column+and+row+indexes+start+from+the+upper+left+corner+of+the+chessboard.%0A36%0Apublic+class+NQueens+%7B%0A%C2%A0+++private+int+n%3B%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0A3.+Finding+the+Solution%0AA+single+NQueens+instance+contains+a+list+of+all+Queen+instances.+It+is+the+Solution+implementation%0Awhich+will+be+supplied+to%2C+solved+by%2C+and+retrieved+from+the+Solver.%0ANotice+that+in+the+four+queens+example%2C+NQueens%E2%80%99s+getN%28%29+method+will+always+return+four.%0ATable+3.+A+Solution+for+Four+Queens+Shown+in+the+Domain+Model%0AA+solution+Queen+column+rowInd+ascend+descen%0AIndex+ex+ingDia+dingDi%0AgonalI+agonalI%0Andex+ndex%0A%28colum+%28colum%0AnIndex+nIndex%0A%2B+-%0ArowInd+rowInd%0Aex%29+ex%29%0AA1+0+1+1+%28**%29+-1%0AB0+1+0+%28*%29+1+%28**%29+1%0AC2+2+2+4+0%0AD0+3+0+%28*%29+3+3%0AWhen+two+queens+share+the+same+column%2C+row+or+diagonal+line%2C+such+as+%28*%29+and+%28**%29%2C+they+can+attack%0Aeach+other.%0A3.3.+Cloud+Balancing%0AThis+example+is+explained+in+a+tutorial.%0A37%0A3.4.+Traveling+Salesman+%28TSP+-+Traveling+Salesman%0AProblem%29%0A3.4.1.+Problem+Description%0AGiven+a+list+of+cities%2C+find+the+shortest+tour+for+a+salesman+that+visits+each+city+exactly+once.%0AThe+problem+is+defined+by+Wikipedia.+It+is+one+of+the+most+intensively+studied+problems+in%0Acomputational+mathematics.+Yet%2C+in+the+real+world%2C+it+is+often+only+part+of+a+planning+problem%2C+along%0Awith+other+constraints%2C+such+as+employee+shift+rostering+constraints.%0A3.4.2.+Problem+Size%0Adj38+++++has++38+cities+with+a+search+space+of+++10%5E43.%0Aeurope40+has++40+cities+with+a+search+space+of+++10%5E46.%0Ast70+++++has++70+cities+with+a+search+space+of+++10%5E98.%0Apcb442+++has+442+cities+with+a+search+space+of++10%5E976.%0Alu980++++has+980+cities+with+a+search+space+of+10%5E2504.%0A3.4.3.+Problem+Difficulty%0ADespite+TSP%E2%80%99s+simple+definition%2C+the+problem+is+surprisingly+hard+to+solve.+Because+it+is+an+NP-hard%0Aproblem+%28like+most+planning+problems%29%2C+the+optimal+solution+for+a+specific+problem+dataset+can%0Achange+a+lot+when+that+problem+dataset+is+slightly+altered%3A%0A38%0A3.5.+Dinner+Party%0A3.5.1.+Problem+Description%0AMiss+Manners+is+throwing+another+dinner+party.%0A%E2%80%A2+This+time+she+invited+144+guests+and+prepared+12+round+tables+with+12+seats+each.%0A%E2%80%A2+Every+guest+should+sit+next+to+someone+%28left+and+right%29+of+the+opposite+gender.%0A%E2%80%A2+And+that+neighbour+should+have+at+least+one+hobby+in+common+with+the+guest.%0A%E2%80%A2+At+every+table%2C+there+should+be+two+politicians%2C+two+doctors%2C+two+socialites%2C+two+coaches%2C+two%0Ateachers+and+two+programmers.%0A%E2%80%A2+And+the+two+politicians%2C+two+doctors%2C+two+coaches+and+two+programmers+should+not+be+the+same%0Akind+at+a+table.%0ADrools+Expert+also+has+the+normal+Miss+Manners+example+%28which+is+much+smaller%29+and+employs+an%0Aexhaustive+heuristic+to+solve+it.+Planner%E2%80%99s+implementation+is+far+more+scalable+because+it+uses%0Aheuristics+to+find+the+best+solution+and+Drools+Expert+to+calculate+the+score+of+each+solution.%0A3.5.2.+Problem+Size%0A39%0Awedding01+has+18+jobs%2C+144+guests%2C+288+hobby+practicians%2C+12+tables+and+144+seats+with%0Aa+search+space+of+10%5E310.%0A3.6.+Tennis+Club+Scheduling%0A3.6.1.+Problem+Description%0AEvery+week+the+tennis+club+has+four+teams+playing+round+robin+against+each+other.+Assign+those%0Afour+spots+to+the+teams+fairly.%0AHard+constraints%3A%0A%E2%80%A2+Conflict%3A+A+team+can+only+play+once+per+day.%0A%E2%80%A2+Unavailability%3A+Some+teams+are+unavailable+on+some+dates.%0AMedium+constraints%3A%0A%E2%80%A2+Fair+assignment%3A+All+teams+should+play+an+%28almost%29+equal+number+of+times.%0ASoft+constraints%3A%0A%E2%80%A2+Evenly+confrontation%3A+Each+team+should+play+against+every+other+team+an+equal+number+of%0Atimes.%0A3.6.2.+Problem+Size%0Amunich-7teams+has+7+teams%2C+18+days%2C+12+unavailabilityPenalties+and+72+teamAssignments%0Awith+a+search+space+of+10%5E60.%0A3.6.3.+Domain+Model%0A40%0A3.7.+Meeting+Scheduling%0A3.7.1.+Problem+Description%0AAssign+each+meeting+to+a+starting+time+and+a+room.+Meetings+have+different+durations.%0AHard+constraints%3A%0A%E2%80%A2+Room+conflict%3A+two+meetings+must+not+use+the+same+room+at+the+same+time.%0A%E2%80%A2+Required+attendance%3A+A+person+cannot+have+two+required+meetings+at+the+same+time.%0A%E2%80%A2+Required+room+capacity%3A+A+meeting+must+not+be+in+a+room+that+doesn%E2%80%99t+fit+all+of+the+meeting%E2%80%99s%0Aattendees.%0A%E2%80%A2+Start+and+end+on+same+day%3A+A+meeting+shouldn%E2%80%99t+be+scheduled+over+multiple+days.%0AMedium+constraints%3A%0A%E2%80%A2+Preferred+attendance%3A+A+person+cannot+have+two+preferred+meetings+at+the+same+time%2C+nor+a%0Apreferred+and+a+required+meeting+at+the+same+time.%0ASoft+constraints%3A%0A%E2%80%A2+Sooner+rather+than+later%3A+Schedule+all+meetings+as+soon+as+possible.%0A41%0A%E2%80%A2+A+break+between+meetings%3A+Any+two+meetings+should+have+at+least+one+time+grain+break%0Abetween+them.%0A%E2%80%A2+Overlapping+meetings%3A+To+minimize+the+number+of+meetings+in+parallel+so+people+don%E2%80%99t+have+to%0Achoose+one+meeting+over+the+other.%0A%E2%80%A2+Assign+larger+rooms+first%3A+If+a+larger+room+is+available+any+meeting+should+be+assigned+to+that%0Aroom+in+order+to+accommodate+as+many+people+as+possible+even+if+they+haven%E2%80%99t+signed+up+to+that%0Ameeting.%0A%E2%80%A2+Room+stability%3A+If+a+person+has+two+consecutive+meetings+with+two+or+less+time+grains+break%0Abetween+them+they+better+be+in+the+same+room.%0A3.7.2.+Problem+Size%0A50meetings-160timegrains-5rooms++has++50+meetings%2C+160+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E145.%0A100meetings-320timegrains-5rooms+has+100+meetings%2C+320+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E320.%0A200meetings-640timegrains-5rooms+has+200+meetings%2C+640+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E701.%0A400meetings-1280timegrains-5rooms+has+400+meetings%2C+1280+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E1522.%0A800meetings-2560timegrains-5rooms+has+800+meetings%2C+2560+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E3285.%0A3.8.+Course+Timetabling+%28ITC+2007+Track+3+-+Curriculum%0ACourse+Scheduling%29%0A3.8.1.+Problem+Description%0ASchedule+each+lecture+into+a+timeslot+and+into+a+room.%0AHard+constraints%3A%0A%E2%80%A2+Teacher+conflict%3A+A+teacher+must+not+have+two+lectures+in+the+same+period.%0A%E2%80%A2+Curriculum+conflict%3A+A+curriculum+must+not+have+two+lectures+in+the+same+period.%0A%E2%80%A2+Room+occupancy%3A+two+lectures+must+not+be+in+the+same+room+in+the+same+period.%0A%E2%80%A2+Unavailable+period+%28specified+per+dataset%29%3A+A+specific+lecture+must+not+be+assigned+to+a+specific%0Aperiod.%0ASoft+constraints%3A%0A%E2%80%A2+Room+capacity%3A+A+room%E2%80%99s+capacity+should+not+be+less+than+the+number+of+students+in+its+lecture.%0A%E2%80%A2+Minimum+working+days%3A+Lectures+of+the+same+course+should+be+spread+out+into+a+minimum%0Anumber+of+days.%0A%E2%80%A2+Curriculum+compactness%3A+Lectures+belonging+to+the+same+curriculum+should+be+adjacent+to+each%0A42%0Aother+%28so+in+consecutive+periods%29.%0A%E2%80%A2+Room+stability%3A+Lectures+of+the+same+course+should+be+assigned+to+the+same+room.%0AThe+problem+is+defined+by+the+International+Timetabling+Competition+2007+track+3.%0A3.8.2.+Problem+Size%0Acomp01+has+24+teachers%2C++14+curricula%2C++30+courses%2C+160+lectures%2C+30+periods%2C++6+rooms%0Aand+++53+unavailable+period+constraints+with+a+search+space+of++10%5E360.%0Acomp02+has+71+teachers%2C++70+curricula%2C++82+courses%2C+283+lectures%2C+25+periods%2C+16+rooms%0Aand++513+unavailable+period+constraints+with+a+search+space+of++10%5E736.%0Acomp03+has+61+teachers%2C++68+curricula%2C++72+courses%2C+251+lectures%2C+25+periods%2C+16+rooms%0Aand++382+unavailable+period+constraints+with+a+search+space+of++10%5E653.%0Acomp04+has+70+teachers%2C++57+curricula%2C++79+courses%2C+286+lectures%2C+25+periods%2C+18+rooms%0Aand++396+unavailable+period+constraints+with+a+search+space+of++10%5E758.%0Acomp05+has+47+teachers%2C+139+curricula%2C++54+courses%2C+152+lectures%2C+36+periods%2C++9+rooms%0Aand++771+unavailable+period+constraints+with+a+search+space+of++10%5E381.%0Acomp06+has+87+teachers%2C++70+curricula%2C+108+courses%2C+361+lectures%2C+25+periods%2C+18+rooms%0Aand++632+unavailable+period+constraints+with+a+search+space+of++10%5E957.%0Acomp07+has+99+teachers%2C++77+curricula%2C+131+courses%2C+434+lectures%2C+25+periods%2C+20+rooms%0Aand++667+unavailable+period+constraints+with+a+search+space+of+10%5E1171.%0Acomp08+has+76+teachers%2C++61+curricula%2C++86+courses%2C+324+lectures%2C+25+periods%2C+18+rooms%0Aand++478+unavailable+period+constraints+with+a+search+space+of++10%5E859.%0Acomp09+has+68+teachers%2C++75+curricula%2C++76+courses%2C+279+lectures%2C+25+periods%2C+18+rooms%0Aand++405+unavailable+period+constraints+with+a+search+space+of++10%5E740.%0Acomp10+has+88+teachers%2C++67+curricula%2C+115+courses%2C+370+lectures%2C+25+periods%2C+18+rooms%0Aand++694+unavailable+period+constraints+with+a+search+space+of++10%5E981.%0Acomp11+has+24+teachers%2C++13+curricula%2C++30+courses%2C+162+lectures%2C+45+periods%2C++5+rooms%0Aand+++94+unavailable+period+constraints+with+a+search+space+of++10%5E381.%0Acomp12+has+74+teachers%2C+150+curricula%2C++88+courses%2C+218+lectures%2C+36+periods%2C+11+rooms%0Aand+1368+unavailable+period+constraints+with+a+search+space+of++10%5E566.%0Acomp13+has+77+teachers%2C++66+curricula%2C++82+courses%2C+308+lectures%2C+25+periods%2C+19+rooms%0Aand++468+unavailable+period+constraints+with+a+search+space+of++10%5E824.%0Acomp14+has+68+teachers%2C++60+curricula%2C++85+courses%2C+275+lectures%2C+25+periods%2C+17+rooms%0Aand++486+unavailable+period+constraints+with+a+search+space+of++10%5E722.%0A3.8.3.+Domain+Model%0A43%0A3.9.+Machine+Reassignment+%28Google+ROADEF+2012%29%0A3.9.1.+Problem+Description%0AAssign+each+process+to+a+machine.+All+processes+already+have+an+original+%28unoptimized%29+assignment.%0AEach+process+requires+an+amount+of+each+resource+%28such+as+CPU%2C+RAM%2C+%E2%80%A6%29.+This+is+a+more+complex%0Aversion+of+the+Cloud+Balancing+example.%0AHard+constraints%3A%0A%E2%80%A2+Maximum+capacity%3A+The+maximum+capacity+for+each+resource+for+each+machine+must+not+be%0Aexceeded.%0A%E2%80%A2+Conflict%3A+Processes+of+the+same+service+must+run+on+distinct+machines.%0A%E2%80%A2+Spread%3A+Processes+of+the+same+service+must+be+spread+out+across+locations.%0A%E2%80%A2+Dependency%3A+The+processes+of+a+service+depending+on+another+service+must+run+in+the%0Aneighborhood+of+a+process+of+the+other+service.%0A%E2%80%A2+Transient+usage%3A+Some+resources+are+transient+and+count+towards+the+maximum+capacity+of%0Aboth+the+original+machine+as+the+newly+assigned+machine.%0ASoft+constraints%3A%0A%E2%80%A2+Load%3A+The+safety+capacity+for+each+resource+for+each+machine+should+not+be+exceeded.%0A44%0A%E2%80%A2+Balance%3A+Leave+room+for+future+assignments+by+balancing+the+available+resources+on+each%0Amachine.%0A%E2%80%A2+Process+move+cost%3A+A+process+has+a+move+cost.%0A%E2%80%A2+Service+move+cost%3A+A+service+has+a+move+cost.%0A%E2%80%A2+Machine+move+cost%3A+Moving+a+process+from+machine+A+to+machine+B+has+another+A-B+specific%0Amove+cost.%0AThe+problem+is+defined+by+the+Google+ROADEF%2FEURO+Challenge+2012.%0A3.9.2.+Value+Proposition%0A45%0A3.9.3.+Problem+Size%0A46%0Amodel_a1_1+has++2+resources%2C++1+neighborhoods%2C+++4+locations%2C++++4+machines%2C++++79%0Aservices%2C+++100+processes+and+1+balancePenalties+with+a+search+space+of+++++10%5E60.%0Amodel_a1_2+has++4+resources%2C++2+neighborhoods%2C+++4+locations%2C++100+machines%2C+++980%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a1_3+has++3+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++216%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a1_4+has++3+resources%2C+50+neighborhoods%2C++50+locations%2C+++50+machines%2C+++142%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_a1_5+has++4+resources%2C++2+neighborhoods%2C+++4+locations%2C+++12+machines%2C+++981%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1079.%0Amodel_a2_1+has++3+resources%2C++1+neighborhoods%2C+++1+locations%2C++100+machines%2C++1000%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_2+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++170%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_3+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++129%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_4+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C+++50+machines%2C+++180%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_a2_5+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C+++50+machines%2C+++153%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_b_1++has+12+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C++2512%0Aservices%2C++5000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E10000.%0Amodel_b_2++has+12+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C++2462%0Aservices%2C++5000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E10000.%0Amodel_b_3++has++6+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+15025%0Aservices%2C+20000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E40000.%0Amodel_b_4++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C++500+machines%2C++1732%0Aservices%2C+20000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E53979.%0Amodel_b_5++has++6+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+35082%0Aservices%2C+40000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E80000.%0Amodel_b_6++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C++200+machines%2C+14680%0Aservices%2C+40000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E92041.%0Amodel_b_7++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C+4000+machines%2C+15050%0Aservices%2C+40000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E144082.%0Amodel_b_8++has++3+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+45030%0Aservices%2C+50000+processes+and+0+balancePenalties+with+a+search+space+of+10%5E100000.%0Amodel_b_9++has++3+resources%2C++5+neighborhoods%2C+100+locations%2C+1000+machines%2C++4609%0Aservices%2C+50000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E150000.%0Amodel_b_10+has++3+resources%2C++5+neighborhoods%2C+100+locations%2C+5000+machines%2C++4896%0Aservices%2C+50000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E184948.%0A3.9.4.+Domain+Model%0A47%0A3.10.+Vehicle+Routing%0A3.10.1.+Problem+Description%0AUsing+a+fleet+of+vehicles%2C+pick+up+the+objects+of+each+customer+and+bring+them+to+the+depot.+Each%0Avehicle+can+service+multiple+customers%2C+but+it+has+a+limited+capacity.%0A48%0ABesides+the+basic+case+%28CVRP%29%2C+there+is+also+a+variant+with+time+windows+%28CVRPTW%29.%0AHard+constraints%3A%0A%E2%80%A2+Vehicle+capacity%3A+a+vehicle+cannot+carry+more+items+then+its+capacity.%0A%E2%80%A2+Time+windows+%28only+in+CVRPTW%29%3A%0A%E2%97%A6+Travel+time%3A+Traveling+from+one+location+to+another+takes+time.%0A%E2%97%A6+Customer+service+duration%3A+a+vehicle+must+stay+at+the+customer+for+the+length+of+the+service%0Aduration.%0A%E2%97%A6+Customer+ready+time%3A+a+vehicle+may+arrive+before+the+customer%E2%80%99s+ready+time%2C+but+it+must%0Await+until+the+ready+time+before+servicing.%0A%E2%97%A6+Customer+due+time%3A+a+vehicle+must+arrive+on+time%2C+before+the+customer%E2%80%99s+due+time.%0ASoft+constraints%3A%0A%E2%80%A2+Total+distance%3A+minimize+the+total+distance+driven+%28fuel+consumption%29+of+all+vehicles.%0AThe+capacitated+vehicle+routing+problem+%28CVRP%29+and+its+timewindowed+variant+%28CVRPTW%29+are%0A49%0Adefined+by+the+VRP+web.%0A3.10.2.+Value+Proposition%0A3.10.3.+Problem+Size%0ACVRP+instances+%28without+time+windows%29%3A%0Abelgium-n50-k10+++++++++++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-n100-k10++++++++++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-n500-k20++++++++++++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-n1000-k20+++++++++++has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-n2750-k55+++++++++++has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-road-km-n50-k10+++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-road-km-n100-k10++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-road-km-n500-k20++++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0A50%0Abelgium-road-km-n1000-k20+++has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-road-km-n2750-k55+++has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-road-time-n50-k10+++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-road-time-n100-k10++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-road-time-n500-k20++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-road-time-n1000-k20+has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-road-time-n2750-k55+has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-d2-n50-k10++++++++++has++2+depots%2C+10+vehicles+and+++48+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-d3-n100-k10+++++++++has++3+depots%2C+10+vehicles+and+++97+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-d5-n500-k20+++++++++has++5+depots%2C+20+vehicles+and++495+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-d8-n1000-k20++++++++has++8+depots%2C+20+vehicles+and++992+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-d10-n2750-k55+++++++has+10+depots%2C+55+vehicles+and+2740+customers+with+a%0Asearch+space+of+10%5E8380.%0AA-n32-k5++has+1+depots%2C++5+vehicles+and++31+customers+with+a+search+space+of++10%5E40.%0AA-n33-k5++has+1+depots%2C++5+vehicles+and++32+customers+with+a+search+space+of++10%5E41.%0AA-n33-k6++has+1+depots%2C++6+vehicles+and++32+customers+with+a+search+space+of++10%5E42.%0AA-n34-k5++has+1+depots%2C++5+vehicles+and++33+customers+with+a+search+space+of++10%5E43.%0AA-n36-k5++has+1+depots%2C++5+vehicles+and++35+customers+with+a+search+space+of++10%5E46.%0AA-n37-k5++has+1+depots%2C++5+vehicles+and++36+customers+with+a+search+space+of++10%5E48.%0AA-n37-k6++has+1+depots%2C++6+vehicles+and++36+customers+with+a+search+space+of++10%5E49.%0AA-n38-k5++has+1+depots%2C++5+vehicles+and++37+customers+with+a+search+space+of++10%5E49.%0AA-n39-k5++has+1+depots%2C++5+vehicles+and++38+customers+with+a+search+space+of++10%5E51.%0AA-n39-k6++has+1+depots%2C++6+vehicles+and++38+customers+with+a+search+space+of++10%5E52.%0AA-n44-k7++has+1+depots%2C++7+vehicles+and++43+customers+with+a+search+space+of++10%5E61.%0AA-n45-k6++has+1+depots%2C++6+vehicles+and++44+customers+with+a+search+space+of++10%5E62.%0AA-n45-k7++has+1+depots%2C++7+vehicles+and++44+customers+with+a+search+space+of++10%5E63.%0AA-n46-k7++has+1+depots%2C++7+vehicles+and++45+customers+with+a+search+space+of++10%5E65.%0AA-n48-k7++has+1+depots%2C++7+vehicles+and++47+customers+with+a+search+space+of++10%5E68.%0AA-n53-k7++has+1+depots%2C++7+vehicles+and++52+customers+with+a+search+space+of++10%5E77.%0AA-n54-k7++has+1+depots%2C++7+vehicles+and++53+customers+with+a+search+space+of++10%5E79.%0AA-n55-k9++has+1+depots%2C++9+vehicles+and++54+customers+with+a+search+space+of++10%5E82.%0AA-n60-k9++has+1+depots%2C++9+vehicles+and++59+customers+with+a+search+space+of++10%5E91.%0AA-n61-k9++has+1+depots%2C++9+vehicles+and++60+customers+with+a+search+space+of++10%5E93.%0AA-n62-k8++has+1+depots%2C++8+vehicles+and++61+customers+with+a+search+space+of++10%5E94.%0AA-n63-k9++has+1+depots%2C++9+vehicles+and++62+customers+with+a+search+space+of++10%5E97.%0AA-n63-k10+has+1+depots%2C+10+vehicles+and++62+customers+with+a+search+space+of++10%5E98.%0AA-n64-k9++has+1+depots%2C++9+vehicles+and++63+customers+with+a+search+space+of++10%5E99.%0AA-n65-k9++has+1+depots%2C++9+vehicles+and++64+customers+with+a+search+space+of+10%5E101.%0AA-n69-k9++has+1+depots%2C++9+vehicles+and++68+customers+with+a+search+space+of+10%5E108.%0A51%0AA-n80-k10+has+1+depots%2C+10+vehicles+and++79+customers+with+a+search+space+of+10%5E130.%0AF-n45-k4++has+1+depots%2C++4+vehicles+and++44+customers+with+a+search+space+of++10%5E60.%0AF-n72-k4++has+1+depots%2C++4+vehicles+and++71+customers+with+a+search+space+of+10%5E108.%0AF-n135-k7+has+1+depots%2C++7+vehicles+and+134+customers+with+a+search+space+of+10%5E240.%0ACVRPTW+instances+%28with+time+windows%29%3A%0Abelgium-tw-d2-n50-k10++++has++2+depots%2C+10+vehicles+and+++48+customers+with+a+search%0Aspace+of+++10%5E74.%0Abelgium-tw-d3-n100-k10+++has++3+depots%2C+10+vehicles+and+++97+customers+with+a+search%0Aspace+of++10%5E170.%0Abelgium-tw-d5-n500-k20+++has++5+depots%2C+20+vehicles+and++495+customers+with+a+search%0Aspace+of+10%5E1168.%0Abelgium-tw-d8-n1000-k20++has++8+depots%2C+20+vehicles+and++992+customers+with+a+search%0Aspace+of+10%5E2607.%0Abelgium-tw-d10-n2750-k55+has+10+depots%2C+55+vehicles+and+2740+customers+with+a+search%0Aspace+of+10%5E8380.%0Abelgium-tw-n50-k10+++++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a+search%0Aspace+of+++10%5E74.%0Abelgium-tw-n100-k10++++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a+search%0Aspace+of++10%5E170.%0Abelgium-tw-n500-k20++++++has++1+depots%2C+20+vehicles+and++499+customers+with+a+search%0Aspace+of+10%5E1168.%0Abelgium-tw-n1000-k20+++++has++1+depots%2C+20+vehicles+and++999+customers+with+a+search%0Aspace+of+10%5E2607.%0Abelgium-tw-n2750-k55+++++has++1+depots%2C+55+vehicles+and+2749+customers+with+a+search%0Aspace+of+10%5E8380.%0ASolomon_025_C101+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_C201+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_R101+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_R201+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_RC101++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_RC201++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_100_C101+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_C201+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_R101+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_R201+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_RC101++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0A52%0ASolomon_100_RC201++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0AHomberger_0200_C1_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_C2_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_R1_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_R2_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_RC1_2_1+has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_RC2_2_1+has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0400_C1_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_C2_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_R1_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_R2_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_RC1_4_1+has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_RC2_4_1+has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0600_C1_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_C2_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_R1_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_R2_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_RC1_6_1+has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_RC2_6_1+has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0800_C1_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_C2_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_R1_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_R2_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_RC1_8_1+has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_RC2_8_1+has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_1000_C110_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0A53%0Aspace+of+10%5E2840.%0AHomberger_1000_C210_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_R110_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_R210_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_RC110_1+has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_RC210_1+has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0A3.10.4.+Domain+Model%0AThe+vehicle+routing+with+timewindows+domain+model+makes+heavily+use+of+shadow+variables.+This%0Aallows+it+to+express+its+constraints+more+naturally%2C+because+properties+such+as+arrivalTime+and%0AdepartureTime%2C+are+directly+available+on+the+domain+model.%0A3.10.4.1.+Road+Distances+Instead+of+Air+Distances%0AIn+the+real+world%2C+vehicles+cannot+follow+a+straight+line+from+location+to+location%3A+they+have+to+use%0Aroads+and+highways.+From+a+business+point+of+view%2C+this+matters+a+lot%3A%0A54%0AFor+the+optimization+algorithm%2C+this+does+not+matter+much%2C+as+long+as+the+distance+between+two%0Apoints+can+be+looked+up+%28and+are+preferably+precalculated%29.+The+road+cost+does+not+even+need+to+be%0Aa+distance%2C+it+can+also+be+travel+time%2C+fuel+cost%2C+or+a+weighted+function+of+those.+There+are+several%0Atechnologies+available+to+precalculate+road+costs%2C+such+as+GraphHopper+%28embeddable%2C+offline+Java%0Aengine%29%2C+Open+MapQuest+%28web+service%29+and+Google+Maps+Client+API+%28web+service%29.%0A55%0AThere+are+also+several+technologies+to+render+it%2C+such+as+Leaflet+and+Google+Maps+for+developers%3A+the%0Aoptaplanner-webexamples-*.war+has+an+example+which+demonstrates+such+rendering%3A%0A56%0AIt+is+even+possible+to+render+the+actual+road+routes+with+GraphHopper+or+Google+Map+Directions%2C%0Abut+because+of+route+overlaps+on+highways%2C+it+can+become+harder+to+see+the+standstill+order%3A%0A57%0ATake+special+care+that+the+road+costs+between+two+points+use+the+same+optimization+criteria+as+the%0Aone+used+in+Planner.+For+example%2C+GraphHopper+etc+will+by+default+return+the+fastest+route%2C+not+the%0Ashortest+route.+Don%E2%80%99t+use+the+km+%28or+miles%29+distances+of+the+fastest+GPS+routes+to+optimize+the%0Ashortest+trip+in+Planner%3A+this+leads+to+a+suboptimal+solution+as+shown+below%3A%0A58%0AContrary+to+popular+belief%2C+most+users+do+not+want+the+shortest+route%3A+they+want+the+fastest+route%0Ainstead.+They+prefer+highways+over+normal+roads.+They+prefer+normal+roads+over+dirt+roads.+In+the%0Areal+world%2C+the+fastest+and+shortest+route+are+rarely+the+same.%0A3.11.+Project+Job+Scheduling%0A3.11.1.+Problem+Description%0ASchedule+all+jobs+in+time+and+execution+mode+to+minimize+project+delays.+Each+job+is+part+of+a%0Aproject.+A+job+can+be+executed+in+different+ways%3A+each+way+is+an+execution+mode+that+implies+a%0Adifferent+duration+but+also+different+resource+usages.+This+is+a+form+of+flexible+job+shop+scheduling.%0A59%0AHard+constraints%3A%0A%E2%80%A2+Job+precedence%3A+a+job+can+only+start+when+all+its+predecessor+jobs+are+finished.%0A%E2%80%A2+Resource+capacity%3A+do+not+use+more+resources+than+available.%0A%E2%97%A6+Resources+are+local+%28shared+between+jobs+of+the+same+project%29+or+global+%28shared+between+all%0Ajobs%29%0A%E2%97%A6+Resource+are+renewable+%28capacity+available+per+day%29+or+nonrenewable+%28capacity+available%0Afor+all+days%29%0AMedium+constraints%3A%0A%E2%80%A2+Total+project+delay%3A+minimize+the+duration+%28makespan%29+of+each+project.%0ASoft+constraints%3A%0A%E2%80%A2+Total+makespan%3A+minimize+the+duration+of+the+whole+multi-project+schedule.%0AThe+problem+is+defined+by+the+MISTA+2013+challenge.%0A3.11.2.+Problem+Size%0A60%0ASchedule+A-1++has++2+projects%2C++24+jobs%2C+++64+execution+modes%2C++7+resources+and++150%0Aresource+requirements.%0ASchedule+A-2++has++2+projects%2C++44+jobs%2C++124+execution+modes%2C++7+resources+and++420%0Aresource+requirements.%0ASchedule+A-3++has++2+projects%2C++64+jobs%2C++184+execution+modes%2C++7+resources+and++630%0Aresource+requirements.%0ASchedule+A-4++has++5+projects%2C++60+jobs%2C++160+execution+modes%2C+16+resources+and++390%0Aresource+requirements.%0ASchedule+A-5++has++5+projects%2C+110+jobs%2C++310+execution+modes%2C+16+resources+and++900%0Aresource+requirements.%0ASchedule+A-6++has++5+projects%2C+160+jobs%2C++460+execution+modes%2C+16+resources+and+1440%0Aresource+requirements.%0ASchedule+A-7++has+10+projects%2C+120+jobs%2C++320+execution+modes%2C+22+resources+and++900%0Aresource+requirements.%0ASchedule+A-8++has+10+projects%2C+220+jobs%2C++620+execution+modes%2C+22+resources+and+1860%0Aresource+requirements.%0ASchedule+A-9++has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+2880%0Aresource+requirements.%0ASchedule+A-10+has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+2970%0Aresource+requirements.%0ASchedule+B-1++has+10+projects%2C+120+jobs%2C++320+execution+modes%2C+31+resources+and++900%0Aresource+requirements.%0ASchedule+B-2++has+10+projects%2C+220+jobs%2C++620+execution+modes%2C+22+resources+and+1740%0Aresource+requirements.%0ASchedule+B-3++has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+3060%0Aresource+requirements.%0ASchedule+B-4++has+15+projects%2C+180+jobs%2C++480+execution+modes%2C+46+resources+and+1530%0Aresource+requirements.%0ASchedule+B-5++has+15+projects%2C+330+jobs%2C++930+execution+modes%2C+46+resources+and+2760%0Aresource+requirements.%0ASchedule+B-6++has+15+projects%2C+480+jobs%2C+1380+execution+modes%2C+46+resources+and+4500%0Aresource+requirements.%0ASchedule+B-7++has+20+projects%2C+240+jobs%2C++640+execution+modes%2C+61+resources+and+1710%0Aresource+requirements.%0ASchedule+B-8++has+20+projects%2C+440+jobs%2C+1240+execution+modes%2C+42+resources+and+3180%0Aresource+requirements.%0ASchedule+B-9++has+20+projects%2C+640+jobs%2C+1840+execution+modes%2C+61+resources+and+5940%0Aresource+requirements.%0ASchedule+B-10+has+20+projects%2C+460+jobs%2C+1300+execution+modes%2C+42+resources+and+4260%0Aresource+requirements.%0A3.12.+Hospital+Bed+Planning+%28PAS+-+Patient+Admission%0AScheduling%29%0A3.12.1.+Problem+Description%0AAssign+each+patient+%28that+will+come+to+the+hospital%29+into+a+bed+for+each+night+that+the+patient+will%0Astay+in+the+hospital.+Each+bed+belongs+to+a+room+and+each+room+belongs+to+a+department.+The%0A61%0Aarrival+and+departure+dates+of+the+patients+is+fixed%3A+only+a+bed+needs+to+be+assigned+for+each+night.%0AThis+problem+features+overconstrained+datasets.%0AHard+constraints%3A%0A%E2%80%A2+Two+patients+must+not+be+assigned+to+the+same+bed+in+the+same+night.+Weight%3A+-1000hard+*%0AconflictNightCount.%0A%E2%80%A2+A+room+can+have+a+gender+limitation%3A+only+females%2C+only+males%2C+the+same+gender+in+the+same%0Anight+or+no+gender+limitation+at+all.+Weight%3A+-50hard+*+nightCount.%0A%E2%80%A2+A+department+can+have+a+minimum+or+maximum+age.+Weight%3A+-100hard+*+nightCount.%0A%E2%80%A2+A+patient+can+require+a+room+with+specific+equipment%28s%29.+Weight%3A+-50hard+*+nightCount.%0AMedium+constraints%3A%0A%E2%80%A2+Assign+every+patient+to+a+bed%2C+unless+the+dataset+is+overconstrained.+Weight%3A+-1medium+*%0AnightCount.%0ASoft+constraints%3A%0A%E2%80%A2+A+patient+can+prefer+a+maximum+room+size%2C+for+example+if+he%2Fshe+wants+a+single+room.+Weight%3A%0A-8soft+*+nightCount.%0A%E2%80%A2+A+patient+is+best+assigned+to+a+department+that+specializes+in+his%2Fher+problem.+Weight%3A+-10soft+*%0A62%0AnightCount.%0A%E2%80%A2+A+patient+is+best+assigned+to+a+room+that+specializes+in+his%2Fher+problem.+Weight%3A+-20soft+*%0AnightCount.%0A%E2%97%A6+That+room+speciality+should+be+priority+1.+Weight%3A+-10soft+*+%28priority+-+1%29+*+nightCount.%0A%E2%80%A2+A+patient+can+prefer+a+room+with+specific+equipment%28s%29.+Weight%3A+-20soft+*+nightCount.%0AThe+problem+is+a+variant+on+Kaho%E2%80%99s+Patient+Scheduling+and+the+datasets+come+from+real+world%0Ahospitals.%0A3.12.2.+Problem+Size%0Atestdata01+has+4+specialisms%2C+2+equipments%2C+4+departments%2C++98+rooms%2C+286+beds%2C+14%0Anights%2C++652+patients+and++652+admissions+with+a+search+space+of+10%5E1601.%0Atestdata02+has+6+specialisms%2C+2+equipments%2C+6+departments%2C+151+rooms%2C+465+beds%2C+14%0Anights%2C++755+patients+and++755+admissions+with+a+search+space+of+10%5E2013.%0Atestdata03+has+5+specialisms%2C+2+equipments%2C+5+departments%2C+131+rooms%2C+395+beds%2C+14%0Anights%2C++708+patients+and++708+admissions+with+a+search+space+of+10%5E1838.%0Atestdata04+has+6+specialisms%2C+2+equipments%2C+6+departments%2C+155+rooms%2C+471+beds%2C+14%0Anights%2C++746+patients+and++746+admissions+with+a+search+space+of+10%5E1994.%0Atestdata05+has+4+specialisms%2C+2+equipments%2C+4+departments%2C+102+rooms%2C+325+beds%2C+14%0Anights%2C++587+patients+and++587+admissions+with+a+search+space+of+10%5E1474.%0Atestdata06+has+4+specialisms%2C+2+equipments%2C+4+departments%2C+104+rooms%2C+313+beds%2C+14%0Anights%2C++685+patients+and++685+admissions+with+a+search+space+of+10%5E1709.%0Atestdata07+has+6+specialisms%2C+4+equipments%2C+6+departments%2C+162+rooms%2C+472+beds%2C+14%0Anights%2C++519+patients+and++519+admissions+with+a+search+space+of+10%5E1387.%0Atestdata08+has+6+specialisms%2C+4+equipments%2C+6+departments%2C+148+rooms%2C+441+beds%2C+21%0Anights%2C++895+patients+and++895+admissions+with+a+search+space+of+10%5E2366.%0Atestdata09+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+105+rooms%2C+310+beds%2C+28%0Anights%2C+1400+patients+and+1400+admissions+with+a+search+space+of+10%5E3487.%0Atestdata10+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+104+rooms%2C+308+beds%2C+56%0Anights%2C+1575+patients+and+1575+admissions+with+a+search+space+of+10%5E3919.%0Atestdata11+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+107+rooms%2C+318+beds%2C+91%0Anights%2C+2514+patients+and+2514+admissions+with+a+search+space+of+10%5E6291.%0Atestdata12+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+105+rooms%2C+310+beds%2C+84%0Anights%2C+2750+patients+and+2750+admissions+with+a+search+space+of+10%5E6851.%0Atestdata13+has+5+specialisms%2C+4+equipments%2C+5+departments%2C+125+rooms%2C+368+beds%2C+28%0Anights%2C++907+patients+and+1109+admissions+with+a+search+space+of+10%5E2845.%0A3.12.3.+Domain+Model%0A63%0A3.13.+Task+assigning%0A3.13.1.+Problem+Description%0AAssign+each+task+to+a+spot+in+an+employee%E2%80%99s+queue.+Each+task+has+a+duration+which+is+affected+by+the%0Aemployee%E2%80%99s+affinity+level+with+the+task%E2%80%99s+customer.%0AHard+constraints%3A%0A%E2%80%A2+Skill%3A+Each+task+requires+one+or+more+skills.+The+employee+must+posses+all+these+skills.%0ASoft+level+0+constraints%3A%0A%E2%80%A2+Critical+tasks%3A+Complete+critical+tasks+first%2C+sooner+than+major+and+minor+tasks.%0ASoft+level+1+constraints%3A%0A%E2%80%A2+Minimize+makespan%3A+Reduce+the+time+to+complete+all+tasks.%0A%E2%97%A6+Start+with+the+longest+working+employee+first%2C+then+the+second+longest+working+employee%0Aand+so+forth%2C+to+creates+fairness+and+load+balancing.%0ASoft+level+2+constraints%3A%0A%E2%80%A2+Major+tasks%3A+Complete+major+tasks+as+soon+as+possible%2C+sooner+than+minor+tasks.%0A64%0ASoft+level+3+constraints%3A%0A%E2%80%A2+Minor+tasks%3A+Complete+minor+tasks+as+soon+as+possible.%0A3.13.2.+Value+Proposition%0A3.13.3.+Problem+Size%0A24tasks-8employees+++has++24+tasks%2C+6+skills%2C++8+employees%2C+++4+task+types+and++4%0Acustomers+with+a+search+space+of+++10%5E30.%0A50tasks-5employees+++has++50+tasks%2C+5+skills%2C++5+employees%2C++10+task+types+and+10%0Acustomers+with+a+search+space+of+++10%5E69.%0A100tasks-5employees++has+100+tasks%2C+5+skills%2C++5+employees%2C++20+task+types+and+15%0Acustomers+with+a+search+space+of++10%5E164.%0A500tasks-20employees+has+500+tasks%2C+6+skills%2C+20+employees%2C+100+task+types+and+60%0Acustomers+with+a+search+space+of+10%5E1168.%0A3.13.4.+Domain+Model%0A65%0A3.14.+Exam+Timetabling+%28ITC+2007+track+1+-%0AExamination%29%0A3.14.1.+Problem+Description%0ASchedule+each+exam+into+a+period+and+into+a+room.+Multiple+exams+can+share+the+same+room+during%0Athe+same+period.%0A66%0AHard+constraints%3A%0A%E2%80%A2+Exam+conflict%3A+two+exams+that+share+students+must+not+occur+in+the+same+period.%0A%E2%80%A2+Room+capacity%3A+A+room%E2%80%99s+seating+capacity+must+suffice+at+all+times.%0A%E2%80%A2+Period+duration%3A+A+period%E2%80%99s+duration+must+suffice+for+all+of+its+exams.%0A%E2%80%A2+Period+related+hard+constraints+%28specified+per+dataset%29%3A%0A%E2%97%A6+Coincidence%3A+two+specified+exams+must+use+the+same+period+%28but+possibly+another+room%29.%0A%E2%97%A6+Exclusion%3A+two+specified+exams+must+not+use+the+same+period.%0A%E2%97%A6+After%3A+A+specified+exam+must+occur+in+a+period+after+another+specified+exam%E2%80%99s+period.%0A%E2%80%A2+Room+related+hard+constraints+%28specified+per+dataset%29%3A%0A%E2%97%A6+Exclusive%3A+one+specified+exam+should+not+have+to+share+its+room+with+any+other+exam.%0ASoft+constraints+%28each+of+which+has+a+parametrized+penalty%29%3A%0A%E2%80%A2+The+same+student+should+not+have+two+exams+in+a+row.%0A%E2%80%A2+The+same+student+should+not+have+two+exams+on+the+same+day.%0A%E2%80%A2+Period+spread%3A+two+exams+that+share+students+should+be+a+number+of+periods+apart.%0A%E2%80%A2+Mixed+durations%3A+two+exams+that+share+a+room+should+not+have+different+durations.%0A%E2%80%A2+Front+load%3A+Large+exams+should+be+scheduled+earlier+in+the+schedule.%0A67%0A%E2%80%A2+Period+penalty+%28specified+per+dataset%29%3A+Some+periods+have+a+penalty+when+used.%0A%E2%80%A2+Room+penalty+%28specified+per+dataset%29%3A+Some+rooms+have+a+penalty+when+used.%0AIt+uses+large+test+data+sets+of+real-life+universities.%0AThe+problem+is+defined+by+the+International+Timetabling+Competition+2007+track+1.+Geoffrey+De%0ASmet+finished+4th+in+that+competition+with+a+very+early+version+of+Planner.+Many+improvements%0Ahave+been+made+since+then.%0A3.14.2.+Problem+Size%0Aexam_comp_set1+has++7883+students%2C++607+exams%2C+54+periods%2C++7+rooms%2C++12+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E1564.%0Aexam_comp_set2+has+12484+students%2C++870+exams%2C+40+periods%2C+49+rooms%2C++12+period%0Aconstraints+and++2+room+constraints+with+a+search+space+of+10%5E2864.%0Aexam_comp_set3+has+16365+students%2C++934+exams%2C+36+periods%2C+48+rooms%2C+168+period%0Aconstraints+and+15+room+constraints+with+a+search+space+of+10%5E3023.%0Aexam_comp_set4+has++4421+students%2C++273+exams%2C+21+periods%2C++1+rooms%2C++40+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of++10%5E360.%0Aexam_comp_set5+has++8719+students%2C+1018+exams%2C+42+periods%2C++3+rooms%2C++27+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E2138.%0Aexam_comp_set6+has++7909+students%2C++242+exams%2C+16+periods%2C++8+rooms%2C++22+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of++10%5E509.%0Aexam_comp_set7+has+13795+students%2C+1096+exams%2C+80+periods%2C+15+rooms%2C++28+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E3374.%0Aexam_comp_set8+has++7718+students%2C++598+exams%2C+80+periods%2C++8+rooms%2C++20+period%0Aconstraints+and++1+room+constraints+with+a+search+space+of+10%5E1678.%0A3.14.3.+Domain+Model%0ABelow+you+can+see+the+main+examination+domain+classes%3A%0A68%0AFigure+3.+Examination+Domain+Class+Diagram%0ANotice+that+we%E2%80%99ve+split+up+the+exam+concept+into+an+Exam+class+and+a+Topic+class.+The+Exam+instances%0Achange+during+solving+%28this+is+the+planning+entity+class%29%2C+when+their+period+or+room+property%0Achanges.+The+Topic%2C+Period+and+Room+instances+never+change+during+solving+%28these+are+problem+facts%2C%0Ajust+like+some+other+classes%29.%0A3.15.+Nurse+Rostering+%28INRC+2010%29%0A3.15.1.+Problem+Description%0AFor+each+shift%2C+assign+a+nurse+to+work+that+shift.%0A69%0AHard+constraints%3A%0A%E2%80%A2+No+unassigned+shifts+%28built-in%29%3A+Every+shift+need+to+be+assigned+to+an+employee.%0A%E2%80%A2+Shift+conflict%3A+An+employee+can+have+only+one+shift+per+day.%0ASoft+constraints%3A%0A%E2%80%A2+Contract+obligations.+The+business+frequently+violates+these%2C+so+they+decided+to+define+these+as%0Asoft+constraints+instead+of+hard+constraints.%0A%E2%97%A6+Minimum+and+maximum+assignments%3A+Each+employee+needs+to+work+more+than+x+shifts%0Aand+less+than+y+shifts+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+working+days%3A+Each+employee+needs+to+work%0Abetween+x+and+y+days+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+free+days%3A+Each+employee+needs+to+be+free+between%0Ax+and+y+days+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+working+weekends%3A+Each+employee+needs+to+work%0Abetween+x+and+y+weekends+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Complete+weekends%3A+Each+employee+needs+to+work+every+day+in+a+weekend+or+not+at+all.%0A%E2%97%A6+Identical+shift+types+during+weekend%3A+Each+weekend+shift+for+the+same+weekend+of+the%0Asame+employee+must+be+the+same+shift+type.%0A%E2%97%A6+Unwanted+patterns%3A+A+combination+of+unwanted+shift+types+in+a+row.+For+example%3A+a+late%0A70%0Ashift+followed+by+an+early+shift+followed+by+a+late+shift.%0A%E2%80%A2+Employee+wishes%3A%0A%E2%97%A6+Day+on+request%3A+An+employee+wants+to+work+on+a+specific+day.%0A%E2%97%A6+Day+off+request%3A+An+employee+does+not+want+to+work+on+a+specific+day.%0A%E2%97%A6+Shift+on+request%3A+An+employee+wants+to+be+assigned+to+a+specific+shift.%0A%E2%97%A6+Shift+off+request%3A+An+employee+does+not+want+to+be+assigned+to+a+specific+shift.%0A%E2%80%A2+Alternative+skill%3A+An+employee+assigned+to+a+skill+should+have+a+proficiency+in+every+skill%0Arequired+by+that+shift.%0AThe+problem+is+defined+by+the+International+Nurse+Rostering+Competition+2010.%0A3.15.2.+Value+Proposition%0A3.15.3.+Problem+Size%0AThere+are+three+dataset+types%3A%0A%E2%80%A2+sprint%3A+must+be+solved+in+seconds.%0A%E2%80%A2+medium%3A+must+be+solved+in+minutes.%0A%E2%80%A2+long%3A+must+be+solved+in+hours.%0A71%0Atoy1++++++++++has+1+skills%2C+3+shiftTypes%2C+2+patterns%2C+1+contracts%2C++6+employees%2C++7%0AshiftDates%2C++35+shiftAssignments+and+++0+requests+with+a+search+space+of+++10%5E27.%0Atoy2++++++++++has+1+skills%2C+3+shiftTypes%2C+3+patterns%2C+2+contracts%2C+20+employees%2C+28%0AshiftDates%2C+180+shiftAssignments+and+140+requests+with+a+search+space+of++10%5E234.%0Asprint01++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint02++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint03++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint04++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint05++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint06++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint07++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint08++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint09++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint10++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint01+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint02+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint03+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late01+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late02+has+1+skills%2C+3+shiftTypes%2C+4+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+144+shiftAssignments+and+139+requests+with+a+search+space+of++10%5E144.%0Asprint_late03+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+160+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E160.%0Asprint_late04+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+160+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E160.%0Asprint_late05+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late06+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late07+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late08+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+++0+requests+with+a+search+space+of++10%5E152.%0Asprint_late09+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+++0+requests+with+a+search+space+of++10%5E152.%0Asprint_late10+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0A72%0Amedium01++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium02++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium03++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium04++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium05++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium_hint01+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_hint02+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_hint03+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late01+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+424+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E626.%0Amedium_late02+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late03+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late04+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+416+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E614.%0Amedium_late05+has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+452+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E667.%0Along01++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along02++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along03++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along04++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along05++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along_hint01+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_hint02+++has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_hint03+++has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_late01+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late02+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+4+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late03+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late04+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+4+contracts%2C+50+employees%2C+28%0A73%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late05+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0A3.15.4.+Domain+Model%0A3.16.+Traveling+Tournament+Problem+%28TTP%29%0A3.16.1.+Problem+Description%0ASchedule+matches+between+n+teams.%0A74%0AHard+constraints%3A%0A%E2%80%A2+Each+team+plays+twice+against+every+other+team%3A+once+home+and+once+away.%0A%E2%80%A2+Each+team+has+exactly+one+match+on+each+timeslot.%0A%E2%80%A2+No+team+must+have+more+than+three+consecutive+home+or+three+consecutive+away+matches.%0A%E2%80%A2+No+repeaters%3A+no+two+consecutive+matches+of+the+same+two+opposing+teams.%0ASoft+constraints%3A%0A%E2%80%A2+Minimize+the+total+distance+traveled+by+all+teams.%0AThe+problem+is+defined+on+Michael+Trick%E2%80%99s+website+%28which+contains+the+world+records+too%29.%0A3.16.2.+Problem+Size%0A75%0A1-nl04+++++has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A1-nl06+++++has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A1-nl08+++++has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A1-nl10+++++has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A1-nl12+++++has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A1-nl14+++++has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A1-nl16+++++has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A2-bra24++++has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A3-nfl16++++has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A3-nfl18++++has+34+days%2C+18+teams+and++306+matches+with+a+search+space+of++10%5E346.%0A3-nfl20++++has+38+days%2C+20+teams+and++380+matches+with+a+search+space+of++10%5E447.%0A3-nfl22++++has+42+days%2C+22+teams+and++462+matches+with+a+search+space+of++10%5E562.%0A3-nfl24++++has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A3-nfl26++++has+50+days%2C+26+teams+and++650+matches+with+a+search+space+of++10%5E838.%0A3-nfl28++++has+54+days%2C+28+teams+and++756+matches+with+a+search+space+of++10%5E999.%0A3-nfl30++++has+58+days%2C+30+teams+and++870+matches+with+a+search+space+of+10%5E1175.%0A3-nfl32++++has+62+days%2C+32+teams+and++992+matches+with+a+search+space+of+10%5E1367.%0A4-super04++has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A4-super06++has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A4-super08++has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A4-super10++has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A4-super12++has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A4-super14++has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A5-galaxy04+has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A5-galaxy06+has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A5-galaxy08+has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A5-galaxy10+has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A5-galaxy12+has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A5-galaxy14+has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A5-galaxy16+has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A5-galaxy18+has+34+days%2C+18+teams+and++306+matches+with+a+search+space+of++10%5E346.%0A5-galaxy20+has+38+days%2C+20+teams+and++380+matches+with+a+search+space+of++10%5E447.%0A5-galaxy22+has+42+days%2C+22+teams+and++462+matches+with+a+search+space+of++10%5E562.%0A5-galaxy24+has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A5-galaxy26+has+50+days%2C+26+teams+and++650+matches+with+a+search+space+of++10%5E838.%0A5-galaxy28+has+54+days%2C+28+teams+and++756+matches+with+a+search+space+of++10%5E999.%0A5-galaxy30+has+58+days%2C+30+teams+and++870+matches+with+a+search+space+of+10%5E1175.%0A5-galaxy32+has+62+days%2C+32+teams+and++992+matches+with+a+search+space+of+10%5E1367.%0A5-galaxy34+has+66+days%2C+34+teams+and+1122+matches+with+a+search+space+of+10%5E1576.%0A5-galaxy36+has+70+days%2C+36+teams+and+1260+matches+with+a+search+space+of+10%5E1801.%0A5-galaxy38+has+74+days%2C+38+teams+and+1406+matches+with+a+search+space+of+10%5E2042.%0A5-galaxy40+has+78+days%2C+40+teams+and+1560+matches+with+a+search+space+of+10%5E2301.%0A3.17.+Cheap+Time+Scheduling%0A3.17.1.+Problem+Description%0ASchedule+all+tasks+in+time+and+on+a+machine+to+minimize+power+cost.+Power+prices+differs+in+time.%0AThis+is+a+form+of+job+shop+scheduling.%0A76%0AHard+constraints%3A%0A%E2%80%A2+Start+time+limits%3A+each+task+must+start+between+its+earliest+start+and+latest+start+limit.%0A%E2%80%A2+Maximum+capacity%3A+the+maximum+capacity+for+each+resource+for+each+machine+must+not+be%0Aexceeded.%0A%E2%80%A2+Startup+and+shutdown%3A+each+machine+must+be+active+in+the+periods+during+which+it+has+assigned%0Atasks.+Between+tasks+it+is+allowed+to+be+idle+to+avoid+startup+and+shutdown+costs.%0AMedium+constraints%3A%0A%E2%80%A2+Power+cost%3A+minimize+the+total+power+cost+of+the+whole+schedule.%0A%E2%97%A6+Machine+power+cost%3A+Each+active+or+idle+machine+consumes+power%2C+which+infers+a+power%0Acost+%28depending+on+the+power+price+during+that+time%29.%0A%E2%97%A6+Task+power+cost%3A+Each+task+consumes+power+too%2C+which+infers+a+power+cost+%28depending+on%0Athe+power+price+during+its+time%29.%0A%E2%97%A6+Machine+startup+and+shutdown+cost%3A+Every+time+a+machine+starts+up+or+shuts+down%2C+an+extra%0Acost+is+inflicted.%0ASoft+constraints+%28addendum+to+the+original+problem+definition%29%3A%0A%E2%80%A2+Start+early%3A+prefer+starting+a+task+sooner+rather+than+later.%0AThe+problem+is+defined+by+the+ICON+challenge.%0A3.17.2.+Problem+Size%0Asample01+++has+3+resources%2C+++2+machines%2C+288+periods+and+++25+tasks+with+a+search%0Aspace+of++++10%5E53.%0Asample02+++has+3+resources%2C+++2+machines%2C+288+periods+and+++50+tasks+with+a+search%0Aspace+of+++10%5E114.%0Asample03+++has+3+resources%2C+++2+machines%2C+288+periods+and++100+tasks+with+a+search%0Aspace+of+++10%5E226.%0Asample04+++has+3+resources%2C+++5+machines%2C+288+periods+and++100+tasks+with+a+search%0Aspace+of+++10%5E266.%0Asample05+++has+3+resources%2C+++2+machines%2C+288+periods+and++250+tasks+with+a+search%0Aspace+of+++10%5E584.%0Asample06+++has+3+resources%2C+++5+machines%2C+288+periods+and++250+tasks+with+a+search%0Aspace+of+++10%5E673.%0Asample07+++has+3+resources%2C+++2+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E2388.%0Asample08+++has+3+resources%2C+++5+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E2748.%0Asample09+++has+4+resources%2C++20+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E6668.%0Ainstance00+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E595.%0Ainstance01+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E599.%0A77%0Ainstance02+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E599.%0Ainstance03+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E591.%0Ainstance04+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E590.%0Ainstance05+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E667.%0Ainstance06+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E660.%0Ainstance07+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E662.%0Ainstance08+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E651.%0Ainstance09+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E659.%0Ainstance10+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1657.%0Ainstance11+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1644.%0Ainstance12+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1637.%0Ainstance13+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1659.%0Ainstance14+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1643.%0Ainstance15+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1782.%0Ainstance16+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1778.%0Ainstance17+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1764.%0Ainstance18+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1769.%0Ainstance19+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1778.%0Ainstance20+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3689.%0Ainstance21+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3678.%0Ainstance22+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3706.%0Ainstance23+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3676.%0Ainstance24+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3681.%0Ainstance25+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3774.%0Ainstance26+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3737.%0Ainstance27+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0A78%0Aspace+of++10%5E3744.%0Ainstance28+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3731.%0Ainstance29+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3746.%0Ainstance30+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7718.%0Ainstance31+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7740.%0Ainstance32+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7686.%0Ainstance33+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7672.%0Ainstance34+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7695.%0Ainstance35+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7807.%0Ainstance36+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7814.%0Ainstance37+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7764.%0Ainstance38+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7736.%0Ainstance39+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7783.%0Ainstance40+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15976.%0Ainstance41+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15935.%0Ainstance42+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15887.%0Ainstance43+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15896.%0Ainstance44+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15885.%0Ainstance45+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20173.%0Ainstance46+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20132.%0Ainstance47+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20126.%0Ainstance48+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20110.%0Ainstance49+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20078.%0A79%0A3.18.+Investment+Asset+Class+Allocation+%28Portfolio%0AOptimization%29%0A3.18.1.+Problem+Description%0ADecide+the+relative+quantity+to+invest+in+each+asset+class.%0AHard+constraints%3A%0A%E2%80%A2+Risk+maximum%3A+the+total+standard+deviation+must+not+be+higher+than+the+standard+deviation%0Amaximum.%0A%E2%97%A6+Total+standard+deviation+calculation+takes+asset+class+correlations+into+account+by+applying%0AMarkowitz+Portfolio+Theory.%0A%E2%80%A2+Region+maximum%3A+Each+region+has+a+quantity+maximum.%0A%E2%80%A2+Sector+maximum%3A+Each+sector+has+a+quantity+maximum.%0ASoft+constraints%3A%0A%E2%80%A2+Maximize+expected+return.%0A3.18.2.+Problem+Size%0Ade_smet_1+has+1+regions%2C+3+sectors+and+11+asset+classes+with+a+search+space+of+10%5E4.%0Airrinki_1+has+2+regions%2C+3+sectors+and+6+asset+classes+with+a+search+space+of+10%5E3.%0ALarger+datasets+have+not+been+created+or+tested+yet%2C+but+should+not+pose+a+problem.+A+good+source%0Aof+data+is+this+Asset+Correlation+website.%0A3.19.+Conference+Scheduling%0A3.19.1.+Problem+Description%0AAssign+each+conference+talk+to+a+timeslot+and+a+room.+Timeslots+can+overlap.+Read%2Fwrite+to%2Ffrom+an%0A*.xlsx+file+that+can+be+edited+with+LibreOffice+or+Excel+too.%0AHard+constraints%3A%0A%E2%80%A2+Talk+type+of+timeslot%3A+The+type+of+a+talk+must+match+the+timeslot%E2%80%99s+talk+type.%0A%E2%80%A2+Room+unavailable+timeslots%3A+A+talk%E2%80%99s+room+must+be+available+during+the+talk%E2%80%99s+timeslot.%0A%E2%80%A2+Room+conflict%3A+Two+talks+can%E2%80%99t+use+the+same+room+during+overlapping+timeslots.%0A%E2%80%A2+Speaker+unavailable+timeslots%3A+Every+talk%E2%80%99s+speaker+must+be+available+during+the+talk%E2%80%99s+timeslot.%0A%E2%80%A2+Speaker+conflict%3A+Two+talks+can%E2%80%99t+share+a+speaker+during+overlapping+timeslots.%0A%E2%80%A2+Generic+purpose+timeslot+and+room+tags%0A80%0A%E2%97%A6+Speaker+required+timeslot+tag%3A+If+a+speaker+has+a+required+timeslot+tag%2C+then+all+his%2Fher+talks%0Amust+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+prohibited+timeslot+tag%3A+If+a+speaker+has+a+prohibited+timeslot+tag%2C+then+all+his%2Fher%0Atalks+cannot+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+required+timeslot+tag%3A+If+a+talk+has+a+required+timeslot+tag%2C+then+it+must+be+assigned+to+a%0Atimeslot+with+that+tag.%0A%E2%97%A6+Talk+prohibited+timeslot+tag%3A+If+a+talk+has+a+prohibited+timeslot+tag%2C+then+it+cannot+be%0Aassigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+required+room+tag%3A+If+a+speaker+has+a+required+room+tag%2C+then+all+his%2Fher+talks+must%0Abe+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Speaker+prohibited+room+tag%3A+If+a+speaker+has+a+prohibited+room+tag%2C+then+all+his%2Fher+talks%0Acannot+be+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Talk+required+room+tag%3A+If+a+talk+has+a+required+room+tag%2C+then+it+must+be+assigned+to+a+room%0Awith+that+tag.%0A%E2%97%A6+Talk+prohibited+room+tag%3A+If+a+talk+has+a+prohibited+room+tag%2C+then+it+cannot+be+assigned+to+a%0Aroom+with+that+tag.%0ASoft+constraints%3A%0A%E2%80%A2+Theme+track+conflict%3A+Minimize+the+number+of+talks+that+share+a+same+theme+tag+during%0Aoverlapping+timeslots.%0A%E2%80%A2+Sector+conflict%3A+Minimize+the+number+of+talks+that+share+a+same+sector+tag+during+overlapping%0Atimeslots.%0A%E2%80%A2+Content+audience+level+flow+violation%3A+For+every+content+tag%2C+schedule+the+introductory+talks%0Abefore+the+advanced+talks.%0A%E2%80%A2+Audience+level+diversity%3A+For+every+timeslot%2C+maximize+the+number+of+talks+with+a+different%0Aaudience+level.%0A%E2%80%A2+Language+diversity%3A+For+every+timeslot%2C+maximize+the+number+of+talks+with+a+different+language.%0A%E2%80%A2+Generic+purpose+timeslot+and+room+tags%0A%E2%97%A6+Speaker+preferred+timeslot+tag%3A+If+a+speaker+has+a+preferred+timeslot+tag%2C+then+all+his%2Fher%0Atalks+should+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+undesired+timeslot+tag%3A+If+a+speaker+has+a+undesired+timeslot+tag%2C+then+all+his%2Fher%0Atalks+should+not+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+preferred+timeslot+tag%3A+If+a+talk+has+a+preferred+timeslot+tag%2C+then+it+should+be+assigned%0Ato+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+undesired+timeslot+tag%3A+If+a+talk+has+a+undesired+timeslot+tag%2C+then+it+should+not+be%0Aassigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+preferred+room+tag%3A+If+a+speaker+has+a+preferred+room+tag%2C+then+all+his%2Fher+talks%0Ashould+be+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Speaker+undesired+room+tag%3A+If+a+speaker+has+a+undesired+room+tag%2C+then+all+his%2Fher+talks%0Ashould+not+be+assigned+to+a+room+with+that+tag.%0A81%0A%E2%97%A6+Talk+preferred+room+tag%3A+If+a+talk+has+a+preferred+room+tag%2C+then+it+should+be+assigned+to+a%0Aroom+with+that+tag.%0A%E2%97%A6+Talk+undesired+room+tag%3A+If+a+talk+has+a+undesired+room+tag%2C+then+it+should+not+be+assigned+to%0Aa+room+with+that+tag.%0A3.19.2.+Value+Proposition%0A3.19.3.+Problem+Size%0A18talks-6timeslots-5rooms++++has++18+talks%2C++6+timeslots+and++5+rooms+with+a+search%0Aspace+of++10%5E26.%0A36talks-12timeslots-5rooms+++has++36+talks%2C+12+timeslots+and++5+rooms+with+a+search%0Aspace+of++10%5E64.%0A72talks-12timeslots-10rooms++has++72+talks%2C+12+timeslots+and+10+rooms+with+a+search%0Aspace+of+10%5E149.%0A108talks-18timeslots-10rooms+has+108+talks%2C+18+timeslots+and+10+rooms+with+a+search%0Aspace+of+10%5E243.%0A216talks-18timeslots-20rooms+has+216+talks%2C+18+timeslots+and+20+rooms+with+a+search%0Aspace+of+10%5E552.%0A82%0A3.20.+Rock+Tour%0A3.20.1.+Problem+Description%0ADrive+the+rock+bus+from+show+to+show%2C+but+schedule+shows+only+on+available+days.%0AHard+constraints%3A%0A%E2%80%A2+Schedule+every+required+show.%0A%E2%80%A2+Schedule+as+many+shows+as+possible.%0AMedium+constraints%3A%0A%E2%80%A2+Maximize+revenue+opportunity.%0A%E2%80%A2+Minimize+driving+time.%0A%E2%80%A2+Visit+sooner+than+later.%0ASoft+constraints%3A%0A%E2%80%A2+Avoid+long+driving+times.%0A3.20.2.+Problem+Size%0A47shows+has+47+shows+with+a+search+space+of+10%5E59.%0A83%0AChapter+4.+Planner+Configuration%0A4.1.+Overview%0ASolving+a+planning+problem+with+Planner+consists+of+the+following+steps%3A%0A1.+Model+your+planning+problem+as+a+class+that+implements+the+interface+Solution%2C+for+example%0Athe+class+NQueens.%0A2.+Configure+a+Solver%2C+for+example+a+First+Fit+and+Tabu+Search+solver+for+any+NQueens+instance.%0A3.+Load+a+problem+data+set+from+your+data+layer%2C+for+example+a+Four+Queens+instance.+That+is+the%0Aplanning+problem.%0A4.+Solve+it+with+Solver.solve%28problem%29+which+returns+the+best+solution+found.%0A4.2.+Solver+Configuration%0A4.2.1.+Solver+Configuration+by+XML%0ABuild+a+Solver+instance+with+the+SolverFactory.+Configure+the+SolverFactory+with+a+solver%0Aconfiguration+XML+file%2C+provided+as+a+classpath+resource+%28as+defined+by+ClassLoader.getResource%28%29%29%3A%0A84%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0++++++++++++++%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0AIn+a+typical+project+%28following+the+Maven+directory+structure%29%2C+that+solverConfig+XML+file+would+be%0Alocated+at%0A%24PROJECT_DIR%2Fsrc%2Fmain%2Fresources%2Forg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%0A.+Alternatively%2C+a+SolverFactory+can+be+created+from+a+File%2C+an+InputStream+or+a+Reader+with+methods%0Asuch+as+SolverFactory.createFromXmlFile%28%29.+However%2C+for+portability+reasons%2C+a+classpath+resource+is%0Arecommended.%0AOn+some+environments+%28OSGi%2C+JBoss+modules%2C+%E2%80%A6%29%2C+classpath+resources+%28such+as+the%0Asolver+config%2C+score+DRL%E2%80%99s+and+domain+classes%29+in+your+jars+might+not+be+available%0Ato+the+default+ClassLoader+of+the+optaplanner-core+jar.+In+those+cases%2C+provide+the%0AClassLoader+of+your+classes+as+a+parameter%3A%0A%EF%81%9A%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0++++++++++++++%22...%2FnqueensSolverConfig.xml%22%2C+getClass%28%29.%0AgetClassLoader%28%29%29%3B%0AWhen+using+Workbench+or+Execution+Server+or+to+take+advantage+of+Drools%E2%80%99s%0AKieContainer+features%2C+provide+the+KieContainer+as+a+parameter%3A%0A%C2%A0++++++KieServices+kieServices+%3D+KieServices.Factory.get%28%29%3B%0A%C2%A0++++++KieContainer+kieContainer+%3D+kieServices.newKieContainer%28%0A%EF%81%9A+%C2%A0++++++++++++++kieServices.newReleaseId%28%22org.nqueens%22%2C+%22nqueens%22%2C%221.0.0%22%29%29%3B%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory%0A.createFromKieContainerXmlResource%28%0A%C2%A0++++++++++++++kieContainer%2C+%22...%2FnqueensSolverConfig.xml%22%29%3B%0AAlso+use+a+ksessionName+in+the+solver+configuration.%0ABoth+a+Solver+and+a+SolverFactory+have+a+generic+type+called+Solution_%2C+which+is+the+class%0Arepresenting+a+planning+problem+and+solution.%0AA+solver+configuration+XML+file+looks+like+this%3A%0A85%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+%3C%21--+Define+the+score+function+--%3E%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A%C2%A0+%3C%21--+Configure+the+optimization+algorithms+%28optional%29+--%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0ANotice+the+three+parts+in+it%3A%0A%E2%80%A2+Define+the+model.%0A%E2%80%A2+Define+the+score+function.%0A%E2%80%A2+Optionally+configure+the+optimization+algorithm%28s%29.%0AThese+various+parts+of+a+configuration+are+explained+further+in+this+manual.%0APlanner+makes+it+relatively+easy+to+switch+optimization+algorithm%28s%29+just+by+changing+the%0Aconfiguration.+There+is+even+a+Benchmarker+which+allows+you+to+play+out+different+configurations%0Aagainst+each+other+and+report+the+most+appropriate+configuration+for+your+use+case.%0A4.2.2.+Solver+Configuration+by+Java+API%0AA+solver+configuration+can+also+be+configured+with+the+SolverConfig+API.+This+is+especially+useful+to%0Achange+some+values+dynamically+at+runtime.+For+example%2C+to+change+the+running+time+based+on%0Auser+input%2C+before+building+the+Solver%3A%0A86%0A%C2%A0+++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0+++++++TerminationConfig+terminationConfig+%3D+new+TerminationConfig%28%29%3B%0A%C2%A0+++++++terminationConfig.setMinutesSpentLimit%28userInput%29%3B%0A%C2%A0+++++++solverFactory.getSolverConfig%28%29.setTerminationConfig%28terminationConfig%29%3B%0A%C2%A0+++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0AEvery+element+in+the+solver+configuration+XML+is+available+as+a+*Config+class+or+a+property+on+a%0A*Config+class+in+the+package+namespace+org.optaplanner.core.config.+These+*Config+classes+are+the%0AJava+representation+of+the+XML+format.+They+build+the+runtime+components+%28of+the+package%0Anamespace+org.optaplanner.core.impl%29+and+assemble+them+into+an+efficient+Solver.%0AThe+SolverFactory+is+only+thread-safe+after+it%E2%80%99s+configured.+So+the+getSolverConfig%28%29%0Amethod+is+not+thread-safe.+To+configure+a+SolverFactory+dynamically+for+each+user%0Arequest%2C+build+a+basic+SolverFactory+during+initialization+and+clone+it+with+the%0AcloneSolverFactory%28%29+method+for+a+user+request%3A%0A%C2%A0+++private+SolverFactory%3CNQueens%3E+base%3B%0A%C2%A0+++public+void+init%28%29+%7B%0A%C2%A0+++++++base+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0+++++++base.getSolverConfig%28%29.setTerminationConfig%28new%0A%EF%81%AA+TerminationConfig%28%29%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+Called+concurrently+from+different+threads%0A%C2%A0+++public+void+userRequest%28...%2C+long+userInput%29%0A%C2%A0+++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+base.cloneSolverFactory%0A%28%29%3B%0A%C2%A0+++++++solverFactory.getSolverConfig%28%29.getTerminationConfig%28%29%0A.setMinutesSpentLimit%28userInput%29%3B%0A%C2%A0+++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A4.2.3.+Annotations+Configuration%0A4.2.3.1.+Automatic+Scanning+for+Annotations%0AInstead+of+the+declaring+the+classes+that+have+a+%40PlanningSolution+or+%40PlanningEntity+manually%3A%0A87%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0APlanner+can+find+scan+the+classpath+and+find+them+automatically%3A%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AOn+environments+such+as+OSGi+and+Android%2C+which+use+a+non-standard%0A%EF%81%9A+ClassLoader%2C+automated+scanning+might+not+find+the+%40PlanningSolution+or%0A%40PlanningEntity+classes.%0AAutomated+scanning+inflicts+a+performance+cost+during+bootstrap.+To+speed+up+scanning+or+if+there%0Aare+multiple+models+in+your+classpath%2C+specify+the+packages+to+scan%3A%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%3E%0A%C2%A0+++%3CpackageInclude%3Eorg.optaplanner.examples.cloudbalancing%3C%2FpackageInclude%3E%0A%C2%A0+%3C%2FscanAnnotatedClasses%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThis+finds+all+solution+and+entity+classes+in+that+package+or+its+subpackages.%0AIf+scanAnnotatedClasses+is+not+specified%2C+the+org.reflections+transitive+maven%0A%EF%81%9A+dependency+can+be+excluded.%0A4.2.3.2.+Annotation+Alternatives%0APlanner+needs+to+be+told+which+classes+in+your+domain+model+are+planning+entities%2C+which%0Aproperties+are+planning+variables%2C+etc.+There+are+several+ways+to+deliver+this+information%3A%0A%E2%80%A2+Add+class+annotations+and+JavaBean+property+annotations+on+the+domain+model%0A%28recommended%29.+The+property+annotations+must+be+on+the+getter+method%2C+not+on+the+setter%0Amethod.+Such+a+getter+does+not+need+to+be+public.%0A88%0A%E2%80%A2+Add+class+annotations+and+field+annotations+on+the+domain+model.+Such+a+field+does+not+need+to%0Abe+public.%0A%E2%80%A2+No+annotations%3A+externalize+the+domain+configuration+in+an+XML+file.+This+is+not+yet+supported.%0AThis+manual+focuses+on+the+first+manner%2C+but+every+feature+supports+all+three+manners%2C+even+if+it%E2%80%99s%0Anot+explicitly+mentioned.%0A4.2.4.+Custom+Properties+Configuration%0ASolver+configuration+elements%2C+that+instantiate+classes+and+explicitly+mention+it%2C+support+custom%0Aproperties.+Custom+properties+are+useful+to+tweak+dynamic+values+through+the+Benchmarker.+For%0Aexample%2C+presume+your+EasyScoreCalculator+has+heavy+calculations+%28which+are+cached%29+and+you%0Awant+to+increase+the+cache+size+in+one+benchmark%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CeasyScoreCalculatorClass%3E...MyEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3CeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%3C%21--+Override+value+--%3E%0A%C2%A0+++%3C%2FeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AAdd+a+public+setter+for+each+custom+property%2C+which+is+called+when+a+Solver+is+build.%0Apublic+class+MyEasyScoreCalculator+extends+EasyScoreCalculator%3CMySolution%3E+%7B%0A%C2%A0+++++++private+int+myCacheSize+%3D+500%3B+%2F%2F+Default+value%0A%C2%A0+++++++%40SuppressWarnings%28%22unused%22%29%0A%C2%A0+++++++public+void+setMyCacheSize%28int+myCacheSize%29+%7B%0A%C2%A0+++++++++++this.myCacheSize+%3D+myCacheSize%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++...%0A%7D%0AMost+value+types+are+supported+%28including+boolean%2C+int%2C+double%2C+BigDecimal%2C+String+and+enums%29.%0A4.3.+Model+a+Planning+Problem%0A4.3.1.+Is+This+Class+a+Problem+Fact+or+Planning+Entity%3F%0ALook+at+a+dataset+of+your+planning+problem.+You+will+recognize+domain+classes+in+there%2C+each+of%0Awhich+can+be+categorized+as+one+of+the+following%3A%0A%E2%80%A2+An+unrelated+class%3A+not+used+by+any+of+the+score+constraints.+From+a+planning+standpoint%2C+this%0Adata+is+obsolete.%0A89%0A%E2%80%A2+A+problem+fact+class%3A+used+by+the+score+constraints%2C+but+does+NOT+change+during+planning+%28as%0Along+as+the+problem+stays+the+same%29.+For+example%3A+Bed%2C+Room%2C+Shift%2C+Employee%2C+Topic%2C+Period%2C+%E2%80%A6+All%0Athe+properties+of+a+problem+fact+class+are+problem+properties.%0A%E2%80%A2+A+planning+entity+class%3A+used+by+the+score+constraints+and+changes+during+planning.+For%0Aexample%3A+BedDesignation%2C+ShiftAssignment%2C+Exam%2C+%E2%80%A6+The+properties+that+change+during+planning%0Aare+planning+variables.+The+other+properties+are+problem+properties.%0AAsk+yourself%3A+What+class+changes+during+planning%3F+Which+class+has+variables+that+I+want+the+Solver%0Ato+change+for+me%3F+That+class+is+a+planning+entity.+Most+use+cases+have+only+one+planning+entity+class.%0AMost+use+cases+also+have+only+one+planning+variable+per+planning+entity+class.%0AIn+real-time+planning%2C+even+though+the+problem+itself+changes%2C+problem+facts+do%0A%EF%81%9A+not+really+change+during+planning%2C+instead+they+change+between+planning%0A%28because+the+Solver+temporarily+stops+to+apply+the+problem+fact+changes%29.%0ATo+create+a+good+domain+model%2C+read+the+domain+modeling+guide.%0AIn+Planner%2C+all+problem+facts+and+planning+entities+are+plain+old+JavaBeans+%28POJOs%29.+Load+them%0Afrom+a+database%2C+an+XML+file%2C+a+data+repository%2C+a+REST+service%2C+a+noSQL+cloud%2C+%E2%80%A6+%28see+integration%29%3A%0Ait+doesn%E2%80%99t+matter.%0A4.3.2.+Problem+Fact%0AA+problem+fact+is+any+JavaBean+%28POJO%29+with+getters+that+does+not+change+during+planning.%0AImplementing+the+interface+Serializable+is+recommended+%28but+not+required%29.+For+example+in+n%0Aqueens%2C+the+columns+and+rows+are+problem+facts%3A%0Apublic+class+Column+implements+Serializable+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0Apublic+class+Row+implements+Serializable+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0AA+problem+fact+can+reference+other+problem+facts+of+course%3A%0A90%0Apublic+class+Course+implements+Serializable+%7B%0A%C2%A0+++private+String+code%3B%0A%C2%A0+++private+Teacher+teacher%3B+%2F%2F+Other+problem+fact%0A%C2%A0+++private+int+lectureSize%3B%0A%C2%A0+++private+int+minWorkingDaySize%3B%0A%C2%A0+++private+List%3CCurriculum%3E+curriculumList%3B+%2F%2F+Other+problem+facts%0A%C2%A0+++private+int+studentSize%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0AA+problem+fact+class+does+not+require+any+Planner+specific+code.+For+example%2C+you+can+reuse+your%0Adomain+classes%2C+which+might+have+JPA+annotations.%0AGenerally%2C+better+designed+domain+classes+lead+to+simpler+and+more+efficient+score%0Aconstraints.+Therefore%2C+when+dealing+with+a+messy+%28denormalized%29+legacy+system%2C%0Ait+can+sometimes+be+worthwhile+to+convert+the+messy+domain+model+into+a+Planner%0Aspecific+model+first.+For+example%3A+if+your+domain+model+has+two+Teacher+instances%0A%EF%81%9A+for+the+same+teacher+that+teaches+at+two+different+departments%2C+it+is+harder+towrite+a+correct+score+constraint+that+constrains+a+teacher%E2%80%99s+spare+time+on+the%0Aoriginal+model+than+on+an+adjusted+model.%0AAlternatively%2C+you+can+sometimes+also+introduce+a+cached+problem+fact+to+enrich%0Athe+domain+model+for+planning+only.%0A4.3.3.+Planning+Entity%0A4.3.3.1.+Planning+Entity+Annotation%0AA+planning+entity+is+a+JavaBean+%28POJO%29+that+changes+during+solving%2C+for+example+a+Queen+that%0Achanges+to+another+row.+A+planning+problem+has+multiple+planning+entities%2C+for+example+for+a%0Asingle+n+queens+problem%2C+each+Queen+is+a+planning+entity.+But+there+is+usually+only+one+planning%0Aentity+class%2C+for+example+the+Queen+class.%0AA+planning+entity+class+needs+to+be+annotated+with+the+%40PlanningEntity+annotation.%0AEach+planning+entity+class+has+one+or+more+planning+variables+%28which+can+be+genuine+or+shadows%29.%0AIt+should+also+have+one+or+more+defining+properties.+For+example+in+n+queens%2C+a+Queen+is+defined+by%0Aits+Column+and+has+a+planning+variable+Row.+This+means+that+a+Queen%E2%80%99s+column+never+changes+during%0Asolving%2C+while+its+row+does+change.%0A91%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++private+Column+column%3B%0A%C2%A0+++%2F%2F+Planning+variables%3A+changes+during+planning%2C+between+score+calculations.%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0AA+planning+entity+class+can+have+multiple+planning+variables.+For+example%2C+a+Lecture+is+defined+by%0Aits+Course+and+its+index+in+that+course+%28because+one+course+has+multiple+lectures%29.+Each+Lecture%0Aneeds+to+be+scheduled+into+a+Period+and+a+Room+so+it+has+two+planning+variables+%28period+and+room%29.%0AFor+example%3A+the+course+Mathematics+has+eight+lectures+per+week%2C+of+which+the+first+lecture+is%0AMonday+morning+at+08%3A00+in+room+212.%0A%40PlanningEntity%0Apublic+class+Lecture+%7B%0A%C2%A0+++private+Course+course%3B%0A%C2%A0+++private+int+lectureIndexInCourse%3B%0A%C2%A0+++%2F%2F+Planning+variables%3A+changes+during+planning%2C+between+score+calculations.%0A%C2%A0+++private+Period+period%3B%0A%C2%A0+++private+Room+room%3B%0A%C2%A0+++%2F%2F+...%0A%7D%0AWithout+automated+scanning%2C+the+solver+configuration+also+needs+to+declare+each+planning+entity%0Aclass%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ASome+uses+cases+have+multiple+planning+entity+classes.+For+example%3A+route+freight+and+trains+into%0Arailway+network+arcs%2C+where+each+freight+can+use+multiple+trains+over+its+journey+and+each+train%0Acan+carry+multiple+freights+per+arc.+Having+multiple+planning+entity+classes+directly+raises+the%0Aimplementation+complexity+of+your+use+case.%0A92%0ADo+not+create+unnecessary+planning+entity+classes.+This+leads+to+difficult+Move%0Aimplementations+and+slower+score+calculation.%0AFor+example%2C+do+not+create+a+planning+entity+class+to+hold+the+total+free+time+of+a%0Ateacher%2C+which+needs+to+be+kept+up+to+date+as+the+Lecture+planning+entities+change.%0AInstead%2C+calculate+the+free+time+in+the+score+constraints+%28or+as+a+shadow+variable%29%0A%EF%81%9A+and+put+the+result+per+teacher+into+a+logically+inserted+score+object.%0AIf+historic+data+needs+to+be+considered+too%2C+then+create+problem+fact+to+hold+the%0Atotal+of+the+historic+assignments+up+to%2C+but+not+including%2C+the+planning+window+%28so%0Athat+it+does+not+change+when+a+planning+entity+changes%29+and+let+the+score%0Aconstraints+take+it+into+account.%0A4.3.3.2.+Planning+Entity+Difficulty%0ASome+optimization+algorithms+work+more+efficiently+if+they+have+an+estimation+of+which+planning%0Aentities+are+more+difficult+to+plan.+For+example%3A+in+bin+packing+bigger+items+are+harder+to+fit%2C+in%0Acourse+scheduling+lectures+with+more+students+are+more+difficult+to+schedule%2C+and+in+n+queens+the%0Amiddle+queens+are+more+difficult+to+fit+on+the+board.%0ADo+not+try+to+use+planning+entity+difficulty+to+implement+a+business%0Aconstraint.+It+will+not+affect+the+score+function%3A+if+we+have+infinite+solving+time%2C%0Athe+returned+solution+will+be+the+same.%0A%EF%81%9A+To+attain+a+schedule+in+which+certain+entities+are+scheduled+earlier+in+the+schedule%2C%0Aadd+a+score+constraint+to+change+the+score+function+so+it+prefers+such+solutions.%0AOnly+consider+adding+planning+entity+difficulty+too+if+it+can+make+the+solver+more%0Aefficient.%0ATo+allow+the+heuristics+to+take+advantage+of+that+domain+specific+information%2C+set+a%0AdifficultyComparatorClass+to+the+%40PlanningEntity+annotation%3A%0A%40PlanningEntity%28difficultyComparatorClass+%3D+CloudProcessDifficultyComparator.class%29%0Apublic+class+CloudProcess+%7B%0A%C2%A0+++%2F%2F+...%0A%7D%0Apublic+class+CloudProcessDifficultyComparator+implements+Comparator%3CCloudProcess%3E+%7B%0A%C2%A0+++public+int+compare%28CloudProcess+a%2C+CloudProcess+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getRequiredMultiplicand%28%29%2C+b.getRequiredMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0A93%0AAlternatively%2C+you+can+also+set+a+difficultyWeightFactoryClass+to+the+%40PlanningEntity+annotation%2C+so%0Athat+you+have+access+to+the+rest+of+the+problem+facts+from+the+Solution+too%3A%0A%40PlanningEntity%28difficultyWeightFactoryClass+%3D+QueenDifficultyWeightFactory.class%29%0Apublic+class+Queen+%7B%0A%C2%A0+++%2F%2F+...%0A%7D%0ASee+sorted+selection+for+more+information.%0ADifficulty+should+be+implemented+ascending%3A+easy+entities+are+lower%2C+difficult%0Aentities+are+higher.+For+example%2C+in+bin+packing%3A+small+item+%3C+medium+item+%3C+big%0A%EF%81%AA+item.%0AAlthough+most+algorithms+start+with+the+more+difficult+entities+first%2C+they+just%0Areverse+the+ordering.%0ANone+of+the+current+planning+variable+states+should+be+used+to+compare+planning+entity+difficulty.%0ADuring+Construction+Heuristics%2C+those+variables+are+likely+to+be+null+anyway.+For+example%2C+a+Queen%27s%0Arow+variable+should+not+be+used.%0A4.3.4.+Planning+Variable+%28genuine%29%0A4.3.4.1.+Planning+Variable+Annotation%0AA+planning+variable+is+a+JavaBean+property+%28so+a+getter+and+setter%29+on+a+planning+entity.+It+points+to%0Aa+planning+value%2C+which+changes+during+planning.+For+example%2C+a+Queen%27s+row+property+is+a+genuine%0Aplanning+variable.+Note+that+even+though+a+Queen%27s+row+property+changes+to+another+Row+during%0Aplanning%2C+no+Row+instance+itself+is+changed.+Normally+planning+variables+are+genuine%2C+but+advanced%0Acases+can+also+have+shadows.%0AA+genuine+planning+variable+getter+needs+to+be+annotated+with+the+%40PlanningVariable+annotation%2C%0Awhich+needs+a+non-empty+valueRangeProviderRefs+property.%0A94%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++...%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setRow%28Row+row%29+%7B%0A%C2%A0+++++++this.row+%3D+row%3B%0A%C2%A0+++%7D%0A%7D%0AThe+valueRangeProviderRefs+property+defines+what+are+the+possible+planning+values+for+this%0Aplanning+variable.+It+references+one+or+more+%40ValueRangeProvider+id%27s.%0AA+%40PlanningVariable+annotation+needs+to+be+on+a+member+in+a+class+with+a%0A%EF%81%9A+%40PlanningEntity+annotation.+It+is+ignored+on+parent+classes+or+subclasses+without%0Athat+annotation.%0AAnnotating+the+field+instead+of+the+property+works+too%3A%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++private+Row+row%3B%0A%7D%0A4.3.4.2.+Nullable+Planning+Variable%0ABy+default%2C+an+initialized+planning+variable+cannot+be+null%2C+so+an+initialized+solution+will+never+use%0Anull+for+any+of+its+planning+variables.+In+an+over-constrained+use+case%2C+this+can+be%0Acounterproductive.+For+example%3A+in+task+assignment+with+too+many+tasks+for+the+workforce%2C+we%0Awould+rather+leave+low+priority+tasks+unassigned+instead+of+assigning+them+to+an+overloaded%0Aworker.%0ATo+allow+an+initialized+planning+variable+to+be+null%2C+set+nullable+to+true%3A%0A95%0A%C2%A0+++%40PlanningVariable%28...%2C+nullable+%3D+true%29%0A%C2%A0+++public+Worker+getWorker%28%29+%7B%0A%C2%A0+++++++return+worker%3B%0A%C2%A0+++%7D%0APlanner+will+automatically+add+the+value+null+to+the+value+range.+There+is+no+need%0A%EF%81%AA+to+add+null+in+a+collection+used+by+a+ValueRangeProvider.%0AUsing+a+nullable+planning+variable+implies+that+your+score+calculation+is%0A%EF%81%9A+responsible+for+punishing+%28or+even+rewarding%29+variables+with+a+null+value.%0ARepeated+planning+%28especially+real-time+planning%29+does+not+mix+well+with+a+nullable+planning%0Avariable.+Every+time+the+Solver+starts+or+a+problem+fact+change+is+made%2C+the+Construction+Heuristics%0Awill+try+to+initialize+all+the+null+variables+again%2C+which+can+be+a+huge+waste+of+time.+One+way+to+deal%0Awith+this%2C+is+to+change+when+a+planning+entity+should+be+reinitialized+with+an%0AreinitializeVariableEntityFilter%3A%0A%C2%A0+++%40PlanningVariable%28...%2C+nullable+%3D+true%2C+reinitializeVariableEntityFilter+%3D%0AReinitializeTaskFilter.class%29%0A%C2%A0+++public+Worker+getWorker%28%29+%7B%0A%C2%A0+++++++return+worker%3B%0A%C2%A0+++%7D%0A4.3.4.3.+When+is+a+Planning+Variable+Considered+Initialized%3F%0AA+planning+variable+is+considered+initialized+if+its+value+is+not+null+or+if+the+variable+is+nullable.+So+a%0Anullable+variable+is+always+considered+initialized%2C+even+when+a+custom%0AreinitializeVariableEntityFilter+triggers+a+reinitialization+during+construction+heuristics.%0AA+planning+entity+is+initialized+if+all+of+its+planning+variables+are+initialized.%0AA+Solution+is+initialized+if+all+of+its+planning+entities+are+initialized.%0A4.3.5.+Planning+Value+and+Planning+Value+Range%0A4.3.5.1.+Planning+Value%0AA+planning+value+is+a+possible+value+for+a+genuine+planning+variable.+Usually%2C+a+planning+value+is+a%0Aproblem+fact%2C+but+it+can+also+be+any+object%2C+for+example+a+double.+It+can+even+be+another+planning%0Aentity+or+even+a+interface+implemented+by+both+a+planning+entity+and+a+problem+fact.%0AA+planning+value+range+is+the+set+of+possible+planning+values+for+a+planning+variable.+This+set+can+be%0Aa+countable+%28for+example+row+1%2C+2%2C+3+or+4%29+or+uncountable+%28for+example+any+double+between+0.0+and%0A1.0%29.%0A96%0A4.3.5.2.+Planning+Value+Range+Provider%0A4.3.5.2.1.+Overview%0AThe+value+range+of+a+planning+variable+is+defined+with+the+%40ValueRangeProvider+annotation.+A%0A%40ValueRangeProvider+annotation+always+has+a+property+id%2C+which+is+referenced+by+the%0A%40PlanningVariable%27s+property+valueRangeProviderRefs.%0AThis+annotation+can+be+located+on+two+types+of+methods%3A%0A%E2%80%A2+On+the+Solution%3A+All+planning+entities+share+the+same+value+range.%0A%E2%80%A2+On+the+planning+entity%3A+The+value+range+differs+per+planning+entity.+This+is+less+common.%0AA+%40ValueRangeProvider+annotation+needs+to+be+on+a+member+in+a+class+with+a%0A%EF%81%9A+%40PlanningSolution+or+a+%40PlanningEntity+annotation.+It+is+ignored+on+parent%0Aclasses+or+subclasses+without+those+annotations.%0AThe+return+type+of+that+method+can+be+three+types%3A%0A%E2%80%A2+Collection%3A+The+value+range+is+defined+by+a+Collection+%28usually+a+List%29+of+its+possible+values.%0A%E2%80%A2+Array%3A+The+value+range+is+defined+by+an+array+of+its+possible+values.%0A%E2%80%A2+ValueRange%3A+The+value+range+is+defined+by+its+bounds.+This+is+less+common.%0A4.3.5.2.2.+ValueRangeProvider+on+the+Solution%0AAll+instances+of+the+same+planning+entity+class+share+the+same+set+of+possible+planning+values+for%0Athat+planning+variable.+This+is+the+most+common+way+to+configure+a+value+range.%0AThe+Solution+implementation+has+method+that+returns+a+Collection+%28or+a+ValueRange%29.+Any+value%0Afrom+that+Collection+is+a+possible+planning+value+for+this+planning+variable.%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22rowRange%22%29%0A%C2%A0+++public+List%3CRow%3E+getRowList%28%29+%7B%0A%C2%A0+++++++return+rowList%3B%0A%C2%A0+++%7D%0A%7D%0A97%0AThat+Collection+%28or+ValueRange%29+must+not+contain+the+value+null%2C+not+even+for+a%0A%EF%81%AA+nullable+planning+variable.%0AAnnotating+the+field+instead+of+the+property+works+too%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22rowRange%22%29%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%7D%0A4.3.5.2.3.+ValueRangeProvider+on+the+Planning+Entity%0AEach+planning+entity+has+its+own+value+range+%28a+set+of+possible+planning+values%29+for+the+planning%0Avariable.+For+example%2C+if+a+teacher+can+never+teach+in+a+room+that+does+not+belong+to+his%0Adepartment%2C+lectures+of+that+teacher+can+limit+their+room+value+range+to+the+rooms+of+his%0Adepartment.%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22departmentRoomRange%22%7D%29%0A%C2%A0+++public+Room+getRoom%28%29+%7B%0A%C2%A0+++++++return+room%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22departmentRoomRange%22%29%0A%C2%A0+++public+List%3CRoom%3E+getPossibleRoomList%28%29+%7B%0A%C2%A0+++++++return+getCourse%28%29.getTeacher%28%29.getDepartment%28%29.getRoomList%28%29%3B%0A%C2%A0+++%7D%0ANever+use+this+to+enforce+a+soft+constraint+%28or+even+a+hard+constraint+when+the+problem+might+not%0Ahave+a+feasible+solution%29.+For+example%3A+Unless+there+is+no+other+way%2C+a+teacher+can+not+teach+in+a%0Aroom+that+does+not+belong+to+his+department.+In+this+case%2C+the+teacher+should+not+be+limited+in+his%0Aroom+value+range+%28because+sometimes+there+is+no+other+way%29.%0ABy+limiting+the+value+range+specifically+of+one+planning+entity%2C+you+are+effectively%0Acreating+a+built-in+hard+constraint.+This+can+have+the+benefit+of+severely+lowering%0A%EF%81%9A+the+number+of+possible+solutions%3B+however%2C+it+can+also+take+away+the+freedom+of%0Athe+optimization+algorithms+to+temporarily+break+that+constraint+in+order+to+escape%0Afrom+a+local+optimum.%0AA+planning+entity+should+not+use+other+planning+entities+to+determinate+its+value+range.+That+would%0Aonly+try+to+make+the+planning+entity+solve+the+planning+problem+itself+and+interfere+with+the%0Aoptimization+algorithms.%0AEvery+entity+has+its+own+List+instance%2C+unless+multiple+entities+have+the+same+value+range.+For%0A98%0Aexample%2C+if+teacher+A+and+B+belong+to+the+same+department%2C+they+use+the+same+List%3CRoom%3E+instance.%0AFurthermore%2C+each+List+contains+a+subset+of+the+same+set+of+planning+value+instances.+For+example%2C%0Aif+department+A+and+B+can+both+use+room+X%2C+then+their+List%3CRoom%3E+instances+contain+the+same+Room%0Ainstance.%0AA+ValueRangeProvider+on+the+planning+entity+consumes+more+memory+than%0A%EF%81%9A+ValueRangeProvider+on+the+Solution+and+disables+certain+automatic+performance%0Aoptimizations.%0AA+ValueRangeProvider+on+the+planning+entity+is+not+currently+compatible+with+a%0A%EF%81%B1+chained+variable.%0A4.3.5.2.4.+ValueRangeFactory%0AInstead+of+a+Collection%2C+you+can+also+return+a+ValueRange+or+CountableValueRange%2C+build+by+the%0AValueRangeFactory%3A%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22delayRange%22%29%0A%C2%A0+++public+CountableValueRange%3CInteger%3E+getDelayRange%28%29+%7B%0A%C2%A0+++++++return+ValueRangeFactory.createIntValueRange%280%2C+5000%29%3B%0A%C2%A0+++%7D%0AA+ValueRange+uses+far+less+memory%2C+because+it+only+holds+the+bounds.+In+the+example+above%2C+a%0ACollection+would+need+to+hold+all+5000+ints%2C+instead+of+just+the+two+bounds.%0AFurthermore%2C+an+incrementUnit+can+be+specified%2C+for+example+if+you+have+to+buy+stocks+in+units+of%0A200+pieces%3A%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22stockAmountRange%22%29%0A%C2%A0+++public+CountableValueRange%3CInteger%3E+getStockAmountRange%28%29+%7B%0A%C2%A0++++++++%2F%2F+Range%3A+0%2C+200%2C+400%2C+600%2C+...%2C+9999600%2C+9999800%2C+10000000%0A%C2%A0+++++++return+ValueRangeFactory.createIntValueRange%280%2C+10000000%2C+200%29%3B%0A%C2%A0+++%7D%0AReturn+CountableValueRange+instead+of+ValueRange+whenever+possible+%28so+Planner%0A%EF%81%9A+knows+that+it%E2%80%99s+countable%29.%0AThe+ValueRangeFactory+has+creation+methods+for+several+value+class+types%3A%0A%E2%80%A2+boolean%3A+A+boolean+range.%0A%E2%80%A2+int%3A+A+32bit+integer+range.%0A%E2%80%A2+long%3A+A+64bit+integer+range.%0A%E2%80%A2+double%3A+A+64bit+floating+point+range+which+only+supports+random+selection+%28because+it+does+not%0Aimplement+CountableValueRange%29.%0A%E2%80%A2+BigInteger%3A+An+arbitrary-precision+integer+range.%0A99%0A%E2%80%A2+BigDecimal%3A+A+decimal+point+range.+By+default%2C+the+increment+unit+is+the+lowest+non-zero+value+in%0Athe+scale+of+the+bounds.%0A%E2%80%A2+Temporal+%28such+as+LocalDate%2C+LocalDateTime%2C+%E2%80%A6%29%3A+A+time+range.%0A4.3.5.2.5.+Combine+ValueRangeProviders%0AValue+range+providers+can+be+combined%2C+for+example%3A%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22companyCarRange%22%2C+%22personalCarRange%22%0A%7D%29%0A%C2%A0+++public+Car+getCar%28%29+%7B%0A%C2%A0+++++++return+car%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22companyCarRange%22%29%0A%C2%A0+++public+List%3CCompanyCar%3E+getCompanyCarList%28%29+%7B%0A%C2%A0+++++++return+companyCarList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22personalCarRange%22%29%0A%C2%A0+++public+List%3CPersonalCar%3E+getPersonalCarList%28%29+%7B%0A%C2%A0+++++++return+personalCarList%3B%0A%C2%A0+++%7D%0A4.3.5.3.+Planning+Value+Strength%0ASome+optimization+algorithms+work+a+bit+more+efficiently+if+they+have+an+estimation+of+which%0Aplanning+values+are+stronger%2C+which+means+they+are+more+likely+to+satisfy+a+planning+entity.+For%0Aexample%3A+in+bin+packing+bigger+containers+are+more+likely+to+fit+an+item+and+in+course+scheduling%0Abigger+rooms+are+less+likely+to+break+the+student+capacity+constraint.+Usually%2C+the+efficiency+gain+of%0Aplanning+value+strength+is+far+less+than+that+of+planning+entity+difficulty.%0ADo+not+try+to+use+planning+value+strength+to+implement+a+business+constraint.%0AIt+will+not+affect+the+score+function%3A+if+we+have+infinite+solving+time%2C+the+returned%0A%EF%81%9A+solution+will+be+the+same.%0ATo+affect+the+score+function%2C+add+a+score+constraint.+Only+consider+adding+planning%0Avalue+strength+too+if+it+can+make+the+solver+more+efficient.%0ATo+allow+the+heuristics+to+take+advantage+of+that+domain+specific+information%2C+set+a%0AstrengthComparatorClass+to+the+%40PlanningVariable+annotation%3A%0A100%0A%C2%A0+++%40PlanningVariable%28...%2C+strengthComparatorClass+%3D+CloudComputerStrengthComparator%0A.class%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0Apublic+class+CloudComputerStrengthComparator+implements+Comparator%3CCloudComputer%3E+%7B%0A%C2%A0+++public+int+compare%28CloudComputer+a%2C+CloudComputer+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getMultiplicand%28%29%2C+b.getMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28b.getCost%28%29%2C+a.getCost%28%29%29+%2F%2F+Descending+%28but+this+is%0Adebatable%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AIf+you+have+multiple+planning+value+classes+in+the+same+value+range%2C+the%0AstrengthComparatorClass+needs+to+implement+a+Comparator+of+a+common+superclass%0A%EF%81%9A+%28for+example+Comparator%3CObject%3E%29+and+be+able+to+handle+comparing+instances+of%0Athose+different+classes.%0AAlternatively%2C+you+can+also+set+a+strengthWeightFactoryClass+to+the+%40PlanningVariable+annotation%2C+so%0Ayou+have+access+to+the+rest+of+the+problem+facts+from+the+solution+too%3A%0A%C2%A0+++%40PlanningVariable%28...%2C+strengthWeightFactoryClass+%3D+RowStrengthWeightFactory.%0Aclass%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0ASee+sorted+selection+for+more+information.%0AStrength+should+be+implemented+ascending%3A+weaker+values+are+lower%2C+stronger%0A%EF%81%AA+values+are+higher.+For+example+in+bin+packing%3A+small+container+%3C+medium%0Acontainer+%3C+big+container.%0ANone+of+the+current+planning+variable+state+in+any+of+the+planning+entities+should+be+used+to+compare%0Aplanning+values.+During+construction+heuristics%2C+those+variables+are+likely+to+be+null.+For+example%2C%0Anone+of+the+row+variables+of+any+Queen+may+be+used+to+determine+the+strength+of+a+Row.%0A4.3.5.4.+Chained+Planning+Variable+%28TSP%2C+VRP%2C+%E2%80%A6%29%0ASome+use+cases%2C+such+as+TSP+and+Vehicle+Routing%2C+require+chaining.+This+means+the+planning+entities%0A101%0Apoint+to+each+other+and+form+a+chain.+By+modeling+the+problem+as+a+set+of+chains+%28instead+of+a+set+of%0Atrees%2Floops%29%2C+the+search+space+is+heavily+reduced.%0AA+planning+variable+that+is+chained+either%3A%0A%E2%80%A2+Directly+points+to+a+problem+fact+%28or+planning+entity%29%2C+which+is+called+an+anchor.%0A%E2%80%A2+Points+to+another+planning+entity+with+the+same+planning+variable%2C+which+recursively+points+to%0Aan+anchor.%0AHere+are+some+example+of+valid+and+invalid+chains%3A%0AEvery+initialized+planning+entity+is+part+of+an+open-ended+chain+that+begins+from+an+anchor.+A%0Avalid+model+means+that%3A%0A%E2%80%A2+A+chain+is+never+a+loop.+The+tail+is+always+open.%0A%E2%80%A2+Every+chain+always+has+exactly+one+anchor.+The+anchor+is+a+problem+fact%2C+never+a+planning%0Aentity.%0A%E2%80%A2+A+chain+is+never+a+tree%2C+it+is+always+a+line.+Every+anchor+or+planning+entity+has+at+most+one%0Atrailing+planning+entity.%0A%E2%80%A2+Every+initialized+planning+entity+is+part+of+a+chain.%0A%E2%80%A2+An+anchor+with+no+planning+entities+pointing+to+it%2C+is+also+considered+a+chain.%0A102%0A%EF%81%B1+A+planning+problem+instance+given+to+the+Solver+must+be+valid.%0AIf+your+constraints+dictate+a+closed+chain%2C+model+it+as+an+open-ended+chain+%28which%0A%EF%81%9A+is+easier+to+persist+in+a+database%29+and+implement+a+score+constraint+for+the+last%0Aentity+back+to+the+anchor.%0AThe+optimization+algorithms+and+built-in+Moves+do+chain+correction+to+guarantee+that+the+model%0Astays+valid%3A%0A%EF%81%B1+A+custom+Move+implementation+must+leave+the+model+in+a+valid+state.%0AFor+example%2C+in+TSP+the+anchor+is+a+Domicile+%28in+vehicle+routing+it+is+Vehicle%29%3A%0Apublic+class+Domicile+...+implements+Standstill+%7B%0A%C2%A0+++...%0A%C2%A0+++public+City+getCity%28%29+%7B...%7D%0A%7D%0AThe+anchor+%28which+is+a+problem+fact%29+and+the+planning+entity+implement+a+common+interface%2C+for%0Aexample+TSP%E2%80%99s+Standstill%3A%0A103%0Apublic+interface+Standstill+%7B%0A%C2%A0+++City+getCity%28%29%3B%0A%7D%0AThat+interface+is+the+return+type+of+the+planning+variable.+Furthermore%2C+the+planning+variable+is%0Achained.+For+example+TSP%E2%80%99s+Visit+%28in+vehicle+routing+it+is+Customer%29%3A%0A%40PlanningEntity%0Apublic+class+Visit+...+implements+Standstill+%7B%0A%C2%A0+++...%0A%C2%A0+++public+City+getCity%28%29+%7B...%7D%0A%C2%A0+++%40PlanningVariable%28graphType+%3D+PlanningVariableGraphType.CHAINED%2C%0A%C2%A0+++++++valueRangeProviderRefs+%3D+%7B%22domicileRange%22%2C+%22visitRange%22%7D%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setPreviousStandstill%28Standstill+previousStandstill%29+%7B%0A%C2%A0+++++++this.previousStandstill+%3D+previousStandstill%3B%0A%C2%A0+++%7D%0A%7D%0ANotice+how+two+value+range+providers+are+usually+combined%3A%0A%E2%80%A2+The+value+range+provider+that+holds+the+anchors%2C+for+example+domicileList.%0A%E2%80%A2+The+value+range+provider+that+holds+the+initialized+planning+entities%2C+for+example+visitList.%0A4.3.6.+Planning+Problem+and+Planning+Solution%0A4.3.6.1.+Planning+Problem+Instance%0AA+dataset+for+a+planning+problem+needs+to+be+wrapped+in+a+class+for+the+Solver+to+solve.+That%0Asolution+class+represents+both+the+planning+problem+and+%28if+solved%29+a+solution.+It+is+annotated+with+a%0A%40PlanningSolution+annotation.+For+example+in+n+queens%2C+the+solution+class+is+the+NQueens+class%2C+which%0Acontains+a+Column+list%2C+a+Row+list%2C+and+a+Queen+list.%0AA+planning+problem+is+actually+an+unsolved+planning+solution+or+-+stated+differently+-+an%0Auninitialized+solution.+For+example+in+n+queens%2C+that+NQueens+class+has+the+%40PlanningSolution%0Aannotation%2C+yet+every+Queen+in+an+unsolved+NQueens+class+is+not+yet+assigned+to+a+Row+%28their+row%0Aproperty+is+null%29.+That%E2%80%99s+not+a+feasible+solution.+It%E2%80%99s+not+even+a+possible+solution.+It%E2%80%99s+an+uninitialized%0Asolution.%0A104%0A4.3.6.2.+Solution+Class%0AA+solution+class+holds+all+problem+facts%2C+planning+entities+and+a+score.+It+is+annotated+with+a%0A%40PlanningSolution+annotation.+For+example%2C+an+NQueens+instance+holds+a+list+of+all+columns%2C+all+rows%0Aand+all+Queen+instances%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++%2F%2F+Problem+facts%0A%C2%A0+++private+int+n%3B%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++%2F%2F+Planning+entities%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++...%0A%7D%0AWithout+automated+scanning%2C+the+solver+configuration+also+needs+to+declare+the+planning+solution%0Aclass%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0A4.3.6.3.+Planning+Entities+of+a+Solution+%28%40PlanningEntityCollectionProperty%29%0APlanner+needs+to+extract+the+entity+instances+from+the+solution+instance.+It+gets+those+collection%28s%29+by%0Acalling+every+getter+%28or+field%29+that+is+annotated+with+%40PlanningEntityCollectionProperty%3A%0A105%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++%40PlanningEntityCollectionProperty%0A%C2%A0+++public+List%3CQueen%3E+getQueenList%28%29+%7B%0A%C2%A0+++++++return+queenList%3B%0A%C2%A0+++%7D%0A%7D%0AThere+can+be+multiple+%40PlanningEntityCollectionProperty+annotated+members.+Those+can+even%0Areturn+a+Collection+with+the+same+entity+class+type.+Instead+of+Collection%2C+it+can+also+return+an%0Aarray.%0AA+%40PlanningEntityCollectionProperty+annotation+needs+to+be+on+a+member+in+a%0A%EF%81%9A+class+with+a+%40PlanningSolution+annotation.+It+is+ignored+on+parent+classes+or%0Asubclasses+without+that+annotation.%0AIn+rare+cases%2C+a+planning+entity+might+be+a+singleton%3A+use+%40PlanningEntityProperty+on+its+getter+%28or%0Afield%29+instead.%0ABoth+annotations+can+also+be+auto+discovered+if+enabled.%0A4.3.6.4.+Score+of+a+Solution+%28%40PlanningScore%29%0AA+Solution+requires+a+score+property+%28or+field%29%2C+which+is+annotated+with+a+%40PlanningScore%0Aannotation.+The+score+property+is+null+if+the+the+score+hasn%E2%80%99t+been+calculated+yet.+The+score+property%0Ais+typed+to+the+specific+Score+implementation+of+your+use+case.+For+example%2C+NQueens+uses+a%0ASimpleScore%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+SimpleScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28SimpleScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%7D%0A106%0AMost+use+cases+use+a+HardSoftScore+instead%3A%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++...%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+HardSoftScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28HardSoftScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%7D%0ASome+use+cases+use+other+score+types.%0AThis+annotation+can+also+be+auto+discovered+if+enabled.%0A4.3.6.5.+Problem+Facts+of+a+Solution+%28%40ProblemFactCollectionProperty%29%0AFor+Drools+score+calculation%2C+Planner+needs+to+extract+the+problem+fact+instances+from+the+solution%0Ainstance.+It+gets+those+collection%28s%29+by+calling+every+method+%28or+field%29+that+is+annotated+with%0A%40ProblemFactCollectionProperty.+All+objects+returned+by+those+methods+will+be+inserted+into+the%0ADrools+session%2C+so+the+score+rules+can+access+them.+For+example+in+NQueens+all+Column+and+Row%0Ainstances+are+problem+facts.%0A107%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CColumn%3E+getColumnList%28%29+%7B%0A%C2%A0+++++++return+columnList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CRow%3E+getRowList%28%29+%7B%0A%C2%A0+++++++return+rowList%3B%0A%C2%A0+++%7D%0A%7D%0AAll+planning+entities+are+automatically+inserted+into+the+Drools+working+memory.+Do+note+add+an%0Aannotation+on+their+properties.%0AThe+problem+facts+methods+are+not+called+often%3A+at+most+only+once+per+solver+phase%0A%EF%81%9A+per+solver+thread.%0AThere+can+be+multiple+%40ProblemFactCollectionProperty+annotated+members.+Those+can+even+return%0Aa+Collection+with+the+same+class+type%2C+but+they+shouldn%E2%80%99t+return+the+same+instance+twice.+Instead+of%0ACollection%2C+it+can+also+return+an+array.%0AA+%40ProblemFactCollectionProperty+annotation+needs+to+be+on+a+member+in+a+class%0A%EF%81%9A+with+a+%40PlanningSolution+annotation.+It+is+ignored+on+parent+classes+or+subclasses%0Awithout+that+annotation.%0AIn+rare+cases%2C+a+problem+fact+might+be+a+singleton%3A+use+%40ProblemFactProperty+on+its+method+%28or+field%29%0Ainstead.%0ABoth+annotations+can+also+be+auto+discovered+if+enabled.%0A4.3.6.5.1.+Cached+Problem+Fact%0AA+cached+problem+fact+is+a+problem+fact+that+does+not+exist+in+the+real+domain+model%2C+but+is%0Acalculated+before+the+Solver+really+starts+solving.+The+problem+facts+methods+have+the+opportunity%0Ato+enrich+the+domain+model+with+such+cached+problem+facts%2C+which+can+lead+to+simpler+and+faster%0Ascore+constraints.%0AFor+example+in+examination%2C+a+cached+problem+fact+TopicConflict+is+created+for+every+two+Topics%0Awhich+share+at+least+one+Student.%0A108%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++private+List%3CTopicConflict%3E+calculateTopicConflictList%28%29+%7B%0A%C2%A0+++++++List%3CTopicConflict%3E+topicConflictList+%3D+new+ArrayList%3CTopicConflict%3E%28%29%3B%0A%C2%A0+++++++for+%28Topic+leftTopic+%3A+topicList%29+%7B%0A%C2%A0+++++++++++for+%28Topic+rightTopic+%3A+topicList%29+%7B%0A%C2%A0+++++++++++++++if+%28leftTopic.getId%28%29+%3C+rightTopic.getId%28%29%29+%7B%0A%C2%A0+++++++++++++++++++int+studentSize+%3D+0%3B%0A%C2%A0+++++++++++++++++++for+%28Student+student+%3A+leftTopic.getStudentList%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++if+%28rightTopic.getStudentList%28%29.contains%28student%29%29+%7B%0A%C2%A0+++++++++++++++++++++++++++studentSize%2B%2B%3B%0A%C2%A0+++++++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28studentSize+%3E+0%29+%7B%0A%C2%A0+++++++++++++++++++++++topicConflictList.add%28new+TopicConflict%28leftTopic%2C+rightTopic%2C%0AstudentSize%29%29%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+topicConflictList%3B%0A%C2%A0+++%7D%0AWhere+a+score+constraint+needs+to+check+that+no+two+exams+with+a+topic+that+shares+a+student+are%0Ascheduled+close+together+%28depending+on+the+constraint%3A+at+the+same+time%2C+in+a+row%2C+or+in+the+same%0Aday%29%2C+the+TopicConflict+instance+can+be+used+as+a+problem+fact%2C+rather+than+having+to+combine+every%0Atwo+Student+instances.%0A4.3.6.6.+Auto+Discover+Solution+Properties%0AInstead+of+configuring+each+property+%28or+field%29+annotation+explicitly%2C+some+can+also+be+deduced%0Aautomatically+by+Planner.+For+example%2C+on+the+cloud+balancing+example%3A%0A%40PlanningSolution%28autoDiscoverMemberType+%3D+AutoDiscoverMemberType.FIELD%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40ProblemFactCollectionProperty%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22computerRange%22%29+%2F%2F+Not+%28yet%29+auto+discovered%0A%C2%A0+++private+List%3CCloudComputer%3E+computerList%3B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40PlanningEntityCollectionProperty%0A%C2%A0+++private+List%3CCloudProcess%3E+processList%3B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0A109%0AThe+AutoDiscoverMemberType+can+be%3A%0A%E2%80%A2+NONE%3A+No+auto+discovery.%0A%E2%80%A2+FIELD%3A+Auto+discover+all+fields+on+the+%40PlanningSolution+class%0A%E2%80%A2+GETTER%3A+Auto+discover+all+getters+on+the+%40PlanningSolution+class%0AThe+automatic+annotation+is+based+on+the+field+type+%28or+getter+return+type%29%3A%0A%E2%80%A2+%40ProblemFactProperty%3A+when+it+isn%E2%80%99t+a+Collection%2C+an+array%2C+a+%40PlanningEntity+class+or+a+Score%0A%E2%80%A2+%40ProblemFactCollectionProperty%3A+when+it%E2%80%99s+a+Collection+%28or+array%29+of+a+type+that+isn%E2%80%99t+a%0A%40PlanningEntity+class%0A%E2%80%A2+%40PlanningEntityProperty%3A+when+it+is+a+configured+%40PlanningEntity+class+or+subclass%0A%E2%80%A2+%40PlanningEntityCollectionProperty%3A+when+it%E2%80%99s+a+Collection+%28or+array%29+of+a+type+that+is+a%0Aconfigured+%40PlanningEntity+class+or+subclass%0A%E2%80%A2+%40PlanningScore%3A+when+it+is+a+Score+or+subclass%0AThese+automatic+annotation+can+still+be+overwritten+per+field+%28or+getter%29.+Specifically%2C+a%0ABendableScore+always+needs+to+override+with+an+explicit+%40PlanningScore+annotation+to+define+the%0Anumber+of+hard+and+soft+levels.%0A4.3.6.7.+Cloning+a+Solution%0AMost+%28if+not+all%29+optimization+algorithms+clone+the+solution+each+time+they+encounter+a+new+best%0Asolution+%28so+they+can+recall+it+later%29+or+to+work+with+multiple+solutions+in+parallel.%0AThere+are+many+ways+to+clone%2C+such+as+a+shallow+clone%2C+deep+clone%2C+%E2%80%A6+This+context%0A%EF%81%9A+focuses+on+a+planning+clone.%0AA+planning+clone+of+a+solution+must+fulfill+these+requirements%3A%0A%E2%80%A2+The+clone+must+represent+the+same+planning+problem.+Usually+it+reuses+the+same+instances+of%0Athe+problem+facts+and+problem+fact+collections+as+the+original.%0A%E2%80%A2+The+clone+must+use+different%2C+cloned+instances+of+the+entities+and+entity+collections.+Changes+to%0Aan+original+Solution+entity%E2%80%99s+variables+must+not+affect+its+clone.%0A110%0AImplementing+a+planning+clone+method+is+hard%2C+therefore+you+do+not+need+to+implement+it.%0A4.3.6.7.1.+FieldAccessingSolutionCloner%0AThis+SolutionCloner+is+used+by+default.+It+works+well+for+most+use+cases.%0AWhen+the+FieldAccessingSolutionCloner+clones+one+of+your+collections+or+maps%2C+it%0Amay+not+recognize+the+implementation+and+replace+it+with+ArrayList%2C%0A%EF%81%B1+LinkedHashSet%2C+TreeSet%2C+LinkedHashMap+or+TreeMap+%28whichever+is+more+applicable%29+.+It%0Arecognizes+most+of+the+common+JDK+collection+and+map+implementations.%0AThe+FieldAccessingSolutionCloner+does+not+clone+problem+facts+by+default.+If+any+of+your+problem%0Afacts+needs+to+be+deep+cloned+for+a+planning+clone%2C+for+example+if+the+problem+fact+references+a%0Aplanning+entity+or+the+planning+solution%2C+mark+it+with+a+%40DeepPlanningClone+annotation%3A%0A%40DeepPlanningClone%0Apublic+class+SeatDesignationDependency+%7B%0A%C2%A0+++private+SeatDesignation+leftSeatDesignation%3B+%2F%2F+planning+entity%0A%C2%A0+++private+SeatDesignation+rightSeatDesignation%3B+%2F%2F+planning+entity%0A%C2%A0+++...%0A%7D%0AIn+the+example+above%2C+because+SeatDesignation+is+a+planning+entity+%28which+is+deep+planning+cloned%0A111%0Aautomatically%29%2C+SeatDesignationDependency+must+also+be+deep+planning+cloned.%0AAlternatively%2C+the+%40DeepPlanningClone+annotation+can+also+be+used+on+a+getter+method.%0A4.3.6.7.2.+Custom+Cloning+with+a+SolutionCloner%0ATo+use+a+custom+cloner%2C+configure+it+on+the+planning+solution%3A%0A%40PlanningSolution%28solutionCloner+%3D+NQueensSolutionCloner.class%29%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+a+NQueens+planning+clone+only+deep+clones+all+Queen+instances.+So+when+the+original%0Asolution+changes+%28later+on+during+planning%29+and+one+or+more+Queen+instances+change%2C+the+planning%0Aclone+isn%E2%80%99t+affected.%0Apublic+class+NQueensSolutionCloner+implements+SolutionCloner%3CNQueens%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+NQueens+cloneSolution%28CloneLedger+ledger%2C+NQueens+original%29+%7B%0A%C2%A0+++++++NQueens+clone+%3D+new+NQueens%28%29%3B%0A%C2%A0+++++++ledger.registerClone%28original%2C+clone%29%3B%0A%C2%A0+++++++clone.setId%28original.getId%28%29%29%3B%0A%C2%A0+++++++clone.setN%28original.getN%28%29%29%3B%0A%C2%A0+++++++clone.setColumnList%28original.getColumnList%28%29%29%3B%0A%C2%A0+++++++clone.setRowList%28original.getRowList%28%29%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+original.getQueenList%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+clonedQueenList+%3D+new+ArrayList%3CQueen%3E%28queenList.size%28%29%29%3B%0A%C2%A0+++++++for+%28Queen+originalQueen+%3A+queenList%29+%7B%0A%C2%A0+++++++++++Queen+cloneQueen+%3D+new+Queen%28%29%3B%0A%C2%A0+++++++++++ledger.registerClone%28originalQueen%2C+cloneQueen%29%3B%0A%C2%A0+++++++++++cloneQueen.setId%28originalQueen.getId%28%29%29%3B%0A%C2%A0+++++++++++cloneQueen.setColumn%28originalQueen.getColumn%28%29%29%3B%0A%C2%A0+++++++++++cloneQueen.setRow%28originalQueen.getRow%28%29%29%3B%0A%C2%A0+++++++++++clonedQueenList.add%28cloneQueen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++clone.setQueenList%28clonedQueenList%29%3B%0A%C2%A0+++++++clone.setScore%28original.getScore%28%29%29%3B%0A%C2%A0+++++++return+clone%3B%0A%C2%A0+++%7D%0A%7D%0AThe+cloneSolution%28%29+method+should+only+deep+clone+the+planning+entities.+Notice+that+the+problem%0Afacts%2C+such+as+Column+and+Row+are+normally+not+cloned%3A+even+their+List+instances+are+not+cloned.+If+the%0Aproblem+facts+were+cloned+too%2C+then+you+would+have+to+make+sure+that+the+new+planning+entity%0Aclones+also+refer+to+the+new+problem+facts+clones+used+by+the+cloned+solution.+For+example%2C+if+you%0A112%0Awere+to+clone+all+Row+instances%2C+then+each+Queen+clone+and+the+NQueens+clone+itself+should+refer+to%0Athose+new+Row+clones.%0ACloning+an+entity+with+a+chained+variable+is+devious%3A+a+variable+of+an+entity+A%0A%EF%81%B1+might+point+to+another+entity+B.+If+A+is+cloned%2C+then+its+variable+must+point+to+the%0Aclone+of+B%2C+not+the+original+B.%0A4.3.6.8.+Create+an+Uninitialized+Solution%0ACreate+a+Solution+instance+to+represent+your+planning+problem%E2%80%99s+dataset%2C+so+it+can+be+set+on+the%0ASolver+as+the+planning+problem+to+solve.+For+example+in+n+queens%2C+an+NQueens+instance+is+created%0Awith+the+required+Column+and+Row+instances+and+every+Queen+set+to+a+different+column+and+every+row%0Aset+to+null.%0A%C2%A0+++private+NQueens+createNQueens%28int+n%29+%7B%0A%C2%A0+++++++NQueens+nQueens+%3D+new+NQueens%28%29%3B%0A%C2%A0+++++++nQueens.setId%280L%29%3B%0A%C2%A0+++++++nQueens.setN%28n%29%3B%0A%C2%A0+++++++nQueens.setColumnList%28createColumnList%28nQueens%29%29%3B%0A%C2%A0+++++++nQueens.setRowList%28createRowList%28nQueens%29%29%3B%0A%C2%A0+++++++nQueens.setQueenList%28createQueenList%28nQueens%29%29%3B%0A%C2%A0+++++++return+nQueens%3B%0A%C2%A0+++%7D%0A%C2%A0+++private+List%3CQueen%3E+createQueenList%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+new+ArrayList%3CQueen%3E%28n%29%3B%0A%C2%A0+++++++long+id+%3D+0L%3B%0A%C2%A0+++++++for+%28Column+column+%3A+nQueens.getColumnList%28%29%29+%7B%0A%C2%A0+++++++++++Queen+queen+%3D+new+Queen%28%29%3B%0A%C2%A0+++++++++++queen.setId%28id%29%3B%0A%C2%A0+++++++++++id%2B%2B%3B%0A%C2%A0+++++++++++queen.setColumn%28column%29%3B%0A%C2%A0+++++++++++%2F%2F+Notice+that+we+leave+the+PlanningVariable+properties+on+null%0A%C2%A0+++++++++++queenList.add%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+queenList%3B%0A%C2%A0+++%7D%0AFigure+4.+Uninitialized+Solution+for+the+Four+Queens+Puzzle%0A113%0AUsually%2C+most+of+this+data+comes+from+your+data+layer%2C+and+your+Solution+implementation+just%0Aaggregates+that+data+and+creates+the+uninitialized+planning+entity+instances+to+plan%3A%0A%C2%A0+++++++private+void+createLectureList%28CourseSchedule+schedule%29+%7B%0A%C2%A0+++++++++++List%3CCourse%3E+courseList+%3D+schedule.getCourseList%28%29%3B%0A%C2%A0+++++++++++List%3CLecture%3E+lectureList+%3D+new+ArrayList%3CLecture%3E%28courseList.size%28%29%29%3B%0A%C2%A0+++++++++++long+id+%3D+0L%3B%0A%C2%A0+++++++++++for+%28Course+course+%3A+courseList%29+%7B%0A%C2%A0+++++++++++++++for+%28int+i+%3D+0%3B+i+%3C+course.getLectureSize%28%29%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++++++++++Lecture+lecture+%3D+new+Lecture%28%29%3B%0A%C2%A0+++++++++++++++++++lecture.setId%28id%29%3B%0A%C2%A0+++++++++++++++++++id%2B%2B%3B%0A%C2%A0+++++++++++++++++++lecture.setCourse%28course%29%3B%0A%C2%A0+++++++++++++++++++lecture.setLectureIndexInCourse%28i%29%3B%0A%C2%A0+++++++++++++++++++%2F%2F+Notice+that+we+leave+the+PlanningVariable+properties+%28period%0Aand+room%29+on+null%0A%C2%A0+++++++++++++++++++lectureList.add%28lecture%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++schedule.setLectureList%28lectureList%29%3B%0A%C2%A0+++++++%7D%0A4.4.+Use+the+Solver%0A4.4.1.+The+Solver+Interface%0AA+Solver+implementation+will+solve+your+planning+problem.%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++Solution_+solve%28Solution_+problem%29%3B%0A%C2%A0+++...%0A%7D%0AA+Solver+can+only+solve+one+planning+problem+instance+at+a+time.+A+Solver+should+only+be+accessed%0Afrom+a+single+thread%2C+except+for+the+methods+that+are+specifically+javadocced+as+being+thread-safe.+It%0Ais+built+with+a+SolverFactory%2C+there+is+no+need+to+implement+it+yourself.%0A4.4.2.+Solving+a+Problem%0ASolving+a+problem+is+quite+easy+once+you+have%3A%0A%E2%80%A2+A+Solver+built+from+a+solver+configuration%0A%E2%80%A2+A+Solution+that+represents+the+planning+problem+instance%0AJust+provide+the+planning+problem+as+argument+to+the+solve%28%29+method+and+it+will+return+the+best%0A114%0Asolution+found%3A%0A%C2%A0+++NQueens+bestSolution+%3D+solver.solve%28problem%29%3B%0AFor+example+in+n+queens%2C+the+solve%28%29+method+will+return+an+NQueens+instance+with+every+Queen%0Aassigned+to+a+Row.%0AFigure+5.+Best+Solution+for+the+Four+Queens+Puzzle+in+8ms+%28Also+an+Optimal+Solution%29%0AThe+solve%28Solution%29+method+can+take+a+long+time+%28depending+on+the+problem+size+and+the+solver%0Aconfiguration%29.+The+Solver+intelligently+wades+through+the+search+space+of+possible+solutions+and%0Aremembers+the+best+solution+it+encounters+during+solving.+Depending+on+a+number+of+factors%0A%28including+problem+size%2C+how+much+time+the+Solver+has%2C+the+solver+configuration%2C+%E2%80%A6%29%2C+that+best%0Asolution+might+or+might+not+be+an+optimal+solution.%0AThe+Solution+instance+given+to+the+method+solve%28Solution%29+is+changed+by+the%0ASolver%2C+but+do+not+mistake+it+for+the+best+solution.%0A%EF%81%9A+The+Solution+instance+returned+by+the+methods+solve%28Solution%29+or%0AgetBestSolution%28%29+is+most+likely+a+planning+clone+of+the+instance+given+to+the%0Amethod+solve%28Solution%29%2C+which+implies+it+is+a+different+instance.%0AThe+Solution+instance+given+to+the+solve%28Solution%29+method+does+not+need+to+be%0A%EF%81%9A+uninitialized.+It+can+be+partially+or+fully+initialized%2C+which+is+often+the+case+in%0Arepeated+planning.%0A4.4.3.+Environment+Mode%3A+Are+There+Bugs+in+my+Code%3F%0AThe+environment+mode+allows+you+to+detect+common+bugs+in+your+implementation.+It+does+not%0Aaffect+the+logging+level.%0AYou+can+set+the+environment+mode+in+the+solver+configuration+XML+file%3A%0A%3Csolver%3E%0A%C2%A0+%3CenvironmentMode%3EFAST_ASSERT%3C%2FenvironmentMode%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AA+solver+has+a+single+Random+instance.+Some+solver+configurations+use+the+Random+instance+a+lot+more%0A115%0Athan+others.+For+example%2C+Simulated+Annealing+depends+highly+on+random+numbers%2C+while+Tabu%0ASearch+only+depends+on+it+to+deal+with+score+ties.+The+environment+mode+influences+the+seed+of+that%0ARandom+instance.%0AThese+are+the+environment+modes%3A%0A4.4.3.1.+FULL_ASSERT%0AThe+FULL_ASSERT+mode+turns+on+all+assertions+%28such+as+assert+that+the+incremental+score%0Acalculation+is+uncorrupted+for+each+move%29+to+fail-fast+on+a+bug+in+a+Move+implementation%2C+a+score%0Arule%2C+the+rule+engine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+also+intrusive+because+it+calls+the%0Amethod+calculateScore%28%29+more+frequently+than+a+non-assert+mode.%0AThe+FULL_ASSERT+mode+is+horribly+slow+%28because+it+does+not+rely+on+incremental+score%0Acalculation%29.%0A4.4.3.2.+NON_INTRUSIVE_FULL_ASSERT%0AThe+NON_INTRUSIVE_FULL_ASSERT+turns+on+several+assertions+to+fail-fast+on+a+bug+in+a+Move%0Aimplementation%2C+a+score+rule%2C+the+rule+engine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+non-intrusive+because+it+does+not+call%0Athe+method+calculateScore%28%29+more+frequently+than+a+non+assert+mode.%0AThe+NON_INTRUSIVE_FULL_ASSERT+mode+is+horribly+slow+%28because+it+does+not+rely+on+incremental%0Ascore+calculation%29.%0A4.4.3.3.+FAST_ASSERT%0AThe+FAST_ASSERT+mode+turns+on+most+assertions+%28such+as+assert+that+an+undoMove%E2%80%99s+score+is+the%0Asame+as+before+the+Move%29+to+fail-fast+on+a+bug+in+a+Move+implementation%2C+a+score+rule%2C+the+rule%0Aengine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+also+intrusive+because+it+calls+the%0Amethod+calculateScore%28%29+more+frequently+than+a+non+assert+mode.%0AThe+FAST_ASSERT+mode+is+slow.%0AIt+is+recommended+to+write+a+test+case+that+does+a+short+run+of+your+planning+problem+with+the%0AFAST_ASSERT+mode+on.%0A4.4.3.4.+REPRODUCIBLE+%28default%29%0AThe+reproducible+mode+is+the+default+mode+because+it+is+recommended+during+development.+In+this%0Amode%2C+two+runs+in+the+same+Planner+version+will+execute+the+same+code+in+the+same+order.+Those%0Atwo+runs+will+have+the+same+result+at+every+step%2C+except+if+the+note+below+applies.+This+enables%0Ayou+to+reproduce+bugs+consistently.+It+also+allows+you+to+benchmark+certain+refactorings+%28such+as+a%0Ascore+constraint+performance+optimization%29+fairly+across+runs.%0A116%0ADespite+the+reproducible+mode%2C+your+application+might+still+not+be+fully%0Areproducible+because+of%3A%0A%E2%80%A2+Use+of+HashSet+%28or+another+Collection+which+has+an+inconsistent+order+between%0AJVM+runs%29+for+collections+of+planning+entities+or+planning+values+%28but+not%0Anormal+problem+facts%29%2C+especially+in+the+Solution+implementation.+Replace+it%0A%EF%81%9A+with+LinkedHashSet.%0A%E2%80%A2+Combining+a+time+gradient+dependent+algorithms+%28most+notably+Simulated%0AAnnealing%29+together+with+time+spent+termination.+A+sufficiently+large%0Adifference+in+allocated+CPU+time+will+influence+the+time+gradient+values.%0AReplace+Simulated+Annealing+with+Late+Acceptance.+Or+instead%2C+replace+time%0Aspent+termination+with+step+count+termination.%0AThe+reproducible+mode+can+be+slightly+slower+than+the+non-reproducible+mode.+If+your+production%0Aenvironment+can+benefit+from+reproducibility%2C+use+this+mode+in+production.%0AIn+practice%2C+this+mode+uses+the+default%2C+fixed+random+seed+if+no+seed+is+specified%2C+and+it+also+disables%0Acertain+concurrency+optimizations+%28such+as+work+stealing%29.%0A4.4.3.5.+NON_REPRODUCIBLE%0AThe+non-reproducible+mode+can+be+slightly+faster+than+the+reproducible+mode.+Avoid+using+it%0Aduring+development+as+it+makes+debugging+and+bug+fixing+painful.+If+your+production+environment%0Adoesn%E2%80%99t+care+about+reproducibility%2C+use+this+mode+in+production.%0AIn+practice%2C+this+mode+uses+no+fixed+random+seed+if+no+seed+is+specified.%0A4.4.4.+Logging+Level%3A+What+is+the+Solver+Doing%3F%0AThe+best+way+to+illuminate+the+black+box+that+is+a+Solver%2C+is+to+play+with+the+logging+level%3A%0A%E2%80%A2+error%3A+Log+errors%2C+except+those+that+are+thrown+to+the+calling+code+as+a+RuntimeException.%0AIf+an+error+happens%2C+Planner+normally+fails+fast%3A+it+throws+a+subclass+of%0ARuntimeException+with+a+detailed+message+to+the+calling+code.+It+does+not+log+it%0Aas+an+error+itself+to+avoid+duplicate+log+messages.+Except+if+the+calling+code%0A%EF%81%9A+explicitly+catches+and+eats+that+RuntimeException%2C+a+Thread%27s+default%0AExceptionHandler+will+log+it+as+an+error+anyway.+Meanwhile%2C+the+code+is%0Adisrupted+from+doing+further+harm+or+obfuscating+the+error.%0A%E2%80%A2+warn%3A+Log+suspicious+circumstances.%0A%E2%80%A2+info%3A+Log+every+phase+and+the+solver+itself.+See+scope+overview.%0A%E2%80%A2+debug%3A+Log+every+step+of+every+phase.+See+scope+overview.%0A%E2%80%A2+trace%3A+Log+every+move+of+every+step+of+every+phase.+See+scope+overview.%0A117%0ATurning+on+trace+logging%2C+will+slow+down+performance+considerably%3A+it+is+often%0Afour+times+slower.+However%2C+it+is+invaluable+during+development+to+discover+a%0Abottleneck.%0AEven+debug+logging+can+slow+down+performance+considerably+for+fast+stepping%0Aalgorithms+%28such+as+Late+Acceptance+and+Simulated+Annealing%29%2C+but+not+for+slow%0A%EF%81%9A+stepping+algorithms+%28such+as+Tabu+Search%29.%0ABoth+cause+congestion+in+multithreaded+solving+with+most+appenders%2C+see+below.%0AIn+Eclipse%2C+debug+logging+to+the+console+tends+to+cause+congestion+with+a+score%0Acalculation+speeds+above+10+000+per+second.+Nor+IntelliJ%2C+nor+the+Maven+command%0Aline+suffer+from+this+problem.%0AFor+example%2C+set+it+to+debug+logging%2C+to+see+when+the+phases+end+and+how+fast+steps+are+taken%3A%0AINFO++Solving+started%3A+time+spent+%283%29%2C+best+score+%28-4init%2F0%29%2C+random+%28JDK+with+seed%0A0%29.%0ADEBUG+++++CH+step+%280%29%2C+time+spent+%285%29%2C+score+%28-3init%2F0%29%2C+selected+move+count+%281%29%2C%0Apicked+move+%28Queen-2+%7Bnull+-%3E+Row-0%7D%29.%0ADEBUG+++++CH+step+%281%29%2C+time+spent+%287%29%2C+score+%28-2init%2F0%29%2C+selected+move+count+%283%29%2C%0Apicked+move+%28Queen-1+%7Bnull+-%3E+Row-2%7D%29.%0ADEBUG+++++CH+step+%282%29%2C+time+spent+%2810%29%2C+score+%28-1init%2F0%29%2C+selected+move+count+%284%29%2C%0Apicked+move+%28Queen-3+%7Bnull+-%3E+Row-3%7D%29.%0ADEBUG+++++CH+step+%283%29%2C+time+spent+%2812%29%2C+score+%28-1%29%2C+selected+move+count+%284%29%2C+picked%0Amove+%28Queen-0+%7Bnull+-%3E+Row-1%7D%29.%0AINFO++Construction+Heuristic+phase+%280%29+ended%3A+time+spent+%2812%29%2C+best+score+%28-1%29%2C+score%0Acalculation+speed+%289000%2Fsec%29%2C+step+total+%284%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%2819%29%2C+score+%28-1%29%2C+++++best+score+%28-1%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-2+-%3E+Row-3%7D%29.%0ADEBUG+++++LS+step+%281%29%2C+time+spent+%2824%29%2C+score+%280%29%2C+new+best+score+%280%29%2C%0Aaccepted%2Fselected+move+count+%289%2F12%29%2C+picked+move+%28Queen-3+%7BRow-3+-%3E+Row-2%7D%29.%0AINFO++Local+Search+phase+%281%29+ended%3A+time+spent+%2824%29%2C+best+score+%280%29%2C+score+calculation%0Aspeed+%284000%2Fsec%29%2C+step+total+%282%29.%0AINFO++Solving+ended%3A+time+spent+%2824%29%2C+best+score+%280%29%2C+score+calculation+speed%0A%287000%2Fsec%29%2C+phase+total+%282%29%2C+environment+mode+%28REPRODUCIBLE%29.%0AAll+time+spent+values+are+in+milliseconds.%0AEverything+is+logged+to+SLF4J%2C+which+is+a+simple+logging+facade+which+delegates+every+log+message%0Ato+Logback%2C+Apache+Commons+Logging%2C+Log4j+or+java.util.logging.+Add+a+dependency+to+the+logging%0Aadaptor+for+your+logging+framework+of+choice.%0AIf+you+are+not+using+any+logging+framework+yet%2C+use+Logback+by+adding+this+Maven+dependency%0A%28there+is+no+need+to+add+an+extra+bridge+dependency%29%3A%0A118%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Ech.qos.logback%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Elogback-classic%3C%2FartifactId%3E%0A%C2%A0+++++%3Cversion%3E1.x%3C%2Fversion%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AConfigure+the+logging+level+on+the+org.optaplanner+package+in+your+logback.xml+file%3A%0A%3Cconfiguration%3E%0A%C2%A0+%3Clogger+name%3D%22org.optaplanner%22+level%3D%22debug%22%2F%3E%0A%C2%A0+...%0A%3C%2Fconfiguration%3E%0AIf+it+isn%E2%80%99t+picked+up%2C+temporarily+add+the+system+property+-Dlogback.debug%3Dtrue+to+figure+out+why.%0AWhen+running+multiple+solvers+or+one+multithreaded+solver%2C+most+appenders%0A%EF%81%9A+%28including+the+console%29+cause+congestion+with+debug+and+trace+logging.+Switch+to+an%0Aasync+appender+to+avoid+this+problem+or+turn+off+debug+logging.%0AIf+instead%2C+you+are+still+using+Log4J+1.x+%28and+you+do+not+want+to+switch+to+its+faster+successor%2C%0ALogback%29%2C+add+the+bridge+dependency%3A%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.slf4j%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eslf4j-log4j12%3C%2FartifactId%3E%0A%C2%A0+++++%3Cversion%3E1.x%3C%2Fversion%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AAnd+configure+the+logging+level+on+the+package+org.optaplanner+in+your+log4j.xml+file%3A%0A%3Clog4j%3Aconfiguration+xmlns%3Alog4j%3D%22http%3A%2F%2Fjakarta.apache.org%2Flog4j%2F%22%3E%0A%C2%A0+%3Ccategory+name%3D%22org.optaplanner%22%3E%0A%C2%A0+++%3Cpriority+value%3D%22debug%22+%2F%3E%0A%C2%A0+%3C%2Fcategory%3E%0A%C2%A0+...%0A%3C%2Flog4j%3Aconfiguration%3E%0A119%0AIn+a+multitenant+application%2C+multiple+Solver+instances+might+be+running+at+the%0Asame+time.+To+separate+their+logging+into+distinct+files%2C+surround+the+solve%28%29+call%0Awith+an+MDC%3A%0A%C2%A0+++++++MDC.put%28%22tenant.name%22%2CtenantName%29%3B%0A%C2%A0+++++++MySolution+bestSolution+%3D+solver.solve%28problem%29%3B%0A%C2%A0+++++++MDC.remove%28%22tenant.name%22%29%3B%0AThen+configure+your+logger+to+use+different+files+for+each+%24%7Btenant.name%7D.+For%0Aexample+in+Logback%2C+use+a+SiftingAppender+in+logback.xml%3A%0A%EF%81%9A+%C2%A0+%3Cappender+name%3D%22fileAppender%22+class%3D%22ch.qos.logback.classic.sift.SiftingAppender%22%3E%0A%C2%A0+++%3Cdiscriminator%3E%0A%C2%A0+++++%3Ckey%3Etenant.name%3C%2Fkey%3E%0A%C2%A0+++++%3CdefaultValue%3Eunknown%3C%2FdefaultValue%3E%0A%C2%A0+++%3C%2Fdiscriminator%3E%0A%C2%A0+++%3Csift%3E%0A%C2%A0+++++%3Cappender+name%3D%22fileAppender.%24%7Btenant.name%7D%22+class%3D%0A%22...FileAppender%22%3E%0A%C2%A0+++++++%3Cfile%3Elocal%2Flog%2Foptaplanner-%24%7Btenant.name%7D.log%3C%2Ffile%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2Fappender%3E%0A%C2%A0+++%3C%2Fsift%3E%0A%C2%A0+%3C%2Fappender%3E%0A4.4.5.+Random+Number+Generator%0AMany+heuristics+and+metaheuristics+depend+on+a+pseudorandom+number+generator+for+move%0Aselection%2C+to+resolve+score+ties%2C+probability+based+move+acceptance%2C+%E2%80%A6+During+solving%2C+the+same%0ARandom+instance+is+reused+to+improve+reproducibility%2C+performance+and+uniform+distribution+of%0Arandom+values.%0ATo+change+the+random+seed+of+that+Random+instance%2C+specify+a+randomSeed%3A%0A%3Csolver%3E%0A%C2%A0+%3CrandomSeed%3E0%3C%2FrandomSeed%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ATo+change+the+pseudorandom+number+generator+implementation%2C+specify+a+randomType%3A%0A120%0A%3Csolver%3E%0A%C2%A0+%3CrandomType%3EMERSENNE_TWISTER%3C%2FrandomType%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThe+following+types+are+supported%3A%0A%E2%80%A2+JDK+%28default%29%3A+Standard+implementation+%28java.util.Random%29.%0A%E2%80%A2+MERSENNE_TWISTER%3A+Implementation+by+Commons+Math.%0A%E2%80%A2+WELL512A%2C+WELL1024A%2C+WELL19937A%2C+WELL19937C%2C+WELL44497A+and+WELL44497B%3A+Implementation+by%0ACommons+Math.%0AFor+most+use+cases%2C+the+randomType+has+no+significant+impact+on+the+average+quality+of+the+best%0Asolution+on+multiple+datasets.+If+you+want+to+confirm+this+on+your+use+case%2C+use+the+benchmarker.%0A121%0AChapter+5.+Score+Calculation%0A5.1.+Score+Terminology%0A5.1.1.+What+is+a+Score%3F%0AEvery+Solution+has+a+score.+The+score+is+an+objective+way+to+compare+two+solutions.+The+solution%0Awith+the+higher+score+is+better.+The+Solver+aims+to+find+the+Solution+with+the+highest+Score+of+all%0Apossible+solutions.+The+best+solution+is+the+Solution+with+the+highest+Score+that+Solver+has%0Aencountered+during+solving%2C+which+might+be+the+optimal+solution.%0APlanner+cannot+automatically+know+which+Solution+is+best+for+your+business%2C+so+you+need+to+tell+it%0Ahow+to+calculate+the+score+of+a+given+Solution+according+to+your+business+needs.+If+you+forget+or+are%0Aunable+to+implement+an+important+business+constraint%2C+the+solution+is+probably+useless%3A%0A5.1.2.+Formalize+the+Business+Constraints%0ATo+implement+a+verbal+business+constraint%2C+it+needs+to+be+formalized+as+a+score+constraint.+Luckily%2C%0Adefining+constraints+in+Planner+is+very+flexible+through+the+following+score+techniques%3A%0A%E2%80%A2+Score+signum+%28positive+or+negative%29%3A+maximize+or+minimize+a+constraint+type%0A%E2%80%A2+Score+weight%3A+put+a+cost%2Fprofit+on+a+constraint+type%0A122%0A%E2%80%A2+Score+level+%28hard%2C+soft%2C+%E2%80%A6%29%3A+prioritize+a+group+of+constraint+types%0A%E2%80%A2+Pareto+scoring+%28rarely+used%29%0ATake+the+time+to+acquaint+yourself+with+the+first+three+techniques.+Once+you+understand+them%2C%0Aformalizing+most+business+constraints+becomes+straightforward.%0A5.1.3.+Score+Constraint+Signum+%28Positive+or+Negative%29%0AAll+score+techniques+are+based+on+constraints.+A+constraint+can+be+a+simple+pattern+%28such+as%0AMaximize+the+apple+harvest+in+the+solution%29+or+a+more+complex+pattern.+A+positive+constraint+is+a%0Aconstraint+you+want+to+maximize.+A+negative+constraint+is+a+constraint+you+want+to+minimize.%0AThe+image+above+illustrates+that+the+optimal+solution+always+has+the+highest+score%2C+regardless+if%0Athe+constraints+are+positive+or+negative.%0AMost+planning+problems+have+only+negative+constraints+and+therefore+have+a+negative+score.+In+that%0Acase%2C+the+score+is+the+sum+of+the+weight+of+the+negative+constraints+being+broken%2C+with+a+perfect%0Ascore+of+0.+This+explains+why+the+score+of+a+solution+of+four+queens+is+the+negative+of+the+number+of%0Aqueen+pairs+which+can+attack+each+other.%0ANegative+and+positive+constraints+can+be+combined%2C+even+in+the+same+score+level.%0A123%0ADo+not+presume+that+your+business+knows+all+its+score+constraints+in+advance.%0A%EF%81%9A+Expect+score+constraints+to+be+added+or+changed+after+the+first+releases.%0AWhen+a+constraint+activates+%28because+the+negative+constraint+is+broken+or+the+positive+constraint+is%0Afulfilled%29+on+a+certain+planning+entity+set%2C+it+is+called+a+constraint+match.%0A5.1.4.+Score+Constraint+Weight%0ANot+all+score+constraints+are+equally+important.+If+breaking+one+constraint+is+equally+bad+as%0Abreaking+another+constraint+x+times%2C+then+those+two+constraints+have+a+different+weight+%28but+they%0Aare+in+the+same+score+level%29.+For+example+in+vehicle+routing%2C+you+can+make+one+%22unhappy+driver%22%0Aconstraint+match+count+as+much+as+two+%22fuel+tank+usage%22+constraint+matches%3A%0AScore+weighting+is+easy+in+use+cases+where+you+can+put+a+price+tag+on+everything.+In+that+case%2C+the%0Apositive+constraints+maximize+revenue+and+the+negative+constraints+minimize+expenses%2C+so+together%0Athey+maximize+profit.+Alternatively%2C+score+weighting+is+also+often+used+to+create+social+fairness.+For%0Aexample%2C+a+nurse%2C+who+requests+a+free+day%2C+pays+a+higher+weight+on+New+Years+eve+than+on+a+normal%0Aday.%0AThe+weight+of+a+constraint+match+can+be+dynamically+based+on+the+planning+entities+involved.+For%0Aexample+in+cloud+balance%2C+the+weight+of+the+soft+constraint+match+for+an+active+Computer+is+the+cost%0Aof+that+Computer+%28which+differs+per+computer%29.%0APutting+a+good+weight+on+a+constraint+can+be+a+difficult+analytical+decision%2C+because+it+is+about%0A124%0Amaking+choices+and+tradeoffs+with+other+constraints.+Don%E2%80%99t+spend+too+much+time+on+it+at+the+start+of%0Aan+implementation.+A+non-accurate+weight+is+less+damaging+than+mediocre+algorithms%3A%0AWhen+deciding+the+weights+of+some+constraints+is+debatable%2C+it%E2%80%99s+recommended+to%0Amake+them+configurable+at+runtime%2C+as+demonstrated+in+the+exam+timetabling%0A%EF%81%9A+example+with+the+InstitutionParametrization+class.+This+allow+the+end-user+to%0Arecalibrate+constraint+weights+in+the+user+interface+and+immediately+discover+the%0Aimpact+of+the+new+weights+by+running+the+solver+again.%0AMost+use+cases+use+a+Score+with+int+weights%2C+such+as+HardSoftScore.%0A5.1.5.+Score+Constraint+Level+%28hard%2C+soft%2C+%E2%80%A6%29%0ASometimes+a+score+constraint+outranks+another+score+constraint%2C+no+matter+how+many+times+the%0Aother+is+broken.+In+that+case%2C+those+score+constraints+are+in+different+levels.+For+example%2C+a+nurse%0Acannot+do+two+shifts+at+the+same+time+%28due+to+the+constraints+of+physical+reality%29%2C+this+outranks+all%0Anurse+happiness+constraints.%0AMost+use+cases+have+only+two+score+levels%2C+hard+and+soft.+The+levels+of+two+scores+are+compared%0Alexicographically.+The+first+score+level+gets+compared+first.+If+those+differ%2C+the+remaining+score+levels%0Aare+ignored.+For+example%2C+a+score+that+breaks+0+hard+constraints+and+1000000+soft+constraints+is%0Abetter+than+a+score+that+breaks+1+hard+constraint+and+0+soft+constraints.%0A125%0AIf+there+are+two+%28or+more%29+score+levels%2C+for+example+a+hard+and+soft+level%2C+then+a+score+is+feasible+if%0Ano+hard+constraints+are+broken.%0ABy+default%2C+Planner+will+always+assign+all+planning+variables+a+planning+value.+If%0Athere+is+no+feasible+solution%2C+this+means+the+best+solution+will+be+infeasible.+To%0A%EF%81%9A+instead+leave+some+of+the+planning+entities+unassigned%2C+apply+overconstrained%0Aplanning.%0AFor+each+constraint%2C+you+need+to+pick+a+score+level%2C+a+score+weight+and+a+score+signum.+For+example%3A%0A-1soft+which+has+score+level+of+soft%2C+a+weight+of+1+and+a+negative+signum.+Do+not+use+a+big%0Aconstraint+weight+when+your+business+actually+wants+different+score+levels.+That+hack%2C+known+as%0Ascore+folding%2C+is+broken%3A%0A126%0AYour+business+might+tell+you+that+your+hard+constraints+all+have+the+same+weight%2C%0Abecause+they+cannot+be+broken+%28so+the+weight+does+not+matter%29.+This+is+not+true%0Abecause+if+no+feasible+solution+exists+for+a+specific+dataset%2C+the+least+infeasible%0Asolution+allows+the+business+to+estimate+how+many+business+resources+they+are%0A%EF%81%9A+lacking.+For+example+in+cloud+balancing%2C+how+many+new+computers+to+buy.%0AFurthermore%2C+it+will+likely+create+a+score+trap.+For+example+in+cloud+balance+if+a%0AComputer+has+seven+CPU+too+little+for+its+Processes%2C+then+it+must+be+weighted+seven%0Atimes+as+much+as+if+it+had+only+one+CPU+too+little.%0AThree+or+more+score+levels+are+supported.+For+example%3A+a+company+might+decide+that+profit%0Aoutranks+employee+satisfaction+%28or+vice+versa%29%2C+while+both+are+outranked+by+the+constraints+of%0Aphysical+reality.%0ATo+model+fairness+or+load+balancing%2C+there+is+no+need+to+use+lots+of+score+levels%0A%EF%81%9A+%28even+though+Planner+can+handle+many+score+levels%29.%0AMost+use+cases+use+a+Score+with+two+weights%2C+such+as+HardSoftScore.%0A5.1.6.+Pareto+Scoring+%28AKA+Multi-objective+Optimization+Scoring%29%0AFar+less+common+is+the+use+case+of+pareto+optimization%2C+which+is+also+known+under+the+more%0Aconfusing+term+multi-objective+optimization.+In+pareto+scoring%2C+score+constraints+are+in+the+same%0A127%0Ascore+level%2C+yet+they+are+not+weighted+against+each+other.+When+two+scores+are+compared%2C+each+of%0Athe+score+constraints+are+compared+individually+and+the+score+with+the+most+dominating+score%0Aconstraints+wins.+Pareto+scoring+can+even+be+combined+with+score+levels+and+score+constraint%0Aweighting.%0AConsider+this+example+with+positive+constraints%2C+where+we+want+to+get+the+most+apples+and+oranges.%0ASince+it+is+impossible+to+compare+apples+and+oranges%2C+we+can+not+weight+them+against+each+other.%0AYet%2C+despite+that+we+can+not+compare+them%2C+we+can+state+that+two+apples+are+better+then+one+apple.%0ASimilarly%2C+we+can+state+that+two+apples+and+one+orange+are+better+than+just+one+orange.+So+despite%0Aour+inability+to+compare+some+Scores+conclusively+%28at+which+point+we+declare+them+equal%29%2C+we+can%0Afind+a+set+of+optimal+scores.+Those+are+called+pareto+optimal.%0AScores+are+considered+equal+far+more+often.+It+is+left+up+to+a+human+to+choose+the+better+out+of+a+set%0Aof+best+solutions+%28with+equal+scores%29+found+by+Planner.+In+the+example+above%2C+the+user+must+choose%0Abetween+solution+A+%28three+apples+and+one+orange%29+and+solution+B+%28one+apple+and+six+oranges%29.+It+is%0Aguaranteed+that+Planner+has+not+found+another+solution+which+has+more+apples+or+more+oranges+or%0Aeven+a+better+combination+of+both+%28such+as+two+apples+and+three+oranges%29.%0ATo+implement+pareto+scoring+in+Planner%2C+implement+a+custom+ScoreDefinition+and+Score+%28and%0Areplace+the+BestSolutionRecaller%29.+Future+versions+will+provide+out-of-the-box+support.%0A128%0AA+pareto+Score%27s+compareTo+method+is+not+transitive+because+it+does+a+pareto%0Acomparison.+For+example%3A+having+two+apples+is+greater+than+one+apple.+One+apple%0Ais+equal+to+One+orange.+Yet%2C+two+apples+are+not+greater+than+one+orange+%28but%0A%EF%81%9A+actually+equal%29.+Pareto+comparison+violates+the+contract+of+the+interface%0Ajava.lang.Comparable%27s+compareTo+method%2C+but+Planners+systems+are+pareto%0Acomparison+safe%2C+unless+explicitly+stated+otherwise+in+this+documentation.%0A5.1.7.+Combining+Score+Techniques%0AAll+the+score+techniques+mentioned+above%2C+can+be+combined+seamlessly%3A%0A5.1.8.+Score+interface%0AA+score+is+represented+by+the+Score+interface%2C+which+naturally+extends+Comparable%3A%0Apublic+interface+Score%3C...%3E+extends+Comparable%3C...%3E+%7B%0A%C2%A0+++...%0A%7D%0AThe+Score+implementation+to+use+depends+on+your+use+case.+Your+score+might+not+efficiently+fit+in+a%0Asingle+long+value.+Planner+has+several+built-in+Score+implementations%2C+but+you+can+implement+a%0Acustom+Score+too.+Most+use+cases+tend+to+use+the+built-in+HardSoftScore.%0A129%0AAll+Score+implementations+also+have+an+initScore+%28which+is+an+int%29.+It+is+mostly+intended+for%0Ainternal+use+in+Planner%3A+it+is+the+negative+number+of+uninitialized+planning+variables.+From+a+user%E2%80%99s%0Aperspective+this+is+0%2C+unless+a+Construction+Heuristic+is+terminated+before+it+could+initialize+all%0Aplanning+variables+%28in+which+case+Score.isSolutionInitialized%28%29+returns+false%29.%0AThe+Score+implementation+%28for+example+HardSoftScore%29+must+be+the+same+throughout+a+Solver%0Aruntime.+The+Score+implementation+is+configured+in+the+solution+domain+class%3A%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%7D%0A5.1.9.+Avoid+Floating+Point+Numbers+in+Score+Calculation%0AAvoid+the+use+of+float+or+double+in+score+calculation.+Use+BigDecimal+or+scaled+long+instead.%0AFloating+point+numbers+%28float+and+double%29+cannot+represent+a+decimal+number+correctly.+For%0Aexample%3A+a+double+cannot+hold+the+value+0.05+correctly.+Instead%2C+it+holds+the+nearest+representable%0A130%0Avalue.+Arithmetic+%28including+addition+and+subtraction%29+with+floating+point+numbers%2C+especially+for%0Aplanning+problems%2C+leads+to+incorrect+decisions%3A%0AAdditionally%2C+floating+point+number+addition+is+not+associative%3A%0ASystem.out.println%28+%28%280.01+%2B+0.02%29+%2B+0.03%29+%3D%3D+%280.01+%2B+%280.02+%2B+0.03%29%29+%29%3B+%2F%2F+returns%0Afalse%0AThis+leads+to+score+corruption.%0ADecimal+numbers+%28BigDecimal%29+have+none+of+these+problems.%0ABigDecimal+arithmetic+is+considerably+slower+than+int%2C+long+or+double+arithmetic.%0AIn+experiments+we+have+seen+the+score+calculation+take+five+times+longer.%0A%EF%81%9A+Therefore%2C+in+many+cases%2C+it+can+be+worthwhile+to+multiply+all+numbers+for+a+single%0Ascore+weight+by+a+plural+of+ten%2C+so+the+score+weight+fits+in+a+scaled+int+or+long.+For%0Aexample%2C+if+we+multiply+all+weights+by+1000%2C+a+fuelCost+of+0.07+becomes+a%0AfuelCostMillis+of+70+and+no+longer+uses+a+decimal+score+weight.%0A131%0A5.2.+Choose+a+Score+Type%0ADepending+on+the+number+of+score+levels+and+type+of+score+weights+you+need%2C+choose+a+Score+type.%0AMost+use+cases+use+a+HardSoftScore.%0ATo+properly+write+a+Score+to+a+database+%28with+JPA%2FHibernate%29+or+to+XML%2FJSON+%28with%0A%EF%81%9A+XStream%2FJAXB%2FJackson%29%2C+see+the+integration+chapter.%0A5.2.1.+SimpleScore%0AA+SimpleScore+has+a+single+int+value%2C+for+example+-123.+It+has+a+single+score+level.%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+SimpleScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+SimpleLongScore+uses+a+long+value+instead+of+an+int+value.%0A%E2%80%A2+SimpleDoubleScore+uses+a+double+value+instead+of+an+int+value.+Not+recommended+to+use.%0A%E2%80%A2+SimpleBigDecimalScore+uses+a+BigDecimal+value+instead+of+an+int+value.%0A5.2.2.+HardSoftScore+%28Recommended%29%0AA+HardSoftScore+has+a+hard+int+value+and+a+soft+int+value%2C+for+example+-123hard%2F-456soft.+It+has+two%0Ascore+levels+%28hard+and+soft%29.%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+HardSoftLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+HardSoftDoubleScore+uses+double+values+instead+of+int+values.+Not+recommended+to+use.%0A%E2%80%A2+HardSoftBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.3.+HardMediumSoftScore%0AA+HardMediumSoftScore+which+has+a+hard+int+value%2C+a+medium+int+value+and+a+soft+int+value%2C+for%0Aexample+-123hard%2F-456medium%2F-789soft.+It+has+three+score+levels+%28hard%2C+medium+and+soft%29.+The+hard%0Alevel+determines+if+the+solution+is+feasible%2C+and+the+medium+level+and+soft+level+score+values%0Adetermine+how+well+the+solution+meets+business+goals.+Higher+medium+values+take+precedence+over%0Asoft+values+irrespective+of+the+soft+value.%0A132%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardMediumSoftScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+HardMediumSoftLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+HardMediumSoftBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.4.+BendableScore%0AA+BendableScore+has+a+configurable+number+of+score+levels.+It+has+an+array+of+hard+int+values+and+an%0Aarray+of+soft+int+values%2C+for+example+with+two+hard+levels+and+three+soft+levels%2C+the+score+can+be+%5B-%0A123%2F-456%5Dhard%2F%5B-789%2F-012%2F-345%5Dsoft.+In+that+case%2C+it+has+five+score+levels.+A+solution+is+feasible+if+all%0Ahard+levels+are+at+least+zero.%0AA+BendableScore+with+one+hard+level+and+one+soft+level+is+equivalent+to+a+HardSoftScore%2C+while+a%0ABendableScore+with+one+hard+level+and+two+soft+levels+is+equivalent+to+a+HardMediumSoftScore.%0A%C2%A0+++%40PlanningScore%28bendableHardLevelsSize+%3D+2%2C+bendableSoftLevelsSize+%3D+3%29%0A%C2%A0+++private+BendableScore+score%3B%0AThe+number+of+hard+and+soft+score+levels+need+to+be+set+at+compilation+time.+It+is+not+flexible+to%0Achange+during+solving.%0ADo+not+use+a+BendableScore+with+seven+levels+just+because+you+have+seven%0Aconstraints.+It+is+extremely+rare+to+use+a+different+score+level+for+each+constraint%2C%0Abecause+that+means+one+constraint+match+on+soft+0+outweighs+even+a+million%0A%EF%81%9A+constraint+matches+of+soft+1.%0AUsually%2C+multiple+constraints+share+the+same+level+and+are+weighted+against+each%0Aother.+Use+explaining+the+score+to+get+the+weight+of+individual+constraints+in+the%0Asame+level.%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+BendableLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+BendableBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.5.+Implementing+a+Custom+Score%0AInternally%2C+each+Score+implementation+also+has+a+ScoreDefinition+implementation.+For+example%3A%0ASimpleScore+is+defined+by+SimpleScoreDefinition.+The+ScoreDefinition+interface+defines+the+score%0Arepresentation.%0ATo+implement+a+custom+Score%2C+also+implement+such+a+custom+ScoreDefinition.+Extend%0AAbstractScoreDefinition+%28preferably+by+copy+pasting+HardSoftScoreDefinition%29+and+start+from+there.%0A133%0AThen+hook+your+custom+ScoreDefinition+in+the+domain%3A%0A%C2%A0+++%40PlanningScore%28scoreDefinitionClass+%3D+MyCustomScoreDefinition.class%29%0A%C2%A0+++private+MyCustomScore+score%3B%0ATo+have+it+integrate+seamlessly+with+JPA%2FHibernate%2C+XStream%2C+Jackson%2C+%E2%80%A6%2C+you%E2%80%99ll+need+to+write%0Acustom+glue+code+too.%0A5.3.+Calculate+the+Score%0A5.3.1.+Score+Calculation+Types%0AThere+are+several+ways+to+calculate+the+Score+of+a+Solution%3A%0A%E2%80%A2+Easy+Java+score+calculation%3A+implement+a+single+Java+method%0A%E2%80%A2+Incremental+Java+score+calculation%3A+implement+multiple+Java+methods%0A%E2%80%A2+Drools+score+calculation+%28recommended%29%3A+implement+score+rules%0AEvery+score+calculation+type+can+use+any+Score+definition.+For+example%2C+easy+Java+score+calculation%0Acan+output+a+HardSoftScore.%0AAll+score+calculation+types+are+Object+Oriented+and+can+reuse+existing+Java+code.%0AThe+score+calculation+must+be+read-only.+It+must+not+change+the+planning+entities%0Aor+the+problem+facts+in+any+way.+For+example%2C+it+must+not+call+a+setter+method+on+a%0Aplanning+entity+in+a+Drools+score+rule%E2%80%99s+RHS.+This+does+not+apply+to+logically%0Ainserted+objects%2C+which+can+be+changed+by+the+score+rules+that+logically+inserted%0Athem+in+the+first+place.%0A%EF%81%AA%0APlanner+will+not+recalculate+the+score+of+a+Solution+if+it+can+predict+it+%28unless+an%0AenvironmentMode+assertion+is+enabled%29.+For+example%2C+after+a+winning+step+is+done%2C%0Athere+is+no+need+to+calculate+the+score+because+that+move+was+done+and+undone%0Aearlier.+As+a+result%2C+there+is+no+guarantee+that+such+changes+applied+during+score%0Acalculation+are+actually+done.%0A5.3.2.+Easy+Java+Score+Calculation%0AAn+easy+way+to+implement+your+score+calculation+in+Java.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Plain+old+Java%3A+no+learning+curve%0A%E2%97%A6+Opportunity+to+delegate+score+calculation+to+an+existing+code+base+or+legacy+system%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+Slower%0A%E2%97%A6+Does+not+scale+because+there+is+no+incremental+score+calculation%0A134%0AImplement+the+one+method+of+the+interface+EasyScoreCalculator%3A%0Apublic+interface+EasyScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++Score+calculateScore%28Solution_+solution%29%3B%0A%7D%0AFor+example+in+n+queens%3A%0Apublic+class+NQueensEasyScoreCalculator+implements+EasyScoreCalculator%3CNQueens%3E+%7B%0A%C2%A0+++public+SimpleScore+calculateScore%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+nQueens.getQueenList%28%29%3B%0A%C2%A0+++++++int+score+%3D+0%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+n%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++for+%28int+j+%3D+i+%2B+1%3B+j+%3C+n%3B+j%2B%2B%29+%7B%0A%C2%A0+++++++++++++++Queen+leftQueen+%3D+queenList.get%28i%29%3B%0A%C2%A0+++++++++++++++Queen+rightQueen+%3D+queenList.get%28j%29%3B%0A%C2%A0+++++++++++++++if+%28leftQueen.getRow%28%29+%21%3D+null+%26%26+rightQueen.getRow%28%29+%21%3D+null%29+%7B%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getRowIndex%28%29+%3D%3D+rightQueen.getRowIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getAscendingDiagonalIndex%28%29+%3D%3D+rightQueen%0A.getAscendingDiagonalIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getDescendingDiagonalIndex%28%29+%3D%3D+rightQueen%0A.getDescendingDiagonalIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+SimpleScore.valueOf%28score%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+it+in+the+solver+configuration%3A%0A135%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueensEasySco%0AreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0ATo+configure+values+of+an+EasyScoreCalculator+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+easyScoreCalculatorCustomProperties+element%0Aand+use+custom+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CeasyScoreCalculatorClass%3E...MyEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3CeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%0A%C2%A0+++%3C%2FeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.3.+Incremental+Java+Score+Calculation%0AA+way+to+implement+your+score+calculation+incrementally+in+Java.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Very+fast+and+scalable%0A%E2%96%AA+Currently+the+fastest+if+implemented+correctly%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+Hard+to+write%0A%E2%96%AA+A+scalable+implementation+heavily+uses+maps%2C+indexes%2C+%E2%80%A6+%28things+the+Drools+rule+engine%0Acan+do+for+you%29%0A%E2%96%AA+You+have+to+learn%2C+design%2C+write+and+improve+all+these+performance+optimizations%0Ayourself%0A%E2%97%A6+Hard+to+read%0A%E2%96%AA+Regular+score+constraint+changes+can+lead+to+a+high+maintenance+cost%0AImplement+all+the+methods+of+the+interface+IncrementalScoreCalculator+and+extend+the+class%0AAbstractIncrementalScoreCalculator%3A%0A136%0Apublic+interface+IncrementalScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++void+resetWorkingSolution%28Solution_+workingSolution%29%3B%0A%C2%A0+++void+beforeEntityAdded%28Object+entity%29%3B%0A%C2%A0+++void+afterEntityAdded%28Object+entity%29%3B%0A%C2%A0+++void+beforeVariableChanged%28Object+entity%2C+String+variableName%29%3B%0A%C2%A0+++void+afterVariableChanged%28Object+entity%2C+String+variableName%29%3B%0A%C2%A0+++void+beforeEntityRemoved%28Object+entity%29%3B%0A%C2%A0+++void+afterEntityRemoved%28Object+entity%29%3B%0A%C2%A0+++Score+calculateScore%28%29%3B%0A%7D%0AFor+example+in+n+queens%3A%0Apublic+class+NQueensAdvancedIncrementalScoreCalculator+extends%0A137%0AAbstractIncrementalScoreCalculator%3CNQueens%3E+%7B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+rowIndexMap%3B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+ascendingDiagonalIndexMap%3B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+descendingDiagonalIndexMap%3B%0A%C2%A0+++private+int+score%3B%0A%C2%A0+++public+void+resetWorkingSolution%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++rowIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n%29%3B%0A%C2%A0+++++++ascendingDiagonalIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n+*+2%29%3B%0A%C2%A0+++++++descendingDiagonalIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n+*+2%29%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+n%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++rowIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++if+%28i+%21%3D+0%29+%7B%0A%C2%A0+++++++++++++++ascendingDiagonalIndexMap.put%28n+-+1+%2B+i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++++++descendingDiagonalIndexMap.put%28%28-i%29%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++score+%3D+0%3B%0A%C2%A0+++++++for+%28Queen+queen+%3A+nQueens.getQueenList%28%29%29+%7B%0A%C2%A0+++++++++++insert%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeEntityAdded%28Object+entity%29+%7B%0A%C2%A0+++++++%2F%2F+Do+nothing%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterEntityAdded%28Object+entity%29+%7B%0A%C2%A0+++++++insert%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeVariableChanged%28Object+entity%2C+String+variableName%29+%7B%0A%C2%A0+++++++retract%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterVariableChanged%28Object+entity%2C+String+variableName%29+%7B%0A%C2%A0+++++++insert%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeEntityRemoved%28Object+entity%29+%7B%0A%C2%A0+++++++retract%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterEntityRemoved%28Object+entity%29+%7B%0A%C2%A0+++++++%2F%2F+Do+nothing%0A%C2%A0+++%7D%0A138%0A%C2%A0+++private+void+insert%28Queen+queen%29+%7B%0A%C2%A0+++++++Row+row+%3D+queen.getRow%28%29%3B%0A%C2%A0+++++++if+%28row+%21%3D+null%29+%7B%0A%C2%A0+++++++++++int+rowIndex+%3D+queen.getRowIndex%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+rowIndexList+%3D+rowIndexMap.get%28rowIndex%29%3B%0A%C2%A0+++++++++++score+-%3D+rowIndexList.size%28%29%3B%0A%C2%A0+++++++++++rowIndexList.add%28queen%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+ascendingDiagonalIndexList+%3D+ascendingDiagonalIndexMap.get%0A%28queen.getAscendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++score+-%3D+ascendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexList.add%28queen%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+descendingDiagonalIndexList+%3D+descendingDiagonalIndexMap.get%0A%28queen.getDescendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++score+-%3D+descendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexList.add%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++private+void+retract%28Queen+queen%29+%7B%0A%C2%A0+++++++Row+row+%3D+queen.getRow%28%29%3B%0A%C2%A0+++++++if+%28row+%21%3D+null%29+%7B%0A%C2%A0+++++++++++List%3CQueen%3E+rowIndexList+%3D+rowIndexMap.get%28queen.getRowIndex%28%29%29%3B%0A%C2%A0+++++++++++rowIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+rowIndexList.size%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+ascendingDiagonalIndexList+%3D+ascendingDiagonalIndexMap.get%0A%28queen.getAscendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+ascendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+descendingDiagonalIndexList+%3D+descendingDiagonalIndexMap.get%0A%28queen.getDescendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+descendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++public+SimpleScore+calculateScore%28%29+%7B%0A%C2%A0+++++++return+SimpleScore.valueOf%28score%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+it+in+the+solver+configuration%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CincrementalScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueens%0AAdvancedIncrementalScoreCalculator%3C%2FincrementalScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A139%0AA+piece+of+incremental+score+calculator+code+can+be+difficult+to+write+and+to+review.%0A%EF%81%AA+Assert+its+correctness+by+using+an+EasyScoreCalculator+to+fulfill+the+assertions%0Atriggered+by+the+environmentMode.%0ATo+configure+values+of+an+IncrementalScoreCalculator+dynamically+in+the+solver+configuration+%28so%0Athe+Benchmarker+can+tweak+those+parameters%29%2C+add+the%0AincrementalScoreCalculatorCustomProperties+element+and+use+custom+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CincrementalScoreCalculatorClass%3E%0A...MyIncrementalScoreCalculator%3C%2FincrementalScoreCalculatorClass%3E%0A%C2%A0+++%3CincrementalScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%0A%C2%A0+++%3C%2FincrementalScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.3.1.+ConstraintMatchAwareIncrementalScoreCalculator%0AOptionally%2C+also+implement+the+ConstraintMatchAwareIncrementalScoreCalculator+interface+to%3A%0A%E2%80%A2+Explain+a+score+by+splitting+it+up+per+score+constraint+with%0AScoreDirector.getConstraintMatchTotals%28%29.%0A%E2%80%A2+Visualize+or+sort+planning+entities+by+how+many+constraints+each+one+breaks+with%0AScoreDirector.getIndictmentMap%28%29.%0A%E2%80%A2+Receive+a+detailed+analysis+if+the+IncrementalScoreCalculator+is+corrupted+in+FAST_ASSERT+or%0AFULL_ASSERT+environmentMode%2C%0Apublic+interface+ConstraintMatchAwareIncrementalScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++void+resetWorkingSolution%28Solution_+workingSolution%2C+boolean%0AconstraintMatchEnabled%29%3B%0A%C2%A0+++Collection%3CConstraintMatchTotal%3E+getConstraintMatchTotals%28%29%3B%0A%C2%A0+++Map%3CObject%2C+Indictment%3E+getIndictmentMap%28%29%3B%0A%7D%0AFor+example+in+machine+reassignment%2C+create+one+ConstraintMatchTotal+per+constraint+type+and%0Acall+addConstraintMatch%28%29+for+each+constraint+match%3A%0A140%0Apublic+class+MachineReassignmentIncrementalScoreCalculator%0A%C2%A0+++++++implements+ConstraintMatchAwareIncrementalScoreCalculator%3CMachineReassignment%3E%0A%7B%0A%C2%A0+++...%0A%C2%A0+++%40Override%0A%C2%A0+++public+void+resetWorkingSolution%28MachineReassignment+workingSolution%2C+boolean%0AconstraintMatchEnabled%29+%7B%0A%C2%A0+++++++resetWorkingSolution%28workingSolution%29%3B%0A%C2%A0+++++++%2F%2F+ignore+constraintMatchEnabled%2C+it+is+always+presumed+enabled%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3CConstraintMatchTotal%3E+getConstraintMatchTotals%28%29+%7B%0A%C2%A0+++++++ConstraintMatchTotal+maximumCapacityMatchTotal+%3D+new+ConstraintMatchTotal%28%0A%C2%A0+++++++++++++++CONSTRAINT_PACKAGE%2C+%22maximumCapacity%22%2C+HardSoftLongScore.ZERO%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++++++for+%28MrMachineScorePart+machineScorePart+%3A+machineScorePartMap.values%28%29%29+%7B%0A%C2%A0+++++++++++for+%28MrMachineCapacityScorePart+machineCapacityScorePart+%3A%0AmachineScorePart.machineCapacityScorePartList%29+%7B%0A%C2%A0+++++++++++++++if+%28machineCapacityScorePart.maximumAvailable+%3C+0L%29+%7B%0A%C2%A0+++++++++++++++++++maximumCapacityMatchTotal.addConstraintMatch%28%0A%C2%A0+++++++++++++++++++++++++++Arrays.asList%28machineCapacityScorePart.machineCapacity%29%2C%0A%C2%A0+++++++++++++++++++++++++++HardSoftLongScore.valueOf%28machineCapacityScorePart%0A.maximumAvailable%2C+0%29%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++...%0A%C2%A0+++++++List%3CConstraintMatchTotal%3E+constraintMatchTotalList+%3D+new+ArrayList%3C%3E%284%29%3B%0A%C2%A0+++++++constraintMatchTotalList.add%28maximumCapacityMatchTotal%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++++++return+constraintMatchTotalList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Map%3CObject%2C+Indictment%3E+getIndictmentMap%28%29+%7B%0A%C2%A0+++++++return+null%3B+%2F%2F+Calculate+it+non-incrementally+from+getConstraintMatchTotals%28%29%0A%C2%A0+++%7D%0A%7D%0AThat+getConstraintMatchTotals%28%29+code+often+duplicates+some+of+the+logic+of+the+normal%0AIncrementalScoreCalculator+methods.+Drools+Score+Calculation+doesn%E2%80%99t+have+this+disadvantage%2C%0Abecause+it+is+constraint+match+aware+automatically+when+needed%2C+without+any+extra+domain-%0Aspecific+code.%0A5.3.4.+Drools+Score+Calculation%0A141%0A5.3.4.1.+Overview%0AImplement+your+score+calculation+using+the+Drools+rule+engine.+Every+score+constraint+is+written+as%0Aone+or+more+score+rules.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Incremental+score+calculation+for+free%0A%E2%96%AA+Because+most+DRL+syntax+uses+forward+chaining%2C+it+does+incremental+calculation+without%0Aany+extra+code%0A%E2%97%A6+Score+constraints+are+isolated+as+separate+rules%0A%E2%96%AA+Easy+to+add+or+edit+existing+score+rules%0A%E2%97%A6+Flexibility+to+augment+your+score+constraints+by%0A%E2%96%AA+Defining+them+in+decision+tables%0A%E2%96%AA+Excel+%28XLS%29+spreadsheet%0A%E2%96%AA+KIE+Workbench+WebUI%0A%E2%96%AA+Translate+them+into+natural+language+with+DSL%0A%E2%96%AA+Store+and+release+in+the+KIE+Workbench+repository%0A%E2%97%A6+Performance+optimizations+in+future+versions+for+free%0A%E2%96%AA+In+every+release%2C+the+Drools+rule+engine+tends+to+become+faster%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+DRL+learning+curve%0A%E2%97%A6+Usage+of+DRL%0A%E2%96%AA+Polyglot+fear+can+prohibit+the+use+of+a+new+language+such+as+DRL+in+some+organizations%0A5.3.4.2.+Drools+Score+Rules+Configuration%0AThere+are+several+ways+to+define+where+your+score+rules+live.%0A5.3.4.2.1.+A+scoreDrl+Resource+on+the+Classpath%0AThis+is+the+easy+way.+The+score+rules+live+in+a+DRL+file+which+is+provided+as+a+classpath+resource.+Just%0Aadd+the+score+rules+DRL+file+in+the+solver+configuration+as+a+%3CscoreDrl%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AIn+a+typical+project+%28following+the+Maven+directory+structure%29%2C+that+DRL+file+would+be+located+at%0A%24PROJECT_DIR%2Fsrc%2Fmain%2Fresources%2Forg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%0A%28even+for+a+war+project%29.%0A142%0AThe+%3CscoreDrl%3E+element+expects+a+classpath+resource%2C+as+defined+by%0A%EF%81%9A+ClassLoader.getResource%28String%29%2C+it+does+not+accept+a+File%2C+nor+an+URL%2C+nor+a%0Awebapp+resource.+See+below+to+use+a+File+instead.%0AAdd+multiple+%3CscoreDrl%3E+elements+if+the+score+rules+are+split+across+multiple+DRL+files.%0AOptionally%2C+you+can+also+set+drools+configuration+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CkieBaseConfigurationProperties%3E%0A%C2%A0+++++%3Cdrools.equalityBehavior%3E...%3C%2Fdrools.equalityBehavior%3E%0A%C2%A0+++%3C%2FkieBaseConfigurationProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0ATo+enable+property+reactive+by+default%2C+without+a+%40propertyReactive+on+the+domain+classes%2C+add%0A%3Cdrools.propertySpecific%3EALWAYS%3C%2Fdrools.propertySpecific%3E+in+there.+Otherwise+Planner%0Aautomatically+changes+the+Drools+default+to+ALLOWED+so+property+reactive+is+not+active+by+default.%0A5.3.4.2.2.+A+scoreDrlFile%0ATo+use+File+on+the+local+file+system%2C+instead+of+a+classpath+resource%2C+add+the+score+rules+DRL+file+in%0Athe+solver+configuration+as+a+%3CscoreDrlFile%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrlFile%3E%2Fhome%2Fge0ffrey%2Ftmp%2FnQueensScoreRules.drl%3C%2FscoreDrlFile%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AFor+portability+reasons%2C+a+classpath+resource+is+recommended+over+a+File.+An%0Aapplication+build+on+one+computer%2C+but+used+on+another+computer%2C+might+not+find%0A%EF%81%B1+the+file+on+the+same+location.+Worse%2C+if+they+use+a+different+Operating+System%2C+it+is%0Ahard+to+choose+a+portable+file+path.%0AAdd+multiple+%3CscoreDrlFile%3E+elements+if+the+score+rules+are+split+across+multiple+DRL+files.%0A5.3.4.2.3.+A+ksessionName+in+a+Kjar+from+a+Maven+repository%0AThis+way+allows+you+to+use+score+rules+defined+by+the+Workbench+or+build+a+kjar+and+deploy+it+to+the%0AExecution+Server.+Both+the+score+rules+and+the+solver+configuration+are+resources+in+a+kjar.+Clients%0Acan+obtain+that+kjar+either+from+the+local+classpath%2C+from+a+local+Maven+repository+or+even+from+a%0Aremote+Maven+repository.%0AThe+score+rules+still+live+in+a+DRL+file%2C+but+the+KieContainer+finds+that+DRL+file+through+the+META-%0AINF%2Fkmodule.xml+file%3A%0A143%0A%3Ckmodule+xmlns%3D%22http%3A%2F%2Fwww.drools.org%2Fxsd%2Fkmodule%22%3E%0A%C2%A0+%3Cconfiguration%3E%0A%C2%A0+++%3C%21--+Don%27t+enable+propertyReactive+unless+there+is+a+%40PropertyReactive+annotation%0Aon+the+domain+classes+--%3E%0A%C2%A0+++%3Cproperty+key%3D%22drools.propertySpecific%22+value%3D%22ALLOWED%22%2F%3E%0A%C2%A0+%3C%2Fconfiguration%3E%0A%C2%A0+%3Ckbase+name%3D%22nQueensKbase%22+packages%3D%22org.optaplanner.examples.nqueens.solver%22%3E%0A%C2%A0+++%3Cksession+name%3D%22nQueensKsession%22%2F%3E%0A%C2%A0+%3C%2Fkbase%3E%0A%3C%2Fkmodule%3E%0AThe+kmodule+above+will+pick+up+all+the+DRL+files+in+the+package%0Aorg.optaplanner.examples.nqueens.solver.+A+kbase+can+even+extend+another+kbase.%0AStarting+from+version+7.0%2C+Drools+enables+property+reactive+by+default+for+all%0Aclasses.+This+means+if+you+have+a+non-simple+getter+and+forget+to+apply+%40Modifies%0A%EF%81%9A+correctly%2C+corruption+occurs.+To+avoid+this%2C+simply+set+drools.propertySpecific+to%0AALLOWED+as+shown+above.%0AAdd+the+ksession+name+in+the+solver+configuration+as+a+%3CksessionName%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CksessionName%3EnQueensKsession%3C%2FksessionName%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AIn+this+approach%2C+it%E2%80%99s+required+to+use+a+SolverFactory.createFromKieContainerXmlResource%28%E2%80%A6%29%0Amethod+to+build+the+SolverFactory.+If+no+%3CksessionName%3E+element+is+specified%2C+the+default+ksession+of%0Athe+kmodule.xml+is+used.%0A5.3.4.3.+Implementing+a+Score+Rule%0AHere+is+an+example+of+a+score+constraint+implemented+as+a+score+rule+in+a+DRL+file%3A%0Arule+%22multipleQueensHorizontal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+rowIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+rowIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0AThis+score+rule+will+fire+once+for+every+two+queens+with+the+same+rowIndex.+The+%28id+%3E+%24id%29+condition%0Ais+needed+to+assure+that+for+two+queens+A+and+B%2C+it+can+only+fire+for+%28A%2C+B%29+and+not+for+%28B%2C+A%29%2C+%28A%2C+A%29+or%0A%28B%2C+B%29.+Let+us+take+a+closer+look+at+this+score+rule+on+this+solution+of+four+queens%3A%0A144%0AIn+this+solution+the+multipleQueensHorizontal+score+rule+will+fire+for+six+queen+couples%3A+%28A%2C+B%29%2C+%28A%2C%0AC%29%2C+%28A%2C+D%29%2C+%28B%2C+C%29%2C+%28B%2C+D%29+and+%28C%2C+D%29.+Because+none+of+the+queens+are+on+the+same+vertical+or+diagonal%0Aline%2C+this+solution+will+have+a+score+of+-6.+An+optimal+solution+of+four+queens+has+a+score+of+0.%0ANotice+that+every+score+rule+will+relate+to+at+least+one+planning+entity+class+%28directly%0Aor+indirectly+through+a+logically+inserted+fact%29.%0A%EF%81%9A+This+is+a+normal+case.+It+would+be+a+waste+of+time+to+write+a+score+rule+that+only%0Arelates+to+problem+facts%2C+as+the+consequence+will+never+change+during+planning%2C+no%0Amatter+what+the+possible+solution.%0AThe+kcontext+variable+is+a+magic+variable+in+Drools+Expert.+The+scoreHolder%27s%0A%EF%81%9A+method+uses+it+to+do+incremental+score+calculation+correctly+and+to+create+a%0AConstraintMatch+instance.%0A5.3.4.4.+Weighing+Score+Rules%0AA+ScoreHolder+instance+is+asserted+into+the+KieSession+as+a+global+called+scoreHolder.+The+score+rules%0Aneed+to+%28directly+or+indirectly%29+update+that+instance.%0A145%0Aglobal+SimpleScoreHolder+scoreHolder%3B%0Arule+%22multipleQueensHorizontal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+rowIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+rowIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0A%2F%2F+multipleQueensVertical+is+obsolete+because+it+is+always+0%0Arule+%22multipleQueensAscendingDiagonal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+ascendingDiagonalIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+ascendingDiagonalIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0Arule+%22multipleQueensDescendingDiagonal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+descendingDiagonalIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+descendingDiagonalIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0ATo+learn+more+about+the+Drools+rule+language+%28DRL%29%2C+consult+the+Drools%0A%EF%81%9A+documentation.%0AMost+use+cases+also+weigh+their+constraint+types+or+even+their+matches+differently%2C+by+using+a%0Aspecific+weight+for+each+constraint+match.+For+example+in+course+scheduling%2C+assigning+a+Lecture+to%0Aa+Room+that+is+lacking+two+seats+is+weighted+equally+bad+as+having+one+isolated+Lecture+in+a%0ACurriculum%3A%0A146%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0A%2F%2F+RoomCapacity%3A+For+each+lecture%2C+the+number+of+students+that+attend+the+course+must%0Abe+less+or+equal%0A%2F%2F+than+the+number+of+seats+of+all+the+rooms+that+host+its+lectures.%0Arule+%22roomCapacity%22%0A%C2%A0+++when%0A%C2%A0+++++++%24room+%3A+Room%28%24capacity+%3A+capacity%29%0A%C2%A0+++++++%24lecture+%3A+Lecture%28room+%3D%3D+%24room%2C+studentSize+%3E+%24capacity%2C+%24studentSize+%3A%0AstudentSize%29%0A%C2%A0+++then%0A%C2%A0+++++++%2F%2F+Each+student+above+the+capacity+counts+as+one+point+of+penalty.%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+%28%24capacity+-+%24studentSize%29%29%3B%0Aend%0A%2F%2F+CurriculumCompactness%3A+Lectures+belonging+to+a+curriculum+should+be+adjacent%0A%2F%2F+to+each+other+%28i.e.%2C+in+consecutive+periods%29.%0A%2F%2F+For+a+given+curriculum+we+account+for+a+violation+every+time+there+is+one+lecture%0Anot+adjacent%0A%2F%2F+to+any+other+lecture+within+the+same+day.%0Arule+%22curriculumCompactness%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++%2F%2F+Each+isolated+lecture+in+a+curriculum+counts+as+two+points+of+penalty.%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-2%29%3B%0Aend%0A5.3.5.+InitializingScoreTrend%0AThe+InitializingScoreTrend+specifies+how+the+Score+will+change+as+more+and+more+variables+are%0Ainitialized+%28while+the+already+initialized+variables+do+not+change%29.+Some+optimization+algorithms%0A%28such+Construction+Heuristics+and+Exhaustive+Search%29+run+faster+if+they+have+such+information.%0AFor+the+Score+%28or+each+score+level+separately%29%2C+specify+a+trend%3A%0A%E2%80%A2+ANY+%28default%29%3A+Initializing+an+extra+variable+can+change+the+score+positively+or+negatively.+Gives%0Ano+performance+gain.%0A%E2%80%A2+ONLY_UP+%28rare%29%3A+Initializing+an+extra+variable+can+only+change+the+score+positively.+Implies+that%3A%0A%E2%97%A6+There+are+only+positive+constraints%0A%E2%97%A6+And+initializing+the+next+variable+can+not+unmatch+a+positive+constraint+that+was+matched%0Aby+a+previous+initialized+variable.%0A%E2%80%A2+ONLY_DOWN%3A+Initializing+an+extra+variable+can+only+change+the+score+negatively.+Implies+that%3A%0A%E2%97%A6+There+are+only+negative+constraints%0A%E2%97%A6+And+initializing+the+next+variable+can+not+unmatch+a+negative+constraint+that+was+matched%0Aby+a+previous+initialized+variable.%0A147%0AMost+use+cases+only+have+negative+constraints.+Many+of+those+have+an+InitializingScoreTrend+that%0Aonly+goes+down%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3E...%2FcloudBalancingScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CinitializingScoreTrend%3EONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AAlternatively%2C+you+can+also+specify+the+trend+for+each+score+level+separately%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3E...%2FcloudBalancingScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CinitializingScoreTrend%3EONLY_DOWN%2FONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.6.+Invalid+Score+Detection%0AWhen+you+put+the+environmentModein+FULL_ASSERT+%28or+FAST_ASSERT%29%2C+it+will+detect+score+corruption+in%0Athe+incremental+score+calculation.+However%2C+that+will+not+verify+that+your+score+calculator+actually%0Aimplements+your+score+constraints+as+your+business+desires.+For+example%2C+one+score+rule+might%0Aconsistently+match+the+wrong+pattern.+To+verify+the+score+rules+against+an+independent%0Aimplementation%2C+configure+a+assertionScoreDirectorFactory%3A%0A%C2%A0+%3CenvironmentMode%3EFAST_ASSERT%3C%2FenvironmentMode%3E%0A%C2%A0+...%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CassertionScoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueensEasySco%0AreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%2FassertionScoreDirectorFactory%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AThis+way%2C+the+scoreDrl+will+be+validated+by+the+EasyScoreCalculator.%0AThis+works+well+to+isolate+score+corruption%2C+but+to+verify+that+the+score+rules%0A%EF%81%9A+implement+the+real+business+needs%2C+a+unit+test+with+a+ScoreVerifier+is+usually%0Abetter.%0A5.4.+Score+Calculation+Performance+Tricks%0A5.4.1.+Overview%0AThe+Solver+will+normally+spend+most+of+its+execution+time+running+the+score+calculation+%28which+is%0A148%0Acalled+in+its+deepest+loops%29.+Faster+score+calculation+will+return+the+same+solution+in+less+time+with%0Athe+same+algorithm%2C+which+normally+means+a+better+solution+in+equal+time.%0A5.4.2.+Score+Calculation+Speed%0AAfter+solving+a+problem%2C+the+Solver+will+log+the+score+calculation+speed+per+second.+This+is+a+good%0Ameasurement+of+Score+calculation+performance%2C+despite+that+it+is+affected+by+non+score+calculation%0Aexecution+time.+It+depends+on+the+problem+scale+of+the+problem+dataset.+Normally%2C+even+for+high%0Ascale+problems%2C+it+is+higher+than+1000%2C+except+when+you+are+using+an+EasyScoreCalculator.%0AWhen+improving+your+score+calculation%2C+focus+on+maximizing+the+score+calculation%0Aspeed%2C+instead+of+maximizing+the+best+score.+A+big+improvement+in+score%0Acalculation+can+sometimes+yield+little+or+no+best+score+improvement%2C+for+example%0Awhen+the+algorithm+is+stuck+in+a+local+or+global+optima.+If+you+are+watching+the%0A%EF%81%AA+calculation+speed+instead%2C+score+calculation+improvements+are+far+more+visible.%0AFurthermore%2C+watching+the+calculation+speed%2C+allows+you+to+remove+or+add+score%0Aconstraints%2C+and+still+compare+it+with+the+original+calculation+speed.+Comparing+the%0Abest+score+with+the+original+would+be+wrong%2C+because+it+is+comparing+apples+and%0Aoranges.%0A5.4.3.+Incremental+Score+Calculation+%28with+Deltas%29%0AWhen+a+Solution+changes%2C+incremental+score+calculation+%28AKA+delta+based+score+calculation%29%2C%0Acalculates+the+delta+with+the+previous+state+to+find+the+new+Score%2C+instead+of+recalculating+the+entire%0Ascore+on+every+solution+evaluation.%0AFor+example%2C+when+a+single+queen+A+moves+from+row+1+to+2%2C+it+will+not+bother+to+check+if+queen+B%0Aand+C+can+attack+each+other%2C+since+neither+of+them+changed%3A%0A149%0ASimilarly+in+employee+rostering%3A%0A150%0AThis+is+a+huge+performance+and+scalability+gain.+Drools+score+calculation+gives+you+this+huge%0Ascalability+gain+without+forcing+you+to+write+a+complicated+incremental+score+calculation%0Aalgorithm.+Just+let+the+Drools+rule+engine+do+the+hard+work.%0ANotice+that+the+speedup+is+relative+to+the+size+of+your+planning+problem+%28your+n%29%2C+making%0Aincremental+score+calculation+far+more+scalable.%0A5.4.4.+Avoid+Calling+Remote+Services+During+Score+Calculation%0ADo+not+call+remote+services+in+your+score+calculation+%28except+if+you+are+bridging+EasyScoreCalculator%0Ato+a+legacy+system%29.+The+network+latency+will+kill+your+score+calculation+performance.+Cache+the%0Aresults+of+those+remote+services+if+possible.%0AIf+some+parts+of+a+constraint+can+be+calculated+once%2C+when+the+Solver+starts%2C+and+never+change%0Aduring+solving%2C+then+turn+them+into+cached+problem+facts.%0A5.4.5.+Pointless+Constraints%0AIf+you+know+a+certain+constraint+can+never+be+broken+%28or+it+is+always+broken%29%2C+you+need+not+write+a%0Ascore+constraint+for+it.+For+example+in+n+queens%2C+the+score+calculation+does+not+check+if+multiple%0Aqueens+occupy+the+same+column%2C+because+a+Queen%27s+column+never+changes+and+every+Solution+starts%0Awith+each+Queen+on+a+different+column.%0A151%0ADo+not+go+overboard+with+this.+If+some+datasets+do+not+use+a+specific+constraint+but%0A%EF%81%9A+others+do%2C+just+return+out+of+the+constraint+as+soon+as+you+can.+There+is+no+need+to%0Adynamically+change+your+score+calculation+based+on+the+dataset.%0A5.4.6.+Built-in+Hard+Constraint%0AInstead+of+implementing+a+hard+constraint%2C+it+can+sometimes+be+built+in.+For+example%2C+if+Lecture+A%0Ashould+never+be+assigned+to+Room+X%2C+but+it+uses+ValueRangeProvider+on+Solution%2C+so+the+Solver+will%0Aoften+try+to+assign+it+to+Room+X+too+%28only+to+find+out+that+it+breaks+a+hard+constraint%29.+Use+a%0AValueRangeProvider+on+the+planning+entity+or+filtered+selection+to+define+that+Course+A+should+only%0Abe+assigned+a+Room+different+than+X.%0AThis+can+give+a+good+performance+gain+in+some+use+cases%2C+not+just+because+the+score+calculation+is%0Afaster%2C+but+mainly+because+most+optimization+algorithms+will+spend+less+time+evaluating+infeasible%0Asolutions.+However%2C+usually+this+not+a+good+idea+because+there+is+a+real+risk+of+trading+short+term%0Abenefits+for+long+term+harm%3A%0A%E2%80%A2+Many+optimization+algorithms+rely+on+the+freedom+to+break+hard+constraints+when+changing%0Aplanning+entities%2C+to+get+out+of+local+optima.%0A%E2%80%A2+Both+implementation+approaches+have+limitations+%28feature+compatibility%2C+disabling+automatic%0Aperformance+optimizations%29%2C+as+explained+in+their+documentation.%0A5.4.7.+Other+Score+Calculation+Performance+Tricks%0A%E2%80%A2+Verify+that+your+score+calculation+happens+in+the+correct+Number+type.+If+you+are+making+the+sum%0Aof+int+values%2C+do+not+let+Drools+sum+it+in+a+double+which+takes+longer.%0A%E2%80%A2+For+optimal+performance%2C+always+use+server+mode+%28java+-server%29.+We+have+seen+performance%0Aincreases+of+50%25+by+turning+on+server+mode.%0A%E2%80%A2+For+optimal+performance%2C+use+the+latest+Java+version.+For+example%2C+in+the+past+we+have+seen%0Aperformance+increases+of+30%25+by+switching+from+java+1.5+to+1.6.%0A%E2%80%A2+Always+remember+that+premature+optimization+is+the+root+of+all+evil.+Make+sure+your+design+is%0Aflexible+enough+to+allow+configuration+based+tweaking.%0A5.4.8.+Score+Trap%0AMake+sure+that+none+of+your+score+constraints+cause+a+score+trap.+A+trapped+score+constraint+uses%0Athe+same+weight+for+different+constraint+matches%2C+when+it+could+just+as+easily+use+a+different+weight.%0AIt+effectively+lumps+its+constraint+matches+together%2C+which+creates+a+flatlined+score+function+for+that%0Aconstraint.+This+can+cause+a+solution+state+in+which+several+moves+need+to+be+done+to+resolve+or%0Alower+the+weight+of+that+single+constraint.+Some+examples+of+score+traps%3A%0A%E2%80%A2+You+need+two+doctors+at+each+table%2C+but+you+are+only+moving+one+doctor+at+a+time.+So+the+solver%0Ahas+no+incentive+to+move+a+doctor+to+a+table+with+no+doctors.+Punish+a+table+with+no+doctors%0Amore+than+a+table+with+only+one+doctor+in+that+score+constraint+in+the+score+function.%0A%E2%80%A2+Two+exams+need+to+be+conducted+at+the+same+time%2C+but+you+are+only+moving+one+exam+at+a+time.%0ASo+the+solver+has+to+move+one+of+those+exams+to+another+timeslot+without+moving+the+other+in%0A152%0Athe+same+move.+Add+a+coarse-grained+move+that+moves+both+exams+at+the+same+time.%0AFor+example%2C+consider+this+score+trap.+If+the+blue+item+moves+from+an+overloaded+computer+to+an%0Aempty+computer%2C+the+hard+score+should+improve.+The+trapped+score+implementation+fails+to+do+that%3A%0AThe+Solver+should+eventually+get+out+of+this+trap%2C+but+it+will+take+a+lot+of+effort+%28especially+if+there+are%0Aeven+more+processes+on+the+overloaded+computer%29.+Before+they+do+that%2C+they+might+actually+start%0Amoving+more+processes+into+that+overloaded+computer%2C+as+there+is+no+penalty+for+doing+so.%0AAvoiding+score+traps+does+not+mean+that+your+score+function+should+be+smart%0Aenough+to+avoid+local+optima.+Leave+it+to+the+optimization+algorithms+to+deal+with%0A%EF%81%9A+the+local+optima.%0AAvoiding+score+traps+means+to+avoid%2C+for+each+score+constraint+individually%2C+a%0Aflatlined+score+function.%0AAlways+specify+the+degree+of+infeasibility.+The+business+will+often+say+%22if+the%0Asolution+is+infeasible%2C+it+does+not+matter+how+infeasible+it+is.%22+While+that+is+true+for%0A%EF%81%AA+the+business%2C+it+is+not+true+for+score+calculation+as+it+benefits+from+knowing+how%0Ainfeasible+it+is.+In+practice%2C+soft+constraints+usually+do+this+naturally+and+it+is+just+a%0Amatter+of+doing+it+for+the+hard+constraints+too.%0AThere+are+several+ways+to+deal+with+a+score+trap%3A%0A153%0A%E2%80%A2+Improve+the+score+constraint+to+make+a+distinction+in+the+score+weight.+For+example%2C+penalize%0A-1hard+for+every+missing+CPU%2C+instead+of+just+-1hard+if+any+CPU+is+missing.%0A%E2%80%A2+If+changing+the+score+constraint+is+not+allowed+from+the+business+perspective%2C+add+a+lower+score%0Alevel+with+a+score+constraint+that+makes+such+a+distinction.+For+example%2C+penalize+-1subsoft+for%0Aevery+missing+CPU%2C+on+top+of+-1hard+if+any+CPU+is+missing.+The+business+ignores+the+subsoft+score%0Alevel.%0A%E2%80%A2+Add+coarse-grained+moves+and+union+select+them+with+the+existing+fine-grained+moves.+A%0Acoarse-grained+move+effectively+does+multiple+moves+to+directly+get+out+of+a+score+trap+with+a%0Asingle+move.+For+example%2C+move+multiple+items+from+the+same+container+to+another+container.%0A5.4.9.+stepLimit+Benchmark%0ANot+all+score+constraints+have+the+same+performance+cost.+Sometimes+one+score+constraint+can+kill%0Athe+score+calculation+performance+outright.+Use+the+Benchmarker+to+do+a+one+minute+run+and+check%0Awhat+happens+to+the+score+calculation+speed+if+you+comment+out+all+but+one+of+the+score+constraints.%0A5.4.10.+Fairness+Score+Constraints%0ASome+use+cases+have+a+business+requirement+to+provide+a+fair+schedule+%28usually+as+a+soft+score%0Aconstraint%29%2C+for+example%3A%0A%E2%80%A2+Fairly+distribute+the+workload+amongst+the+employees%2C+to+avoid+envy.%0A%E2%80%A2+Evenly+distribute+the+workload+amongst+assets%2C+to+improve+reliability.%0AImplementing+such+a+constraint+can+seem+difficult+%28especially+because+there+are+different+ways+to%0Aformalize+fairness%29%2C+but+usually+the+squared+workload+implementation+behaves+most+desirable.+For%0Aeach+employee%2Fasset%2C+count+the+workload+w+and+subtract+w%C2%B2+from+the+score.%0A154%0AAs+shown+above%2C+the+squared+workload+implementation+guarantees+that+if+you+select+two+employees%0Afrom+a+given+solution+and+make+their+distribution+between+those+two+employees+fairer%2C+then+the%0Aresulting+new+solution+will+have+a+better+overall+score.+Do+not+just+use+the+difference+from+the%0Aaverage+workload%2C+as+that+can+lead+to+unfairness%2C+as+demonstrated+below.%0A155%0AInstead+of+the+squared+workload%2C+it+is+also+possible+to+use+the+variance+%28squared%0Adifference+to+the+average%29+or+the+standard+deviation+%28square+root+of+the+variance%29.%0A%EF%81%9A+This+has+no+effect+on+the+score+comparison%2C+because+the+average+will+not+change%0Aduring+planning.+It+is+just+more+work+to+implement+%28because+the+average+needs+to%0Abe+known%29+and+trivially+slower+%28because+the+calculation+is+a+bit+longer%29.%0AWhen+the+workload+is+perfectly+balanced%2C+the+user+often+likes+to+see+a+0+score%2C+instead+of+the%0Adistracting+-34soft+in+the+image+above+%28for+the+last+solution+which+is+almost+perfectly+balanced%29.+To%0Anullify+this%2C+either+add+the+average+multiplied+by+the+number+of+entities+to+the+score+or+instead+show%0Athe+variance+or+standard+deviation+in+the+UI.%0A5.5.+Explaining+the+Score%3A+Which+Constraints+Are%0ABroken%3F%0AThe+easiest+way+to+explain+the+score+during+development+is+to+print+the+return+value+of%0AexplainBestScore%28%29%2C+but+only+use+this+method+for+diagnostic+purposes%3A%0ASystem.out.println%28solver.explainBestScore%28%29%29%3B%0AFor+example+in+conference+scheduling%2C+this+prints+that+talk+S51+is+responsible+for+breaking+the+hard%0Aconstraint+Speaker+required+room+tag%3A%0A156%0AExplanation+of+score+%28-1hard%2F-806soft%29%3A%0A%C2%A0+++Constraint+match+totals%3A%0A%C2%A0+++++++-1hard%3A+constraint+%28Speaker+required+room+tag%29+has+1+matches%3A%0A%C2%A0+++++++++++-1hard%3A+justifications+%28%5BS51%5D%29%0A%C2%A0+++++++-340soft%3A+constraint+%28Theme+track+conflict%29+has+32+matches%3A%0A%C2%A0+++++++++++-20soft%3A+justifications+%28%5BS68%2C+S66%2C+ConferenceParametrization-0%5D%29%0A%C2%A0+++++++++++-20soft%3A+justifications+%28%5BS61%2C+S44%2C+ConferenceParametrization-0%5D%29%0A%C2%A0+++++++++++...%0A%C2%A0+++++++...%0A%C2%A0+++Indictments+%28top+5+of+72%29%3A%0A%C2%A0+++++++-1hard%2F-22soft%3A+justification+%28S51%29+has+12+matches%3A%0A%C2%A0+++++++++++-1hard%3A+constraint+%28Speaker+required+room+tag%29%0A%C2%A0+++++++++++-10soft%3A+constraint+%28Theme+track+conflict%29%0A%C2%A0+++++++++++...%0A%C2%A0+++++++...%0ADo+not+attempt+to+parse+this+string+or+use+it+in+your+UI+or+exposed+services.+Instead%0A%EF%81%AA+use+the+ConstraintMatch+API+below+and+do+it+properly.%0A5.5.1.+Using+Score+Calculation+Outside+the+Solver%0AIf+other+parts+of+your+application%2C+for+example+your+webUI%2C+need+to+calculate+the+score+of+a+solution%2C%0Areuse+the+ScoreDirectorFactory+of+the+Solver+to+build+a+separate+ScoreDirector+for+that+webUI%3A%0AScoreDirectorFactory%3CCloudBalance%3E+scoreDirectorFactory+%3D+solver%0A.getScoreDirectorFactory%28%29%3B%0Atry+%28ScoreDirector%3CCloudBalance%3E+guiScoreDirector+%3D+scoreDirectorFactory%0A.buildScoreDirector%28%29%29+%7B%0A%C2%A0+++...%0A%7D%0AThe+try+ARM+will+call+ScoreDirector.close%28%29+when+the+ScoreDirector+becomes%0A%EF%81%9A+useless%2C+to+avoid+a+memory+leak%2C+especially+with+Drools+score+calculation.%0AThen+use+it+when+you+need+to+calculate+the+Score+of+a+Solution%3A%0AguiScoreDirector.setWorkingSolution%28cloudBalance%29%3B%0AScore+score+%3D+guiScoreDirector.calculateScore%28%29%3B%0AFurthermore%2C+the+ScoreDirector+can+explain+the+score+through+constraint+match+totals+and%2For%0Aindictments%3A%0A157%0A5.5.2.+Constraint+Match+Total%3A+Break+down+the+Score+by+Constraint%0ATo+break+down+the+score+per+constraint+%28so+per+score+rule+with+Drools+score+calculation%29%2C+get+the%0AConstraintMatchTotals+from+the+ScoreDirector%3A%0Afor+%28ConstraintMatchTotal+constraintMatchTotal+%3A+guiScoreDirector%0A.getConstraintMatchTotals%28%29%29+%7B%0A%C2%A0+++String+constraintName+%3D+constraintMatchTotal.getConstraintName%28%29%3B%0A%C2%A0+++%2F%2F+The+score+impact+of+that+constraint%0A%C2%A0+++Score+scoreTotal+%3D+constraintMatchTotal.getScoreTotal%28%29%3B%0A%C2%A0+++for+%28ConstraintMatch+constraintMatch+%3A+constraintMatchTotal.getConstraintMatchSet%0A%28%29%29+%7B%0A%C2%A0+++++++List%3CObject%3E+justificationList+%3D+constraintMatch.getJustificationList%28%29%3B%0A%C2%A0+++++++Score+score+%3D+constraintMatch.getScore%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A%7D%0AEach+ConstraintMatchTotal+is+one+constraint+%28so+one+score+rule%29+and+has+a+part+of+the+overall+score.%0AThe+sum+of+ConstraintMatchTotal.getScoreTotal%28%29+equals+the+overall+score.%0A158%0ADrools+score+calculation+supports+constraint+matches+automatically%2C+but%0A%EF%81%9A+incremental+Java+score+calculation+requires+implementing+an+extra+interface.%0A5.5.3.+Indictment+Heat+Map%3A+Visualize+the+Hot+Planning+Entities%0ATo+show+a+heat+map+in+the+UI+that+highlights+the+planning+entities+and+problem+facts+have+an%0Aimpact+on+the+Score%2C+get+the+Indictment+map+from+the+ScoreDirector%3A%0AMap%3CObject%2C+Indictment%3E+indictmentMap+%3D+guiScoreDirector.getIndictmentMap%28%29%3B%0Afor+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++Indictment+indictment+%3D+indictmentMap.get%28process%29%3B%0A%C2%A0+++if+%28indictment+%3D%3D+null%29+%7B%0A%C2%A0+++++++continue%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+The+score+impact+of+that+planning+entity%0A%C2%A0+++Score+scoreTotal+%3D+indictment.getScoreTotal%28%29%3B%0A%C2%A0+++for+%28ConstraintMatch+constraintMatch+%3A+indictment.getConstraintMatchSet%28%29%29+%7B%0A%C2%A0+++++++String+constraintName+%3D+constraintMatch.getConstraintName%28%29%3B%0A%C2%A0+++++++Score+score+%3D+constraintMatch.getScore%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A%7D%0AEach+Indictment+is+the+sum+of+all+constraints+where+that+justification+object+is+involved+with.+The%0Asum+of+Indictment.getScoreTotal%28%29+differs+from+the+overall+score%2C+because+multiple+Indictments+can%0Ashare+the+same+ConstraintMatch.%0ADrools+score+calculation+supports+indictments+and+constraint+matches%0A%EF%81%9A+automatically%2C+but+incremental+Java+score+calculation+requires+implementing+an%0Aextra+interface.%0A5.6.+Testing+score+constraints+with+JUnit%0AIt%E2%80%99s+recommended+to+write+a+unit+test+for+each+score+constraint+individually+to+check+that+it+behaves%0Acorrectly.%0AAdd+a+test+scoped+dependency+to+the+optaplanner-test+jar+to+take+advantage+of+the+JUnit+integration%0Aand+use+the+ScoreVerifier+classes+to+test+score+rules+in+DRL+%28or+a+constraint+match+aware%0Aincremental+score+calculator%29.+For+example%2C+suppose+we+want+to+test+these+score+rules%3A%0A159%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0Arule+%22requiredCpuPowerTotal%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addHardConstraintMatch%28...%29%3B%0Aend%0A...%0Arule+%22computerCost%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28...%29%3B%0Aend%0AFor+each+score+rule%2C+we+have+a+separate+%40Test+that+only+tests+the+effect+of+that+score+rule+on+the%0Ascore%3A%0Apublic+class+CloudBalancingScoreConstraintTest+%7B%0A%C2%A0+++private+HardSoftScoreVerifier%3CCloudBalance%3E+scoreVerifier+%3D+new%0AHardSoftScoreVerifier%3C%3E%28%0A%C2%A0+++++++++++SolverFactory.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%29%3B%0A%C2%A0+++%40Test%0A%C2%A0+++public+void+requiredCpuPowerTotal%28%29+%7B%0A%C2%A0+++++++CloudComputer+c1+%3D+new+CloudComputer%281L%2C+1000%2C+1%2C+1%2C+1%29%3B%0A%C2%A0+++++++CloudComputer+c2+%3D+new+CloudComputer%282L%2C+200%2C+1%2C+1%2C+1%29%3B%0A%C2%A0+++++++CloudProcess+p1+%3D+new+CloudProcess%281L%2C+700%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudProcess+p2+%3D+new+CloudProcess%282L%2C+70%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudBalance+solution+%3D+new+CloudBalance%280L%2C%0A%C2%A0+++++++++++++++Arrays.asList%28c1%2C+c2%29%2C%0A%C2%A0+++++++++++++++Arrays.asList%28p1%2C+p2%29%29%3B%0A%C2%A0+++++++%2F%2F+Uninitialized%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c1%29%3B%0A%C2%A0+++++++p2.setComputer%28c1%29%3B%0A%C2%A0+++++++%2F%2F+Usage+700+%2B+70+is+within+capacity+1000+of+c1%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c2%29%3B%0A%C2%A0+++++++p2.setComputer%28c2%29%3B%0A%C2%A0+++++++%2F%2F+Usage+700+%2B+70+is+above+capacity+200+of+c2%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+-570%2C+solution%29%3B%0A%C2%A0+++%7D%0A160%0A%C2%A0+++...%0A%C2%A0+++%40Test%0A%C2%A0+++public+void+computerCost%28%29+%7B%0A%C2%A0+++++++CloudComputer+c1+%3D+new+CloudComputer%281L%2C+1%2C+1%2C+1%2C+200%29%3B%0A%C2%A0+++++++CloudComputer+c2+%3D+new+CloudComputer%282L%2C+1%2C+1%2C+1%2C+30%29%3B%0A%C2%A0+++++++CloudProcess+p1+%3D+new+CloudProcess%281L%2C+0%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudProcess+p2+%3D+new+CloudProcess%282L%2C+0%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudBalance+solution+%3D+new+CloudBalance%280L%2C%0A%C2%A0+++++++++++++++Arrays.asList%28c1%2C+c2%29%2C%0A%C2%A0+++++++++++++++Arrays.asList%28p1%2C+p2%29%29%3B%0A%C2%A0+++++++%2F%2F+Uninitialized%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c1%29%3B%0A%C2%A0+++++++p2.setComputer%28c1%29%3B%0A%C2%A0+++++++%2F%2F+Pay+200+for+c1%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+-200%2C+solution%29%3B%0A%C2%A0+++++++p2.setComputer%28c2%29%3B%0A%C2%A0+++++++%2F%2F+Pay+200+%2B+30+for+c1+and+c2%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+-230%2C+solution%29%3B%0A%C2%A0+++%7D%0A%7D%0AThere+is+a+ScoreVerifier+implementation+for+each+Score+implementation.+In+the+assertHardWeight%28%29%0Aand+assertSoftWeight%28%29+methods%2C+the+weight+of+the+other+score+rules+is+ignored+%28even+those+of+the%0Asame+score+level%29.%0AA+ScoreVerifier+does+not+work+well+to+isolate+score+corruption%2C+use+an%0A%EF%81%9A+assertionScoreDirectorFactory+instead.%0A161%0AChapter+6.+Shadow+Variable%0A6.1.+Introduction%0AA+shadow+variable+is+a+planning+variable+whose+correct+value+can+be+deduced+from+the+state+of+the%0Agenuine+planning+variables.+Even+though+such+a+variable+violates+the+principle+of+normalization+by%0Adefinition%2C+in+some+use+cases+it+can+be+very+practical+to+use+a+shadow+variable%2C+especially+to+express%0Athe+constraints+more+naturally.+For+example+in+vehicle+routing+with+time+windows%3A+the+arrival+time%0Aat+a+customer+for+a+vehicle+can+be+calculated+based+on+the+previously+visited+customers+of+that%0Avehicle+%28and+the+known+travel+times+between+two+locations%29.%0AWhen+the+customers+for+a+vehicle+change%2C+the+arrival+time+for+each+customer+is+automatically%0Aadjusted.+For+more+information%2C+see+the+vehicle+routing+domain+model.%0AFrom+a+score+calculation+perspective%2C+a+shadow+variable+is+like+any+other+planning+variable.+From%0Aan+optimization+perspective%2C+Planner+effectively+only+optimizes+the+genuine+variables+%28and+mostly%0Aignores+the+shadow+variables%29%3A+it+just+assures+that+when+a+genuine+variable+changes%2C+any+dependent%0Ashadow+variables+are+changed+accordingly.%0A162%0AAny+class+that+has+at+least+one+shadow+variable%2C+is+a+planning+entity+class%0A%28even+if+it+has+no+genuine+planning+variables%29.+That+class+must+be+defined+in%0Athe+solver+configuration+%28unless+classes+are+automatically+scanned%29+and+have+a%0A%EF%81%AA+%40PlanningEntity+annotation.%0AA+genuine+planning+entity+class+has+at+least+one+genuine+planning+variable%2C+but+can%0Ahave+shadow+variables+too.+A+shadow+planning+entity+class+has+no+genuine%0Aplanning+variables+and+at+least+one+shadow+planning+variable.%0AThere+are+several+built-in+shadow+variables%3A%0A6.2.+Bi-directional+Variable+%28Inverse+Relation+Shadow%0AVariable%29%0ATwo+variables+are+bi-directional+if+their+instances+always+point+to+each+other+%28unless+one+side+points%0Ato+null+and+the+other+side+does+not+exist%29.+So+if+A+references+B%2C+then+B+references+A.%0AFor+a+non-chained+planning+variable%2C+the+bi-directional+relationship+must+be+a+many+to+one%0Arelationship.+To+map+a+bi-directional+relationship+between+two+planning+variables%2C+annotate+the%0Amaster+side+%28which+is+the+genuine+side%29+as+a+normal+planning+variable%3A%0A163%0A%40PlanningEntity%0Apublic+class+CloudProcess+%7B%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setComputer%28CloudComputer+computer%29+%7B...%7D%0A%7D%0AAnd+then+annotate+the+other+side+%28which+is+the+shadow+side%29+with+a+%40InverseRelationShadowVariable%0Aannotation+on+a+Collection+%28usually+a+Set+or+List%29+property%3A%0A%40PlanningEntity%0Apublic+class+CloudComputer+%7B%0A%C2%A0+++%40InverseRelationShadowVariable%28sourceVariableName+%3D+%22computer%22%29%0A%C2%A0+++public+List%3CCloudProcess%3E+getProcessList%28%29+%7B%0A%C2%A0+++++++return+processList%3B%0A%C2%A0+++%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.+The+sourceVariableName+property+is+the+name+of+the+genuine%0Aplanning+variable+on+the+return+type+of+the+getter+%28so+the+name+of+the+genuine+planning+variable+on%0Athe+other+side%29.%0AThe+shadow+property%2C+which+is+a+Collection%2C+can+never+be+null.+If+no+genuine%0Avariable+is+referencing+that+shadow+entity%2C+then+it+is+an+empty+Collection.%0A%EF%81%9A+Furthermore+it+must+be+a+mutable+Collection+because+once+the+Solver+starts%0Ainitializing+or+changing+genuine+planning+variables%2C+it+will+add+and+remove+to+the%0ACollections+of+those+shadow+variables+accordingly.%0AFor+a+chained+planning+variable%2C+the+bi-directional+relationship+is+always+a+one+to+one+relationship.%0AIn+that+case%2C+the+genuine+side+looks+like+this%3A%0A164%0A%40PlanningEntity%0Apublic+class+Customer+...+%7B%0A%C2%A0+++%40PlanningVariable%28graphType+%3D+PlanningVariableGraphType.CHAINED%2C+...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setPreviousStandstill%28Standstill+previousStandstill%29+%7B...%7D%0A%7D%0AAnd+the+shadow+side+looks+like+this%3A%0A%40PlanningEntity%0Apublic+class+Standstill+%7B%0A%C2%A0+++%40InverseRelationShadowVariable%28sourceVariableName+%3D+%22previousStandstill%22%29%0A%C2%A0+++public+Customer+getNextCustomer%28%29+%7B%0A%C2%A0++++++++return+nextCustomer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setNextCustomer%28Customer+nextCustomer%29+%7B...%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.%0AThe+input+planning+problem+of+a+Solver+must+not+violate+bi-directional%0A%EF%81%B1+relationships.+If+A+points+to+B%2C+then+B+must+point+to+A.+Planner+will+not+violate+that%0Aprinciple+during+planning%2C+but+the+input+must+not+violate+it+either.%0A6.3.+Anchor+Shadow+Variable%0AAn+anchor+shadow+variable+is+the+anchor+of+a+chained+variable.%0AAnnotate+the+anchor+property+as+a+%40AnchorShadowVariable+annotation%3A%0A%40PlanningEntity%0Apublic+class+Customer+%7B%0A%C2%A0+++%40AnchorShadowVariable%28sourceVariableName+%3D+%22previousStandstill%22%29%0A%C2%A0+++public+Vehicle+getVehicle%28%29+%7B...%7D%0A%C2%A0+++public+void+setVehicle%28Vehicle+vehicle%29+%7B...%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.+The+sourceVariableName+property+is+the+name+of+the+chained%0A165%0Avariable+on+the+same+entity+class.%0A6.4.+Custom+VariableListener%0ATo+update+a+shadow+variable%2C+Planner+uses+a+VariableListener.+To+define+a+custom+shadow+variable%2C%0Awrite+a+custom+VariableListener%3A+implement+the+interface+and+annotate+it+on+the+shadow+variable%0Athat+needs+to+change.%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerClass+%3D+VehicleUpdatingVariableListener%0A.class%2C%0A%C2%A0+++++++++++sources+%3D+%7B%40PlanningVariableReference%28variableName+%3D+%22previousStandstill%22%0A%29%7D%29%0A%C2%A0+++public+Vehicle+getVehicle%28%29+%7B%0A%C2%A0+++++++return+vehicle%3B%0A%C2%A0+++%7D%0ARegister+this+class+as+a+planning+entity.+The+variableName+is+the+%28genuine+or+shadow%29+variable+that%0Atriggers+changes+to+this+shadow+variable.%0AIf+the+class+of+the+trigger+variable+is+different+than+the+shadow+variable%2C+also%0Aspecify+the+entityClass+on+%40PlanningVariableReference.+In+that+case%2C+make+sure+that%0A%EF%81%9A+entityClass+is+also+properly+configured+as+a+planning+entity+class+in+the+solver%0Aconfig%2C+or+the+VariableListener+will+simply+never+trigger.%0AFor+example%2C+the+VehicleUpdatingVariableListener+assures+that+every+Customer+in+a+chain+has+the%0Asame+Vehicle%2C+namely+the+chain%E2%80%99s+anchor.%0A166%0Apublic+class+VehicleUpdatingVariableListener+implements+VariableListener%3CCustomer%3E+%7B%0A%C2%A0+++public+void+afterEntityAdded%28ScoreDirector+scoreDirector%2C+Customer+customer%29+%7B%0A%C2%A0+++++++updateVehicle%28scoreDirector%2C+customer%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterVariableChanged%28ScoreDirector+scoreDirector%2C+Customer+customer%29+%7B%0A%C2%A0+++++++updateVehicle%28scoreDirector%2C+customer%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%C2%A0+++protected+void+updateVehicle%28ScoreDirector+scoreDirector%2C+Customer+sourceCustomer%29%0A%7B%0A%C2%A0+++++++Standstill+previousStandstill+%3D+sourceCustomer.getPreviousStandstill%28%29%3B%0A%C2%A0+++++++Vehicle+vehicle+%3D+previousStandstill+%3D%3D+null+%3F+null+%3A+previousStandstill%0A.getVehicle%28%29%3B%0A%C2%A0+++++++Customer+shadowCustomer+%3D+sourceCustomer%3B%0A%C2%A0+++++++while+%28shadowCustomer+%21%3D+null+%26%26+shadowCustomer.getVehicle%28%29+%21%3D+vehicle%29+%7B%0A%C2%A0+++++++++++scoreDirector.beforeVariableChanged%28shadowCustomer%2C+%22vehicle%22%29%3B%0A%C2%A0+++++++++++shadowCustomer.setVehicle%28vehicle%29%3B%0A%C2%A0+++++++++++scoreDirector.afterVariableChanged%28shadowCustomer%2C+%22vehicle%22%29%3B%0A%C2%A0+++++++++++shadowCustomer+%3D+shadowCustomer.getNextCustomer%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AA+VariableListener+can+only+change+shadow+variables.+It+must+never+change+a%0A%EF%81%B1+genuine+planning+variable+or+a+problem+fact.%0A%EF%81%B1+Any+change+of+a+shadow+variable+must+be+told+to+the+ScoreDirector.%0AIf+one+VariableListener+changes+two+shadow+variables+%28because+having+two+separate%0AVariableListeners+would+be+inefficient%29%2C+then+annotate+only+the+first+shadow+variable+with+the%0AvariableListenerClass+and+let+the+other+shadow+variable%28s%29+reference+the+first+shadow+variable%3A%0A167%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerClass+%3D%0ATransportTimeAndCapacityUpdatingVariableListener.class%2C%0A%C2%A0+++++++++++sources+%3D+%7B%40PlanningVariableReference%28variableName+%3D+%22previousStandstill%22%0A%29%7D%29%0A%C2%A0+++public+Integer+getTransportTime%28%29+%7B%0A%C2%A0+++++++return+transportTime%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerRef+%3D+%40PlanningVariableReference%0A%28variableName+%3D+%22transportTime%22%29%29%0A%C2%A0+++public+Integer+getCapacity%28%29+%7B%0A%C2%A0+++++++return+capacity%3B%0A%C2%A0+++%7D%0A6.5.+VariableListener+triggering+order%0AAll+shadow+variables+are+triggered+by+a+VariableListener%2C+regardless+if+it%E2%80%99s+a+built-in+or+a+custom%0Ashadow+variable.+The+genuine+and+shadow+variables+form+a+graph%2C+that+determines+the+order+in%0Awhich+the+afterEntityAdded%28%29%2C+afterVariableChanged%28%29+and+afterEntityRemoved%28%29+methods+are+called%3A%0A168%0AIn+the+example+above%2C+D+could+have+also+been+ordered+after+E+%28or+F%29+because+there%0A%EF%81%9A+is+no+direct+or+indirect+dependency+between+D+and+E+%28or+F%29.%0APlanner+guarantees+that%3A%0A%E2%80%A2+The+first+VariableListener%27s+after*%28%29+methods+trigger+after+the+last+genuine+variable+has%0Achanged.+Therefore+the+genuine+variables+%28A+and+B+in+the+example+above%29+are+guaranteed+to+be%0Ain+a+consistent+state+across+all+its+instances+%28with+values+A1%2C+A2+and+B1+in+the+example+above%29%0Abecause+the+entire+Move+has+been+applied.%0A%E2%80%A2+The+second+VariableListener%27s+after*%28%29+methods+trigger+after+the+last+first+shadow+variable+has%0Achanged.+Therefore+the+first+shadow+variable+%28C+in+the+example+above%29+are+guaranteed+to+be+in%0Aconsistent+state+across+all+its+instances+%28with+values+C1+and+C2+in+the+example+above%29.+And+of%0Acourse+the+genuine+variables+too.%0A%E2%80%A2+And+so+forth.%0APlanner+does+not+guarantee+the+order+in+which+the+after*%28%29+methods+are+called+for+the%0AsameVariableListener+with+different+parameters+%28such+as+A1+and+A2+in+the+example+above%29%2C%0Aalthough+they+are+likely+to+be+in+the+order+in+which+they+were+affected.%0ABy+default%2C+Planner+does+not+guarantee+that+the+events+are+unique.+For+example%2C+if+a+shadow%0Avariable+on+an+entity+is+changed+twice+in+the+same+move+%28for+example+by+two+different+genuine%0Avariables%29%2C+then+that+will+cause+the+same+event+twice+on+the+VariableListeners+that+are+listening+to%0Athat+original+shadow+variable.+To+avoid+dealing+with+that+complexity%2C+overwrite+the+method%0A169%0ArequiresUniqueEntityEvents%28%29+to+receive+unique+events+at+the+cost+of+a+small+performance+penalty%3A%0Apublic+class+StartTimeUpdatingVariableListener+implements+VariableListener%3CTask%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+requiresUniqueEntityEvents%28%29+%7B%0A%C2%A0+++++++return+true%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A170%0AChapter+7.+Optimization+Algorithms%0A7.1.+Search+Space+Size+in+the+Real+World%0AThe+number+of+possible+solutions+for+a+planning+problem+can+be+mind+blowing.+For+example%3A%0A%E2%80%A2+Four+queens+has+256+possible+solutions+%284%5E4%29+and+two+optimal+solutions.%0A%E2%80%A2+Five+queens+has+3125+possible+solutions+%285%5E5%29+and+one+optimal+solution.%0A%E2%80%A2+Eight+queens+has+16777216+possible+solutions+%288%5E8%29+and+92+optimal+solutions.%0A%E2%80%A2+64+queens+has+more+than+10%5E115+possible+solutions+%2864%5E64%29.%0A%E2%80%A2+Most+real-life+planning+problems+have+an+incredible+number+of+possible+solutions+and+only+one%0Aor+a+few+optimal+solutions.%0AFor+comparison%3A+the+minimal+number+of+atoms+in+the+known+universe+%2810%5E80%29.+As+a+planning%0Aproblem+gets+bigger%2C+the+search+space+tends+to+blow+up+really+fast.+Adding+only+one+extra+planning%0Aentity+or+planning+value+can+heavily+multiply+the+running+time+of+some+algorithms.%0ACalculating+the+number+of+possible+solutions+depends+on+the+design+of+the+domain+model%3A%0A171%0AThis+search+space+size+calculation+includes+infeasible+solutions+%28if+they+can+be%0Arepresented+by+the+model%29%2C+because%3A%0A%E2%80%A2+The+optimal+solution+might+be+infeasible.%0A%EF%81%9A+%E2%80%A2+There+are+many+types+of+hard+constraints+that+cannot+be+incorporated+in+theformula+practically.+For+example%2C+in+Cloud+Balancing%2C+try+incorporating+the+CPU%0Acapacity+constraint+in+the+formula.%0AEven+in+cases+where+adding+some+of+the+hard+constraints+in+the+formula+is%0Apractical+%28for+example%2C+Course+Scheduling%29%2C+the+resulting+search+space+is+still+huge.%0AAn+algorithm+that+checks+every+possible+solution+%28even+with+pruning%2C+such+as+in+Branch+And+Bound%29%0Acan+easily+run+for+billions+of+years+on+a+single+real-life+planning+problem.+The+aim+is+to+find+the+best%0Asolution+in+the+available+timeframe.+Planning+competitions+%28such+as+the+International+Timetabling%0ACompetition%29+show+that+Local+Search+variations+%28Tabu+Search%2C+Simulated+Annealing%2C+Late%0AAcceptance%2C+%E2%80%A6%29+usually+perform+best+for+real-world+problems+given+real-world+time+limitations.%0A7.2.+Does+Planner+Find+the+Optimal+Solution%3F%0AThe+business+wants+the+optimal+solution%2C+but+they+also+have+other+requirements%3A%0A%E2%80%A2+Scale+out%3A+Large+production+data+sets+must+not+crash+and+have+also+good+results.%0A172%0A%E2%80%A2+Optimize+the+right+problem%3A+The+constraints+must+match+the+actual+business+needs.%0A%E2%80%A2+Available+time%3A+The+solution+must+be+found+in+time%2C+before+it+becomes+useless+to+execute.%0A%E2%80%A2+Reliability%3A+Every+data+set+must+have+at+least+a+decent+result+%28better+than+a+human+planner%29.%0AGiven+these+requirements%2C+and+despite+the+promises+of+some+salesmen%2C+it+is+usually+impossible+for%0Aanyone+or+anything+to+find+the+optimal+solution.+Therefore%2C+Planner+focuses+on+finding+the+best%0Asolution+in+available+time.+In+realistic%2C+independent+competitions%2C+it+often+comes+out+as+the+best%0Areusable+software.%0AThe+nature+of+NP-complete+problems+make+scaling+a+prime+concern.%0AThe+quality+of+a+result+from+a+small+data+set+is+no+indication+of+the+quality+of+a%0A%EF%81%9A+result+from+a+large+data+set.%0AScaling+issues+cannot+be+mitigated+by+hardware+purchases+later+on.+Start+testing+with+a+production%0Asized+data+set+as+soon+as+possible.+Do+not+assess+quality+on+small+data+sets+%28unless+production%0Aencounters+only+such+data+sets%29.+Instead%2C+solve+a+production+sized+data+set+and+compare+the+results%0Aof+longer+executions%2C+different+algorithms+and+-+if+available+-+the+human+planner.%0A7.3.+Architecture+Overview%0APlanner+is+the+first+framework+to+combine+optimization+algorithms+%28metaheuristics%2C+%E2%80%A6%29+with+score%0Acalculation+by+a+rule+engine+%28such+as+Drools+Expert%29.+This+combination+is+very+efficient%2C+because%3A%0A%E2%80%A2+A+rule+engine%2C+such+as+Drools+Expert%2C+is+great+for+calculating+the+score+of+a+solution+of+a%0Aplanning+problem.+It+makes+it+easy+and+scalable+to+add+additional+soft+or+hard+constraints+such%0Aas%2C+%22a+teacher+should+not+teach+more+then+seven+hours+a+day%22.+It+does+delta-based+score%0Acalculation+without+any+extra+code.+However+it+tends+to+be+not+suitable+to+actually+find+new%0Asolutions.%0A%E2%80%A2+An+optimization+algorithm+is+great+at+finding+new+improving+solutions+for+a+planning%0Aproblem%2C+without+necessarily+brute-forcing+every+possibility.+However%2C+it+needs+to+know+the%0Ascore+of+a+solution+and+offers+no+support+in+calculating+that+score+efficiently.%0A173%0A7.4.+Optimization+Algorithms+Overview%0APlanner+supports+three+families+of+optimization+algorithms%3A+Exhaustive+Search%2C+Construction%0AHeuristics+and+Metaheuristics.+In+practice%2C+Metaheuristics+%28in+combination+with+Construction%0AHeuristics+to+initialize%29+are+the+recommended+choice%3A%0A174%0AEach+of+these+algorithm+families+have+multiple+optimization+algorithms%3A%0ATable+4.+Optimization+Algorithms+Overview%0AAlgorithm+Scalable%3F+Optimal%3F+Easy+to+use%3F+Tweakable%3F+Requires+CH%3F%0AExhaustive+Search+%28ES%29%0A%C2%A0%C2%A0Brute+Force+0%2F5+5%2F5+5%2F5+0%2F5+No%0A%C2%A0%C2%A0Branch+And+0%2F5+5%2F5+4%2F5+2%2F5+No%0ABound%0AConstruction+heuristics+%28CH%29%0A%C2%A0%C2%A0First+Fit+5%2F5+1%2F5+5%2F5+1%2F5+No%0A%C2%A0%C2%A0First+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Weakest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0A%C2%A0%C2%A0Weakest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Strongest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0A%C2%A0%C2%A0Strongest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Cheapest+3%2F5+2%2F5+5%2F5+2%2F5+No%0AInsertion%0A175%0AAlgorithm+Scalable%3F+Optimal%3F+Easy+to+use%3F+Tweakable%3F+Requires+CH%3F%0A%C2%A0%C2%A0Regret+3%2F5+2%2F5+5%2F5+2%2F5+No%0AInsertion%0AMetaheuristics+%28MH%29%0A%C2%A0%C2%A0Local+Search+%28LS%29%0A%C2%A0%C2%A0%C2%A0%C2%A0Hill+Climbing+5%2F5+2%2F5+4%2F5+3%2F5+Yes%0A%C2%A0%C2%A0%C2%A0%C2%A0Tabu+Search+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0A%C2%A0%C2%A0%C2%A0%C2%A0Simulated+5%2F5+4%2F5+2%2F5+5%2F5+Yes%0AAnnealing%0A%C2%A0%C2%A0%C2%A0%C2%A0Late+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0AAcceptance%0A%C2%A0%C2%A0%C2%A0%C2%A0Step+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0ACounting+Hill%0AClimbing%0A%C2%A0%C2%A0%C2%A0%C2%A0Variable+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0ANeighborhood%0ADescent%0A%C2%A0%C2%A0Evolutionary+Algorithms+%28EA%29%0A%C2%A0%C2%A0%C2%A0%C2%A0Evolutionary+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0AStrategies%0A%C2%A0%C2%A0%C2%A0%C2%A0Genetic+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0AAlgorithms%0ATo+learn+more+about+metaheuristics%2C+see+Essentials+of+Metaheuristics+or+Clever+Algorithms.%0A7.5.+Which+Optimization+Algorithms+Should+I+Use%3F%0AThe+best+optimization+algorithms+configuration+to+use+depends+heavily+on+your+use+case.+However%2C%0Athis+basic+procedure+provides+a+good+starting+configuration+that+will+produce+better+than+average%0Aresults.%0A1.+Start+with+a+quick+configuration+that+involves+little+or+no+configuration+and+optimization+code%3A%0ASee+First+Fit.%0A2.+Next%2C+implement+planning+entity+difficulty+comparison+and+turn+it+into+First+Fit+Decreasing.%0A3.+Next%2C+add+Late+Acceptance+behind+it%3A%0Aa.+First+Fit+Decreasing.%0Ab.+Late+Acceptance.%0AAt+this+point%2C+the+return+on+invested+time+lowers+and+the+result+is+likely+to+be+sufficient.%0AHowever%2C+this+can+be+improved+at+a+lower+return+on+invested+time.+Use+the+Benchmarker+and+try+a%0Acouple+of+different+Tabu+Search%2C+Simulated+Annealing+and+Late+Acceptance+configurations%2C+for%0Aexample%3A%0A176%0A1.+First+Fit+Decreasing%3A+Tabu+Search.%0AUse+the+Benchmarker+to+improve+the+values+for+the+size+parameters.%0AOther+experiments+can+also+be+run.+For+example%2C+the+following+multiple+algorithms+can+be%0Acombined+together%3A%0A1.+First+Fit+Decreasing%0A2.+Late+Acceptance+%28relatively+long+time%29%0A3.+Tabu+Search+%28relatively+short+time%29%0A7.6.+Power+tweaking+or+default+parameter+values%0AMany+optimization+algorithms+have+parameters+that+affect+results+and+scalability.+Planner+applies%0Aconfiguration+by+exception%2C+so+all+optimization+algorithms+have+default+parameter+values.+This+is%0Avery+similar+to+the+Garbage+Collection+parameters+in+a+JVM%3A+most+users+have+no+need+to+tweak%0Athem%2C+but+power+users+often+do.%0AThe+default+parameter+values+are+sufficient+for+many+cases+%28and+especially+for+prototypes%29%2C+but+if%0Adevelopment+time+allows%2C+it+may+be+beneficial+to+power+tweak+them+with+the+benchmarker+for%0Abetter+results+and+scalability+on+a+specific+use+case.+The+documentation+for+each+optimization%0Aalgorithm+also+declares+the+advanced+configuration+for+power+tweaking.%0AThe+default+value+of+parameters+will+change+between+minor+versions%2C+to+improve%0A%EF%81%B1+them+for+most+users.+The+advanced+configuration+can+be+used+to+prevent%0Aunwanted+changes%2C+however%2C+this+is+not+recommended.%0A7.7.+Solver+Phase%0AA+Solver+can+use+multiple+optimization+algorithms+in+sequence.+Each+optimization+algorithm+is%0Arepresented+by+one+solver+Phase.+There+is+never+more+than+one+Phase+solving+at+the+same+time.%0ASome+Phase+implementations+can+combine+techniques+from+multiple+optimization%0A%EF%81%9A+algorithms%2C+but+it+is+still+just+one+Phase.+For+example%3A+a+Local+Search+Phase+can+do%0ASimulated+Annealing+with+entity+Tabu.%0AHere+is+a+configuration+that+runs+three+phases+in+sequence%3A%0A177%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...+%3C%21--+First+phase%3A+First+Fit+Decreasing+--%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...+%3C%21--+Second+phase%3A+Late+Acceptance+--%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...+%3C%21--+Third+phase%3A+Tabu+Search+--%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0AThe+solver+phases+are+run+in+the+order+defined+by+solver+configuration.%0A%E2%80%A2+When+the+first+Phase+terminates%2C+the+second+Phase+starts%2C+and+so+on.%0A%E2%80%A2+When+the+last+Phase+terminates%2C+the+Solver+terminates.%0AUsually%2C+a+Solver+will+first+run+a+construction+heuristic+and+then+run+one+or+multiple+metaheuristics%3A%0AIf+no+phases+are+configured%2C+Planner+will+default+to+a+Construction+Heuristic+phase+followed+by+a%0ALocal+Search+phase.%0A178%0ASome+phases+%28especially+construction+heuristics%29+will+terminate+automatically.+Other+phases%0A%28especially+metaheuristics%29+will+only+terminate+if+the+Phase+is+configured+to+terminate%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3Ctermination%3E%3C%21--+Solver+termination+--%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E90%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%3C%21--+Phase+termination+--%3E%0A%C2%A0+++++%3CsecondsSpentLimit%3E60%3C%2FsecondsSpentLimit%3E%3C%21--+Give+the+next+phase+a+chance+to%0Arun+too%2C+before+the+Solver+terminates+--%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0AIf+the+Solver+terminates+%28before+the+last+Phase+terminates+itself%29%2C+the+current+phase+is+terminated+and%0Aall+subsequent+phases+will+not+run.%0A7.8.+Scope+Overview%0AA+solver+will+iteratively+run+phases.+Each+phase+will+usually+iteratively+run+steps.+Each+step%2C+in+turn%2C%0Ausually+iteratively+runs+moves.+These+form+four+nested+scopes%3A%0A1.+Solver%0A2.+Phase%0A3.+Step%0A4.+Move%0A179%0AConfigure+logging+to+display+the+log+messages+of+each+scope.%0A7.9.+Termination%0ANot+all+phases+terminate+automatically+and+may+take+a+significant+amount+of+time.+A+Solver+can+be%0Aterminated+synchronously+by+up-front+configuration%2C+or+asynchronously+from+another+thread.%0AMetaheuristic+phases+in+particular+need+to+be+instructed+to+stop+solving.+This+can+be+because+of+a%0Anumber+of+reasons%2C+for+example%2C+if+the+time+is+up%2C+or+the+perfect+score+has+been+reached+just+before%0Aits+solution+is+used.+Finding+the+optimal+solution+cannot+be+relied+on+%28unless+you+know+the+optimal%0Ascore%29%2C+because+a+metaheuristic+algorithm+is+generally+unaware+of+the+optimal+solution.%0AThis+is+not+an+issue+for+real-life+problems%2C+as+finding+the+optimal+solution+may+take+more+time+than%0Ais+available.+Finding+the+best+solution+in+the+available+time+is+the+most+important+outcome.%0AIf+no+termination+is+configured+%28and+a+metaheuristic+algorithm+is+used%29%2C+the+Solver%0A%EF%81%AA+will+run+forever%2C+until+terminateEarly%28%29+is+called+from+another+thread.+This+is%0Aespecially+common+during+real-time+planning.%0AFor+synchronous+termination%2C+configure+a+Termination+on+a+Solver+or+a+Phase+when+it+needs+to+stop.%0AThe+built-in+implementations+of+these+should+be+sufficient%2C+but+custom+terminations+are+supported%0Atoo.+Every+Termination+can+calculate+a+time+gradient+%28needed+for+some+optimization+algorithms%29%2C%0Awhich+is+a+ratio+between+the+time+already+spent+solving+and+the+estimated+entire+solving+time+of+the%0A180%0ASolver+or+Phase.%0A7.9.1.+TimeMillisSpentTermination%0ATerminates+when+an+amount+of+time+has+been+used.%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CmillisecondsSpentLimit%3E500%3C%2FmillisecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E10%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CminutesSpentLimit%3E5%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3ChoursSpentLimit%3E1%3C%2FhoursSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CdaysSpentLimit%3E2%3C%2FdaysSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AMultiple+time+types+can+be+used+together%2C+for+example+to+configure+150+minutes%2C+either+configure+it%0Adirectly%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CminutesSpentLimit%3E150%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AOr+use+a+combination+that+sums+up+to+150+minutes%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3ChoursSpentLimit%3E2%3C%2FhoursSpentLimit%3E%0A%C2%A0+++%3CminutesSpentLimit%3E30%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A181%0AThis+Termination+will+most+likely+sacrifice+perfect+reproducibility+%28even+with%0AenvironmentMode+REPRODUCIBLE%29+because+the+available+CPU+time+differs+frequently%0Abetween+runs%3A%0A%EF%81%9A+%E2%80%A2+The+available+CPU+time+influences+the+number+of+steps+that+can+be+taken%2Cwhich+might+be+a+few+more+or+less.%0A%E2%80%A2+The+Termination+might+produce+slightly+different+time+gradient+values%2C+which%0Awill+send+time+gradient-based+algorithms+%28such+as+Simulated+Annealing%29+on+a%0Aradically+different+path.%0A7.9.2.+UnimprovedTimeMillisSpentTermination%0ATerminates+when+the+best+score+has+not+improved+in+a+specified+amount+of+time.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedMillisecondsSpentLimit%3E500%3C%2FunimprovedMillisecondsSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedSecondsSpentLimit%3E10%3C%2FunimprovedSecondsSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedMinutesSpentLimit%3E5%3C%2FunimprovedMinutesSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedHoursSpentLimit%3E1%3C%2FunimprovedHoursSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedDaysSpentLimit%3E1%3C%2FunimprovedDaysSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A182%0AThis+termination+should+not+be+applied+to+Construction+Heuristics+as+they+only+update+the+best%0Asolution+at+the+end.+Configuring+it+on+a+specific+Phase+%28such+as+%3ClocalSearch%3E%29%2C+instead+of+on+the%0ASolver+itself+may+be+a+better+option.%0AThis+Termination+will+most+likely+sacrifice+perfect+reproducibility+%28even+with%0AenvironmentMode+REPRODUCIBLE%29+as+the+available+CPU+time+differs+frequently+between%0Aruns%3A%0A%EF%81%9A+%E2%80%A2+The+available+CPU+time+influences+the+number+of+steps+that+can+be+taken%2Cwhich+might+be+a+few+more+or+less.%0A%E2%80%A2+The+Termination+might+produce+slightly+different+time+gradient+values%2C+which%0Awill+send+time+gradient+based+algorithms+%28such+as+Simulated+Annealing%29+on+a%0Aradically+different+path.%0A7.9.3.+BestScoreTermination%0ABestScoreTermination+terminates+when+a+certain+score+has+been+reached.+Use+this+Termination+where%0Athe+perfect+score+is+known%2C+for+example+for+four+queens+%28which+uses+a+SimpleScore%29%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E0%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AA+planning+problem+with+a+HardSoftScore+may+look+like+this%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E0hard%2F-5000soft%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AA+planning+problem+with+a+BendableScore+with+three+hard+levels+and+one+soft+level+may+look+like%0Athis%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E%5B0%2F0%2F0%5Dhard%2F%5B-5000%5Dsoft%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AIn+this+instance%2C+Termination+once+a+feasible+solution+has+been+reached+is+not+practical+because+it%0Arequires+a+bestScoreLimit+such+as+0hard%2F-2147483648soft.+Use+the+next+termination+instead.%0A7.9.4.+BestScoreFeasibleTermination%0ATerminates+as+soon+as+a+feasible+solution+has+been+discovered.+Requires+that+Score+implements%0AFeasibilityScore.%0A183%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreFeasible%3Etrue%3C%2FbestScoreFeasible%3E%0A%C2%A0+%3C%2Ftermination%3E%0AThis+Termination+is+usually+combined+with+other+terminations.%0A7.9.5.+StepCountTermination%0ATerminates+when+a+number+of+steps+has+been+reached.+This+is+useful+for+hardware+performance%0Aindependent+runs.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CstepCountLimit%3E100%3C%2FstepCountLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AThis+Termination+can+only+be+used+for+a+Phase+%28such+as+%3ClocalSearch%3E%29%2C+not+for+the+Solver+itself.%0A7.9.6.+UnimprovedStepCountTermination%0ATerminates+when+the+best+score+has+not+improved+in+a+number+of+steps.+This+is+useful+for+hardware%0Aperformance+independent+runs.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedStepCountLimit%3E100%3C%2FunimprovedStepCountLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AIf+the+score+has+not+improved+recently%2C+it+is+unlikely+to+improve+in+a+reasonable+timeframe.+It+has%0Abeen+observed+that+once+a+new+best+solution+is+found+%28even+after+a+long+time+without+improvement%0Aon+the+best+solution%29%2C+the+next+few+steps+tend+to+improve+the+best+solution.%0AThis+Termination+can+only+be+used+for+a+Phase+%28such+as+%3ClocalSearch%3E%29%2C+not+for+the+Solver+itself.%0A7.9.7.+ScoreCalculationCountTermination%0AScoreCalculationCountTermination+terminates+when+a+number+of+score+calculations+have+been%0Areached.+This+is+often+the+sum+of+the+number+of+moves+and+the+number+of+steps.+This+is+useful+for%0Abenchmarking.%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CscoreCalculationCountLimit%3E100000%3C%2FscoreCalculationCountLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A184%0ASwitching+EnvironmentMode+can+heavily+impact+when+this+termination+ends.%0A7.9.8.+Combining+Multiple+Terminations%0ATerminations+can+be+combined%2C+for+example%3A+terminate+after+100+steps+or+if+a+score+of+0+has+been%0Areached%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CterminationCompositionStyle%3EOR%3C%2FterminationCompositionStyle%3E%0A%C2%A0+++%3CstepCountLimit%3E100%3C%2FstepCountLimit%3E%0A%C2%A0+++%3CbestScoreLimit%3E0%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AAlternatively+you+can+use+AND%2C+for+example%3A+terminate+after+reaching+a+feasible+score+of+at+least+-100%0Aand+no+improvements+in+5+steps%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CterminationCompositionStyle%3EAND%3C%2FterminationCompositionStyle%3E%0A%C2%A0+++%3CunimprovedStepCountLimit%3E5%3C%2FunimprovedStepCountLimit%3E%0A%C2%A0+++%3CbestScoreLimit%3E-100%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AThis+example+ensures+it+does+not+just+terminate+after+finding+a+feasible+solution%2C+but+also+completes%0Aany+obvious+improvements+on+that+solution+before+terminating.%0A7.9.9.+Asynchronous+Termination+from+Another+Thread%0AAsychronous+termination+from+another+thread+occurs+when+a+Solver+needs+to+be+terminated+early%0Afrom+another+thread%2C+for+example%2C+due+to+a+user+action+or+a+server+restart.+This+cannot+be%0Aconfigured+by+a+Termination+as+it+is+impossible+to+predict+when+and+if+it+will+occur.+Therefore+the%0ASolver+interface+has+the+following+thread-safe+methods%3A%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++boolean+terminateEarly%28%29%3B%0A%C2%A0+++boolean+isTerminateEarly%28%29%3B%0A%7D%0AWhen+calling+the+terminateEarly%28%29+method+from+another+thread%2C+the+Solver+will+terminate+at+its%0Aearliest+convenience+and+the+solve%28Solution%29+method+will+return+%28in+the+original+Solver+thread%29.%0A185%0AInterrupting+the+Solver+thread+%28which+is+the+thread+that+called%0ASolver.solve%28Solution%29%29+has+the+same+affect+as+calling+terminateEarly%28%29+except+that%0A%EF%81%9A+it+leaves+that+thread+in+the+interrupted+state.+This+guarantees+a+graceful+shutdown%0Awhen+an+ExecutorService+%28such+as+a+thread+pool%29+is+shutdown+because+that+only%0Ainterrupts+all+active+threads+in+the+pool.%0A7.10.+SolverEventListener%0AEach+time+a+new+best+solution+is+found%2C+a+new+BestSolutionChangedEvent+is+fired+in+the+Solver+thread.%0ATo+listen+to+such+events%2C+add+a+SolverEventListener+to+the+Solver%3A%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++void+addEventListener%28SolverEventListener%3CS%3E+eventListener%29%3B%0A%C2%A0+++void+removeEventListener%28SolverEventListener%3CS%3E+eventListener%29%3B%0A%7D%0AThe+BestSolutionChangedEvent%27s+newBestSolution+may+not+be+initialized+or+feasible.+Use+the%0AisFeasible%28%29+method+on+BestSolutionChangedEvent%27s+new+best+Score+to+detect+such+cases%3A%0A%C2%A0+++solver.addEventListener%28new+SolverEventListener%3CCloudBalance%3E%28%29+%7B%0A%C2%A0+++++++public+void+bestSolutionChanged%28BestSolutionChangedEvent%3CCloudBalance%3E+event%29%0A%7B%0A%C2%A0+++++++++++%2F%2F+Ignore+infeasible+%28including+uninitialized%29+solutions%0A%C2%A0+++++++++++if+%28event.getNewBestSolution%28%29.getScore%28%29.isFeasible%28%29%29+%7B%0A%C2%A0+++++++++++++++...%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%29%3B%0AUse+Score.isSolutionInitialized%28%29+instead+of+Score.isFeasible%28%29+to+only+ignore+uninitialized%0Asolutions%2C+but+also+accept+infeasible+solutions.%0AThe+bestSolutionChanged%28%29+method+is+called+in+the+solver%E2%80%99s+thread%2C+as+part+of%0A%EF%81%B1+Solver.solve%28%29.+So+it+should+return+quickly+to+avoid+slowing+down+the+solving.%0A7.11.+Custom+Solver+Phase%0ARun+a+custom+optimization+algorithm+between+phases+or+before+the+first+phase+to+initialize+the%0ASolution%2C+or+to+get+a+better+score+quickly.+You+will+still+want+to+reuse+the+score+calculation.+For%0Aexample%2C+to+implement+a+custom+Construction+Heuristic+without+implementing+an+entire+Phase.%0A186%0AMost+of+the+time%2C+a+custom+solver+phase+is+not+worth+the+development+time%0Ainvestment.+The+supported+Constructions+Heuristics+are+configurable+%28use+the%0A%EF%81%9A+Benchmarker+to+tweak+them%29%2C+Termination+aware+and+support+partially+initialized%0Asolutions+too.%0AThe+CustomPhaseCommand+interface+appears+as+follows%3A%0Apublic+interface+CustomPhaseCommand%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++void+changeWorkingSolution%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%7D%0AFor+example%2C+extend+AbstractCustomPhaseCommand+and+implement+the+changeWorkingSolution%28%29%0Amethod%3A%0Apublic+class+ToOriginalMachineSolutionInitializer+extends+AbstractCustomPhaseCommand%0A%3CMachineReassignment%3E+%7B%0A%C2%A0+++public+void+changeWorkingSolution%28ScoreDirector%3CMachineReassignment%3E%0AscoreDirector%29+%7B%0A%C2%A0+++++++MachineReassignment+machineReassignment+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++for+%28MrProcessAssignment+processAssignment+%3A+machineReassignment%0A.getProcessAssignmentList%28%29%29+%7B%0A%C2%A0+++++++++++scoreDirector.beforeVariableChanged%28processAssignment%2C+%22machine%22%29%3B%0A%C2%A0+++++++++++processAssignment.setMachine%28processAssignment.getOriginalMachine%28%29%29%3B%0A%C2%A0+++++++++++scoreDirector.afterVariableChanged%28processAssignment%2C+%22machine%22%29%3B%0A%C2%A0+++++++++++scoreDirector.triggerVariableListeners%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AAny+change+on+the+planning+entities+in+a+CustomPhaseCommand+must+be+notified+to+the%0A%EF%81%B1+ScoreDirector.%0ADo+not+change+any+of+the+problem+facts+in+a+CustomPhaseCommand.+That+will+corrupt%0Athe+Solver+because+any+previous+score+or+solution+was+for+a+different+problem.+To%0A%EF%81%9A+do+that%2C+read+about+repeated+planning+and+do+it+with+a+ProblemFactChange%0Ainstead.%0AConfigure+the+CustomPhaseCommand+in+the+solver+configuration%3A%0A187%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0%0A%3CcustomPhaseCommandClass%3Eorg.optaplanner.examples.machinereassignment.solver.solution.%0Ainitializer.ToOriginalMachineSolutionInitializer%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0A%C2%A0+...+%3C%21--+Other+phases+--%3E%0A%3C%2Fsolver%3E%0AConfigure+multiple+customPhaseCommandClass+instances+to+run+them+in+sequence.%0AIf+the+changes+of+a+CustomPhaseCommand+do+not+result+in+a+better+score%2C+the+best%0Asolution+will+not+be+changed+%28so+effectively+nothing+will+have+changed+for+the+next%0APhase+or+CustomPhaseCommand%29.+To+force+such+changes+anyway%2C+use%0AforceUpdateBestSolution%3A%0A%EF%81%AA%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0+++%3CcustomPhaseCommandClass%3E...MyCustomPhase%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+++%3CforceUpdateBestSolution%3Etrue%3C%2FforceUpdateBestSolution%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0AIf+the+Solver+or+a+Phase+wants+to+terminate+while+a+CustomPhaseCommand+is+still%0Arunning%2C+it+will+wait+to+terminate+until+the+CustomPhaseCommand+is+complete.+This%0A%EF%81%9A+may+take+a+significant+amount+of+time.+The+built-in+solver+phases+do+not+have+this%0Aissue.%0ATo+configure+values+of+a+CustomPhaseCommand+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+customProperties+element+and+use+custom%0Aproperties%3A%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0+++%3CcustomPhaseCommandClass%3E...MyCustomPhase%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+++%3CcustomProperties%3E%0A%C2%A0+++++%3CmySelectionSize%3E5%3C%2FmySelectionSize%3E%0A%C2%A0+++%3C%2FcustomProperties%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0A7.12.+No+Change+Solver+Phase%0AIn+rare+cases%2C+it%E2%80%99s+useful+not+to+run+any+solver+phases.+But+by+default%2C+configuring+no+phase+will%0Atrigger+running+the+default+phases.+To+avoid+those%2C+configure+a+NoChangePhase%3A%0A188%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CnoChangePhase%2F%3E%0A%3C%2Fsolver%3E%0A7.13.+Multithreaded+Solving%0AThere+are+several+ways+of+doing+multithreaded+solving%3A%0A%E2%80%A2+Multitenancy%3A+solve+different+datasets+in+parallel%0A%E2%97%A6+The+SolverManager+will+make+it+even+easier+to+set+this+up%2C+in+a+future+version.%0A%E2%80%A2+Multi+bet+solving%3A+solve+1+dataset+with+multiple%2C+isolated+solvers+and+take+the+best+result.%0A%E2%97%A6+Not+recommended%3A+This+is+a+marginal+gain+for+a+high+cost+of+hardware+resources.%0A%E2%97%A6+Use+the+Benchmarker+during+development+to+determine+the+most+appropriate+algorithm%2C%0Aalthough+that%E2%80%99s+only+on+average.%0A%E2%97%A6+Use+multithreaded+incremental+solving+instead.%0A%E2%80%A2+Partitioned+Search%3A+Split+1+dataset+in+multiple+parts+and+solve+them+independently.%0A%E2%97%A6+Configure+a+Partitioned+Search.%0A%E2%80%A2+Multithreaded+incremental+solving%3A+solve+1+dataset+with+multiple+threads+without+sacrificing%0Aincremental+score+calculation.%0A%E2%97%A6+Donate+a+portion+of+your+CPU+cores+to+Planner+to+scale+up+the+score+calculation+speed+and%0Aget+the+same+results+in+fraction+of+the+time.%0A%E2%97%A6+Configure+multithreaded+incremental+solving.%0A189%0AA+logging+level+of+debug+or+trace+might+cause+congestion+multithreaded+solving+and%0A%EF%81%9A+slow+down+the+score+calculation+speed.%0A7.13.1.+Custom+Thread+Factory+%28WildFly%2C+Android%2C+GAE%2C+%E2%80%A6%29%0AThe+threadFactoryClass+allows+to+plug+in+a+custom+ThreadFactory+for+environments+where+arbitrary%0Athread+creation+should+be+avoided%2C+such+as+most+application+servers+%28including+WildFly%29%2C+Android%2C%0Aor+Google+App+Engine.%0AConfigure+the+ThreadFactory+on+the+solver+to+create+the+move+threads+and+the+Partition+Search%0Athreads+with+it%3A%0A%3Csolver%3E%0A%C2%A0+%3CthreadFactoryClass%3E...MyAppServerThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0A7.13.2.+Multithreaded+Incremental+Solving%0AEnable+multithreaded+incremental+solving+by+configuring+a+moveThreadCount%3A%0A190%0A%3Csolver%3E%0A%C2%A0+%3CmoveThreadCount%3EAUTO%3C%2FmoveThreadCount%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThat+one+extra+line+heavily+improves+the+score+calculation+speed%2C+presuming+that+your+machine+has%0Aenough+free+CPU+cores.%0AAdvanced+configuration%3A%0A%3Csolver%3E%0A%C2%A0+%3CmoveThreadCount%3E4%3C%2FmoveThreadCount%3E%0A%C2%A0+%3CmoveThreadBufferSize%3E10%3C%2FmoveThreadBufferSize%3E%0A%C2%A0+%3CthreadFactoryClass%3E...MyAppServerThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AA+moveThreadCount+of+4+saturates+almost+5+CPU+cores%3A+the+4+move+threads+fill+up+4+CPU+cores%0Acompletely+and+the+solver+thread+uses+most+of+another+CPU+core.%0AThe+following+moveThreadCounts+are+supported%3A%0A%E2%80%A2+NONE+%28default%29%3A+Don%E2%80%99t+run+any+move+threads.+Use+the+single+threaded+code.%0A%E2%80%A2+AUTO%3A+Let+Planner+decide+how+many+move+threads+to+run+in+parallel.+On+machines+or+containers%0Awith+little+or+no+CPUs%2C+this+falls+back+to+the+single+threaded+code.%0A%E2%80%A2+Static+number%3A+The+number+of+move+threads+to+run+in+parallel.%0A%3CmoveThreadCount%3E4%3C%2FmoveThreadCount%3E%0AThis+can+be+1+to+enforce+running+the+multithreaded+code+with+only+1+move+thread+%28which+is+less%0Aefficient+than+NONE%29.%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+move+threads+to+run+in+parallel.+It+can+use+the%0Avariable+availableProcessorCount.+For+example%3A%0A%3CmoveThreadCount%3E%28availableProcessorCount+%2F+2%29+%2B+1%3C%2FmoveThreadCount%3E%0AIt+is+counter-effective+to+set+a+moveThreadCount+that+is+higher+than+the+number+of+available+CPU+cores%2C%0Aas+that+will+slow+down+the+score+calculation+speed.+One+good+reason+to+do+it+anyway%2C+is+to+reproduce%0Aa+bug+of+a+high-end+production+machine.%0A191%0AMultithreaded+solving+is+still+reproducible%2C+as+long+as+the+resolved+moveThreadCount%0Ais+stable.+A+run+of+the+same+solver+configuration+on+2+machines+with+a+different%0A%EF%81%9A+number+of+CPUs%2C+is+still+reproducible%2C+unless+the+moveThreadCount+is+set+to+AUTO+or+a%0Afunction+of+availableProcessorCount.%0AThe+moveThreadBufferSize+power+tweaks+the+number+of+moves+that+are+selected+but+won%E2%80%99t+be%0Aforaged.+Setting+it+too+low+reduces+performance%2C+but+setting+it+too+high+too.+Unless+you%E2%80%99re+deeply%0Afamiliar+with+the+inner+workings+of+multithreaded+solving%2C+don%E2%80%99t+configure+this+parameter.%0ATo+run+in+an+environment+that+doesn%E2%80%99t+like+arbitrary+thread+creation%2C+use+threadFactoryClass+to+plug%0Ain+a+custom+thread+factory.%0A192%0AChapter+8.+Move+and+Neighborhood%0ASelection%0A8.1.+Move+and+Neighborhood+Introduction%0A8.1.1.+What+is+a+Move%3F%0AA+Move+is+a+change+%28or+set+of+changes%29+from+a+solution+A+to+a+solution+B.+For+example%2C+the+move+below%0Achanges+queen+C+from+row+0+to+row+2%3A%0AThe+new+solution+is+called+a+neighbor+of+the+original+solution%2C+because+it+can+be+reached+in+a+single%0AMove.+Although+a+single+move+can+change+multiple+queens%2C+the+neighbors+of+a+solution+should+always%0Abe+a+very+small+subset+of+all+possible+solutions.+For+example%2C+on+that+original+solution%2C+these+are+all%0Apossible+changeMove%27s%3A%0AIf+we+ignore+the+four+changeMove%27s+that+have+no+impact+and+are+therefore+not+doable%2C+we+can+see+that%0Anumber+of+moves+is+n+*+%28n+-+1%29+%3D+12.+This+is+far+less+than+the+number+of+possible+solutions%2C+which%0Ais+n+%5E+n+%3D+256.+As+the+problem+scales+out%2C+the+number+of+possible+moves+increases+far+less+than+the%0Anumber+of+possible+solutions.%0AYet%2C+in+four+changeMove%27s+or+less+we+can+reach+any+solution.+For+example+we+can+reach+a+very%0Adifferent+solution+in+three+changeMove%27s%3A%0A193%0AThere+are+many+other+types+of+moves+besides+changeMove%27s.+Many+move+types+are%0Aincluded+out-of-the-box%2C+but+you+can+also+implement+custom+moves.%0A%EF%81%9A%0AA+Move+can+affect+multiple+entities+or+even+create%2Fdelete+entities.+But+it+must+not%0Achange+the+problem+facts.%0AAll+optimization+algorithms+use+Move%27s+to+transition+from+one+solution+to+a+neighbor+solution.%0ATherefore%2C+all+the+optimization+algorithms+are+confronted+with+Move+selection%3A+the+craft+of+creating%0Aand+iterating+moves+efficiently+and+the+art+of+finding+the+most+promising+subset+of+random+moves%0Ato+evaluate+first.%0A8.1.2.+What+is+a+MoveSelector%3F%0AA+MoveSelector%27s+main+function+is+to+create+Iterator%3CMove%3E+when+needed.+An+optimization+algorithm%0Awill+iterate+through+a+subset+of+those+moves.%0AHere%E2%80%99s+an+example+how+to+configure+a+changeMoveSelector+for+the+optimization+algorithm+Local%0ASearch%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0AOut+of+the+box%2C+this+works+and+all+properties+of+the+changeMoveSelector+are+defaulted+sensibly%0A%28unless+that+fails+fast+due+to+ambiguity%29.+On+the+other+hand%2C+the+configuration+can+be+customized%0Asignificantly+for+specific+use+cases.+For+example%3A+you+might+want+to+configure+a+filter+to+discard%0Apointless+moves.%0A8.1.3.+Subselecting+of+Entities%2C+Values+and+Other+Moves%0ATo+create+a+Move%2C+a+MoveSelector+needs+to+select+one+or+more+planning+entities+and%2For+planning%0Avalues+to+move.+Just+like+MoveSelectors%2C+EntitySelectors+and+ValueSelectors+need+to+support+a%0Asimilar+feature+set+%28such+as+scalable+just-in-time+selection%29.+Therefore%2C+they+all+implement+a+common%0Ainterface+Selector+and+they+are+configured+similarly.%0AA+MoveSelector+is+often+composed+out+of+EntitySelectors%2C+ValueSelectors+or+even+other%0AMoveSelectors%2C+which+can+be+configured+individually+if+desired%3A%0A194%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0ATogether%2C+this+structure+forms+a+Selector+tree%3A%0AThe+root+of+this+tree+is+a+MoveSelector+which+is+injected+into+the+optimization+algorithm%0Aimplementation+to+be+%28partially%29+iterated+in+every+step.%0A8.2.+Generic+MoveSelectors%0A195%0A8.2.1.+changeMoveSelector%0AFor+one+planning+variable%2C+the+ChangeMove+selects+one+planning+entity+and+one+planning+value+and%0Aassigns+the+entity%E2%80%99s+variable+to+that+value.%0ASimplest+configuration%3A%0A%C2%A0+++%3CchangeMoveSelector%2F%3E%0AIf+there+are+multiple+entity+classes+or+multiple+planning+variables+for+one+entity+class%2C+a+simple%0Aconfiguration+will+automatically+unfold+into+a+union+of+ChangeMove+selectors+for+every+planning%0Avariable.%0AAdvanced+configuration%3A%0A196%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AA+ChangeMove+is+the+finest+grained+move.%0AAlmost+every+moveSelector+configuration+injected+into+a+metaheuristic+algorithm%0Ashould+include+a+changeMoveSelector+or+a+custom+implementation.+This%0A%EF%81%AA+guarantees+that+every+possible+Solution+can+be+reached+through+applying+a%0Anumber+of+moves+in+sequence+%28not+taking+score+traps+into+account%29.+Of+course%2C%0Anormally+it+is+unioned+with+other%2C+more+coarse+grained+move+selectors.%0A8.2.2.+swapMoveSelector%0AThe+SwapMove+selects+two+different+planning+entities+and+swaps+the+planning+values+of+all+their%0Aplanning+variables.%0A197%0AAlthough+a+SwapMove+on+a+single+variable+is+essentially+just+two+ChangeMoves%2C+it%E2%80%99s+often+the+winning%0Astep+where+the+first+of+the+two+ChangeMoves+would+not+be+the+winning+step+because+it+leaves+the%0Asolution+in+a+state+with+broken+hard+constraints.+For+example%3A+swapping+the+room+of+two+lectures%0Adoesn%E2%80%99t+bring+the+solution+in+a+intermediate+state+where+both+lectures+are+in+the+same+room+which%0Abreaks+a+hard+constraint.%0ASimplest+configuration%3A%0A%C2%A0+++%3CswapMoveSelector%2F%3E%0AIf+there+are+multiple+entity+classes%2C+a+simple+configuration+will+automatically+unfold+into+a+union+of%0ASwapMove+selectors+for+every+entity+class.%0AAdvanced+configuration%3A%0A198%0A%C2%A0+++%3CswapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CsecondaryEntitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FsecondaryEntitySelector%3E%0A%C2%A0+++++%3CvariableNameInclude%3Eroom%3C%2FvariableNameInclude%3E%0A%C2%A0+++++%3CvariableNameInclude%3E...%3C%2FvariableNameInclude%3E%0A%C2%A0+++%3C%2FswapMoveSelector%3E%0AThe+secondaryEntitySelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0AentitySelector+are+swapped.%0AIf+one+or+more+variableNameInclude+properties+are+specified%2C+not+all+planning+variables+will+be%0Aswapped%2C+but+only+those+specified.+For+example+for+course+scheduling%2C+specifying+only%0AvariableNameInclude+room+will+make+it+only+swap+room%2C+not+period.%0A8.2.3.+pillarChangeMoveSelector%0AA+pillar+is+a+set+of+planning+entities+which+have+the+same+planning+value%28s%29+for+their+planning%0Avariable%28s%29.+The+PillarChangeMove+selects+one+entity+pillar+%28or+subset+of+those%29+and+changes+the+value%0Aof+one+variable+%28which+is+the+same+for+all+entities%29+to+another+value.%0A199%0AIn+the+example+above%2C+queen+A+and+C+have+the+same+value+%28row+0%29+and+are+moved+to+row+2.+Also+the%0Ayellow+and+blue+process+have+the+same+value+%28computer+Y%29+and+are+moved+to+computer+X.%0ASimplest+configuration%3A%0A%C2%A0+++%3CpillarChangeMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A200%0A%C2%A0+++%3CpillarChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CpillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CsubPillarEnabled%3Etrue%3C%2FsubPillarEnabled%3E%0A%C2%A0+++++++%3CminimumSubPillarSize%3E1%3C%2FminimumSubPillarSize%3E%0A%C2%A0+++++++%3CmaximumSubPillarSize%3E1000%3C%2FmaximumSubPillarSize%3E%0A%C2%A0+++++%3C%2FpillarSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FpillarChangeMoveSelector%3E%0AA+sub+pillar+is+a+subset+of+entities+that+share+the+same+value%28s%29+for+their+variable%28s%29.+For+example+if%0Aqueen+A%2C+B%2C+C+and+D+are+all+located+on+row+0%2C+they+are+a+pillar+and+%5BA%2C+D%5D+is+one+of+the+many+sub%0Apillars.+If+subPillarEnabled+%28defaults+to+true%29+is+false%2C+no+sub+pillars+are+selected.+If+sub+pillars+are%0Aenabled%2C+the+pillar+itself+is+also+included+and+the+properties+minimumSubPillarSize+%28defaults+to+1%29+and%0AmaximumSubPillarSize+%28defaults+to+infinity%29+limit+the+size+of+the+selected+%28sub%29+pillar.%0AThe+number+of+sub+pillars+of+a+pillar+is+exponential+to+the+size+of+the+pillar.+For%0A%EF%81%9A+example+a+pillar+of+size+32+has+%282%5E32+-+1%29+subpillars.+Therefore+a+pillarSelector%0Aonly+supports+JIT+random+selection+%28which+is+the+default%29.%0AThe+other+properties+are+explained+in+changeMoveSelector.%0A8.2.4.+pillarSwapMoveSelector%0AA+pillar+is+a+set+of+planning+entities+which+have+the+same+planning+value%28s%29+for+their+planning%0Avariable%28s%29.+The+PillarSwapMove+selects+two+different+entity+pillars+and+swaps+the+values+of+all+their%0Avariables+for+all+their+entities.%0A201%0ASimplest+configuration%3A%0A%C2%A0+++%3CpillarSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A202%0A%C2%A0+++%3CpillarSwapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CpillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CsubPillarEnabled%3Etrue%3C%2FsubPillarEnabled%3E%0A%C2%A0+++++++%3CminimumSubPillarSize%3E1%3C%2FminimumSubPillarSize%3E%0A%C2%A0+++++++%3CmaximumSubPillarSize%3E1000%3C%2FmaximumSubPillarSize%3E%0A%C2%A0+++++%3C%2FpillarSelector%3E%0A%C2%A0+++++%3CsecondaryPillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FsecondaryPillarSelector%3E%0A%C2%A0+++++%3CvariableNameInclude%3Eroom%3C%2FvariableNameInclude%3E%0A%C2%A0+++++%3CvariableNameInclude%3E...%3C%2FvariableNameInclude%3E%0A%C2%A0+++%3C%2FpillarSwapMoveSelector%3E%0AThe+secondaryPillarSelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0ApillarSelector+are+swapped.%0AThe+other+properties+are+explained+in+swapMoveSelector+and+pillarChangeMoveSelector.%0A8.2.5.+tailChainSwapMoveSelector+or+2-opt+%28chained+variables+only%29%0AA+tailChain+is+a+set+of+planning+entities+with+a+chained+planning+variable+which+form+a+last+part+of+a%0Achain.+The+tailChainSwapMove+selects+a+tail+chain+and+swaps+it+with+the+tail+chain+of+another%0Aplanning+value+%28in+a+different+or+the+same+anchor+chain%29.+If+the+targeted+planning+value%2C+doesn%E2%80%99t%0Ahave+a+tail+chain%2C+it+swaps+with+nothing+%28resulting+in+a+change+like+move%29.+If+it+occurs+within+the%0Asame+anchor+chain%2C+a+partial+chain+reverse+occurs.+In+academic+papers%2C+this+is+often+called+a+2-opt%0Amove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CtailChainSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A203%0A%C2%A0+++%3CsubChainChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FsubChainChangeMoveSelector%3E%0AThe+entitySelector+selects+the+start+of+the+tail+chain+that+is+being+moved.+The+valueSelector+selects%0Ato+where+that+tail+chain+is+moved.+If+it+has+a+tail+chain+itself%2C+that+is+moved+to+the+location+of+the%0Aoriginal+tail+chain.+It+uses+a+valueSelector+instead+of+a+secondaryEntitySelector+to+be+able+to+include%0Aall+possible+2opt+moves+%28such+as+moving+to+the+end+of+a+tail%29+and+to+work+correctly+with+nearby%0Aselection+%28because+of+asymmetric+distances+and+also+swapped+entity+distance+gives+an+incorrect%0Aselection+probability%29.%0AAlthough+subChainChangeMoveSelector+and+subChainSwapMoveSelector+include+almost%0A%EF%81%9A+every+possible+tailChainSwapMove%2C+experiments+have+shown+that+focusing+on%0AtailChainSwapMoves+increases+efficiency.%0A8.2.6.+subChainChangeMoveSelector+%28chained+variables+only%29%0AA+subChain+is+a+set+of+planning+entities+with+a+chained+planning+variable+which+form+part+of+a%0Achain.+The+subChainChangeMoveSelector+selects+a+subChain+and+moves+it+to+another+place+%28in+a%0Adifferent+or+the+same+anchor+chain%29.%0ASimplest+configuration%3A%0A%C2%A0+++%3CsubChainChangeMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A204%0A%C2%A0+++%3CsubChainChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++%3CsubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsubChainSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3CselectReversingMoveToo%3Etrue%3C%2FselectReversingMoveToo%3E%0A%C2%A0+++%3C%2FsubChainChangeMoveSelector%3E%0AThe+subChainSelector+selects+a+number+of+entities%2C+no+less+than+minimumSubChainSize+%28defaults+to+1%29%0Aand+no+more+than+maximumSubChainSize+%28defaults+to+infinity%29.%0AIf+minimumSubChainSize+is+1+%28which+is+the+default%29%2C+this+selector+might+select+the+same%0Amove+as+a+ChangeMoveSelector%2C+at+a+far+lower+selection+probability+%28because+each%0Amove+type+has+the+same+selection+chance+by+default+%28not+every+move+instance%29+and%0Athere+are+far+more+SubChainChangeMove+instances+than+ChangeMove+instances%29.%0A%EF%81%9A+However%2C+don%E2%80%99t+just+remove+the+ChangeMoveSelector%2C+because+experiments+show%0Athat+it%E2%80%99s+good+to+focus+on+ChangeMoves.%0AFurthermore%2C+in+a+SubChainSwapMoveSelector%2C+setting+minimumSubChainSize+prevents%0Aswapping+a+subchain+of+size+1+with+a+subchain+of+at+least+size+2.%0AThe+selectReversingMoveToo+property+%28defaults+to+true%29+enables+selecting+the+reverse+of+every%0Asubchain+too.%0A8.2.7.+subChainSwapMoveSelector+%28chained+variables+only%29%0AThe+subChainSwapMoveSelector+selects+two+different+subChains+and+moves+them+to+another+place+in+a%0Adifferent+or+the+same+anchor+chain.%0ASimplest+configuration%3A%0A%C2%A0+++%3CsubChainSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A205%0A%C2%A0+++%3CsubChainSwapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++%3CsubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsubChainSelector%3E%0A%C2%A0+++++%3CsecondarySubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsecondarySubChainSelector%3E%0A%C2%A0+++++%3CselectReversingMoveToo%3Etrue%3C%2FselectReversingMoveToo%3E%0A%C2%A0+++%3C%2FsubChainSwapMoveSelector%3E%0AThe+secondarySubChainSelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0AsubChainSelector+are+swapped.%0AThe+other+properties+are+explained+in+subChainChangeMoveSelector.%0A8.3.+Combining+Multiple+MoveSelectors%0A8.3.1.+unionMoveSelector%0AA+unionMoveSelector+selects+a+Move+by+selecting+one+of+its+MoveSelector+children+to+supply+the+next%0AMove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AAdvanced+configuration%3A%0A206%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CselectorProbabilityWeightFactoryClass%3E%0A...ProbabilityWeightFactory%3C%2FselectorProbabilityWeightFactoryClass%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2F...MoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AThe+selectorProbabilityWeightFactory+determines+in+selectionOrder+RANDOM+how+often+a%0AMoveSelector+child+is+selected+to+supply+the+next+Move.+By+default%2C+each+MoveSelector+child+has+the%0Asame+chance+of+being+selected.%0A207%0AChange+the+fixedProbabilityWeight+of+such+a+child+to+select+it+more+often.+For+example%2C+the%0AunionMoveSelector+can+return+a+SwapMove+twice+as+often+as+a+ChangeMove%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E1.0%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E2.0%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AThe+number+of+possible+ChangeMoves+is+very+different+from+the+number+of+possible+SwapMoves+and%0Afurthermore+it%E2%80%99s+problem+dependent.+To+give+each+individual+Move+the+same+selection+chance+%28as%0Aopposed+to+each+MoveSelector%29%2C+use+the+FairSelectorProbabilityWeightFactory%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0%0A%3CselectorProbabilityWeightFactoryClass%3Eorg.optaplanner.core.impl.heuristic.selector.co%0Ammon.decorator.FairSelectorProbabilityWeightFactory%3C%2FselectorProbabilityWeightFactoryC%0Alass%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.3.2.+cartesianProductMoveSelector%0AA+cartesianProductMoveSelector+selects+a+new+CompositeMove.+It+builds+that+CompositeMove+by+selecting%0Aone+Move+per+MoveSelector+child+and+adding+it+to+the+CompositeMove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0AAdvanced+configuration%3A%0A208%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CignoreEmptyChildIterators%3Etrue%3C%2FignoreEmptyChildIterators%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2F...MoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0AThe+ignoreEmptyChildIterators+property+%28true+by+default%29+will+ignore+every+empty+childMoveSelector%0Ato+avoid+returning+no+moves.+For+example%3A+a+cartesian+product+of+changeMoveSelector+A+and+B%2C+for%0Awhich+B+is+empty+%28because+all+it%E2%80%99s+entities+are+immovable%29+returns+no+move+if%0AignoreEmptyChildIterators+is+false+and+the+moves+of+A+if+ignoreEmptyChildIterators+is+true.%0ATo+enforce+that+two+child+selectors+use+the+same+entity+or+value+efficiently%2C+use+mimic+selection%2C+not%0Amove+filtering.%0A8.4.+EntitySelector%0ASimplest+configuration%3A%0A%C2%A0+++++%3CentitySelector%2F%3E%0AAdvanced+configuration%3A%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++++%3CentityClass%3E%0Aorg.optaplanner.examples.curriculumcourse.domain.Lecture%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0AThe+entityClass+property+is+only+required+if+it+cannot+be+deduced+automatically+because+there+are%0Amultiple+entity+classes.%0A8.5.+ValueSelector%0ASimplest+configuration%3A%0A209%0A%C2%A0+++++%3CvalueSelector%2F%3E%0AAdvanced+configuration%3A%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0AThe+variableName+property+is+only+required+if+it+cannot+be+deduced+automatically+because+there+are%0Amultiple+variables+%28for+the+related+entity+class%29.%0AIn+exotic+Construction+Heuristic+configurations%2C+the+entityClass+from+the+EntitySelector+sometimes%0Aneeds+to+be+downcasted%2C+which+can+be+done+with+the+property+downcastEntityClass%3A%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22period%22%3E%0A%C2%A0+++++++%3CdowncastEntityClass%3E...LeadingExam%3C%2FdowncastEntityClass%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0AIf+a+selected+entity+cannot+be+downcasted%2C+the+ValueSelector+is+empty+for+that+entity.%0A8.6.+General+Selector+Features%0A8.6.1.+CacheType%3A+Create+Moves+Ahead+of+Time+or+Just+In+Time%0AA+Selector%27s+cacheType+determines+when+a+selection+%28such+as+a+Move%2C+an+entity%2C+a+value%2C+%E2%80%A6%29+is+created%0Aand+how+long+it+lives.%0AAlmost+every+Selector+supports+setting+a+cacheType%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AThe+following+cacheTypes+are+supported%3A%0A%E2%80%A2+JUST_IN_TIME+%28default%29%3A+Not+cached.+Construct+each+selection+%28Move%2C+%E2%80%A6%29+just+before+it%E2%80%99s+used.+This%0Ascales+up+well+in+memory+footprint.%0A%E2%80%A2+STEP%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+step+and+cache+them+in+a+list%0Afor+the+remainder+of+the+step.+This+scales+up+badly+in+memory+footprint.%0A%E2%80%A2+PHASE%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+solver+phase+and+cache+them%0Ain+a+list+for+the+remainder+of+the+phase.+Some+selections+cannot+be+phase+cached+because+the+list%0Achanges+every+step.+This+scales+up+badly+in+memory+footprint%2C+but+has+a+slight+performance%0Again.%0A210%0A%E2%80%A2+SOLVER%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+Solver+and+cache+them+in+a%0Alist+for+the+remainder+of+the+Solver.+Some+selections+cannot+be+solver+cached+because+the+list%0Achanges+every+step.+This+scales+up+badly+in+memory+footprint%2C+but+has+a+slight+performance%0Again.%0AA+cacheType+can+be+set+on+composite+selectors+too%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0ANested+selectors+of+a+cached+selector+cannot+be+configured+to+be+cached+themselves%2C+unless+it%E2%80%99s+a%0Ahigher+cacheType.+For+example%3A+a+STEP+cached+unionMoveSelector+can+hold+a+PHASE+cached%0AchangeMoveSelector%2C+but+not+a+STEP+cached+changeMoveSelector.%0A8.6.2.+SelectionOrder%3A+Original%2C+Sorted%2C+Random%2C+Shuffled+or+Probabilistic%0AA+Selector%27s+selectionOrder+determines+the+order+in+which+the+selections+%28such+as+Moves%2C+entities%2C%0Avalues%2C+%E2%80%A6%29+are+iterated.+An+optimization+algorithm+will+usually+only+iterate+through+a+subset+of+its%0AMoveSelector%27s+selections%2C+starting+from+the+start%2C+so+the+selectionOrder+is+critical+to+decide+which%0AMoves+are+actually+evaluated.%0AAlmost+every+Selector+supports+setting+a+selectionOrder%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AThe+following+selectionOrders+are+supported%3A%0A%E2%80%A2+ORIGINAL%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+default+order.+Each+selection+will+be%0Aselected+only+once.%0A%E2%97%A6+For+example%3A+A0%2C+A1%2C+A2%2C+A3%2C+%E2%80%A6%2C+B0%2C+B1%2C+B2%2C+B3%2C+%E2%80%A6%2C+C0%2C+C1%2C+C2%2C+C3%2C+%E2%80%A6%0A%E2%80%A2+SORTED%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+sorted+order.+Each+selection+will+be%0Aselected+only+once.+Requires+cacheType+%3E%3D+STEP.+Mostly+used+on+an+entitySelector+or%0AvalueSelector+for+construction+heuristics.+See+sorted+selection.%0A%E2%97%A6+For+example%3A+A0%2C+B0%2C+C0%2C+%E2%80%A6%2C+A2%2C+B2%2C+C2%2C+%E2%80%A6%2C+A1%2C+B1%2C+C1%2C+%E2%80%A6%0A%E2%80%A2+RANDOM+%28default%29%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+non-shuffled+random%0Aorder.+A+selection+might+be+selected+multiple+times.+This+scales+up+well+in+performance+because%0Ait+does+not+require+caching.%0A211%0A%E2%97%A6+For+example%3A+C2%2C+A3%2C+B1%2C+C2%2C+A0%2C+C0%2C+%E2%80%A6%0A%E2%80%A2+SHUFFLED%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+shuffled+random+order.+Each%0Aselection+will+be+selected+only+once.+Requires+cacheType+%3E%3D+STEP.+This+scales+up+badly+in%0Aperformance%2C+not+just+because+it+requires+caching%2C+but+also+because+a+random+number+is%0Agenerated+for+each+element%2C+even+if+it%E2%80%99s+not+selected+%28which+is+the+grand+majority+when+scaling%0Aup%29.%0A%E2%97%A6+For+example%3A+C2%2C+A3%2C+B1%2C+A0%2C+C0%2C+%E2%80%A6%0A%E2%80%A2+PROBABILISTIC%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+random+order%2C+based+on+the%0Aselection+probability+of+each+element.+A+selection+with+a+higher+probability+has+a+higher+chance%0Ato+be+selected+than+elements+with+a+lower+probability.+A+selection+might+be+selected+multiple%0Atimes.+Requires+cacheType+%3E%3D+STEP.+Mostly+used+on+an+entitySelector+or+valueSelector.+See%0Aprobabilistic+selection.%0A%E2%97%A6+For+example%3A+B1%2C+B1%2C+A1%2C+B2%2C+B1%2C+C2%2C+B1%2C+B1%2C+%E2%80%A6%0AA+selectionOrder+can+be+set+on+composite+selectors+too.%0AWhen+a+Selector+is+cached%2C+all+of+its+nested+Selectors+will+naturally+default+to%0A%EF%81%9A+selectionOrder+ORIGINAL.+Avoid+overwriting+the+selectionOrder+of+those+nested%0ASelectors.%0A8.6.3.+Recommended+Combinations+of+CacheType+and+SelectionOrder%0A8.6.3.1.+Just+in+Time+Random+Selection+%28default%29%0AThis+combination+is+great+for+big+use+cases+%2810+000+entities+or+more%29%2C+as+it+scales+up+well+in+memory%0Afootprint+and+performance.+Other+combinations+are+often+not+even+viable+on+such+sizes.+It+works%0Afor+smaller+use+cases+too%2C+so+it%E2%80%99s+a+good+way+to+start+out.+It%E2%80%99s+the+default%2C+so+this+explicit+configuration%0Aof+cacheType+and+selectionOrder+is+actually+obsolete%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EJUST_IN_TIME%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AHere%E2%80%99s+how+it+works.+When+Iterator%3CMove%3E.next%28%29+is+called%2C+a+child+MoveSelector+is+randomly%0Aselected+%281%29%2C+which+creates+a+random+Move+%282%2C+3%2C+4%29+and+is+then+returned+%285%29%3A%0A212%0ANotice+that+it+never+creates+a+list+of+Moves+and+it+generates+random+numbers+only+for+Moves+that+are%0Aactually+selected.%0A8.6.3.2.+Cached+Shuffled+Selection%0AThis+combination+often+wins+for+small+and+medium+use+cases+%285000+entities+or+less%29.+Beyond+that%0Asize%2C+it+scales+up+badly+in+memory+footprint+and+performance.%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESHUFFLED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AHere%E2%80%99s+how+it+works%3A+At+the+start+of+the+phase+%28or+step+depending+on+the+cacheType%29%2C+all+moves+are%0Acreated+%281%29+and+cached+%282%29.+When+MoveSelector.iterator%28%29+is+called%2C+the+moves+are+shuffled+%283%29.%0AWhen+Iterator%3CMove%3E.next%28%29+is+called%2C+the+next+element+in+the+shuffled+list+is+returned+%284%29%3A%0A213%0ANotice+that+each+Move+will+only+be+selected+once%2C+even+though+they+are+selected+in+random+order.%0AUse+cacheType+PHASE+if+none+of+the+%28possibly+nested%29+Selectors+require+STEP.+Otherwise%2C+do%0Asomething+like+this%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3ESTEP%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESHUFFLED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3CpillarSwapMoveSelector%2F%3E%3C%21--+Does+not+support+cacheType+PHASE+--%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.6.3.3.+Cached+Random+Selection%0AThis+combination+is+often+a+worthy+competitor+for+medium+use+cases%2C+especially+with+fast+stepping%0Aoptimization+algorithms+%28such+as+Simulated+Annealing%29.+Unlike+cached+shuffled+selection%2C+it+doesn%E2%80%99t%0Awaste+time+shuffling+the+moves+list+at+the+beginning+of+every+step.%0A214%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.6.4.+Filtered+Selection%0AThere+can+be+certain+moves+that+you+don%E2%80%99t+want+to+select%2C+because%3A%0A%E2%80%A2+The+move+is+pointless+and+would+only+waste+CPU+time.+For+example%2C+swapping+two+lectures+of%0Athe+same+course+will+result+in+the+same+score+and+the+same+schedule+because+all+lectures+of+one%0Acourse+are+interchangeable+%28same+teacher%2C+same+students%2C+same+topic%29.%0A%E2%80%A2+Doing+the+move+would+break+a+built-in+hard+constraint%2C+so+the+solution+would+be+infeasible+but%0Athe+score+function+doesn%E2%80%99t+check+built-in+hard+constraints+%28for+performance+gain%29.+For+example%2C%0Adon%E2%80%99t+change+a+gym+lecture+to+a+room+which+is+not+a+gym+room.%0AAny+built-in+hard+constraint+must+probably+be+filtered+on+every+move+type+of%0Aevery+solver+phase.+For+example+if+it+filters+the+change+move+of+Local+Search%2C+it%0Amust+also+filter+the+swap+move+that+swaps+the+room+of+a+gym+lecture+with%0A%EF%81%9A+another+lecture+for+which+the+other+lecture%E2%80%99s+original+room+isn%E2%80%99t+a+gym+room.%0AFurthermore%2C+it+must+also+filter+the+change+moves+of+the+Construction%0AHeuristics+%28which+requires+an+advanced+configuration%29.%0AIf+a+move+is+unaccepted+by+the+filter%2C+it%E2%80%99s+not+executed+and+the+score+isn%E2%80%99t+calculated.%0A215%0AFiltering+uses+the+interface+SelectionFilter%3A%0Apublic+interface+SelectionFilter%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++boolean+accept%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+T+selection%29%3B%0A%7D%0AImplement+the+accept+method+to+return+false+on+a+discarded+selection+%28see+below%29.+Filtered%0Aselection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+works+with+any+cacheType+and+selectionOrder.%0AApply+the+filter+on+the+lowest+level+possible.+In+most+cases%2C+you%E2%80%99ll+need+to+know%0A%EF%81%9A+both+the+entity+and+the+value+involved+so+you%E2%80%99ll+have+to+apply+it+on+the+move%0Aselector.%0A8.6.4.1.+Filtered+Move+Selection%0AUnaccepted+moves+will+not+be+selected+and+will+therefore+never+have+their+doMove%28%29+method+called%3A%0A216%0Apublic+class+DifferentCourseSwapMoveFilter+implements+SelectionFilter%3CSwapMove%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector+scoreDirector%2C+SwapMove+move%29+%7B%0A%C2%A0+++++++Lecture+leftLecture+%3D+%28Lecture%29+move.getLeftEntity%28%29%3B%0A%C2%A0+++++++Lecture+rightLecture+%3D+%28Lecture%29+move.getRightEntity%28%29%3B%0A%C2%A0+++++++return+%21leftLecture.getCourse%28%29.equals%28rightLecture.getCourse%28%29%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+moveSelector+%28potentially+both+in+the+Local+Search+and%0Athe+Construction+Heuristics+if+it+filters+ChangeMoves%29%3A%0A%C2%A0+++%3CswapMoveSelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.DifferentCourseSwap%0AMoveFilter%3C%2FfilterClass%3E%0A%C2%A0+++%3C%2FswapMoveSelector%3E%0AYou+can+configure+multiple+filterClass+elements+on+a+single+move+selector.%0A8.6.4.2.+Filtered+Entity+Selection%0AUnaccepted+entities+will+not+be+selected+and+will+therefore+never+be+used+to+create+a+move.%0Apublic+class+LongLectureSelectionFilter+implements+SelectionFilter%3CLecture%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CCourseSchedule%3E+scoreDirector%2C+Lecture%0Alecture%29+%7B%0A%C2%A0+++++++return+lecture.isLong%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+entitySelector+%28potentially+both+in+the+Local+Search%0Aand+the+Construction+Heuristics%29%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.LongLectureSelectio%0AnFilter%3C%2FfilterClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A217%0AIf+that+filter+should+apply+on+all+entities%2C+configure+it+as+a+global+movableEntitySelectionFilter%0Ainstead.%0AYou+can+configure+multiple+filterClass+elements+on+a+single+entity+selector.%0A8.6.4.3.+Filtered+Value+Selection%0AUnaccepted+values+will+not+be+selected+and+will+therefore+never+be+used+to+create+a+move.%0Apublic+class+LongPeriodSelectionFilter+implements+SelectionFilter%3CPeriod%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CCourseSchedule%3E+scoreDirector%2C+Period+period%29%0A%7B%0A%C2%A0+++++++return+period%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+valueSelector+%28potentially+both+in+the+Local+Search+and%0Athe+Construction+Heuristics%29%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.LongPeriodSelection%0AFilter%3C%2FfilterClass%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AYou+can+configure+multiple+filterClass+elements+on+a+single+value+selector.%0A8.6.5.+Sorted+Selection%0ASorted+selection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+does+not+work+with+cacheType+JUST_IN_TIME+and+it+only+works%0Awith+selectionOrder+SORTED.%0AIt%E2%80%99s+mostly+used+in+construction+heuristics.%0AIf+the+chosen+construction+heuristic+implies+sorting%2C+for+example%0AFIRST_FIT_DECREASING+implies+that+the+EntitySelector+is+sorted%2C+there+is+no+need+to%0A%EF%81%9A+explicitly+configure+a+Selector+with+sorting.+If+you+do+explicitly+configure+the%0ASelector%2C+it+overwrites+the+default+settings+of+that+construction+heuristic.%0A8.6.5.1.+Sorted+Selection+by+SorterManner%0ASome+Selector+types+implement+a+SorterManner+out+of+the+box%3A%0A218%0A%E2%80%A2+EntitySelector+supports%3A%0A%E2%97%A6+DECREASING_DIFFICULTY%3A+Sorts+the+planning+entities+according+to+decreasing+planning+entity%0Adifficulty.+Requires+that+planning+entity+difficulty+is+annotated+on+the+domain+model.%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A%E2%80%A2+ValueSelector+supports%3A%0A%E2%97%A6+INCREASING_STRENGTH%3A+Sorts+the+planning+values+according+to+increasing+planning+value%0Astrength.+Requires+that+planning+value+strength+is+annotated+on+the+domain+model.%0A%C2%A0+++%3CvalueSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++%3C%2FvalueSelector%3E%0A8.6.5.2.+Sorted+Selection+by+Comparator%0AAn+easy+way+to+sort+a+Selector+is+with+a+plain+old+Comparator%3A%0Apublic+class+CloudProcessDifficultyComparator+implements+Comparator%3CCloudProcess%3E+%7B%0A%C2%A0+++public+int+compare%28CloudProcess+a%2C+CloudProcess+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getRequiredMultiplicand%28%29%2C+b.getRequiredMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AYou%E2%80%99ll+also+need+to+configure+it+%28unless+it%E2%80%99s+annotated+on+the+domain+model+and+automatically%0Aapplied+by+the+optimization+algorithm%29%3A%0A219%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterComparatorClass%3E%0A...CloudProcessDifficultyComparator%3C%2FsorterComparatorClass%3E%0A%C2%A0+++++%3CsorterOrder%3EDESCENDING%3C%2FsorterOrder%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A8.6.5.3.+Sorted+Selection+by+SelectionSorterWeightFactory%0AIf+you+need+the+entire+Solution+to+sort+a+Selector%2C+use+a+SelectionSorterWeightFactory+instead%3A%0Apublic+interface+SelectionSorterWeightFactory%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++Comparable+createSorterWeight%28Solution_+solution%2C+T+selection%29%3B%0A%7D%0A220%0Apublic+class+QueenDifficultyWeightFactory+implements+SelectionSorterWeightFactory%0A%3CNQueens%2C+Queen%3E+%7B%0A%C2%A0+++public+QueenDifficultyWeight+createSorterWeight%28NQueens+nQueens%2C+Queen+queen%29+%7B%0A%C2%A0+++++++int+distanceFromMiddle+%3D+calculateDistanceFromMiddle%28nQueens.getN%28%29%2C+queen%0A.getColumnIndex%28%29%29%3B%0A%C2%A0+++++++return+new+QueenDifficultyWeight%28queen%2C+distanceFromMiddle%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%C2%A0+++public+static+class+QueenDifficultyWeight+implements+Comparable%0A%3CQueenDifficultyWeight%3E+%7B%0A%C2%A0+++++++private+final+Queen+queen%3B%0A%C2%A0+++++++private+final+int+distanceFromMiddle%3B%0A%C2%A0+++++++public+QueenDifficultyWeight%28Queen+queen%2C+int+distanceFromMiddle%29+%7B%0A%C2%A0+++++++++++this.queen+%3D+queen%3B%0A%C2%A0+++++++++++this.distanceFromMiddle+%3D+distanceFromMiddle%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++public+int+compareTo%28QueenDifficultyWeight+other%29+%7B%0A%C2%A0+++++++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++++++%2F%2F+The+more+difficult+queens+have+a+lower+distance+to+the+middle%0A%C2%A0+++++++++++++++++++.append%28other.distanceFromMiddle%2C+distanceFromMiddle%29+%2F%2F%0ADecreasing%0A%C2%A0+++++++++++++++++++%2F%2F+Tie+breaker%0A%C2%A0+++++++++++++++++++.append%28queen.getColumnIndex%28%29%2C+other.queen.getColumnIndex%28%29%29%0A%C2%A0+++++++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AYou%E2%80%99ll+also+need+to+configure+it+%28unless+it%E2%80%99s+annotated+on+the+domain+model+and+automatically%0Aapplied+by+the+optimization+algorithm%29%3A%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterWeightFactoryClass%3E%0A...QueenDifficultyWeightFactory%3C%2FsorterWeightFactoryClass%3E%0A%C2%A0+++++%3CsorterOrder%3EDESCENDING%3C%2FsorterOrder%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A221%0A8.6.5.4.+Sorted+Selection+by+SelectionSorter%0AAlternatively%2C+you+can+also+use+the+interface+SelectionSorter+directly%3A%0Apublic+interface+SelectionSorter%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++void+sort%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+List%3CT%3E+selectionList%29%3B%0A%7D%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterClass%3E...MyEntitySorter%3C%2FsorterClass%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A8.6.6.+Probabilistic+Selection%0AProbabilistic+selection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+does+not+work+with+cacheType+JUST_IN_TIME+and+it+only+works%0Awith+selectionOrder+PROBABILISTIC.%0A222%0AEach+selection+has+a+probabilityWeight%2C+which+determines+the+chance+that+selection+will+be+selected%3A%0Apublic+interface+SelectionProbabilityWeightFactory%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++double+createProbabilityWeight%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+T%0Aselection%29%3B%0A%7D%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3EPROBABILISTIC%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CprobabilityWeightFactoryClass%3E%0A...MyEntityProbabilityWeightFactoryClass%3C%2FprobabilityWeightFactoryClass%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0AFor+example%2C+if+there+are+three+entities%3A+process+A+%28probabilityWeight+2.0%29%2C+process+B%0A%28probabilityWeight+0.5%29+and+process+C+%28probabilityWeight+0.5%29%2C+then+process+A+will+be+selected+four%0Atimes+more+than+B+and+C.%0A8.6.7.+Limited+Selection%0ASelecting+all+possible+moves+sometimes+does+not+scale+well+enough%2C+especially+for+construction%0Aheuristics+%28which+don%E2%80%99t+support+acceptedCountLimit%29.%0ATo+limit+the+number+of+selected+selection+per+step%2C+apply+a+selectedCountLimit+on+the+selector%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CselectedCountLimit%3E100%3C%2FselectedCountLimit%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0ATo+scale+Local+Search%2C+setting+acceptedCountLimit+is+usually+better+than+using%0A%EF%81%9A+selectedCountLimit.%0A8.6.8.+Mimic+Selection+%28Record%2FReplay%29%0ADuring+mimic+selection%2C+one+normal+selector+records+its+selection+and+one+or+multiple+other+special%0Aselectors+replay+that+selection.+The+recording+selector+acts+as+a+normal+selector+and+supports+all%0Aother+configuration+properties.+A+replaying+selector+mimics+the+recording+selection+and+supports+no%0Aother+configuration+properties.%0AThe+recording+selector+needs+an+id.+A+replaying+selector+must+reference+a+recorder%E2%80%99s+id+with+a%0AmimicSelectorRef%3A%0A223%0A%C2%A0+++++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++++%3CentitySelector+id%3D%22entitySelector%22%2F%3E%0A%C2%A0+++++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++++%3CentitySelector+mimicSelectorRef%3D%22entitySelector%22%2F%3E%0A%C2%A0+++++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3C%2FcartesianProductMoveSelector%3E%0AMimic+selection+is+useful+to+create+a+composite+move+from+two+moves+that+affect+the+same+entity.%0A8.6.9.+Nearby+Selection%0AIn+some+use+cases+%28such+as+TSP+and+VRP%2C+but+also+in+non-chained+variable+cases%29%2C+changing+entities%0Ato+nearby+values+or+swapping+nearby+entities+can+heavily+increase+scalability+and+improve%0Asolution+quality.%0ANearby+selection+increases+the+probability+of+selecting+an+entity+or+value+which+is+nearby+to+the+first%0Aentity+being+moved+in+that+move.%0A224%0AThe+distance+between+two+entities+or+values+is+domain+specific.+Therefore%2C+implement+the%0ANearbyDistanceMeter+interface%3A%0Apublic+interface+NearbyDistanceMeter%3CO%2C+D%3E+%7B%0A%C2%A0+++double+getNearbyDistance%28O+origin%2C+D+destination%29%3B%0A%7D%0AIt+returns+a+double+which+represents+the+distance%3A%0Apublic+class+CustomerNearbyDistanceMeter+implements+NearbyDistanceMeter%3CCustomer%2C%0AStandstill%3E+%7B%0A%C2%A0+++public+double+getNearbyDistance%28Customer+origin%2C+Standstill+destination%29+%7B%0A%C2%A0+++++++return+origin.getDistanceTo%28destination%29%3B%0A%C2%A0+++%7D%0A%7D%0ATo+configure+nearby+selection%2C+add+a+nearbySelection+element+in+the+entitySelector+or+valueSelector%0Aand+use+mimic+selection+to+specify+which+entity+should+be+near+by+the+selection.%0A225%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector1%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector1%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector2%22%2F%3E%0A%C2%A0+++++++%3CsecondaryEntitySelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector2%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FsecondaryEntitySelector%3E%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3CtailChainSwapMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector3%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector3%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FtailChainSwapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AA+distributionSizeMaximum+parameter+should+not+be+1+because+if+the+nearest+is+already+the+planning%0Avalue+of+the+current+entity%2C+then+the+only+move+that+is+selectable+is+not+doable.%0ATo+allow+every+element+to+be+selected%2C+regardless+of+the+number+of+entities%2C+only+set+the+distribution%0Atype+%28so+without+a+distributionSizeMaximum+parameter%29%3A%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CnearbySelectionDistributionType%3E%0APARABOLIC_DISTRIBUTION%3C%2FnearbySelectionDistributionType%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0AThe+following+NearbySelectionDistributionTypes+are+supported%3A%0A226%0A%E2%80%A2+BLOCK_DISTRIBUTION%3A+Only+the+n+nearest+are+selected%2C+with+an+equal+probability.+For+example%2C%0Aselect+the+20+nearest%3A%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CblockDistributionSizeMaximum%3E20%3C%2FblockDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+LINEAR_DISTRIBUTION%3A+Nearest+elements+are+selected+with+a+higher+probability.+The+probability%0Adecreases+linearly.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3ClinearDistributionSizeMaximum%3E40%3C%2FlinearDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+PARABOLIC_DISTRIBUTION+%28recommended%29%3A+Nearest+elements+are+selected+with+a+higher%0Aprobability.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CparabolicDistributionSizeMaximum%3E80%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+BETA_DISTRIBUTION%3A+Selection+according+to+a+beta+distribution.+Slows+down+the+solver%0Asignificantly.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CbetaDistributionAlpha%3E1%3C%2FbetaDistributionAlpha%3E%0A%C2%A0+++%3CbetaDistributionBeta%3E5%3C%2FbetaDistributionBeta%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0AAs+always%2C+use+the+Benchmarker+to+tweak+values+if+desired.%0A8.7.+Custom+Moves%0A8.7.1.+Which+Move+Types+Might+be+Missing+in+my+Implementation%3F%0ATo+determine+which+move+types+might+be+missing+in+your+implementation%2C+run+a+Benchmarker+for%0Aa+short+amount+of+time+and+configure+it+to+write+the+best+solutions+to+disk.+Take+a+look+at+such+a+best%0Asolution%3A+it+will+likely+be+a+local+optima.+Try+to+figure+out+if+there%E2%80%99s+a+move+that+could+get+out+of+that%0Alocal+optima+faster.%0AIf+you+find+one%2C+implement+that+coarse-grained+move%2C+mix+it+with+the+existing+moves+and%0Abenchmark+it+against+the+previous+configurations+to+see+if+you+want+to+keep+it.%0A227%0A8.7.2.+Custom+Moves+Introduction%0AInstead+of+using+the+generic+Moves+%28such+as+ChangeMove%29+you+can+also+implement+your+own+Move.%0AGeneric+and+custom+MoveSelectors+can+be+combined+as+desired.%0AA+custom+Move+can+be+tailored+to+work+to+the+advantage+of+your+constraints.+For+example+in%0Aexamination+scheduling%2C+changing+the+period+of+an+exam+A+would+also+change+the+period+of+all+the%0Aother+exams+that+need+to+coincide+with+exam+A.%0AA+custom+Move+is+also+slightly+faster+than+a+generic+Move.+However%2C+it%E2%80%99s+far+more+work+to+implement%0Aand+much+harder+to+avoid+bugs.+After+implementing+a+custom+Move%2C+turn+on+environmentMode%0AFULL_ASSERT+to+check+for+score+corruptions.%0A8.7.3.+The+Interface+Move%0AAll+moves+implement+the+Move+interface%3A%0Apublic+interface+Move%3CSolution_%3E+%7B%0A%C2%A0+++boolean+isMoveDoable%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Move%3CSolution_%3E+doMove%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++...%0A%7D%0ATo+implement+a+custom+move%2C+it%E2%80%99s+recommended+to+extend+AbstractMove+instead+implementing+Move%0Adirectly.+Planner+calls+AbstractMove.doMove%28ScoreDirector%29%2C+which+calls%0AdoMoveOnGenuineVariables%28ScoreDirector%29.+For+example+in+cloud+balancing%2C+this+move+changes+one%0Aprocess+to+another+computer%3A%0A228%0Apublic+class+CloudComputerChangeMove+extends+AbstractMove%3CCloudBalance%3E+%7B%0A%C2%A0+++private+CloudProcess+cloudProcess%3B%0A%C2%A0+++private+CloudComputer+toCloudComputer%3B%0A%C2%A0+++public+CloudComputerChangeMove%28CloudProcess+cloudProcess%2C+CloudComputer%0AtoCloudComputer%29+%7B%0A%C2%A0+++++++this.cloudProcess+%3D+cloudProcess%3B%0A%C2%A0+++++++this.toCloudComputer+%3D+toCloudComputer%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++protected+void+doMoveOnGenuineVariables%28ScoreDirector%3CCloudBalance%3E+scoreDirector%29%0A%7B%0A%C2%A0+++++++scoreDirector.beforeVariableChanged%28cloudProcess%2C+%22computer%22%29%3B%0A%C2%A0+++++++cloudProcess.setComputer%28toCloudComputer%29%3B%0A%C2%A0+++++++scoreDirector.afterVariableChanged%28cloudProcess%2C+%22computer%22%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+...%0A%7D%0AThe+implementation+must+notify+the+ScoreDirector+of+any+changes+it+makes+to+planning+entity%E2%80%99s%0Avariables%3A+Call+the+scoreDirector.beforeVariableChanged%28Object%2C+String%29+and%0AscoreDirector.afterVariableChanged%28Object%2C+String%29+methods+directly+before+and+after+modifying%0Aan+entity%E2%80%99s+planning+variable.%0AThe+example+move+above+is+a+fine-grained+move+because+it+changes+only+one+planning+variable.+On%0Athe+other+hand%2C+a+coarse-grained+move+changes+multiple+entities+or+multiple+planning+variables+in+a%0Asingle+move%2C+usually+to+avoid+breaking+hard+constraints+by+making+multiple+related+changes+at%0Aonce.+For+example%2C+a+swap+move+is+really+just+two+change+moves%2C+but+it+keeps+those+two+changes%0Atogether.%0AA+Move+can+only+change%2Fadd%2Fremove+planning+entities%2C+it+must+not+change+any+of%0A%EF%81%B1+the+problem+facts+as+that+will+cause+score+corruption.+Use+real-time+planning+to%0Achange+problem+facts+while+solving.%0APlanner+automatically+filters+out+non+doable+moves+by+calling+the+isMoveDoable%28ScoreDirector%29%0Amethod+on+each+selected+move.+A+non+doable+move+is%3A%0A%E2%80%A2+A+move+that+changes+nothing+on+the+current+solution.+For+example%2C+moving+process+P1+on%0Acomputer+X+to+computer+X+is+not+doable%2C+because+it+is+already+there.%0A%E2%80%A2+A+move+that+is+impossible+to+do+on+the+current+solution.+For+example%2C+moving+process+P1+to%0Acomputer+Q+%28when+Q+isn%E2%80%99t+in+the+list+of+computers%29+is+not+doable+because+it+would+assign+a%0Aplanning+value+that%E2%80%99s+not+inside+the+planning+variable%E2%80%99s+value+range.%0AIn+the+cloud+balancing+example%2C+a+move+which+assigns+a+process+to+the+computer+it%E2%80%99s+already%0A229%0Aassigned+to+is+not+doable%3A%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+isMoveDoable%28ScoreDirector%3CCloudBalance%3E+scoreDirector%29+%7B%0A%C2%A0+++++++return+%21Objects.equals%28cloudProcess.getComputer%28%29%2C+toCloudComputer%29%3B%0A%C2%A0+++%7D%0AWe+don%E2%80%99t+need+to+check+if+toCloudComputer+is+in+the+value+range%2C+because+we+only+generate+moves+for%0Awhich+that+is+the+case.+A+move+that+is+currently+not+doable+can+become+doable+when+the+working%0ASolution+changes+in+a+later+step%2C+otherwise+we+probably+shouldn%E2%80%99t+have+created+it+in+the+first+place.%0AEach+move+has+an+undo+move%3A+a+move+%28normally+of+the+same+type%29+which+does+the+exact+opposite.+In%0Athe+cloud+balancing+example+the+undo+move+of+P1+%7BX+%E2%86%92+Y%7D+is+the+move+P1+%7BY+%E2%86%92+X%7D.+The+undo+move%0Aof+a+move+is+created+when+the+Move+is+being+done+on+the+current+solution%2C+before+the+genuine%0Avariables+change%3A%0A%C2%A0+++%40Override%0A%C2%A0+++public+CloudComputerChangeMove+createUndoMove%28ScoreDirector%3CCloudBalance%3E%0AscoreDirector%29+%7B%0A%C2%A0+++++++return+new+CloudComputerChangeMove%28cloudProcess%2C+cloudProcess.getComputer%28%29%29%3B%0A%C2%A0+++%7D%0ANotice+that+if+P1+would+have+already+been+moved+to+Y%2C+the+undo+move+would+create+the+move+P1+%7BY%0A%E2%86%92+Y%7D%2C+instead+of+the+move+P1+%7BY+%E2%86%92+X%7D.%0AA+solver+phase+might+do+and+undo+the+same+Move+more+than+once.+In+fact%2C+many+solver+phases+will%0Aiteratively+do+and+undo+a+number+of+moves+to+evaluate+them%2C+before+selecting+one+of+those+and%0Adoing+that+move+again+%28without+undoing+it+the+last+time%29.%0AA+Move+must+also+implement+the+getPlanningEntities%28%29+and+getPlanningValues%28%29+methods.+Those+are%0Aused+by+entity+tabu+and+value+tabu+respectively.+They+are+called+after+the+Move+has+already+been%0Adone.%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningEntities%28%29+%7B%0A%C2%A0+++++++return+Collections.singletonList%28cloudProcess%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningValues%28%29+%7B%0A%C2%A0+++++++return+Collections.singletonList%28toCloudComputer%29%3B%0A%C2%A0+++%7D%0AIf+the+Move+changes+multiple+planning+entities%2C+such+as+in+a+swap+move%2C+return+all+of+them+in%0AgetPlanningEntities%28%29+and+return+all+their+values+%28to+which+they+are+changing%29+in%0AgetPlanningValues%28%29.%0A230%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningEntities%28%29+%7B%0A%C2%A0+++++++return+Arrays.asList%28leftCloudProcess%2C+rightCloudProcess%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningValues%28%29+%7B%0A%C2%A0+++++++return+Arrays.asList%28leftCloudProcess.getComputer%28%29%2C+rightCloudProcess%0A.getComputer%28%29%29%3B%0A%C2%A0+++%7D%0AA+Move+must+implement+the+equals%28%29+and+hashCode%28%29+methods+for+move+tabu.+Two+moves+which%0Amake+the+same+change+on+a+solution%2C+should+be+equal+ideally.%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+equals%28Object+o%29+%7B%0A%C2%A0+++++++if+%28this+%3D%3D+o%29+%7B%0A%C2%A0+++++++++++return+true%3B%0A%C2%A0+++++++%7D+else+if+%28o+instanceof+CloudComputerChangeMove%29+%7B%0A%C2%A0+++++++++++CloudComputerChangeMove+other+%3D+%28CloudComputerChangeMove%29+o%3B%0A%C2%A0+++++++++++return+new+EqualsBuilder%28%29%0A%C2%A0+++++++++++++++++++.append%28cloudProcess%2C+other.cloudProcess%29%0A%C2%A0+++++++++++++++++++.append%28toCloudComputer%2C+other.toCloudComputer%29%0A%C2%A0+++++++++++++++++++.isEquals%28%29%3B%0A%C2%A0+++++++%7D+else+%7B%0A%C2%A0+++++++++++return+false%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+int+hashCode%28%29+%7B%0A%C2%A0+++++++return+new+HashCodeBuilder%28%29%0A%C2%A0+++++++++++++++.append%28cloudProcess%29%0A%C2%A0+++++++++++++++.append%28toCloudComputer%29%0A%C2%A0+++++++++++++++.toHashCode%28%29%3B%0A%C2%A0+++%7D%0ANotice+that+it+checks+if+the+other+move+is+an+instance+of+the+same+move+type.+This+instanceof+check%0Ais+important+because+a+move+will+be+compared+to+a+move+with+another+move+type+if+you+have%0Amultiple+move+selectors.%0AImplement+the+toString%28%29+method+to+keep+Planner%E2%80%99s+logs+readable%3A%0A%C2%A0+++public+String+toString%28%29+%7B%0A%C2%A0+++++++return+cloudProcess+%2B+%22+%7B%22+%2B+cloudProcess.getComputer%28%29+%2B+%22+-%3E+%22+%2B%0AtoCloudComputer+%2B+%22%7D%22%3B%0A%C2%A0+++%7D%0A231%0ANow%2C+let%E2%80%99s+generate+instances+of+this+custom+Move+class.%0ACustom+MoveListFactory+and+MoveIteratorFactory+implementations+must+ensure%0A%EF%81%B1+that+they+do+not+move+immovable+entities.%0A8.7.4.+MoveListFactory%3A+the+Easy+Way+to+Generate+Custom+Moves%0AThe+easiest+way+to+generate+custom+moves+is+by+implementing+the+interface+MoveListFactory%3A%0Apublic+interface+MoveListFactory%3CSolution_%3E+%7B%0A%C2%A0+++List%3CMove%3E+createMoveList%28Solution_+solution%29%3B%0A%7D%0AFor+example%3A%0Apublic+class+CloudComputerChangeMoveFactory+implements+MoveListFactory%3CCloudBalance%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+List%3CCloudComputerChangeMove%3E+createMoveList%28CloudBalance+cloudBalance%29+%7B%0A%C2%A0+++++++List%3CCloudComputerChangeMove%3E+moveList+%3D+new+ArrayList%3C%3E%28%29%3B%0A%C2%A0+++++++List%3CCloudComputer%3E+cloudComputerList+%3D+cloudBalance.getComputerList%28%29%3B%0A%C2%A0+++++++for+%28CloudProcess+cloudProcess+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++for+%28CloudComputer+cloudComputer+%3A+cloudComputerList%29+%7B%0A%C2%A0+++++++++++++++moveList.add%28new+CloudComputerChangeMove%28cloudProcess%2C+cloudComputer%29%0A%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+moveList%3B%0A%C2%A0+++%7D%0A%7D%0ASimple+configuration+%28which+can+be+nested+in+a+unionMoveSelector+just+like+any+other+MoveSelector%29%3A%0A%C2%A0+++%3CmoveListFactory%3E%0A%C2%A0%0A%3CmoveListFactoryClass%3Eorg.optaplanner.examples.cloudbalancing.optional.move.CloudCompu%0AterChangeMoveFactory%3C%2FmoveListFactoryClass%3E%0A%C2%A0+++%3C%2FmoveListFactory%3E%0AAdvanced+configuration%3A%0A232%0A%C2%A0+++%3CmoveListFactory%3E%0A%C2%A0+++++...+%3C%21--+Normal+moveSelector+properties+--%3E%0A%C2%A0%0A%3CmoveListFactoryClass%3Eorg.optaplanner.examples.cloudbalancing.optional.move.CloudCompu%0AterChangeMoveFactory%3C%2FmoveListFactoryClass%3E%0A%C2%A0+++%3C%2FmoveListFactory%3E%0ABecause+the+MoveListFactory+generates+all+moves+at+once+in+a+List%3CMove%3E%2C+it+does+not+support%0AcacheType+JUST_IN_TIME.+Therefore%2C+moveListFactory+uses+cacheType+STEP+by+default+and+it+scales%0Abadly.%0A8.7.5.+MoveIteratorFactory%3A+Generate+Custom+Moves+Just+in+Time%0AUse+this+advanced+form+to+generate+custom+moves+Just+In+Time+by+implementing+the%0AMoveIteratorFactory+interface%3A%0Apublic+interface+MoveIteratorFactory%3CSolution_%3E+%7B%0A%C2%A0+++long+getSize%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Iterator%3CMove%3E+createOriginalMoveIterator%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Iterator%3CMove%3E+createRandomMoveIterator%28ScoreDirector%3CSolution_%3E+scoreDirector%2C%0ARandom+workingRandom%29%3B%0A%7D%0AThe+getSize%28%29+method+must+return+an+estimation+of+the+size.+It+doesn%E2%80%99t+need+to+be+correct%2C+but+it%E2%80%99s%0Abetter+too+big+than+too+small.+The+createOriginalMoveIterator+method+is+called+if+the+selectionOrder%0Ais+ORIGINAL+or+if+it+is+cached.+The+createRandomMoveIterator+method+is+called+for+selectionOrder%0ARANDOM+combined+with+cacheType+JUST_IN_TIME.%0ADon%E2%80%99t+create+a+collection+%28array%2C+list%2C+set+or+map%29+of+Moves+when+creating+the%0A%EF%81%AA+Iterator%3CMove%3E%3A+the+whole+purpose+of+MoveIteratorFactory+over+MoveListFactory+is%0Ato+create+a+Move+just+in+time+in+a+custom+Iterator.next%28%29.%0ASimple+configuration+%28which+can+be+nested+in+a+unionMoveSelector+just+like+any+other+MoveSelector%29%3A%0A%C2%A0+++%3CmoveIteratorFactory%3E%0A%C2%A0+++++%3CmoveIteratorFactoryClass%3E...%3C%2FmoveIteratorFactoryClass%3E%0A%C2%A0+++%3C%2FmoveIteratorFactory%3E%0AAdvanced+configuration%3A%0A233%0A%C2%A0+++%3CmoveIteratorFactory%3E%0A%C2%A0+++++...+%3C%21--+Normal+moveSelector+properties+--%3E%0A%C2%A0+++++%3CmoveIteratorFactoryClass%3E...%3C%2FmoveIteratorFactoryClass%3E%0A%C2%A0+++%3C%2FmoveIteratorFactory%3E%0A234%0AChapter+9.+Exhaustive+Search%0A9.1.+Overview%0AExhaustive+Search+will+always+find+the+global+optimum+and+recognize+it+too.+That+being+said%2C+it%0Adoesn%E2%80%99t+scale+%28not+even+beyond+toy+data+sets%29+and+is+therefore+mostly+useless.%0A9.2.+Brute+Force%0A9.2.1.+Algorithm+Description%0AThe+Brute+Force+algorithm+creates+and+evaluates+every+possible+solution.%0ANotice+that+it+creates+a+search+tree+that+explodes+exponentially+as+the+problem+size+increases%2C+so+it%0Ahits+a+scalability+wall.%0ABrute+Force+is+mostly+unusable+for+a+real-world+problem+due+to+time%0A%EF%81%AA+limitations%2C+as+shown+in+scalability+of+Exhaustive+Search.%0A235%0A9.2.2.+Configuration%0ASimplest+configuration+of+Brute+Force%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRUTE_FORCE%3C%2FexhaustiveSearchType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%3C%2Fsolver%3E%0A9.3.+Branch+And+Bound%0A9.3.1.+Algorithm+Description%0ABranch+And+Bound+also+explores+nodes+in+an+exponential+search+tree%2C+but+it+investigates+more%0Apromising+nodes+first+and+prunes+away+worthless+nodes.%0AFor+each+node%2C+Branch+And+Bound+calculates+the+optimistic+bound%3A+the+best+possible+score+to+which%0Athat+node+can+lead+to.+If+the+optimistic+bound+of+a+node+is+lower+or+equal+to+the+global+pessimistic%0Abound%2C+then+it+prunes+away+that+node+%28including+the+entire+branch+of+all+its+subnodes%29.%0AAcademic+papers+use+the+term+lower+bound+instead+of+optimistic+bound+%28and+the%0Aterm+upper+bound+instead+of+pessimistic+bound%29%2C+because+they+minimize+the+score.%0A%EF%81%9A+Planner+maximizes+the+score+%28because+it+supports+combining+negative+and+positive%0Aconstraints%29.+Therefore%2C+for+clarity%2C+it+uses+different+terms%2C+as+it+would+be+confusing%0Ato+use+the+term+lower+bound+for+a+bound+which+is+always+higher.%0AFor+example%3A+at+index+14%2C+it+sets+the+global+pessimistic+bound+to+-2.+Because+all+solutions+reachable%0Afrom+the+node+visited+at+index+11+will+have+a+score+lower+or+equal+to+-2+%28the+node%E2%80%99s+optimistic%0Abound%29%2C+they+can+be+pruned+away.%0A236%0ANotice+that+Branch+And+Bound+%28much+like+Brute+Force%29+creates+a+search+tree+that+explodes%0Aexponentially+as+the+problem+size+increases.+So+it+hits+the+same+scalability+wall%2C+only+a+little+bit+later.%0ABranch+And+Bound+is+mostly+unusable+for+a+real-world+problem+due+to+time%0A%EF%81%AA+limitations%2C+as+shown+in+scalability+of+Exhaustive+Search.%0A9.3.2.+Configuration%0ASimplest+configuration+of+Branch+And+Bound%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%3C%2Fsolver%3E%0AFor+the+pruning+to+work+with+the+default+ScoreBounder%2C+the+InitializingScoreTrend%0A%EF%81%AA+should+be+set.+Especially+an+InitializingScoreTrend+of+ONLY_DOWN+%28or+at+least+has%0AONLY_DOWN+in+the+leading+score+levels%29+prunes+a+lot.%0AAdvanced+configuration%3A%0A237%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EDEPTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0AThe+nodeExplorationType+options+are%3A%0A%E2%80%A2+DEPTH_FIRST+%28default%29%3A+Explore+deeper+nodes+first+%28and+then+a+better+score+and+then+a+better%0Aoptimistic+bound%29.+Deeper+nodes+%28especially+leaf+nodes%29+often+improve+the+pessimistic+bound.+A%0Abetter+pessimistic+bound+allows+pruning+more+nodes+to+reduce+the+search+space.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EDEPTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+BREADTH_FIRST+%28not+recommended%29%3A+Explore+nodes+layer+by+layer+%28and+then+a+better+score+and%0Athen+a+better+optimistic+bound%29.+Scales+terribly+in+memory+%28and+usually+in+performance+too%29.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EBREADTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+SCORE_FIRST%3A+Explore+nodes+with+a+better+score+first+%28and+then+a+better+optimistic+bound+and%0Athen+deeper+nodes+first%29.+Might+scale+as+terribly+as+BREADTH_FIRST+in+some+cases.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3ESCORE_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+OPTIMISTIC_BOUND_FIRST%3A+Explore+nodes+with+a+better+optimistic+bound+first+%28and+then+a+better%0Ascore+and+then+deeper+nodes+first%29.+Might+scale+as+terribly+as+BREADTH_FIRST+in+some+cases.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EOPTIMISTIC_BOUND_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0AThe+entitySorterManner+options+are%3A%0A238%0A%E2%80%A2+DECREASING_DIFFICULTY%3A+Initialize+the+more+difficult+planning+entities+first.+This+usually+increases%0Apruning+%28and+therefore+improves+scalability%29.+Requires+the+model+to+support+planning+entity%0Adifficulty+comparison.%0A%E2%80%A2+DECREASING_DIFFICULTY_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+entity+difficulty%0Acomparison%2C+behave+like+DECREASING_DIFFICULTY%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Initialize+the+planning+entities+in+original+order.%0AThe+valueSorterManner+options+are%3A%0A%E2%80%A2+INCREASING_STRENGTH%3A+Evaluate+the+planning+values+in+increasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+INCREASING_STRENGTH_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+value+strength%0Acomparison%2C+behave+like+INCREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+DECREASING_STRENGTH%3A+Evaluate+the+planning+values+in+decreasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+DECREASING_STRENGTH_IF_AVAILABLE%3A+If+the+model+supports+planning+value+strength+comparison%2C%0Abehave+like+DECREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Try+the+planning+values+in+original+order.%0A9.4.+Scalability+of+Exhaustive+Search%0AExhaustive+Search+variants+suffer+from+two+big+scalability+issues%3A%0A%E2%80%A2+They+scale+terribly+memory+wise.%0A%E2%80%A2+They+scale+horribly+performance+wise.%0AAs+shown+in+these+time+spent+graphs+from+the+Benchmarker%2C+Brute+Force+and+Branch+And+Bound%0Aboth+hit+a+performance+scalability+wall.+For+example%2C+on+N+queens+it+hits+wall+at+a+few+dozen%0Aqueens%3A%0A239%0AIn+most+use+cases%2C+such+as+Cloud+Balancing%2C+the+wall+appears+out+of+thin+air%3A%0A240%0AExhaustive+Search+hits+this+wall+on+small+datasets+already%2C+so+in+production+these%0Aoptimizations+algorithms+are+mostly+useless.+Use+Construction+Heuristics+with+Local+Search%0Ainstead%3A+those+can+handle+thousands+of+queens%2Fcomputers+easily.%0AThrowing+hardware+at+these+scalability+issues+has+no+noticeable+impact.+Newer%0A%EF%81%9A+and+more+hardware+are+just+a+drop+in+the+ocean.+Moore%E2%80%99s+law+cannot+win+against%0Athe+onslaught+of+a+few+more+planning+entities+in+the+dataset.%0A241%0AChapter+10.+Construction+Heuristics%0A10.1.+Overview%0AA+construction+heuristic+builds+a+pretty+good+initial+solution+in+a+finite+length+of+time.+Its+solution%0Aisn%E2%80%99t+always+feasible%2C+but+it+finds+it+fast+so+metaheuristics+can+finish+the+job.%0AConstruction+heuristics+terminate+automatically%2C+so+there%E2%80%99s+usually+no+need+to+configure+a%0ATermination+on+the+construction+heuristic+phase+specifically.%0A10.2.+First+Fit%0A10.2.1.+Algorithm+Description%0AThe+First+Fit+algorithm+cycles+through+all+the+planning+entities+%28in+default+order%29%2C+initializing+one%0Aplanning+entity+at+a+time.+It+assigns+the+planning+entity+to+the+best+available+planning+value%2C+taking%0Athe+already+initialized+planning+entities+into+account.+It+terminates+when+all+planning+entities+have%0Abeen+initialized.+It+never+changes+a+planning+entity+after+it+has+been+assigned.%0ANotice+that+it+starts+with+putting+Queen+A+into+row+0+%28and+never+moving+it+later%29%2C+which+makes+it%0Aimpossible+to+reach+the+optimal+solution.+Suffixing+this+construction+heuristic+with+metaheuristics%0Acan+remedy+that.%0A242%0A10.2.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.3.+First+Fit+Decreasing%0A10.3.1.+Algorithm+Description%0ALike+First+Fit%2C+but+assigns+the+more+difficult+planning+entities+first%2C+because+they+are+less+likely+to+fit%0Ain+the+leftovers.+So+it+sorts+the+planning+entities+on+decreasing+difficulty.%0A243%0ARequires+the+model+to+support+planning+entity+difficulty+comparison.%0AOne+would+expect+that+this+algorithm+has+better+results+than+First+Fit.+That%E2%80%99s%0A%EF%81%9A+usually+the+case%2C+but+not+always.%0A10.3.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A244%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.4.+Weakest+Fit%0A10.4.1.+Algorithm+Description%0ALike+First+Fit%2C+but+uses+the+weaker+planning+values+first%2C+because+the+strong+planning+values+are%0Amore+likely+to+be+able+to+accommodate+later+planning+entities.+So+it+sorts+the+planning+values+on%0Aincreasing+strength.%0ARequires+the+model+to+support+planning+value+strength+comparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit.+That%E2%80%99s+often%0A%EF%81%9A+not+the+case.%0A10.4.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.5.+Weakest+Fit+Decreasing%0A10.5.1.+Algorithm+Description%0ACombines+First+Fit+Decreasing+and+Weakest+Fit.+So+it+sorts+the+planning+entities+on+decreasing%0Adifficulty+and+the+planning+values+on+increasing+strength.%0ARequires+the+model+to+support+planning+entity+difficulty+comparison+and+planning+value+strength%0Acomparison.%0A245%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+Decreasing.%0A%EF%81%9A+That%E2%80%99s+often+not+the+case.+However%2C+it+is+usually+better+than+Weakest+Fit.%0A10.5.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.6.+Strongest+Fit%0A10.6.1.+Algorithm+Description%0ALike+First+Fit%2C+but+uses+the+strong+planning+values+first%2C+because+the+strong+planning+values+are+more%0Alikely+to+have+a+lower+soft+cost+to+use.+So+it+sorts+the+planning+values+on+decreasing+strength.%0ARequires+the+model+to+support+planning+value+strength+comparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+or+Weakest+Fit.%0A%EF%81%9A+That%E2%80%99s+often+not+the+case.%0A10.6.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A246%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.7.+Strongest+Fit+Decreasing%0A10.7.1.+Algorithm+Description%0ACombines+First+Fit+Decreasing+and+Strongest+Fit.+So+it+sorts+the+planning+entities+on+decreasing%0Adifficulty+and+the+planning+values+on+decreasing+strength.%0ARequires+the+model+to+support+planning+entity+difficulty+comparison+and+planning+value+strength%0Acomparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+Decreasing+or%0A%EF%81%9A+Weakest+Fit+Decreasing.+That%E2%80%99s+often+not+the+case.+However%2C+it+is+usually+better+than%0AStrongest+Fit.%0A10.7.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A247%0A10.8.+Allocate+Entity+From+Queue%0A10.8.1.+Algorithm+Description%0AAllocate+Entity+From+Queue+is+a+versatile%2C+generic+form+of+First+Fit%2C+First+Fit+Decreasing%2C+Weakest+Fit%2C%0AWeakest+Fit+Decreasing%2C+Strongest+Fit+and+Strongest+Fit+Decreasing.+It+works+like+this%3A%0A1.+Put+all+entities+in+a+queue.%0A2.+Assign+the+first+entity+%28from+that+queue%29+to+the+best+value.%0A3.+Repeat+until+all+entities+are+assigned.%0A10.8.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_ENTITY_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_ENTITY_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+entitySorterManner+options+are%3A%0A%E2%80%A2+DECREASING_DIFFICULTY%3A+Initialize+the+more+difficult+planning+entities+first.+This+usually+increases%0Apruning+%28and+therefore+improves+scalability%29.+Requires+the+model+to+support+planning+entity%0Adifficulty+comparison.%0A%E2%80%A2+DECREASING_DIFFICULTY_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+entity+difficulty%0Acomparison%2C+behave+like+DECREASING_DIFFICULTY%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Initialize+the+planning+entities+in+original+order.%0AThe+valueSorterManner+options+are%3A%0A%E2%80%A2+INCREASING_STRENGTH%3A+Evaluate+the+planning+values+in+increasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+INCREASING_STRENGTH_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+value+strength%0Acomparison%2C+behave+like+INCREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+DECREASING_STRENGTH%3A+Evaluate+the+planning+values+in+decreasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A248%0A%E2%80%A2+DECREASING_STRENGTH_IF_AVAILABLE%3A+If+the+model+supports+planning+value+strength+comparison%2C%0Abehave+like+DECREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Try+the+planning+values+in+original+order.%0AAdvanced+configuration+with+Weakest+Fit+Decreasing+for+a+single+entity+class+with+one+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0APer+step%2C+the+QueuedEntityPlacer+selects+one+uninitialized+entity+from+the+EntitySelector+and+applies%0Athe+winning+Move+%28out+of+all+the+moves+for+that+entity+generated+by+the+MoveSelector%29.+The+mimic%0Aselection+ensures+that+the+winning+Move+changes+only+the+selected+entity.%0ATo+customize+the+entity+or+value+sorting%2C+see+sorted+selection.+For+scaling+out%2C+see+scaling%0Aconstruction+heuristics.%0AIf+there+are+multiple+planning+variables%2C+there%E2%80%99s+one+ChangeMoveSelector+per+planning+variable%2C%0Awhich+are+either+in+a+cartesian+product+or+in+sequential+steps%2C+similar+to+the+less+verbose%0Aconfiguration.%0A10.8.3.+Multiple+Entity+Classes%0AThe+easiest+way+to+deal+with+multiple+entity+classes+is+to+run+a+separate+Construction+Heuristic+for%0Aeach+entity+class%3A%0A249%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CentityClass%3E...DogEntity%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CentityClass%3E...CatEntity%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.8.4.+Pick+Early+Type%0AThere+are+several+pick+early+types+for+Construction+Heuristics%3A%0A%E2%80%A2+NEVER%3A+Evaluate+all+the+selected+moves+to+initialize+the+variable%28s%29.+This+is+the+default+if+the%0AInitializingScoreTrend+is+not+ONLY_DOWN.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3ENEVER%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%E2%80%A2+FIRST_NON_DETERIORATING_SCORE%3A+Initialize+the+variable%28s%29+with+the+first+move+that+doesn%E2%80%99t%0Adeteriorate+the+score%2C+ignore+the+remaining+selected+moves.+This+is+the+default+if+the%0AInitializingScoreTrend+is+ONLY_DOWN.%0A250%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_NON_DETERIORATING_SCORE%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AIf+there+are+only+negative+constraints%2C+but+the+InitializingScoreTrend+is+strictly%0Anot+ONLY_DOWN%2C+it+can+sometimes+make+sense+to+apply%0A%EF%81%9A+FIRST_NON_DETERIORATING_SCORE.+Use+the+Benchmarker+to+decide+if+the%0Ascore+quality+loss+is+worth+the+time+gain.%0A%E2%80%A2+FIRST_FEASIBLE_SCORE%3A+Initialize+the+variable%28s%29+with+the+first+move+that+has+a+feasible+score.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_FEASIBLE_SCORE%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AIf+the+InitializingScoreTrend+is+ONLY_DOWN%2C+use+FIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%0Ainstead%2C+because+that%E2%80%99s+faster+without+any+disadvantages.%0A%E2%80%A2+FIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%3A+Initialize+the+variable%28s%29+with+the+first+move%0Athat+doesn%E2%80%99t+deteriorate+the+feasibility+of+the+score+any+further.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.9.+Allocate+To+Value+From+Queue%0A10.9.1.+Algorithm+Description%0AAllocate+To+Value+From+Queue+works+like+this%3A%0A1.+Put+all+values+in+a+round-robin+queue.%0A2.+Assign+the+best+entity+to+the+first+value+%28from+that+queue%29.%0A3.+Repeat+until+all+entities+are+assigned.%0A251%0A10.9.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3E%0AALLOCATE_TO_VALUE_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3E%0AALLOCATE_TO_VALUE_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration+for+a+single+entity+class+with+a+single+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedValuePlacer%3E%0A%C2%A0+++++%3CvalueSelector+id%3D%22placerValueSelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector+mimicSelectorRef%3D%22placerValueSelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedValuePlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.%0A10.10.+Cheapest+Insertion%0A10.10.1.+Algorithm+Description%0AThe+Cheapest+Insertion+algorithm+cycles+through+all+the+planning+values+for+all+the+planning%0Aentities%2C+initializing+one+planning+entity+at+a+time.+It+assigns+a+planning+entity+to+the+best+available%0A252%0Aplanning+value+%28out+of+all+the+planning+entities+and+values%29%2C+taking+the+already+initialized+planning%0Aentities+into+account.+It+terminates+when+all+planning+entities+have+been+initialized.+It+never%0Achanges+a+planning+entity+after+it+has+been+assigned.%0A%EF%81%9A+Cheapest+Insertion+scales+considerably+worse+than+First+Fit%2C+etc.%0A10.10.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ECHEAPEST_INSERTION%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A253%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ECHEAPEST_INSERTION%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0Afrom+pool.%0A10.11.+Regret+Insertion%0A10.11.1.+Algorithm+Description%0AThe+Regret+Insertion+algorithm+behaves+like+the+Cheapest+Insertion+algorithm.+It+also+cycles+through%0Aall+the+planning+values+for+all+the+planning+entities%2C+initializing+one+planning+entity+at+a+time.+But%0Ainstead+of+picking+the+entity-value+combination+with+the+best+score%2C+it+picks+the+entity+which+has+the%0Alargest+score+loss+between+its+best+and+second+best+value+assignment.+It+then+assigns+that+entity+to+its%0Abest+value%2C+to+avoid+regretting+not+having+done+that.%0A10.11.2.+Configuration%0AThis+algorithm+has+not+been+implemented+yet.%0A10.12.+Allocate+From+Pool%0A10.12.1.+Algorithm+Description%0AAllocate+From+Pool+is+a+versatile%2C+generic+form+of+Cheapest+Insertion+and+Regret+Insertion.+It+works%0Alike+this%3A%0A1.+Put+all+entity-value+combinations+in+a+pool.%0A2.+Assign+the+best+entity+to+best+value.%0A3.+Repeat+until+all+entities+are+assigned.%0A10.12.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_FROM_POOL%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A254%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_FROM_POOL%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+entitySorterManner+and+valueSorterManner+options+are+described+in+Allocate+Entity+From+Queue.%0AAdvanced+configuration+with+Cheapest+Insertion+for+a+single+entity+class+with+a+single+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CpooledEntityPlacer%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FpooledEntityPlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0APer+step%2C+the+PooledEntityPlacer+applies+the+winning+Move+%28out+of+all+the+moves+for+that+entity%0Agenerated+by+the+MoveSelector%29.%0ATo+customize+the+entity+or+value+sorting%2C+see+sorted+selection.+Other+Selector+customization+%28such+as%0Afiltering+and+limiting%29+is+supported+too.%0AFor+scaling+out%2C+see+scaling+construction+heuristics.%0A10.13.+Scaling+Construction+Heuristics%0AIf+the+Construction+Heuristic+takes+a+long+time+to+solve+and+create+an+initial+solution%2C+there+is+too%0Alittle+time+left+for+Local+Search+to+reach+a+near+optimal+solution.%0AIdeally%2C+a+Construction+Heuristic+should+take+less+than+20+seconds+from+scratch+and+less+than+50%0Amilliseconds+in+real-time+planning%2C+so+there+is+plenty+of+time+left+for+Local+Search.+If+the%0ABenchmarker+proves+that+this+is+not+the+case%2C+there%E2%80%99s+a+number+of+improvements+that+can+be+done%3A%0A10.13.1.+InitializingScoreTrend+shortcuts%0AIf+the+InitializingScoreTrend+is+ONLY_DOWN%2C+a+Construction+Heuristic+algorithm+%28such+as+First+Fit%29+is%0Afaster%3A+for+an+entity%2C+it+picks+the+first+move+for+which+the+score+does+not+deteriorate+the+last+step%0A255%0Ascore%2C+ignoring+all+subsequent+moves+in+that+step.%0AIt+can+take+that+shortcut+without+reducing+solution+quality%2C+because+a+down+trend+guarantees+that%0Ainitializing+any+additional+planning+variable+can+only+make+the+score+the+same+or+worse.+So+if+a%0Amove+has+the+same+score+as+before+the+planning+variable+was+initialized%2C+then+no+other+move+can%0Ahave+a+better+score.%0A10.13.2.+Scaling+Multiple+Planning+Variables+in+Construction+Heuristics%0AThere+are+two+ways+to+deal+with+multiple+planning+variables%2C+depending+on+how+their+ChangeMoves%0Aare+combined%3A%0A%E2%80%A2+Cartesian+product+%28default%29%3A+All+variables+of+the+selected+entity+are+assigned+together.+This%0Ausually+results+in+a+better+solution+quality%2C+but+it+scales+poorly+because+it+tries+every%0Acombination+of+variables.+For+example%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%E2%80%A2+Sequential%3A+One+variable+is+assigned+at+a+time.+Scales+better%2C+at+the+cost+of+solution+quality.+The%0Aorder+of+the+planning+variables+matters.+For+example%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+second+way+scales+better%2C+so+it+can+be+worth+to+switch+to+it.+For+example%2C+in+a+course+scheduling%0Aexample+with+200+rooms+and+40+periods%2C+a+cartesian+product+selects+8%C2%A0000+moves+per+entity+%281+step%0Aper+entity%29.+On+the+other+hand%2C+a+sequential+approach+only+selects+240+moves+per+entity+%282+steps+per%0Aentity%29%2C+ending+the+Construction+Heuristic+3+times+faster.+Especially+for+three+or+more+planning%0Avariables%2C+the+scaling+difference+is+huge.+For+example%2C+with+three+variables+of+1%C2%A0000+values+each%2C+a%0Acartesian+product+selects+1%C2%A0000%C2%A0000%C2%A0000+moves+per+entity+%281+step+per+entity%29.+A+sequential+approach%0A256%0Aonly+selects+3%C2%A0000+moves+per+entity+%283+steps+per+entity%29%2C+ending+the+Construction+Heuristic+300%C2%A0000%0Atimes+faster.%0AThe+order+of+the+variables+is+important%2C+especially+in+the+sequential+technique.+In%0Athe+sequential+example+above%2C+it%E2%80%99s+better+to+select+the+period+first+and+the+room%0Asecond+%28instead+of+the+other+way+around%29%2C+because+there+are+more+hard+constraints%0A%EF%81%AA+that+do+not+involve+the+room%2C+such+as+no+teacher+should+teach+two+lectures+at+the%0Asame+time.%0ALet+the+Benchmarker+guide+you.%0AWith+three+or+more+variables%2C+it%E2%80%99s+possible+to+combine+the+cartesian+product+and+sequential%0Atechniques%3A%0A257%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22teacher%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.13.3.+Other+Scaling+Techniques+in+Construction+Heuristics%0APartitioned+Search+reduces+the+number+of+moves+per+step.+On+top+of+that%2C+it+runs+the+Construction%0AHeuristic+on+the+partitions+in+parallel.+It+is+supported+to+only+partition+the+Construction+Heuristic%0Aphase.%0AOther+Selector+customizations+can+also+reduce+the+number+of+moves+generated+by+step%3A%0A%E2%80%A2+Filtered+selection%0A%E2%80%A2+Limited+selection%0A258%0AChapter+11.+Local+Search%0A11.1.+Overview%0ALocal+Search+starts+from+an+initial+solution+and+evolves+that+single+solution+into+a+mostly+better+and%0Abetter+solution.+It+uses+a+single+search+path+of+solutions%2C+not+a+search+tree.+At+each+solution+in+this%0Apath+it+evaluates+a+number+of+moves+on+the+solution+and+applies+the+most+suitable+move+to+take+the%0Astep+to+the+next+solution.+It+does+that+for+a+high+number+of+iterations+until+it%E2%80%99s+terminated+%28usually%0Abecause+its+time+has+run+out%29.%0ALocal+Search+acts+a+lot+like+a+human+planner%3A+it+uses+a+single+search+path+and+moves+facts+around+to%0Afind+a+good+feasible+solution.+Therefore+it%E2%80%99s+pretty+natural+to+implement.%0ALocal+Search+needs+to+start+from+an+initialized+solution%2C+therefore+it%E2%80%99s+usually+required+to%0Aconfigure+a+Construction+Heuristic+phase+before+it.%0A11.2.+Local+Search+Concepts%0A11.2.1.+Step+by+Step%0AA+step+is+the+winning+Move.+Local+Search+tries+a+number+of+moves+on+the+current+solution+and+picks%0Athe+best+accepted+move+as+the+step%3A%0AFigure+6.+Decide+the+next+step+at+step+0+%28four+queens+example%29%0ABecause+the+move+B0+to+B3+has+the+highest+score+%28-3%29%2C+it+is+picked+as+the+next+step.+If+multiple+moves%0Ahave+the+same+highest+score%2C+one+is+picked+randomly%2C+in+this+case+B0+to+B3.+Note+that+C0+to+C3+%28not%0Ashown%29+could+also+have+been+picked+because+it+also+has+the+score+-3.%0AThe+step+is+applied+on+the+solution.+From+that+new+solution%2C+Local+Search+tries+every+move+again%2C+to%0Adecide+the+next+step+after+that.+It+continually+does+this+in+a+loop%2C+and+we+get+something+like+this%3A%0A259%0AFigure+7.+All+steps+%28four+queens+example%29%0ANotice+that+Local+Search+doesn%E2%80%99t+use+a+search+tree%2C+but+a+search+path.+The+search+path+is+highlighted%0Aby+the+green+arrows.+At+each+step+it+tries+all+selected+moves%2C+but+unless+it%E2%80%99s+the+step%2C+it+doesn%E2%80%99t%0Ainvestigate+that+solution+further.+This+is+one+of+the+reasons+why+Local+Search+is+very+scalable.%0AAs+shown+above%2C+Local+Search+solves+the+four+queens+problem+by+starting+with+the+starting+solution%0Aand+make+the+following+steps+sequentially%3A%0A1.+B0+to+B3%0A2.+D0+to+B2%0A3.+A0+to+B1%0A260%0ATurn+on+debug+logging+for+the+category+org.optaplanner+to+show+those+steps+in+the+log%3A%0AINFO++Solving+started%3A+time+spent+%280%29%2C+best+score+%28-6%29%2C+environment+mode%0A%28REPRODUCIBLE%29%2C+random+%28JDK+with+seed+0%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%2820%29%2C+score+%28-3%29%2C+new+best+score+%28-3%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-0+-%3E+Row-3%7D%29.%0ADEBUG+++++LS+step+%281%29%2C+time+spent+%2831%29%2C+score+%28-1%29%2C+new+best+score+%28-1%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-3+%7BRow-0+-%3E+Row-2%7D%29.%0ADEBUG+++++LS+step+%282%29%2C+time+spent+%2840%29%2C+score+%280%29%2C+new+best+score+%280%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-0+%7BRow-0+-%3E+Row-1%7D%29.%0AINFO++Local+Search+phase+%280%29+ended%3A+time+spent+%2841%29%2C+best+score+%280%29%2C+score+calculation%0Aspeed+%285000%2Fsec%29%2C+step+total+%283%29.%0AINFO++Solving+ended%3A+time+spent+%2841%29%2C+best+score+%280%29%2C+score+calculation+speed%0A%285000%2Fsec%29%2C+phase+total+%281%29%2C+environment+mode+%28REPRODUCIBLE%29.%0ANotice+that+a+log+message+includes+the+toString%28%29+method+of+the+Move+implementation+which+returns%0Afor+example+%22Queen-1+%7BRow-0+%E2%86%92+Row-3%7D%22.%0AA+naive+Local+Search+configuration+solves+the+four+queens+problem+in+three+steps%2C+by+evaluating%0Aonly+37+possible+solutions+%28three+steps+with+12+moves+each+%2B+one+starting+solution%29%2C+which+is+only%0Afraction+of+all+256+possible+solutions.+It+solves+16+queens+in+31+steps%2C+by+evaluating+only+7441+out+of%0A18446744073709551616+possible+solutions.+By+using+a+Construction+Heuristics+phase+first%2C+it%E2%80%99s+even+a%0Alot+more+efficient.%0A11.2.2.+Decide+the+Next+Step%0ALocal+Search+decides+the+next+step+with+the+aid+of+three+configurable+components%3A%0A%E2%80%A2+A+MoveSelector+which+selects+the+possible+moves+of+the+current+solution.+See+the+chapter+move%0Aand+neighborhood+selection.%0A%E2%80%A2+An+Acceptor+which+filters+out+unacceptable+moves.%0A%E2%80%A2+A+Forager+which+gathers+accepted+moves+and+picks+the+next+step+from+them.%0AThe+solver+phase+configuration+looks+like+this%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A261%0AIn+the+example+below%2C+the+MoveSelector+generated+the+moves+shown+with+the+blue+lines%2C+the+Acceptor%0Aaccepted+all+of+them+and+the+Forager+picked+the+move+B0+to+B3.%0ATurn+on+trace+logging+to+show+the+decision+making+in+the+log%3A%0AINFO++Solver+started%3A+time+spent+%280%29%2C+score+%28-6%29%2C+new+best+score+%28-6%29%2C+random+%28JDK%0Awith+seed+0%29.%0ATRACE+++++++++Move+index+%280%29+not+doable%2C+ignoring+move+%28Queen-0+%7BRow-0+-%3E+Row-0%7D%29.%0ATRACE+++++++++Move+index+%281%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-1%7D%29.%0ATRACE+++++++++Move+index+%282%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-2%7D%29.%0ATRACE+++++++++Move+index+%283%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%286%29%2C+score+%28-3%29%2C+accepted+%28true%29%2C+move+%28Queen-1+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%289%29%2C+score+%28-3%29%2C+accepted+%28true%29%2C+move+%28Queen-2+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%2812%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-3+%7BRow-0+-%3E%0ARow-3%7D%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%286%29%2C+score+%28-3%29%2C+new+best+score+%28-3%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-0+-%3E+Row-3%7D%29.%0A...%0ABecause+the+last+solution+can+degrade+%28for+example+in+Tabu+Search%29%2C+the+Solver+remembers+the+best%0Asolution+it+has+encountered+through+the+entire+search+path.+Each+time+the+current+solution+is+better%0Athan+the+last+best+solution%2C+the+current+solution+is+cloned+and+referenced+as+the+new+best+solution.%0A262%0A11.2.3.+Acceptor%0AAn+Acceptor+is+used+%28together+with+a+Forager%29+to+active+Tabu+Search%2C+Simulated+Annealing%2C+Late%0AAcceptance%2C+%E2%80%A6+For+each+move+it+checks+whether+it+is+accepted+or+not.%0ABy+changing+a+few+lines+of+configuration%2C+you+can+easily+switch+from+Tabu+Search+to+Simulated%0AAnnealing+or+Late+Acceptance+and+back.%0AYou+can+implement+your+own+Acceptor%2C+but+the+built-in+acceptors+should+suffice+for+most+needs.+You%0Acan+also+combine+multiple+acceptors.%0A11.2.4.+Forager%0AA+Forager+gathers+all+accepted+moves+and+picks+the+move+which+is+the+next+step.+Normally+it+picks%0Athe+accepted+move+with+the+highest+score.+If+several+accepted+moves+have+the+highest+score%2C+one+is%0Apicked+randomly+to+break+the+tie.+Breaking+ties+randomly+leads+to+better+results.%0A263%0AIt+is+possible+to+disable+breaking+ties+randomly+by+explicitly+setting%0AbreakTieRandomly+to+false%2C+but+that%E2%80%99s+almost+never+a+good+idea%3A%0A%EF%81%9A+%E2%80%A2+If+an+earlier+move+is+better+than+a+later+move+with+the+same+score%2C+the+scorecalculator+should+add+an+extra+softer+score+level+to+score+the+first+move+as%0Aslightly+better.+Don%E2%80%99t+rely+on+move+selection+order+to+enforce+that.%0A%E2%80%A2+Random+tie+breaking+does+not+affect+reproducibility.%0A11.2.4.1.+Accepted+Count+Limit%0AWhen+there+are+many+possible+moves%2C+it+becomes+inefficient+to+evaluate+all+of+them+at+every+step.%0ATo+evaluate+only+a+random+subset+of+all+the+moves%2C+use%3A%0A%E2%80%A2+An+acceptedCountLimit+integer%2C+which+specifies+how+many+accepted+moves+should+be+evaluated%0Aduring+each+step.+By+default%2C+all+accepted+moves+are+evaluated+at+every+step.%0A%C2%A0+%3Cforager%3E%0A%C2%A0+++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+%3C%2Fforager%3E%0AUnlike+the+n+queens+problem%2C+real+world+problems+require+the+use+of+acceptedCountLimit.+Start+from%0Aan+acceptedCountLimit+that+takes+a+step+in+less+than+two+seconds.+Turn+on+INFO+logging+to+see+the%0Astep+times.+Use+the+Benchmarker+to+tweak+the+value.%0AWith+a+low+acceptedCountLimit+%28so+a+fast+stepping+algorithm%29%2C+it+is+recommended+to%0Aavoid+using+selectionOrder+SHUFFLED+because+the+shuffling+generates+a+random%0A%EF%81%AA+number+for+every+element+in+the+selector%2C+taking+up+a+lot+of+time%2C+but+only+a+few%0Aelements+are+actually+selected.%0A11.2.4.2.+Pick+Early+Type%0AA+forager+can+pick+a+move+early+during+a+step%2C+ignoring+subsequent+selected+moves.+There+are+three%0Apick+early+types+for+Local+Search%3A%0A%E2%80%A2+NEVER%3A+A+move+is+never+picked+early%3A+all+accepted+moves+are+evaluated+that+the+selection+allows.%0AThis+is+the+default.%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3ENEVER%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%E2%80%A2+FIRST_BEST_SCORE_IMPROVING%3A+Pick+the+first+accepted+move+that+improves+the+best+score.+If+none%0Aimprove+the+best+score%2C+it+behaves+exactly+like+the+pickEarlyType+NEVER.%0A264%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_BEST_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%E2%80%A2+FIRST_LAST_STEP_SCORE_IMPROVING%3A+Pick+the+first+accepted+move+that+improves+the+last+step+score.%0AIf+none+improve+the+last+step+score%2C+it+behaves+exactly+like+the+pickEarlyType+NEVER.%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_LAST_STEP_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A11.3.+Hill+Climbing+%28Simple+Local+Search%29%0A11.3.1.+Algorithm+Description%0AHill+Climbing+tries+all+selected+moves+and+then+takes+the+best+move%2C+which+is+the+move+which+leads%0Ato+the+solution+with+the+highest+score.+That+best+move+is+called+the+step+move.+From+that+new%0Asolution%2C+it+again+tries+all+selected+moves+and+takes+the+best+move+and+continues+like+that+iteratively.%0AIf+multiple+selected+moves+tie+for+the+best+move%2C+one+of+them+is+randomly+chosen+as+the+best+move.%0ANotice+that+once+a+queen+has+moved%2C+it+can+be+moved+again+later.+This+is+a+good+thing%2C+because+in+an%0A265%0ANP-complete+problem+it%E2%80%99s+impossible+to+predict+what+will+be+the+optimal+final+value+for+a+planning%0Avariable.%0A11.3.2.+Stuck+in+Local+Optima%0AHill+Climbing+always+takes+improving+moves.+This+may+seem+like+a+good+thing%2C+but+it%E2%80%99s+not%3A+Hill%0AClimbing+can+easily+get+stuck+in+a+local+optimum.+This+happens+when+it+reaches+a+solution+for%0Awhich+all+the+moves+deteriorate+the+score.+Even+if+it+picks+one+of+those+moves%2C+the+next+step+might%0Ago+back+to+the+original+solution+and+which+case+chasing+its+own+tail%3A%0AImprovements+upon+Hill+Climbing+%28such+as+Tabu+Search%2C+Simulated+Annealing+and+Late+Acceptance%29%0Aaddress+the+problem+of+being+stuck+in+local+optima.+Therefore%2C+it%E2%80%99s+recommend+to+never+use+Hill%0AClimbing%2C+unless+you%E2%80%99re+absolutely+sure+there+are+no+local+optima+in+your+planning+problem.%0A11.3.3.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3EHILL_CLIMBING%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AAdvanced+configuration%3A%0A266%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CacceptorType%3EHILL_CLIMBING%3C%2FacceptorType%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.4.+Tabu+Search%0A11.4.1.+Algorithm+Description%0ATabu+Search+works+like+Hill+Climbing%2C+but+it+maintains+a+tabu+list+to+avoid+getting+stuck+in+local%0Aoptima.+The+tabu+list+holds+recently+used+objects+that+are+taboo+to+use+for+now.+Moves+that+involve%0Aan+object+in+the+tabu+list%2C+are+not+accepted.+The+tabu+list+objects+can+be+anything+related+to+the+move%2C%0Asuch+as+the+planning+entity%2C+planning+value%2C+move%2C+solution%2C+%E2%80%A6+Here%E2%80%99s+an+example+with+entity+tabu%0Afor+four+queens%2C+so+the+queens+are+put+in+the+tabu+list%3A%0A%EF%81%9A+It%E2%80%99s+called+Tabu+Search%2C+not+Taboo+Search.+There+is+no+spelling+error.%0A267%0AScientific+paper%3A+Tabu+Search+-+Part+1+and+Part+2+by+Fred+Glover+%281989+-+1990%29%0A11.4.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3ETABU_SEARCH%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AWhen+Tabu+Search+takes+steps+it+creates+one+or+more+tabu%E2%80%99s.+For+a+number+of+steps%2C+it+does+not%0Aaccept+a+move+if+that+move+breaks+tabu.+That+number+of+steps+is+the+tabu+size.+Advanced%0Aconfiguration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AA+Tabu+Search+acceptor+should+be+combined+with+a+high+acceptedCountLimit%2C+such%0A%EF%81%AA+as+1000.%0APlanner+implements+several+tabu+types%3A%0A%E2%80%A2+Planning+entity+tabu+%28recommended%29+makes+the+planning+entities+of+recent+steps+tabu.+For%0Aexample%2C+for+N+queens+it+makes+the+recently+moved+queens+tabu.+It%E2%80%99s+recommended+to+start+with%0Athis+tabu+type.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0ATo+avoid+hard+coding+the+tabu+size%2C+configure+a+tabu+ratio%2C+relative+to+the+number+of+entities%2C+for%0Aexample+2%25%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuRatio%3E0.02%3C%2FentityTabuRatio%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Planning+value+tabu+makes+the+planning+values+of+recent+steps+tabu.+For+example%2C+for+N+queens%0A268%0Ait+makes+the+recently+moved+to+rows+tabu.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CvalueTabuSize%3E7%3C%2FvalueTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0ATo+avoid+hard+coding+the+tabu+size%2C+configure+a+tabu+ratio%2C+relative+to+the+number+of+values%2C+for%0Aexample+2%25%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CvalueTabuRatio%3E0.02%3C%2FvalueTabuRatio%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Move+tabu+makes+recent+steps+tabu.+It+does+not+accept+a+move+equal+to+one+of+those+steps.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CmoveTabuSize%3E7%3C%2FmoveTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Undo+move+tabu+makes+the+undo+move+of+recent+steps+tabu.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CundoMoveTabuSize%3E7%3C%2FundoMoveTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Solution+tabu+makes+recently+visited+solutions+tabu.+It+does+not+accept+a+move+that+leads+to+one%0Aof+those+solutions.+It+requires+that+the+Solution+implements+equals%28%29+and+hashCode%28%29+properly.+If%0Ayou+can+spare+the+memory%2C+don%E2%80%99t+be+cheap+on+the+tabu+size.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsolutionTabuSize%3E1000%3C%2FsolutionTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0AFor+non-trivial+cases%2C+solution+tabu+is+usually+useless+because+the+search+space+size+makes+it%0Astatistically+highly+unlikely+to+reach+the+same+solution+twice.+Therefore+its+use+is+not%0Arecommended%2C+except+for+small+datasets.%0ASometimes+it%E2%80%99s+useful+to+combine+tabu+types%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++++%3CvalueTabuSize%3E3%3C%2FvalueTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A269%0AIf+the+tabu+size+is+too+small%2C+the+solver+can+still+get+stuck+in+a+local+optimum.+On+the+other+hand%2C+if%0Athe+tabu+size+is+too+large%2C+the+solver+can+be+inefficient+by+bouncing+of+the+walls.+Use+the%0ABenchmarker+to+fine+tweak+your+configuration.%0A11.5.+Simulated+Annealing%0A11.5.1.+Algorithm+Description%0ASimulated+Annealing+evaluates+only+a+few+moves+per+step%2C+so+it+steps+quickly.+In+the+classic%0Aimplementation%2C+the+first+accepted+move+is+the+winning+step.+A+move+is+accepted+if+it+doesn%E2%80%99t%0Adecrease+the+score+or+-+in+case+it+does+decrease+the+score+-+it+passes+a+random+check.+The+chance+that%0Aa+decreasing+move+passes+the+random+check+decreases+relative+to+the+size+of+the+score+decrement%0Aand+the+time+the+phase+has+been+running+%28which+is+represented+as+the+temperature%29.%0ASimulated+Annealing+does+not+always+pick+the+move+with+the+highest+score%2C+neither+does+it+evaluate%0Amany+moves+per+step.+At+least+at+first.+Instead%2C+it+gives+non+improving+moves+also+a+chance+to+be%0Apicked%2C+depending+on+its+score+and+the+time+gradient+of+the+Termination.+In+the+end%2C+it+gradually%0Aturns+into+Hill+Climbing%2C+only+accepting+improving+moves.%0A11.5.2.+Configuration%0AStart+with+a+simulatedAnnealingStartingTemperature+set+to+the+maximum+score+delta+a+single+move%0Acan+cause.+Use+the+Benchmarker+to+tweak+the+value.+Advanced+configuration%3A%0A270%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsimulatedAnnealingStartingTemperature%3E%0A2hard%2F100soft%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ASimulated+Annealing+should+use+a+low+acceptedCountLimit.+The+classic+algorithm+uses+an%0AacceptedCountLimit+of+1%2C+but+often+4+performs+better.%0ASimulated+Annealing+can+be+combined+with+a+tabu+acceptor+at+the+same+time.+That+gives+Simulated%0AAnnealing+salted+with+a+bit+of+Tabu.+Use+a+lower+tabu+size+than+in+a+pure+Tabu+Search+configuration.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsimulatedAnnealingStartingTemperature%3E%0A2hard%2F100soft%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++++%3CentityTabuSize%3E5%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.6.+Late+Acceptance%0A11.6.1.+Algorithm+Description%0ALate+Acceptance+%28also+known+as+Late+Acceptance+Hill+Climbing%29+also+evaluates+only+a+few+moves+per%0Astep.+A+move+is+accepted+if+it+does+not+decrease+the+score%2C+or+if+it+leads+to+a+score+that+is+at+least+the%0Alate+score+%28which+is+the+winning+score+of+a+fixed+number+of+steps+ago%29.%0A271%0AScientific+paper%3A+The+Late+Acceptance+Hill-Climbing+Heuristic+by+Edmund+K.+Burke%2C+Yuri+Bykov%0A%282012%29%0A11.6.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3ELATE_ACCEPTANCE%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ALate+Acceptance+accepts+any+move+that+has+a+score+which+is+higher+than+the+best+score+of+a+number%0Aof+steps+ago.+That+number+of+steps+is+the+lateAcceptanceSize.+Advanced+configuration%3A%0A272%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3ClateAcceptanceSize%3E400%3C%2FlateAcceptanceSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ALate+Acceptance+should+use+a+low+acceptedCountLimit.%0ALate+Acceptance+can+be+combined+with+a+tabu+acceptor+at+the+same+time.+That+gives+Late%0AAcceptance+salted+with+a+bit+of+Tabu.+Use+a+lower+tabu+size+than+in+a+pure+Tabu+Search%0Aconfiguration.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3ClateAcceptanceSize%3E400%3C%2FlateAcceptanceSize%3E%0A%C2%A0+++++%3CentityTabuSize%3E5%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.7.+Step+Counting+Hill+Climbing%0A11.7.1.+Algorithm+Description%0AStep+Counting+Hill+Climbing+also+evaluates+only+a+few+moves+per+step.+For+a+number+of+steps%2C+it%0Akeeps+the+step+score+as+a+threshold.+A+move+is+accepted+if+it+does+not+decrease+the+score%2C+or+if+it+leads%0Ato+a+score+that+is+at+least+the+threshold+score.%0AScientific+paper%3A+An+initial+study+of+a+novel+Step+Counting+Hill+Climbing+heuristic+applied+to%0Atimetabling+problems+by+Yuri+Bykov%2C+Sanja+Petrovic+%282013%29%0A11.7.2.+Configuration%0AStep+Counting+Hill+Climbing+accepts+any+move+that+has+a+score+which+is+higher+than+a+threshold%0Ascore.+Every+number+of+steps+%28specified+by+stepCountingHillClimbingSize%29%2C+the+threshold+score+is+set%0Ato+the+step+score.%0A273%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CstepCountingHillClimbingSize%3E400%3C%2FstepCountingHillClimbingSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AStep+Counting+Hill+Climbing+should+use+a+low+acceptedCountLimit.%0AStep+Counting+Hill+Climbing+can+be+combined+with+a+tabu+acceptor+at+the+same+time%2C+similar+as%0Ashown+in+the+Late+Acceptance+section.%0A11.8.+Strategic+Oscillation%0A11.8.1.+Algorithm+Description%0AStrategic+Oscillation+is+an+add-on%2C+which+works+especially+well+with+Tabu+Search.+Instead+of+picking%0Athe+accepted+move+with+the+highest+score%2C+it+employs+a+different+mechanism%3A+If+there%E2%80%99s+an%0Aimproving+move%2C+it+picks+it.+If+there%E2%80%99s+no+improving+move+however%2C+it+prefers+moves+which+improve%0Aa+softer+score+level%2C+over+moves+which+break+a+harder+score+level+less.%0A11.8.2.+Configuration%0AConfigure+a+finalistPodiumType%2C+for+example+in+a+Tabu+Search+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+++++%3CfinalistPodiumType%3ESTRATEGIC_OSCILLATION%3C%2FfinalistPodiumType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AThe+following+finalistPodiumTypes+are+supported%3A%0A%E2%80%A2+HIGHEST_SCORE+%28default%29%3A+Pick+the+accepted+move+with+the+highest+score.%0A%E2%80%A2+STRATEGIC_OSCILLATION%3A+Alias+for+the+default+strategic+oscillation+variant.%0A%E2%80%A2+STRATEGIC_OSCILLATION_BY_LEVEL%3A+If+there+is+an+accepted+improving+move%2C+pick+it.+If+no+such+move%0Aexists%2C+prefer+an+accepted+move+which+improves+a+softer+score+level+over+one+that+doesn%E2%80%99t+%28even%0Aif+it+has+a+better+harder+score+level%29.+A+move+is+improving+if+it%E2%80%99s+better+than+the+last+completed%0A274%0Astep+score.%0A%E2%80%A2+STRATEGIC_OSCILLATION_BY_LEVEL_ON_BEST_SCORE%3A+Like+STRATEGIC_OSCILLATION_BY_LEVEL%2C+but+define%0Aimproving+as+better+than+the+best+score+%28instead+of+the+last+completed+step+score%29.%0A11.9.+Variable+Neighborhood+Descent%0A11.9.1.+Algorithm+Description%0AVariable+Neighborhood+Descent+iteratively+tries+multiple+move+selectors+in+original+order+%28depleting%0Aeach+selector+entirely+before+trying+the+next+one%29%2C+picking+the+first+improving+move+%28which+also%0Aresets+the+iterator+back+to+the+first+move+selector%29.%0ADespite+that+VND+has+a+name+that+ends+with+descent+%28from+the+research+papers%29%2C%0A%EF%81%9A+the+implementation+will+ascend+to+a+higher+score+%28which+is+a+better+score%29.%0A11.9.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3EVARIABLE_NEIGHBORHOOD_DESCENT%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CselectionOrder%3EORIGINAL%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CacceptorType%3EHILL_CLIMBING%3C%2FacceptorType%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_LAST_STEP_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AVariable+Neighborhood+Descent+doesn%E2%80%99t+scale+well%2C+but+it+is+useful+in+some+use+cases+with+a+very%0Aerratic+score+landscape.%0A275%0A11.10.+Using+a+Custom+Termination%2C+MoveSelector%2C%0AEntitySelector%2C+ValueSelector+or+Acceptor%0APlug+in+a+custom+Termination%2C+MoveSelector%2C+EntitySelector%2C+ValueSelector+or+Acceptor+by+extending%0Athe+abstract+class+and+also+the+related+%5C*Config+class.%0AExtending+Config+classes+is+not+covered+by+the+backwards+compatbility+gaurantee.%0A%EF%81%AA+Whenever+possible%2C+it%E2%80%99s+better+to+just+use+custom+properties+instead.%0AFor+example%2C+to+use+a+custom+Termination%2C+extend+the+AbstractTermination+class%2C+extend+the%0ATerminationConfig+class+and+configure+it+in+the+solver+configuration.%0A%3Csolver%3E%0A%C2%A0+%3Ctermination+class%3D%22...MyTerminationConfig%22%3E%0A%C2%A0+++%3CmyProperty%3EmyValue%3C%2FmyProperty%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%3C%2Fsolver%3E%0AIt%E2%80%99s+not+possible+to+inject+a+Termination%2C+%E2%80%A6+instance+directly+%28to+avoid+extending+a%0AConfig+class+too%29+because%3A%0A%E2%80%A2+A+SolverFactory+can+build+multiple+Solver+instances%2C+which+each+require+a%0Adistinct+Termination%2C+%E2%80%A6+instance.%0A%EF%81%9A+%E2%80%A2+A+solver+configuration+needs+to+be+serializable+from+and+to+XML.+This+makes%0Abenchmarking+with+PlannerBenchmark+particularly+easy+because+you+can%0Aconfigure+different+Solver+variants+in+XML.%0A%E2%80%A2+A+Config+class+is+often+easier+and+clearer+to+configure.+For+example%3A%0ATerminationConfig+translates+minutesSpentLimit+and+secondsSpentLimit+into%0AtimeMillisSpentLimit.%0AIf+you+write+a+custom+implementation+of+any+of+those+classes%2C+let+us+know+why+on+our+forum.+If+it%E2%80%99s%0Anot+domain+specific%2C+you+might+want+to+consider+contributing+it+back+as+a+pull+request+on+github%3A%0Awe%E2%80%99ll+optimize+it+and+take+it+along+in+future+refactorings.%0A276%0AChapter+12.+Evolutionary+Algorithms%0A12.1.+Overview%0AEvolutionary+Algorithms+work+on+a+population+of+solutions+and+evolve+that+population.%0A12.2.+Evolutionary+Strategies%0AThis+algorithm+has+not+been+implemented+yet.%0A12.3.+Genetic+Algorithms%0AThis+algorithm+has+not+been+implemented+yet.%0AA+good+Genetic+Algorithms+prototype+in+Planner+was+written+some+time+ago%2C+but+it%0Awasn%E2%80%99t+practical+to+merge+and+support+it+at+the+time.+The+results+of+Genetic%0AAlgorithms+were+consistently+and+seriously+inferior+to+all+the+Local+Search+variants%0A%EF%81%9A+%28except+Hill+Climbing%29+on+all+use+cases+tried.+Nevertheless%2C+a+future+version+of%0APlanner+will+add+support+for+Genetic+Algorithms%2C+so+you+can+easily+benchmark%0AGenetic+Algorithms+on+your+use+case+too.%0A277%0AChapter+13.+Hyperheuristics%0A13.1.+Overview%0AA+hyperheuristic+automates+the+decision+which+heuristic%28s%29+to+use+on+a+specific+data+set.%0AA+future+version+of+Planner+will+have+native+support+for+hyperheuristics.+Meanwhile%2C+it%E2%80%99s+possible+to%0Aimplement+it+yourself%3A+Based+on+the+size+or+difficulty+of+a+data+set+%28which+is+a+criterion%29%2C+use+a%0Adifferent+Solver+configuration+%28or+adjust+the+default+configuration+using+the+Solver+configuration%0AAPI%29.+The+Benchmarker+can+help+to+identify+such+criteria.%0A278%0AChapter+14.+Partitioned+Search%0A14.1.+Algorithm+Description%0AIt+is+often+more+efficient+to+partition+large+data+sets+%28usually+above+5000+planning+entities%29+into%0Asmaller+pieces+and+solve+them+separately.+Partition+Search+is+multithreaded%2C+so+it+provides+a%0Aperformance+boost+on+multi-core+machines+due+to+higher+CPU+utilization.+Additionally%2C+even+when%0Aonly+using+one+CPU%2C+it+finds+an+initial+solution+faster%2C+because+the+search+space+sum+of+a+partitioned%0AConstruction+Heuristic+is+far+less+than+its+non-partitioned+variant.%0AHowever%2C+partitioning+does+lead+to+suboptimal+results%2C+even+if+the+pieces+are+solved+optimally%2C+as%0Ashown+below%3A%0AIt+effectively+trades+a+short+term+gain+in+solution+quality+for+long+term+loss.+One+way+to+compensate%0Afor+this+loss%2C+is+to+run+a+non-partitioned+Local+Search+after+the+Partitioned+Search+phase.%0ANot+all+use+cases+can+be+partitioned.+Partitioning+only+works+for+use+cases+where%0A%EF%81%9A+the+planning+entities+and+value+ranges+can+be+split+into+n+partitions%2C+without+any+of%0Athe+constraints+crossing+boundaries+between+partitions.%0A279%0A14.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AThere+are+several+ways+to+partition+a+solution.%0AAdvanced+configuration%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++...%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CrunnablePartThreadLimit%3E4%3C%2FrunnablePartThreadLimit%3E%0A%C2%A0+++%3CconstructionHeuristic%3E...%3C%2FconstructionHeuristic%3E%0A%C2%A0+++%3ClocalSearch%3E...%3C%2FlocalSearch%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AThe+runnablePartThreadLimit+allows+limiting+CPU+usage+to+avoid+hanging+your+machine%2C+see+below.%0ATo+run+in+an+environment+that+doesn%E2%80%99t+like+arbitrary+thread+creation%2C+plug+in+a+custom+thread%0Afactory.%0AA+logging+level+of+debug+or+trace+causes+congestion+in+multithreaded+Partitioned%0A%EF%81%AA+Search+and+slows+down+the+score+calculation+speed.%0AJust+like+a+%3Csolver%3E+element%2C+the+%3CpartitionedSearch%3E+element+can+contain+one+or+more+phases.+Each%0Aof+those+phases+will+be+run+on+each+partition.%0AA+common+configuration+is+to+first+run+a+Partitioned+Search+phase+%28which+includes+a+Construction%0AHeuristic+and+a+Local+Search%29+followed+by+a+non-partitioned+Local+Search+phase%3A%0A280%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++%3CsolutionPartitionerClass%3E...CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CconstructionHeuristic%2F%3E%0A%C2%A0+++%3ClocalSearch%3E%0A%C2%A0+++++%3Ctermination%3E%0A%C2%A0+++++++%3CsecondsSpentLimit%3E60%3C%2FsecondsSpentLimit%3E%0A%C2%A0+++++%3C%2Ftermination%3E%0A%C2%A0+++%3C%2FlocalSearch%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0A%C2%A0+%3ClocalSearch%2F%3E%0A14.3.+Partitioning+a+Solution%0A14.3.1.+Custom+SolutionPartitioner%0ATo+use+a+custom+SolutionPartitioner%2C+configure+one+on+the+Partitioned+Search+phase%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AImplement+the+SolutionPartitioner+interface%3A%0Apublic+interface+SolutionPartitioner%3CSolution_%3E+%7B%0A%C2%A0+++List%3CSolution_%3E+splitWorkingSolution%28ScoreDirector%3CSolution_%3E+scoreDirector%2C%0AInteger+runnablePartThreadLimit%29%3B%0A%7D%0AThe+size%28%29+of+the+returned+List+is+the+partCount+%28the+number+of+partitions%29.+This+can+be+decided%0Adynamically%2C+for+example%2C+based+on+the+size+of+the+non-partitioned+solution.+The+partCount+is%0Aunrelated+to+the+runnablePartThreadLimit.%0AFor+example%3A%0Apublic+class+CloudBalancePartitioner+implements+SolutionPartitioner%3CCloudBalance%3E+%7B%0A%C2%A0+++private+int+partCount+%3D+4%3B%0A%C2%A0+++private+int+minimumProcessListSize+%3D+75%3B%0A%C2%A0+++%40Override%0A%C2%A0+++public+List%3CCloudBalance%3E+splitWorkingSolution%28ScoreDirector%3CCloudBalance%3E%0A281%0AscoreDirector%2C+Integer+runnablePartThreadLimit%29+%7B%0A%C2%A0+++++++CloudBalance+originalSolution+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++List%3CCloudComputer%3E+originalComputerList+%3D+originalSolution.getComputerList%28%29%3B%0A%C2%A0+++++++List%3CCloudProcess%3E+originalProcessList+%3D+originalSolution.getProcessList%28%29%3B%0A%C2%A0+++++++int+partCount+%3D+this.partCount%3B%0A%C2%A0+++++++if+%28originalProcessList.size%28%29+%2F+partCount+%3C+minimumProcessListSize%29+%7B%0A%C2%A0+++++++++++partCount+%3D+originalProcessList.size%28%29+%2F+minimumProcessListSize%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++List%3CCloudBalance%3E+partList+%3D+new+ArrayList%3C%3E%28partCount%29%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+partCount%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++CloudBalance+partSolution+%3D+new+CloudBalance%28originalSolution.getId%28%29%2C%0A%C2%A0+++++++++++++++++++new+ArrayList%3C%3E%28originalComputerList.size%28%29+%2F+partCount+%2B+1%29%2C%0A%C2%A0+++++++++++++++++++new+ArrayList%3C%3E%28originalProcessList.size%28%29+%2F+partCount+%2B+1%29%29%3B%0A%C2%A0+++++++++++partList.add%28partSolution%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++int+partIndex+%3D+0%3B%0A%C2%A0+++++++Map%3CLong%2C+Pair%3CInteger%2C+CloudComputer%3E%3E+idToPartIndexAndComputerMap+%3D+new%0AHashMap%3C%3E%28originalComputerList.size%28%29%29%3B%0A%C2%A0+++++++for+%28CloudComputer+originalComputer+%3A+originalComputerList%29+%7B%0A%C2%A0+++++++++++CloudBalance+part+%3D+partList.get%28partIndex%29%3B%0A%C2%A0+++++++++++CloudComputer+computer+%3D+new+CloudComputer%28%0A%C2%A0+++++++++++++++++++originalComputer.getId%28%29%2C%0A%C2%A0+++++++++++++++++++originalComputer.getCpuPower%28%29%2C+originalComputer.getMemory%28%29%2C%0A%C2%A0+++++++++++++++++++originalComputer.getNetworkBandwidth%28%29%2C+originalComputer.getCost%28%0A%29%29%3B%0A%C2%A0+++++++++++part.getComputerList%28%29.add%28computer%29%3B%0A%C2%A0+++++++++++idToPartIndexAndComputerMap.put%28computer.getId%28%29%2C+Pair.of%28partIndex%2C%0Acomputer%29%29%3B%0A%C2%A0+++++++++++partIndex+%3D+%28partIndex+%2B+1%29+%25+partList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++partIndex+%3D+0%3B%0A%C2%A0+++++++for+%28CloudProcess+originalProcess+%3A+originalProcessList%29+%7B%0A%C2%A0+++++++++++CloudBalance+part+%3D+partList.get%28partIndex%29%3B%0A%C2%A0+++++++++++CloudProcess+process+%3D+new+CloudProcess%28%0A%C2%A0+++++++++++++++++++originalProcess.getId%28%29%2C%0A%C2%A0+++++++++++++++++++originalProcess.getRequiredCpuPower%28%29%2C+originalProcess%0A.getRequiredMemory%28%29%2C%0A%C2%A0+++++++++++++++++++originalProcess.getRequiredNetworkBandwidth%28%29%29%3B%0A%C2%A0+++++++++++part.getProcessList%28%29.add%28process%29%3B%0A%C2%A0+++++++++++if+%28originalProcess.getComputer%28%29+%21%3D+null%29+%7B%0A%C2%A0+++++++++++++++Pair%3CInteger%2C+CloudComputer%3E+partIndexAndComputer+%3D%0AidToPartIndexAndComputerMap.get%28%0A%C2%A0+++++++++++++++++++++++originalProcess.getComputer%28%29.getId%28%29%29%3B%0A%C2%A0+++++++++++++++if+%28partIndexAndComputer+%3D%3D+null%29+%7B%0A%C2%A0+++++++++++++++++++throw+new+IllegalStateException%28%22The+initialized+process+%28%22+%2B%0AoriginalProcess%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+has+a+computer+%28%22+%2B+originalProcess.getComputer%28%29%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+which+doesn%27t+exist+in+the+originalSolution+%28%22+%2B%0AoriginalSolution+%2B+%22%29.%22%29%3B%0A282%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++++++if+%28partIndex+%21%3D+partIndexAndComputer.getLeft%28%29.intValue%28%29%29+%7B%0A%C2%A0+++++++++++++++++++throw+new+IllegalStateException%28%22The+initialized+process+%28%22+%2B%0AoriginalProcess%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+with+partIndex+%28%22+%2B+partIndex%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+has+a+computer+%28%22+%2B+originalProcess.getComputer%28%29%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+which+belongs+to+another+partIndex+%28%22+%2B%0ApartIndexAndComputer.getLeft%28%29+%2B+%22%29.%22%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++++++process.setComputer%28partIndexAndComputer.getRight%28%29%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++partIndex+%3D+%28partIndex+%2B+1%29+%25+partList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+partList%3B%0A%C2%A0+++%7D%0A%7D%0ATo+configure+values+of+a+SolutionPartitioner+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+solutionPartitionerCustomProperties+element%0Aand+use+custom+properties%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++%3CsolutionPartitionerClass%3E...CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CsolutionPartitionerCustomProperties%3E%0A%C2%A0+++++%3CmyPartCount%3E8%3C%2FmyPartCount%3E%0A%C2%A0+++++%3CmyMinimumProcessListSize%3E100%3C%2FmyMinimumProcessListSize%3E%0A%C2%A0+++%3C%2FsolutionPartitionerCustomProperties%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0A14.4.+Runnable+Part+Thread+Limit%0AWhen+running+a+multithreaded+solver%2C+such+as+Partitioned+Search%2C+CPU+power+can+quickly+become%0Aa+scarce+resource%2C+which+can+cause+other+processes+or+threads+to+hang+or+freeze.+However%2C+Planner%0Ahas+a+system+to+prevent+CPU+starving+of+other+processes+%28such+as+an+SSH+connection+in+production%0Aor+your+IDE+in+development%29+or+other+threads+%28such+as+the+servlet+threads+that+handle+REST%0Arequests%29.%0AAs+explained+in+sizing+hardware+and+software%2C+each+solver+%28including+each+child+solver%29+does+no+IO%0Aduring+solve%28%29+and+therefore+saturates+one+CPU+core+completely.+In+Partitioned+Search%2C+every%0Apartition+always+has+its+own+thread%2C+called+a+part+thread.+It+is+impossible+for+two+partitions+to+share%0Aa+thread%2C+because+of+asynchronous+termination%3A+the+second+thread+would+never+run.+Every+part%0Athread+will+try+to+consume+one+CPU+core+entirely%2C+so+if+there+are+more+partitions+than+CPU+cores%2C%0Athis+will+probably+hang+the+system.+Thread.setPriority%28%29+is+often+too+weak+to+solve+this+hogging%0Aproblem%2C+so+another+approach+is+used.%0AThe+runnablePartThreadLimit+parameter+specifies+how+many+part+threads+are+runnable+at+the+same%0Atime.+The+other+part+threads+will+temporarily+block+and+therefore+will+not+consume+any+CPU+power.%0A283%0AThis+parameter+basically+specifies+how+many+CPU+cores+are+donated+to+Planner.+All+part%0Athreads+share+the+CPU+cores+in+a+round-robin+manner+to+consume+%28more+or+less%29+the+same+number%0Aof+CPU+cycles%3A%0AThe+following+runnablePartThreadLimit+options+are+supported%3A%0A%E2%80%A2+UNLIMITED%3A+Allow+Planner+to+occupy+all+CPU+cores%2C+do+not+avoid+hogging.+Useful+if+a+no+hogging%0ACPU+policy+is+configured+on+the+OS+level.%0A%E2%80%A2+AUTO+%28default%29%3A+Let+Planner+decide+how+many+CPU+cores+to+occupy.+This+formula+is+based+on%0Aexperience.+It+does+not+hog+all+CPU+cores+on+a+multi-core+machine.%0A%E2%80%A2+Static+number%3A+The+number+of+CPU+cores+to+consume.+For+example%3A%0A%3CrunnablePartThreadLimit%3E2%3C%2FrunnablePartThreadLimit%3E%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+CPU+cores+to+occupy.+It+can+use+the+variable%0AavailableProcessorCount.+For+example%3A%0A%3CrunnablePartThreadLimit%3EavailableProcessorCount+-+2%3C%2FrunnablePartThreadLimit%3E%0A284%0AIf+the+runnablePartThreadLimit+is+equal+to+or+higher+than+the+number+of+available%0A%EF%81%B1+processors%2C+the+host+is+likely+to+hang+or+freeze%2C+unless+there+is+an+OS+specific+policy%0Ain+place+to+avoid+Planner+from+hogging+all+the+CPU+processors.%0A285%0AChapter+15.+Benchmarking+and+Tweaking%0A15.1.+Find+the+Best+Solver+Configuration%0APlanner+supports+several+optimization+algorithms%2C+so+you%E2%80%99re+probably+wondering+which+is+the+best%0Aone%3F+Although+some+optimization+algorithms+generally+perform+better+than+others%2C+it+really%0Adepends+on+your+problem+domain.+Most+solver+phases+have+parameters+which+can+be+tweaked.%0AThose+parameters+can+influence+the+results+a+lot%2C+even+though+most+solver+phases+work+pretty+well%0Aout-of-the-box.%0ALuckily%2C+Planner+includes+a+benchmarker%2C+which+allows+you+to+play+out+different+solver+phases+with%0Adifferent+settings+against+each+other+in+development%2C+so+you+can+use+the+best+configuration+for+your%0Aplanning+problem+in+production.%0A15.2.+Benchmark+Configuration%0A15.2.1.+Add+a+Dependency+on+optaplanner-benchmark%0AThe+benchmarker+is+in+a+separate+artifact+called+optaplanner-benchmark.%0AIf+you+use+Maven%2C+add+a+dependency+in+your+pom.xml+file%3A%0A286%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eoptaplanner-benchmark%3C%2FartifactId%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AThis+is+similar+for+Gradle%2C+Ivy+and+Buildr.+The+version+must+be+exactly+the+same+as+the+optaplanner-%0Acore+version+used+%28which+is+automatically+the+case+if+you+import+optaplanner-bom%29.%0AIf+you+use+ANT%2C+you%E2%80%99ve+probably+already+copied+the+required+jars+from+the+download+zip%E2%80%99s+binaries%0Adirectory.%0A15.2.2.+Run+a+Simple+Benchmark%0ATo+quickly+setup+a+benchmark%2C+create+a+PlannerBenchmarkFactory+from+your+SolverFactory%2C+load+a%0Afew+datasets+and+benchmark+them.+For+example%2C+with+3+datasets%3A%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28...%29%3B%0A%C2%A0+++++++PlannerBenchmarkFactory+benchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromSolverFactory%28solverFactory%29%3B%0A%C2%A0+++++++CloudBalance+dataset1+%3D+...%3B%0A%C2%A0+++++++CloudBalance+dataset2+%3D+...%3B%0A%C2%A0+++++++CloudBalance+dataset3+%3D+...%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+benchmarkFactory.buildPlannerBenchmark%0A%28dataset1%2C+dataset2%2C+dataset3%29%3B%0A%C2%A0+++++++plannerBenchmark.benchmarkAndShowReportInBrowser%28%29%3B%0AThis+generates+a+benchmark+report+in+local%2FbenchmarkReport+and+shows+it+in+your+browser+when+it%E2%80%99s%0Afinished.+The+SolverFactory%E2%80%99s+solver+configuration+needs+a+termination+to+limit+how+long+each%0Adataset+runs.+To+configure+a+different+benchmark+directory%2C+pass+a+%60File+parameter+to%0AcreateFromSolverFactory%28%29.%0AThe+generated+benchmark+report+already+contains+interesting+information%2C+but+it+doesn%E2%80%99t+allow%0Acomparing+solver+configurations+to+find+the+best+algorithm.+To+do+that%2C+set+up+a+benchmark%0Aconfiguration%3A%0A15.2.3.+Configure+and+Run+an+Advanced+Benchmark%0ABuild+a+PlannerBenchmark+instance+with+a+PlannerBenchmarkFactory.+Configure+it+with+a+benchmark%0Aconfiguration+XML+file%2C+provided+as+a+classpath+resource%3A%0A287%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fbenchmark%2FnqueensBenchmarkConfig.xml%22%29%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+plannerBenchmarkFactory%0A.buildPlannerBenchmark%28%29%3B%0A%C2%A0+++++++plannerBenchmark.benchmark%28%29%3B%0AA+benchmark+configuration+file+looks+like+this%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fcloudbalancing%2Funsolved%2F100computers-%0A300processes.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fcloudbalancing%2Funsolved%2F200computers-%0A600processes.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Common+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ETabu+Search%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Tabu+Search+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ESimulated+Annealing%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Simulated+Annealing+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ELate+Acceptance%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Late+Acceptance+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2FplannerBenchmark%3E%0AThis+PlannerBenchmark+will+try+three+configurations+%28Tabu+Search%2C+Simulated+Annealing+and+Late%0A288%0AAcceptance%29+on+two+data+sets+%28100computers-300processes+and+200computers-600processes%29%2C+so+it+will%0Arun+six+solvers.%0AEvery+%3CsolverBenchmark%3E+element+contains+a+solver+configuration+and+one+or+more%0A%3CinputSolutionFile%3E+elements.+It+will+run+the+solver+configuration+on+each+of+those+unsolved%0Asolution+files.+The+element+name+is+optional%2C+because+it+is+generated+if+absent.+The+inputSolutionFile%0Ais+read+by+a+SolutionFileIO+%28relative+to+the+working+directory%29.%0AUse+a+forward+slash+%28%2F%29+as+the+file+separator+%28for+example+in+the+element%0A%3CinputSolutionFile%3E%29.+That+will+work+on+any+platform+%28including+Windows%29.%0A%EF%81%9A%0ADo+not+use+backslash+%28%5C%29+as+the+file+separator%3A+that+breaks+portability+because+it%0Adoes+not+work+on+Linux+and+Mac.%0AThe+benchmark+report+will+be+written+in+the+directory+specified+by+the+%3CbenchmarkDirectory%3E%0Aelement+%28relative+to+the+working+directory%29.%0AIt%E2%80%99s+recommended+that+the+benchmarkDirectory+is+a+directory+ignored+for+source%0Acontrol+and+not+cleaned+by+your+build+system.+This+way+the+generated+files+are+not%0A%EF%81%9A+bloating+your+source+control+and+they+aren%E2%80%99t+lost+when+doing+a+build.+For+example%0Ain+git%2C+it+should+be+added+to+.gitignore.+Usually+that+directory+is+called+local.%0AIf+an+Exception+or+Error+occurs+in+a+single+benchmark%2C+the+entire+Benchmarker+will+not+fail-fast%0A%28unlike+everything+else+in+Planner%29.+Instead%2C+the+Benchmarker+will+continue+to+run+all+other%0Abenchmarks%2C+write+the+benchmark+report+and+then+fail+%28if+there+is+at+least+one+failing+single%0Abenchmark%29.+The+failing+benchmarks+will+be+clearly+marked+as+such+in+the+benchmark+report.%0A15.2.3.1.+Inherited+solver+benchmark%0ATo+lower+verbosity%2C+the+common+parts+of+multiple+%3CsolverBenchmark%3E+elements+are+extracted+to+the%0A%3CinheritedSolverBenchmark%3E+element.+Every+property+can+still+be+overwritten+per+%3CsolverBenchmark%3E%0Aelement.+Note+that+inherited+solver+phases+such+as+%3CconstructionHeuristic%3E+or+%3ClocalSearch%3E+are+not%0Aoverwritten+but+instead+are+added+to+the+tail+of+the+solver+phases+list.%0A15.2.4.+SolutionFileIO%3A+Input+And+Output+Of+Solution+Files%0A15.2.4.1.+SolutionFileIO+Interface%0AThe+benchmarker+needs+to+be+able+to+read+the+input+files+to+load+a+Solution.+Also%2C+it+optionally%0Awrites+the+best+Solution+of+each+benchmark+to+an+output+file.+It+does+that+through+the+SolutionFileIO%0Ainterface+which+has+a+read+and+write+method%3A%0A289%0Apublic+interface+SolutionFileIO%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++Solution_+read%28File+inputSolutionFile%29%3B%0A%C2%A0+++void+write%28Solution_+solution%2C+File+outputSolutionFile%29%3B%0A%7D%0AThe+SolutionFileIO+interface+is+in+the+optaplanner-persistence-common+jar+%28which+is+a+dependency+of%0Athe+optaplanner-benchmark+jar%29.+There+are+several+ways+to+serialize+a+solution%3A%0A15.2.4.2.+XStreamSolutionFileIO%3A+Serialize+To+And+From+An+XML+Format%0ATo+use+the+XStreamSolutionFileIO+instance+to+read+and+write+solutions%2C+configure+your+Solution+class%0Aas+an+xStreamAnnotatedClass%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++%3CxStreamAnnotatedClass%3E%0Aorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FxStreamAnnotatedClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F32queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AThose+input+files+need+to+have+been+written+with+a+XStreamSolutionFileIO+instance%2C+not+just+any%0AXStream+instance%2C+because+the+XStreamSolutionFileIO+uses+a+customized+XStream+instance.%0AThe+inputSolutionFile+needs+to+come+from+a+trusted+source%3A+if+it+contains+malicious%0Adata%2C+it+can+be+exploited.+The+XStreamSolutionFileIO+disables+the+XStream+security%0Aframework%2C+so+it+just+works+out+of+the+box.%0A%EF%81%AA%0AIf+you+expose+benchmarking+in+production%2C+use%0AXStreamSolutionFileIO.getXStream%28%29+to+enable+the+security+framework+and%0Aexplicitly+whitelist+all+marshalled+classes.%0AAdd+XStream+annotations+%28such+as+%40XStreamAlias%29+on+your+domain+classes+to+use+a+less+verbose+XML%0Aformat.+Regardless%2C+XML+is+still+a+very+verbose+format.+Reading+or+writing+large+datasets+in+this%0Aformat+can+cause+an+OutOfMemoryError%2C+StackOverflowError+or+large+performance+degradation.%0A15.2.4.3.+Custom+SolutionFileIO%3A+Serialize+To+And+From+A+Custom+Format%0AImplement+your+own+SolutionFileIO+implementation+and+configure+it+with+the+solutionFileIOClass%0Aelement+to+write+to+a+custom+format+%28such+as+a+txt+or+a+binary+format%29%3A%0A290%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0%0A%3CsolutionFileIOClass%3Eorg.optaplanner.examples.machinereassignment.persistence.MachineR%0AeassignmentFileIO%3C%2FsolutionFileIOClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3E%0Adata%2Fmachinereassignment%2Fimport%2Fmodel_a1_1.txt%3C%2FinputSolutionFile%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AIt%E2%80%99s+recommended+that+output+files+can+be+read+as+input+files%2C+which+implies+that%0AgetInputFileExtension%28%29+and+getOutputFileExtension%28%29+return+the+same+value.%0A%EF%81%B1+A+SolutionFileIO+implementation+must+be+thread-safe.%0A15.2.4.4.+Reading+An+Input+Solution+From+A+Database+%28Or+Other+Storage%29%0AThere+are+two+options+if+your+dataset+is+in+a+relational+database+or+another+type+of+repository%3A%0A%E2%80%A2+Extract+the+datasets+from+the+database+and+serialize+them+to+a+local+file+%28for+example+as+XML%0Awith+XStreamSolutionFileIO+if+XML+isn%E2%80%99t+too+verbose%29.+Then+use+those+files+in+%3CinputSolutionFile%3E%0Aelements.%0A%E2%97%A6+The+benchmarks+are+now+more+reliable+because+they+run+offline.%0A%E2%97%A6+Each+dataset+is+only+loaded+just+in+time.%0A%E2%80%A2+Load+all+the+datasets+in+advance+and+pass+them+to+the+buildPlannerBenchmark%28%29+method%3A%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+benchmarkFactory.buildPlannerBenchmark%0A%28dataset1%2C+dataset2%2C+dataset3%29%3B%0A15.2.5.+Warming+Up+The+HotSpot+Compiler%0AWithout+a+warm+up%2C+the+results+of+the+first+%28or+first+few%29+benchmarks+are+not+reliable%2C+because+they%0Awill+lose+CPU+time+on+HotSpot+JIT+compilation+%28and+possibly+DRL+compilation+too%29.%0ATo+avoid+that+distortion%2C+the+benchmarker+runs+some+of+the+benchmarks+for+30+seconds%2C+before%0Arunning+the+real+benchmarks.+That+default+warm+up+of+30+seconds+usually+suffices.+Change+it%2C+for%0Aexample+to+give+it+60+seconds%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CwarmUpSecondsSpentLimit%3E60%3C%2FwarmUpSecondsSpentLimit%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0ATurn+off+the+warm+up+phase+altogether+by+setting+it+to+zero%3A%0A291%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CwarmUpSecondsSpentLimit%3E0%3C%2FwarmUpSecondsSpentLimit%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+warm+up+time+budget+does+not+include+the+time+it+takes+to+load+the+datasets.%0A%EF%81%9A+With+large+datasets%2C+this+can+cause+the+warm+up+to+run+considerably+longer+than%0Aspecified+in+the+configuration.%0A15.2.6.+Benchmark+Blueprint%3A+A+Predefined+Configuration%0ATo+quickly+configure+and+run+a+benchmark+for+typical+solver+configs%2C+use+a%0AsolverBenchmarkBluePrint+instead+of+solverBenchmarks%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++%3CxStreamAnnotatedClass%3E%0Aorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FxStreamAnnotatedClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F32queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F64queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+++++%3CscoreDirectorFactory%3E%0A%C2%A0+++++++%3CscoreDrl%3E%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++++++%3CinitializingScoreTrend%3EONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+++++%3C%2FscoreDirectorFactory%3E%0A%C2%A0+++++%3Ctermination%3E%0A%C2%A0+++++++%3CminutesSpentLimit%3E1%3C%2FminutesSpentLimit%3E%0A%C2%A0+++++%3C%2Ftermination%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmarkBluePrint%3E%0A%C2%A0%0A%3CsolverBenchmarkBluePrintType%3EEVERY_CONSTRUCTION_HEURISTIC_TYPE_WITH_EVERY_LOCAL_SEARC%0AH_TYPE%3C%2FsolverBenchmarkBluePrintType%3E%0A%C2%A0+%3C%2FsolverBenchmarkBluePrint%3E%0A%3C%2FplannerBenchmark%3E%0AThe+following+SolverBenchmarkBluePrintTypes+are+supported%3A%0A292%0A%E2%80%A2+EVERY_CONSTRUCTION_HEURISTIC_TYPE%3A+Run+every+Construction+Heuristic+type+%28First+Fit%2C+First+Fit%0ADecreasing%2C+Cheapest+Insertion%2C+%E2%80%A6%29.%0A%E2%80%A2+EVERY_LOCAL_SEARCH_TYPE%3A+Run+every+Local+Search+type+%28Tabu+Search%2C+Late+Acceptance%2C+%E2%80%A6%29+with%0Athe+default+Construction+Heuristic.%0A%E2%80%A2+EVERY_CONSTRUCTION_HEURISTIC_TYPE_WITH_EVERY_LOCAL_SEARCH_TYPE%3A+Run+every+Construction%0AHeuristic+type+with+every+Local+Search+type.%0A15.2.7.+Write+The+Output+Solution+Of+Benchmark+Runs%0AThe+best+solution+of+each+benchmark+run+can+be+written+in+the+benchmarkDirectory.+By+default%2C+this%0Ais+disabled%2C+because+the+files+are+rarely+used+and+considered+bloat.+Also%2C+on+large+datasets%2C+writing%0Athe+best+solution+of+each+single+benchmark+can+take+quite+some+time+and+memory+%28causing+an%0AOutOfMemoryError%29%2C+especially+in+a+verbose+format+like+XStream+XML.%0ATo+write+those+solutions+in+the+benchmarkDirectory%2C+enable+writeOutputSolutionEnabled%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CwriteOutputSolutionEnabled%3Etrue%3C%2FwriteOutputSolutionEnabled%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A15.2.8.+Benchmark+Logging%0ABenchmark+logging+is+configured+like+solver+logging.%0ATo+separate+the+log+messages+of+each+single+benchmark+run+into+a+separate+file%2C+use+the+MDC+with%0Akey+singleBenchmark.name+in+a+sifting+appender.+For+example+with+Logback+in+logback.xml%3A%0A%C2%A0+%3Cappender+name%3D%22fileAppender%22+class%3D%22ch.qos.logback.classic.sift.SiftingAppender%22%3E%0A%C2%A0+++%3Cdiscriminator%3E%0A%C2%A0+++++%3Ckey%3EsingleBenchmark.name%3C%2Fkey%3E%0A%C2%A0+++++%3CdefaultValue%3Eapp%3C%2FdefaultValue%3E%0A%C2%A0+++%3C%2Fdiscriminator%3E%0A%C2%A0+++%3Csift%3E%0A%C2%A0+++++%3Cappender+name%3D%22fileAppender.%24%7BsingleBenchmark.name%7D%22+class%3D%22...FileAppender%22%3E%0A%C2%A0+++++++%3Cfile%3Elocal%2Flog%2FoptaplannerBenchmark-%24%7BsingleBenchmark.name%7D.log%3C%2Ffile%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2Fappender%3E%0A%C2%A0+++%3C%2Fsift%3E%0A%C2%A0+%3C%2Fappender%3E%0A15.3.+Benchmark+Report%0A293%0A15.3.1.+HTML+Report%0AAfter+running+a+benchmark%2C+an+HTML+report+will+be+written+in+the+benchmarkDirectory+with+the%0Aindex.html+filename.+Open+it+in+your+browser.+It+has+a+nice+overview+of+your+benchmark+including%3A%0A%E2%80%A2+Summary+statistics%3A+graphs+and+tables%0A%E2%80%A2+Problem+statistics+per+inputSolutionFile%3A+graphs+and+CSV%0A%E2%80%A2+Each+solver+configuration+%28ranked%29%3A+Handy+to+copy+and+paste%0A%E2%80%A2+Benchmark+information%3A+settings%2C+hardware%2C+%E2%80%A6%0A%EF%81%9A+Graphs+are+generated+by+the+excellent+JFreeChart+library.%0AThe+HTML+report+will+use+your+default+locale+to+format+numbers.+If+you+share+the+benchmark%0Areport+with+people+from+another+country%2C+consider+overwriting+the+locale+accordingly%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3Clocale%3Een_US%3C%2Flocale%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0A15.3.2.+Ranking+The+Solvers%0AThe+benchmark+report+automatically+ranks+the+solvers.+The+Solver+with+rank+0+is+called+the+favorite%0ASolver%3A+it+performs+best+overall%2C+but+it+might+not+be+the+best+on+every+problem.+It%E2%80%99s+recommended+to%0Ause+that+favorite+Solver+in+production.%0AHowever%2C+there+are+different+ways+of+ranking+the+solvers.+Configure+it+like+this%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingType%3ETOTAL_SCORE%3C%2FsolverRankingType%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+following+solverRankingTypes+are+supported%3A%0A%E2%80%A2+TOTAL_SCORE+%28default%29%3A+Maximize+the+overall+score%2C+so+minimize+the+overall+cost+if+all+solutions%0Awould+be+executed.%0A%E2%80%A2+WORST_SCORE%3A+Minimize+the+worst+case+scenario.%0A%E2%80%A2+TOTAL_RANKING%3A+Maximize+the+overall+ranking.+Use+this+if+your+datasets+differ+greatly+in+size+or%0Adifficulty%2C+producing+a+difference+in+Score+magnitude.%0A294%0ASolvers+with+at+least+one+failed+single+benchmark+do+not+get+a+ranking.+Solvers+with+not+fully%0Ainitialized+solutions+are+ranked+worse.%0ATo+use+a+custom+ranking%2C+implement+a+Comparator%3A%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingComparatorClass%3E%0A...TotalScoreSolverRankingComparator%3C%2FsolverRankingComparatorClass%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0AOr+by+implementing+a+weight+factory%3A%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingWeightFactoryClass%3E%0A...TotalRankSolverRankingWeightFactory%3C%2FsolverRankingWeightFactoryClass%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A15.4.+Summary+Statistics%0A15.4.1.+Best+Score+Summary+%28Graph+And+Table%29%0AShows+the+best+score+per+inputSolutionFile+for+each+solver+configuration.%0AUseful+for+visualizing+the+best+solver+configuration.%0A295%0AFigure+8.+Best+Score+Summary+Statistic%0A15.4.2.+Best+Score+Scalability+Summary+%28Graph%29%0AShows+the+best+score+per+problem+scale+for+each+solver+configuration.%0AUseful+for+visualizing+the+scalability+of+each+solver+configuration.%0AThe+problem+scale+will+report+0+if+any+%40ValueRangeProvider+method+signature%0A%EF%81%9A+returns+ValueRange+%28instead+of+CountableValueRange+or+Collection%29.%0A15.4.3.+Best+Score+Distribution+Summary+%28Graph%29%0AShows+the+best+score+distribution+per+inputSolutionFile+for+each+solver+configuration.%0AUseful+for+visualizing+the+reliability+of+each+solver+configuration.%0A296%0AFigure+9.+Best+Score+Distribution+Summary+Statistic%0AEnable+statistical+benchmarking+to+use+this+summary.%0A15.4.4.+Winning+Score+Difference+Summary+%28Graph+And+Table%29%0AShows+the+winning+score+difference+per+inputSolutionFile+for+each+solver+configuration.+The%0Awinning+score+difference+is+the+score+difference+with+the+score+of+the+winning+solver+configuration%0Afor+that+particular+inputSolutionFile.%0AUseful+for+zooming+in+on+the+results+of+the+best+score+summary.%0A15.4.5.+Worst+Score+Difference+Percentage+%28ROI%29+Summary+%28Graph+and%0ATable%29%0AShows+the+return+on+investment+%28ROI%29+per+inputSolutionFile+for+each+solver+configuration+if+you%E2%80%99d%0Aupgrade+from+the+worst+solver+configuration+for+that+particular+inputSolutionFile.%0AUseful+for+visualizing+the+return+on+investment+%28ROI%29+to+decision+makers.%0A15.4.6.+Score+Calculation+Speed+Summary+%28Graph+and+Table%29%0AShows+the+score+calculation+speed%3A+a+count+per+second+per+problem+scale+for+each+solver%0Aconfiguration.%0A297%0AUseful+for+comparing+different+score+calculators+and%2For+score+rule+implementations+%28presuming%0Athat+the+solver+configurations+do+not+differ+otherwise%29.+Also+useful+to+measure+the+scalability+cost+of%0Aan+extra+constraint.%0A15.4.7.+Time+Spent+Summary+%28Graph+And+Table%29%0AShows+the+time+spent+per+inputSolutionFile+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+visualizing+the+performance+of+construction+heuristics+%28presuming+that+no+other+solver%0Aphases+are+configured%29.%0A15.4.8.+Time+Spent+Scalability+Summary+%28Graph%29%0AShows+the+time+spent+per+problem+scale+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+extrapolating+the+scalability+of+construction+heuristics+%28presuming+that+no+other+solver%0Aphases+are+configured%29.%0A15.4.9.+Best+Score+Per+Time+Spent+Summary+%28Graph%29%0AShows+the+best+score+per+time+spent+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+visualizing+trade-off+between+the+best+score+versus+the+time+spent+for+construction%0Aheuristics+%28presuming+that+no+other+solver+phases+are+configured%29.%0A15.5.+Statistic+Per+Dataset+%28Graph+And+CSV%29%0A15.5.1.+Enable+A+Problem+Statistic%0AThe+benchmarker+supports+outputting+problem+statistics+as+graphs+and+CSV+%28comma+separated%0Avalues%29+files+to+the+benchmarkDirectory.+To+configure+one+or+more%2C+add+a+problemStatisticType+line%0Afor+each+one%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%2Fsolved%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++++%3CproblemStatisticType%3ESCORE_CALCULATION_SPEED%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0A298%0AThese+problem+statistics+can+slow+down+the+solvers+noticeably%2C+which+affects+the%0Abenchmark+results.+That%E2%80%99s+why+they+are+optional+and+only+BEST_SCORE+is+enabled+by%0Adefault.+To+disable+that+one+too%2C+use+problemStatisticEnabled%3A%0A%EF%81%9A+%C2%A0+++%3CproblemBenchmarks%3E%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticEnabled%3Efalse%3C%2FproblemStatisticEnabled%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AThe+summary+statistics+do+not+slow+down+the+solver+and+are+always+generated.%0AThe+following+types+are+supported%3A%0A15.5.2.+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29%0AShows+how+the+best+score+evolves+over+time.+It+is+run+by+default.+To+run+it+when+other+statistics+are%0Aconfigured%2C+also+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A299%0AFigure+10.+Best+Score+Over+Time+Statistic%0AA+time+gradient+based+algorithm+%28such+as+Simulated+Annealing%29+will+have+a%0Adifferent+statistic+if+it%E2%80%99s+run+with+a+different+time+limit+configuration.+That%E2%80%99s%0A%EF%81%9A+because+this+Simulated+Annealing+implementation+automatically+determines+its%0Avelocity+based+on+the+amount+of+time+that+can+be+spent.+On+the+other+hand%2C+for+the%0ATabu+Search+and+Late+Acceptance%2C+what+you+see+is+what+you%E2%80%99d+get.%0AThe+best+score+over+time+statistic+is+very+useful+to+detect+abnormalities%2C+such+as+a+potential%0Ascore+trap+which+gets+the+solver+temporarily+stuck+in+a+local+optima.%0A300%0A15.5.3.+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29%0ATo+see+how+the+step+score+evolves+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3ESTEP_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A301%0AFigure+11.+Step+Score+Over+Time+Statistic%0ACompare+the+step+score+statistic+with+the+best+score+statistic+%28especially+on+parts+for+which+the+best%0Ascore+flatlines%29.+If+it+hits+a+local+optima%2C+the+solver+should+take+deteriorating+steps+to+escape+it.+But+it%0Ashouldn%E2%80%99t+deteriorate+too+much+either.%0AThe+step+score+statistic+has+been+seen+to+slow+down+the+solver+noticeably+due+to+GC%0A%EF%81%B1+stress%2C+especially+for+fast+stepping+algorithms+%28such+as+Simulated+Annealing+and%0ALate+Acceptance%29.%0A15.5.4.+Score+Calculation+Speed+Statistic+%28Graph+And+CSV%29%0ATo+see+how+fast+the+scores+are+calculated%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3ESCORE_CALCULATION_SPEED%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A302%0AFigure+12.+Score+Calculation+Speed+Statistic%0AThe+initial+high+calculation+speed+is+typical+during+solution+initialization%3A+it%E2%80%99s+far%0Aeasier+to+calculate+the+score+of+a+solution+if+only+a+handful+planning+entities+have%0A%EF%81%9A+been+initialized%2C+than+when+all+the+planning+entities+are+initialized.%0AAfter+those+few+seconds+of+initialization%2C+the+calculation+speed+is+relatively+stable%2C%0Aapart+from+an+occasional+stop-the-world+garbage+collector+disruption.%0A15.5.5.+Best+Solution+Mutation+Over+Time+Statistic+%28Graph+And+CSV%29%0ATo+see+how+much+each+new+best+solution+differs+from+the+previous+best+solution%2C+by+counting+the%0Anumber+of+planning+variables+which+have+a+different+value+%28not+including+the+variables+that+have%0Achanged+multiple+times+but+still+end+up+with+the+same+value%29%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SOLUTION_MUTATION%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A303%0AFigure+13.+Best+Solution+Mutation+Over+Time+Statistic%0AUse+Tabu+Search+-+an+algorithm+that+behaves+like+a+human+-+to+get+an+estimation+on+how+difficult+it%0Awould+be+for+a+human+to+improve+the+previous+best+solution+to+that+new+best+solution.%0A15.5.6.+Move+Count+Per+Step+Statistic+%28Graph+And+CSV%29%0ATo+see+how+the+selected+and+accepted+move+count+per+step+evolves+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EMOVE_COUNT_PER_STEP%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A304%0AFigure+14.+Move+Count+Per+Step+Statistic%0AThis+statistic+has+been+seen+to+slow+down+the+solver+noticeably+due+to+GC+stress%2C%0A%EF%81%B1+especially+for+fast+stepping+algorithms+%28such+as+Simulated+Annealing+and+Late%0AAcceptance%29.%0A15.5.7.+Memory+Use+Statistic+%28Graph+And+CSV%29%0ATo+see+how+much+memory+is+used%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EMEMORY_USE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A305%0AFigure+15.+Memory+Use+Statistic%0A%EF%81%B1+The+memory+use+statistic+has+been+seen+to+affect+the+solver+noticeably.%0A15.6.+Statistic+Per+Single+Benchmark+%28Graph+And+CSV%29%0A15.6.1.+Enable+A+Single+Statistic%0AA+single+statistic+is+static+for+one+dataset+for+one+solver+configuration.+Unlike+a+problem+statistic%2C+it%0Adoes+not+aggregate+over+solver+configurations.%0AThe+benchmarker+supports+outputting+single+statistics+as+graphs+and+CSV+%28comma+separated+values%29%0Afiles+to+the+benchmarkDirectory.+To+configure+one%2C+add+a+singleStatisticType+line%3A%0A306%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%2Fsolved%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3E...%3C%2FproblemStatisticType%3E%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_BEST_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AMultiple+singleStatisticType+elements+are+allowed.%0AThese+statistic+per+single+benchmark+can+slow+down+the+solver+noticeably%2C+which%0A%EF%81%9A+affects+the+benchmark+results.+That%E2%80%99s+why+they+are+optional+and+not+enabled+by%0Adefault.%0AThe+following+types+are+supported%3A%0A15.6.2.+Constraint+Match+Total+Best+Score+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+constraints+are+matched+in+the+best+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3ECONSTRAINT_MATCH_TOTAL_BEST_SCORE%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A307%0AFigure+16.+Constraint+Match+Total+Best+Score+Diff+Over+Time+Statistic%0ARequires+the+score+calculation+to+support+constraint+matches.+Drools+score+calculation+supports%0Aconstraint+matches+automatically%2C+but+incremental+Java+score+calculation+requires+more+work.%0A%EF%81%B1+The+constraint+match+total+statistics+affect+the+solver+noticeably.%0A15.6.3.+Constraint+Match+Total+Step+Score+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+constraints+are+matched+in+the+step+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3ECONSTRAINT_MATCH_TOTAL_STEP_SCORE%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A308%0AFigure+17.+Constraint+Match+Total+Step+Score+Diff+Over+Time+Statistic%0AAlso+requires+the+score+calculation+to+support+constraint+matches.%0A%EF%81%B1+The+constraint+match+total+statistics+affect+the+solver+noticeably.%0A15.6.4.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+move+types+improve+the+best+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_BEST_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A309%0AFigure+18.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic%0A15.6.5.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+how+much+each+winning+step+affects+the+step+score+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_STEP_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A310%0AFigure+19.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic%0A15.7.+Advanced+Benchmarking%0A15.7.1.+Benchmarking+Performance+Tricks%0A15.7.1.1.+Parallel+Benchmarking+On+Multiple+Threads%0AIf+you+have+multiple+processors+available+on+your+computer%2C+you+can+run+multiple+benchmarks+in%0Aparallel+on+multiple+threads+to+get+your+benchmarks+results+faster%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CparallelBenchmarkCount%3EAUTO%3C%2FparallelBenchmarkCount%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0ARunning+too+many+benchmarks+in+parallel+will+affect+the+results+of+benchmarks%0A%EF%81%B1+negatively.+Leave+some+processors+unused+for+garbage+collection+and+other%0Aprocesses.%0AThe+following+parallelBenchmarkCounts+are+supported%3A%0A311%0A%E2%80%A2+1+%28default%29%3A+Run+all+benchmarks+sequentially.%0A%E2%80%A2+AUTO%3A+Let+Planner+decide+how+many+benchmarks+to+run+in+parallel.+This+formula+is+based+on%0Aexperience.+It%E2%80%99s+recommended+to+prefer+this+over+the+other+parallel+enabling+options.%0A%E2%80%A2+Static+number%3A+The+number+of+benchmarks+to+run+in+parallel.%0A%3CparallelBenchmarkCount%3E2%3C%2FparallelBenchmarkCount%3E%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+benchmarks+to+run+in+parallel.+It+can+use+the%0Avariable+availableProcessorCount.+For+example%3A%0A%3CparallelBenchmarkCount%3E%28availableProcessorCount+%2F+2%29+%2B+1%3C%2FparallelBenchmarkCount%3E%0AThe+parallelBenchmarkCount+is+always+limited+to+the+number+of+available%0A%EF%81%9A+processors.+If+it%E2%80%99s+higher%2C+it+will+be+automatically+decreased.%0AIf+you+have+a+computer+with+slow+or+unreliable+cooling%2C+increasing+the%0AparallelBenchmarkCount+above+one+%28even+on+AUTO%29+may+overheat+your+CPU.%0A%EF%81%9A+The+sensors+command+can+help+you+detect+if+this+is+the+case.+It+is+available+in+the%0Apackage+lm_sensors+or+lm-sensors+in+most+Linux+distributions.+There+are+several%0Afreeware+tools+available+for+Windows+too.%0AThe+benchmarker+uses+a+thread+pool+internally%2C+but+you+can+optionally+plug+in+a+custom%0AThreadFactory%2C+for+example+when+running+benchmarks+on+an+application+server+or+a+cloud%0Aplatform%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CthreadFactoryClass%3E...MyCustomThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AIn+the+future%2C+we+will+also+support+multi-JVM+benchmarking.+This+feature+is%0A%EF%81%9A+independent+of+multithreaded+solving+or+multi-JVM+solving.%0A15.7.2.+Statistical+Benchmarking%0ATo+minimize+the+influence+of+your+environment+and+the+Random+Number+Generator+on+the%0Abenchmark+results%2C+configure+the+number+of+times+each+single+benchmark+run+is+repeated.+The%0Aresults+of+those+runs+are+statistically+aggregated.+Each+individual+result+is+also+visible+in+the+report%2C%0Aas+well+as+plotted+in+the+best+score+distribution+summary.%0AJust+add+a+%3CsubSingleCount%3E+element+to+an+%3CinheritedSolverBenchmark%3E+element+or+in+a%0A%3CsolverBenchmark%3E+element%3A%0A312%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+++%3CsubSingleCount%3E10%3C%2FsubSingleCount%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+subSingleCount+defaults+to+1+%28so+no+statistical+benchmarking%29.%0AIf+subSingleCount+is+higher+than+1%2C+the+benchmarker+will+automatically+use+a%0A%EF%81%9A+differentRandom+seed+for+every+sub+single+run%2C+without+losing+reproducibility+%28for%0Aeach+sub+single+index%29+in+EnvironmentModeREPRODUCIBLE+and+lower.%0A15.7.3.+Template+Based+Benchmarking+And+Matrix+Benchmarking%0AMatrix+benchmarking+is+benchmarking+a+combination+of+value+sets.+For+example%3A+benchmark+four%0AentityTabuSize+values+%285%2C+7%2C+11+and+13%29+combined+with+three+acceptedCountLimit+values+%28500%2C+1000+and%0A2000%29%2C+resulting+in+12+solver+configurations.%0ATo+reduce+the+verbosity+of+such+a+benchmark+configuration%2C+you+can+use+a+Freemarker+template+for%0Athe+benchmark+configuration+instead%3A%0A313%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%3C%23list+%5B5%2C+7%2C+11%2C+13%5D+as+entityTabuSize%3E%0A%3C%23list+%5B500%2C+1000%2C+2000%5D+as+acceptedCountLimit%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ETabu+Search+entityTabuSize+%24%7BentityTabuSize%7D+acceptedCountLimit%0A%24%7BacceptedCountLimit%7D%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3ClocalSearch%3E%0A%C2%A0+++++++%3CunionMoveSelector%3E%0A%C2%A0+++++++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++++%3C%2FunionMoveSelector%3E%0A%C2%A0+++++++%3Cacceptor%3E%0A%C2%A0+++++++++%3CentityTabuSize%3E%24%7BentityTabuSize%7D%3C%2FentityTabuSize%3E%0A%C2%A0+++++++%3C%2Facceptor%3E%0A%C2%A0+++++++%3Cforager%3E%0A%C2%A0+++++++++%3CacceptedCountLimit%3E%24%7BacceptedCountLimit%7D%3C%2FacceptedCountLimit%3E%0A%C2%A0+++++++%3C%2Fforager%3E%0A%C2%A0+++++%3C%2FlocalSearch%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2F%23list%3E%0A%3C%2F%23list%3E%0A%3C%2FplannerBenchmark%3E%0ATo+configure+Matrix+Benchmarking+for+Simulated+Annealing+%28or+any+other+configuration+that%0Ainvolves+a+Score+template+variable%29%2C+use+the+replace%28%29+method+in+the+solver+benchmark+name%0Aelement%3A%0A314%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%3C%23list+%5B%221hard%2F10soft%22%2C+%221hard%2F20soft%22%2C+%221hard%2F50soft%22%2C+%221hard%2F70soft%22%5D+as%0AstartingTemperature%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ESimulated+Annealing+startingTemperature+%24%7BstartingTemperature%3Freplace%28%22%2F%22%2C%0A%22_%22%29%7D%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3ClocalSearch%3E%0A%C2%A0+++++++%3Cacceptor%3E%0A%C2%A0+++++++++%3CsimulatedAnnealingStartingTemperature%3E%0A%24%7BstartingTemperature%7D%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++++++%3C%2Facceptor%3E%0A%C2%A0+++++%3C%2FlocalSearch%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2F%23list%3E%0A%3C%2FplannerBenchmark%3E%0AA+solver+benchmark+name+doesn%E2%80%99t+allow+some+characters+%28such+a+%2F%29+because+the%0A%EF%81%9A+name+is+also+used+a+file+name.%0AAnd+build+it+with+the+class+PlannerBenchmarkFactory%3A%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromFreemarkerXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Foptional%2Fbenchmark%2FcloudBalancingBenchmarkCon%0AfigTemplate.xml.ftl%22%29%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+plannerBenchmarkFactory%0A.buildPlannerBenchmark%28%29%3B%0A15.7.4.+Benchmark+Report+Aggregation%0AThe+BenchmarkAggregator+takes+one+or+more+existing+benchmarks+and+merges+them+into+new%0Abenchmark+report%2C+without+actually+running+the+benchmarks+again.%0A315%0AThis+is+useful+to%3A%0A%E2%80%A2+Report+on+the+impact+of+code+changes%3A+Run+the+same+benchmark+configuration+before+and%0Aafter+the+code+changes%2C+then+aggregate+a+report.%0A%E2%80%A2+Report+on+the+impact+of+dependency+upgrades%3A+Run+the+same+benchmark+configuration%0Abefore+and+after+upgrading+the+dependency%2C+then+aggregate+a+report.%0A%E2%80%A2+Condense+a+too+verbose+report%3A+Select+only+the+interesting+solver+benchmarks+from+the%0Aexisting+report.+This+especially+useful+on+template+reports+to+make+the+graphs+readable.%0A%E2%80%A2+Partially+rerun+a+benchmark%3A+Rerun+part+of+an+existing+report+%28for+example+only+the+failed+or%0Ainvalid+solvers%29%2C+then+recreate+the+original+intended+report+with+the+new+values.%0ATo+use+it%2C+provide+a+PlannerBenchmarkFactory+to+the+BenchmarkAggregatorFrame+to+display+the+GUI%3A%0A%C2%A0+++public+static+void+main%28String%5B%5D+args%29+%7B%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fbenchmark%2FnqueensBenchmarkConfig.xml%22%29%3B%0A%C2%A0+++++++BenchmarkAggregatorFrame.createAndDisplay%28plannerBenchmarkFactory%29%3B%0A%C2%A0+++%7D%0A316%0ADespite+that+it+uses+a+benchmark+configuration+as+input%2C+it+ignores+all+elements+of%0A%EF%81%B1+that+configuration%2C+except+for+the+elements+%3CbenchmarkDirectory%3E+and%0A%3CbenchmarkReport%3E.%0AIn+the+GUI%2C+select+the+interesting+benchmarks+and+click+the+button+to+generate+the+report.%0AAll+the+input+reports+which+are+being+merged+should+have+been+generated+with+the%0Asame+Planner+version+%28excluding+hotfix+differences%29+as+the+BenchmarkAggregator.%0A%EF%81%9A+Using+reports+from+different+Planner+major+or+minor+versions+are+not+guaranteed%0Ato+succeed+and+deliver+correct+information%2C+because+the+benchmark+report+data%0Astructure+often+changes.%0A317%0AChapter+16.+Repeated+Planning%0A16.1.+Introduction+to+Repeated+Planning%0AThe+problem+facts+used+to+create+a+solution+may+change+before+or+during+the+execution+of+that%0Asolution.+Delaying+planning+in+order+to+lower+the+risk+of+problem+facts+changing+is+not+ideal%2C+as+an%0Aincomplete+plan+is+preferable+to+no+plan.%0AThe+following+examples+demonstrate+situations+where+planning+solutions+need+to+be+altered+due+to%0Aunpredictable+changes%3A%0A%E2%80%A2+Unforeseen+fact+changes%0A%E2%97%A6+An+employee+assigned+to+a+shift+calls+in+sick.%0A%E2%97%A6+An+airplane+scheduled+to+take+off+has+a+technical+delay.%0A%E2%97%A6+One+of+the+machines+or+vehicles+break+down.%0AUnforeseen+fact+changes+benefit+from+using+backup+planning.%0A%E2%80%A2+Cannot+assign+all+entities+immediately%0ALeave+some+unassigned.+For+example%3A%0A%E2%97%A6+There+are+10+shifts+at+the+same+time+to+assign+but+only+nine+employees+to+handle+shifts.%0AFor+this+type+of+planning%2C+use+overconstrained+planning.%0A%E2%80%A2+Unknown+long+term+future+facts%0AFor+example%3A%0A%E2%97%A6+Hospital+admissions+for+the+next+two+weeks+are+reliable%2C+but+those+for+week+three+and+four%0Aare+less+reliable%2C+and+for+week+five+and+beyond+are+not+worth+planning+yet.%0AThis+problem+benefits+from+continuous+planning.%0A%E2%80%A2+Constantly+changing+problem+facts%0AUse+real-time+planning.%0AMore+CPU+time+results+in+a+better+planning+solution.%0APlanner+allows+you+to+start+planning+earlier%2C+despite+unforeseen+changes%2C+as+the+optimization%0Aalgorithms+support+planning+a+solution+that+has+already+been+partially+planned.+This+is+known+as%0Arepeated+planning.%0A16.2.+Backup+Planning%0ABackup+planning+adds+extra+score+constraints+to+create+space+in+the+planning+for+when+things+go%0A318%0Awrong.+That+creates+a+backup+plan+within+the+plan+itself.%0AAn+example+of+backup+planning+is+as+follows%3A%0A1.+Create+an+extra+score+constraint.+For+example%3A%0A%E2%97%A6+Assign+an+employee+as+the+spare+employee+%28one+for+every+10+shifts+at+the+same+time%29.%0A%E2%97%A6+Keep+one+hospital+bed+open+in+each+department.%0A2.+Change+the+planning+problem+when+an+unforeseen+event+occurs.%0AFor+example%2C+if+an+employee+calls+in+sick%3A%0A%E2%97%A6+Delete+the+sick+employee+and+leave+their+shifts+unassigned.%0A%E2%97%A6+Restart+the+planning%2C+starting+from+that+solution%2C+which+now+has+a+different+score.%0AThe+construction+heuristics+fills+in+the+newly+created+gaps+%28probably+with+the+spare+employee%29+and%0Athe+metaheuristics+will+improve+it+even+further.%0A16.3.+Overconstrained+Planning%0AWhen+there+is+no+feasible+solution+to+assign+all+planning+entities%2C+it+is+preferable+to+assign+as+many%0Aentities+as+possible+without+breaking+hard+constraints.+This+is+called+overconstrained+planning.%0ABy+default%2C+Planner+assigns+all+planning+entities%2C+overloads+the+planning+values%2C+and+therefore%0Abreaks+hard+constraints.+There+are+two+ways+to+avoid+this%3A%0A%E2%80%A2+Use+nullable+planning+variables%2C+so+that+some+entities+are+unassigned.%0A%E2%80%A2+Add+virtual+values+to+catch+the+unassigned+entities.%0A16.3.1.+Overconstrained+Planning+with+Nullable+Variables%0AIf+we+handle+overconstrained+planning+with+nullable+variables%2C+the+overload+entities+will+be+left%0Aunassigned%3A%0A319%0ATo+implement+this%3A%0A1.+Add+an+additional+score+level+%28usually+a+medium+level+between+the+hard+and+soft+level%29+by%0Aswitching+Score+type.%0A2.+Make+the+planning+variable+nullable.%0A3.+Add+a+score+constraint+on+the+new+level+%28usually+a+medium+constraint%29+to+penalize+the+number%0Aof+unassigned+entities+%28or+a+weighted+sum+of+them%29.%0A16.3.2.+Overconstrained+Planning+with+Virtual+Values%0AIn+overconstrained+planning+it+is+often+useful+to+know+which+resources+are+lacking.+In%0Aoverconstrained+planning+with+virtual+values%2C+the+solution+indicates+which+resources+to+buy.%0ATo+implement+this%3A%0A1.+Add+an+additional+score+level+%28usually+a+medium+level+between+the+hard+and+soft+level%29+by%0Aswitching+Score+type.%0A2.+Add+a+number+of+virtual+values.+It+can+be+difficult+to+determine+a+good+formula+to+calculate+that%0Anumber%3A%0A%E2%97%A6+Do+not+add+too+many%2C+as+that+will+decrease+solver+efficiency.%0A%E2%97%A6+Importantly%2C+do+not+add+too+few+as+that+will+lead+to+an+infeasible+solution.%0A3.+Add+a+score+constraint+on+the+new+level+%28usually+a+medium+constraint%29+to+penalize+the+number%0A320%0Aof+virtual+assigned+entities+%28or+a+weighted+sum+of+them%29.%0A4.+Optionally%2C+change+all+soft+constraints+to+ignore+virtual+assigned+entities.%0A16.4.+Continuous+Planning+%28Windowed+Planning%29%0AContinuous+planning+is+the+technique+of+planning+one+or+more+upcoming+planning+periods+at+the%0Asame+time+and+repeating+that+process+monthly%2C+weekly%2C+daily%2C+hourly%2C+or+even+more+frequently.%0AHowever%2C+as+time+is+infinite%2C+planning+all+future+time+periods+is+impossible.%0AIn+the+employee+rostering+example+above%2C+we+re-plan+every+four+days.+Each+time%2C+we+actually+plan+a%0Awindow+of+12+days%2C+but+we+only+publish+the+first+four+days%2C+which+is+stable+enough+to+share+with+the%0Aemployees%2C+so+they+can+plan+their+social+life+accordingly.%0A321%0AIn+the+hospital+bed+planning+example+above%2C+notice+the+difference+between+the+original+planning+of%0ANovember+1st+and+the+new+planning+of+November+5th%3A+some+problem+facts+%28F%2C+H%2C+I%2C+J%2C+K%29+changed+in%0Athe+meantime%2C+which+results+in+unrelated+planning+entities+%28G%29+changing+too.%0AThe+planning+window+can+be+split+up+in+several+stages%3A%0A%E2%80%A2+History%0AImmutable+past+time+periods.+It+contains+only+immovable+entities.%0A%E2%97%A6+Recent+historic+entities+can+also+affect+score+constraints+that+apply+to+movable+entities.+For%0Aexample%2C+in+nurse+rostering%2C+a+nurse+that+has+worked+the+last+three+historic+weekends+in+a%0Arow+should+not+be+assigned+to+three+more+weekends+in+a+row%2C+because+she+requires+a+one%0Afree+weekend+per+month.%0A%E2%97%A6+Do+not+load+all+historic+entities+in+memory%3A+even+though+immovable+entities+do+not+affect%0Asolving+performance%2C+they+can+cause+out+of+memory+problems+when+the+data+grows+to+years.%0AOnly+load+those+that+might+still+affect+the+current+constraints+with+a+good+safety+margin.%0A%E2%80%A2+Published%0AUpcoming+time+periods+that+have+been+published.+They+contain+only+Immovable+and%2For+semi-%0Aimmovable+planning+entities.%0A%E2%97%A6+The+published+schedule+has+been+shared+with+the+business.+For+example%2C+in+nurse+rostering%2C%0Athe+nurses+will+use+this+schedule+to+plan+their+personal+lives%2C+so+they+require+a+publish+notice%0A322%0Aof+for+example+3+weeks+in+advance.+Normal+planning+will+not+change+that+part+of+schedule.%0AChanging+that+schedule+later+is+disruptive%2C+but+were+exceptions+force+us+to+do+them+anyway%0A%28for+example+someone+calls+in+sick%29%2C+do+change+this+part+of+the+planning+while+minimizing%0Adisruption+with+non-disruptive+replanning.%0A%E2%80%A2+Draft%0AUpcoming+time+periods+after+the+published+time+periods+that+can+change+freely.+They+contain%0Amovable+planning+entities%2C+except+for+any+that+are+immovable+for+other+reasons+%28such+as+being%0Apinned+by+a+user%29.%0A%E2%97%A6+The+first+part+of+the+draft%2C+called+the+final+draft%2C+will+be+published%2C+so+these+planning+entities%0Acan+change+one+last+time.+The+publishing+frequency%2C+for+example+once+per+week%2C+determines%0Athe+number+of+time+periods+that+change+from+draft+to+published.%0A%E2%97%A6+The+latter+time+periods+of+the+draft+are+likely+change+again+in+later+planning+efforts%2C%0Aespecially+if+some+of+the+problem+facts+change+by+then+%28for+example+nurse+Ann+doesn%E2%80%99t+want%0Ato+work+on+one+of+those+days%29.%0ADespite+that+these+latter+planning+entities+might+still+change+a+lot%2C+we+can%E2%80%99t+leave+them+out%0Afor+later%2C+because+we+would+risk+painting+ourselves+in+a+corner.+For+example%2C+in+employee%0Arostering+we+could+have+all+our+rare+skilled+employees+working+the+last+5+days+of+the+week%0Athat+gets+published%2C+which+won%E2%80%99t+reduce+the+score+of+that+week%2C+but+will+make+it+impossible%0Afor+us+to+deliver+a+feasible+schedule+the+next+week.+So+the+draft+length+needs+to+be+longer%0Athan+the+part+that+will+be+published+first.%0A%E2%97%A6+That+draft+part+is+usually+not+shared+with+the+business+yet%2C+because+it+is+too+volatile+and+it%0Awould+only+raise+false+expectations.+However%2C+it+is+stored+in+the+database+and+used+as+a%0Astarting+point+for+the+next+solver.%0A%E2%80%A2+Unplanned+%28out+of+scope%29%0APlanning+entities+that+are+not+in+the+current+planning+window.%0A%E2%97%A6+If+the+planning+window+is+too+small+to+plan+all+entities%2C+you%E2%80%99re+dealing+with+overconstrained%0Aplanning.%0A%E2%97%A6+If+time+is+a+planning+variable%2C+the+size+of+the+planning+window+is+determined+dynamically%2C+in%0Awhich+case+the+unplanned+stage+is+not+applicable.%0A323%0A16.4.1.+Immovable+Planning+Entities%0AAn+immovable+planning+entity+doesn%E2%80%99t+change+during+solving.+This+is+commonly+used+by+users+to%0Apin+down+one+or+more+specific+assignments+and+force+Planner+to+schedule+around+those+fixed%0Aassignments.%0A16.4.1.1.+Pin+Down+Planning+Entities+with+%40PlanningPin%0ATo+make+some+planning+entities+immovable%2C+add+an+%40PlanningPin+annotation+on+a+boolean+getter+or%0Afield+of+the+planning+entity+class.+That+boolean+is+true+if+the+entity+is+immovable+%28pinned+down+to+its%0Acurrent+planning+values%29+and+false+otherwise.%0A1.+Add+the+%40PlanningPin+annotation+on+a+boolean%3A%0A324%0A%40PlanningEntity%0Apublic+class+Lecture+%7B%0A%C2%A0+++private+boolean+pinned%3B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningPin%0A%C2%A0+++public+boolean+isPinned%28%29+%7B%0A%C2%A0+++++++return+pinned%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0AIn+the+example+above%2C+if+pinned+is+true%2C+the+lecture+will+not+be+assigned+to+another+period+or+room%0A%28even+if+the+current+period+and+rooms+fields+are+null%29.%0A16.4.1.2.+Configure+a+Movable+EntitySelectionFilter%0AAlternatively%2C+to+make+some+planning+entities+immovable%2C+add+an+entity+SelectionFilter+that%0Areturns+true+if+an+entity+is+movable%2C+and+false+if+it+is+immovable.+This+is+more+flexible+and+more%0Averbose+than+the+%40PlanningPin+approach.%0AFor+example+on+the+nurse+rostering+example%3A%0A1.+Add+the+SelectionFilter%3A%0Apublic+class+MovableShiftAssignmentSelectionFilter+implements+SelectionFilter%0A%3CNurseRoster%2C+ShiftAssignment%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CNurseRoster%3E+scoreDirector%2C+ShiftAssignment%0AshiftAssignment%29+%7B%0A%C2%A0+++++++NurseRoster+nurseRoster+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++ShiftDate+shiftDate+%3D+shiftAssignment.getShift%28%29.getShiftDate%28%29%3B%0A%C2%A0+++++++return+nurseRoster.getNurseRosterInfo%28%29.isInPlanningWindow%28shiftDate%29%3B%0A%C2%A0+++%7D%0A%7D%0A2.+Configure+the+SelectionFilter%3A%0A%40PlanningEntity%28movableEntitySelectionFilter+%3D%0AMovableShiftAssignmentSelectionFilter.class%29%0Apublic+class+ShiftAssignment+%7B%0A%C2%A0+++...%0A%7D%0A325%0A16.4.2.+Nonvolatile+Replanning+to+Minimize+Disruption+%28Semi-movable%0APlanning+Entities%29%0AReplanning+an+existing+plan+can+be+very+disruptive.+If+the+plan+affects+humans+%28such+as+employees%2C%0Adrivers%2C+%E2%80%A6%29%2C+very+disruptive+changes+are+often+undesirable.+In+such+cases%2C+nonvolatile+replanning%0Ahelps+by+restricting+planning+freedom%3A+the+gain+of+changing+a+plan+must+be+higher+than+the%0Adisruption+it+causes.+This+is+usually+implemented+by+taxing+all+planning+entities+that+change.%0AIn+the+machine+reassignment+example%2C+the+entity+has+both+the+planning+variable+machine+and+its%0Aoriginal+value+originalMachine%3A%0A326%0A%40PlanningEntity%28...%29%0Apublic+class+ProcessAssignment+%7B%0A%C2%A0+++private+MrProcess+process%3B%0A%C2%A0+++private+Machine+originalMachine%3B%0A%C2%A0+++private+Machine+machine%3B%0A%C2%A0+++public+Machine+getOriginalMachine%28%29+%7B...%7D%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Machine+getMachine%28%29+%7B...%7D%0A%C2%A0+++public+boolean+isMoved%28%29+%7B%0A%C2%A0+++++++return+originalMachine+%21%3D+null+%26%26+originalMachine+%21%3D+machine%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0ADuring+planning%2C+the+planning+variable+machine+changes.+By+comparing+it+with+the+originalMachine%2C%0Aa+change+in+plan+can+be+penalized%3A%0Arule+%22processMoved%22%0A%C2%A0+++when%0A%C2%A0+++++++ProcessAssignment%28moved+%3D%3D+true%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-1000%29%3B%0Aend%0AThe+soft+penalty+of+-1000+means+that+a+better+solution+is+only+accepted+if+it+improves+the+soft+score%0Afor+at+least+1000+points+per+variable+changed+%28or+if+it+improves+the+hard+score%29.%0A16.5.+Real-time+Planning%0ATo+do+real-time+planning%2C+combine+the+following+planning+techniques%3A%0A%E2%80%A2+Backup+planning+-+adding+extra+score+constraints+to+allow+for+unforeseen+changes.%0A%E2%80%A2+Continuous+planning+-+planning+for+one+or+more+future+planning+periods.%0A%E2%80%A2+Short+planning+windows.%0AThis+lowers+the+burden+of+real-time+planning.%0AAs+time+passes%2C+the+problem+itself+changes.+Consider+the+vehicle+routing+use+case%3A%0A327%0AIn+the+example+above%2C+three+customers+are+added+at+different+times+%2807%3A56%2C+08%3A02+and+08%3A45%29%2C+after%0Athe+original+customer+set+finished+solving+at+07%3A55%2C+and+in+some+cases%2C+after+the+vehicles+already+left.%0APlanner+can+handle+such+scenarios+with+ProblemFactChange+%28in+combination+with+immovable%0Aplanning+entities%29.%0A16.5.1.+ProblemFactChange%0AWhile+the+Solver+is+solving%2C+one+of+the+problem+facts+may+be+changed+by+an+outside+event.+For%0Aexample%2C+an+airplane+is+delayed+and+needs+the+runway+at+a+later+time.%0ADo+not+change+the+problem+fact+instances+used+by+the+Solver+while+it+is+solving%0A%EF%81%AA+%28from+another+thread+or+even+in+the+same+thread%29%2C+as+that+will+corrupt+it.%0AAdd+a+ProblemFactChange+to+the+Solver%2C+which+it+executes+in+the+solver+thread+as+soon+as+possible.+For%0Aexample%3A%0A328%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++boolean+addProblemFactChange%28ProblemFactChange%3CSolution_%3E+problemFactChange%29%3B%0A%C2%A0+++boolean+isEveryProblemFactChangeProcessed%28%29%3B%0A%C2%A0+++...%0A%7D%0Apublic+interface+ProblemFactChange%3CSolution_%3E+%7B%0A%C2%A0+++void+doChange%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%7D%0AThe+ScoreDirector+must+be+updated+with+any+change+on+the+problem+facts+of%0A%EF%81%B1+planning+entities+in+a+ProblemFactChange.%0ATo+write+a+ProblemFactChange+correctly%2C+it+is+important+to+understand+the+behavior+of+a+planning%0Aclone.%0AA+planning+clone+of+a+solution+must+fulfill+these+requirements%3A%0A%E2%80%A2+The+clone+must+represent+the+same+planning+problem.+Usually+it+reuses+the+same+instances+of%0Athe+problem+facts+and+problem+fact+collections+as+the+original.%0A%E2%80%A2+The+clone+must+use+different%2C+cloned+instances+of+the+entities+and+entity+collections.+Changes+to%0Aan+original+Solution+entity%E2%80%99s+variables+must+not+affect+its+clone.%0A16.5.1.1.+Cloud+Balancing+ProblemFactChange+Example%0AConsider+the+following+example+of+a+ProblemFactChange+implementation+in+the+cloud+balancing+use%0Acase%3A%0A329%0A%C2%A0+++public+void+deleteComputer%28final+CloudComputer+computer%29+%7B%0A%C2%A0+++++++solver.addProblemFactChange%28scoreDirector+-%3E+%7B%0A%C2%A0+++++++++++CloudBalance+cloudBalance+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++++++CloudComputer+workingComputer+%3D+scoreDirector.lookUpWorkingObject%28%0Acomputer%29%3B%0A%C2%A0+++++++++++%2F%2F+First+remove+the+problem+fact+from+all+planning+entities+that+use+it%0A%C2%A0+++++++++++for+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++++++if+%28process.getComputer%28%29+%3D%3D+workingComputer%29+%7B%0A%C2%A0+++++++++++++++++++scoreDirector.beforeVariableChanged%28process%2C+%22computer%22%29%3B%0A%C2%A0+++++++++++++++++++process.setComputer%28null%29%3B%0A%C2%A0+++++++++++++++++++scoreDirector.afterVariableChanged%28process%2C+%22computer%22%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+A+SolutionCloner+does+not+clone+problem+fact+lists+%28such+as%0AcomputerList%29%0A%C2%A0+++++++++++%2F%2F+Shallow+clone+the+computerList+so+only+workingSolution+is+affected%2C+not%0AbestSolution+or+guiSolution%0A%C2%A0+++++++++++ArrayList%3CCloudComputer%3E+computerList+%3D+new+ArrayList%3C%3E%28cloudBalance%0A.getComputerList%28%29%29%3B%0A%C2%A0+++++++++++cloudBalance.setComputerList%28computerList%29%3B%0A%C2%A0+++++++++++%2F%2F+Remove+the+problem+fact+itself%0A%C2%A0+++++++++++scoreDirector.beforeProblemFactRemoved%28workingComputer%29%3B%0A%C2%A0+++++++++++computerList.remove%28workingComputer%29%3B%0A%C2%A0+++++++++++scoreDirector.afterProblemFactRemoved%28workingComputer%29%3B%0A%C2%A0+++++++++++scoreDirector.triggerVariableListeners%28%29%3B%0A%C2%A0+++++++%7D%29%3B%0A%C2%A0+++%7D%0A1.+Any+change+in+a+ProblemFactChange+must+be+done+on+the+Solution+instance+of%0AscoreDirector.getWorkingSolution%28%29.%0A2.+The+workingSolution+is+a+planning+clone+of+the+BestSolutionChangedEvent%27s+bestSolution.%0A%E2%97%A6+The+workingSolution+in+the+Solver+is+never+the+same+instance+as+the+Solution+in+the+rest+of%0Ayour+application%3A+it+is+a+planning+clone.%0A%E2%97%A6+A+planning+clone+also+clones+the+planning+entities+and+planning+entity+collections.%0ASo+any+change+on+the+planning+entities+must+happen+on+the+instances+held+by%0AscoreDirector.getWorkingSolution%28%29.%0A3.+Use+the+method+ScoreDirector.lookUpWorkingObject%28%29+to+translate+and+retrieve+the+working%0Asolution%E2%80%99s+instance+of+an+object.%0A4.+A+planning+clone+does+not+clone+the+problem+facts%2C+nor+the+problem+fact+collections.+Therefore%0Athe+workingSolution+and+the+bestSolution+share+the+same+problem+fact+instances+and+the+same%0Aproblem+fact+list+instances.%0AAny+problem+fact+or+problem+fact+list+changed+by+a+ProblemFactChange+must+be+problem+cloned%0Afirst+%28which+can+imply+rerouting+references+in+other+problem+facts+and+planning+entities%29.%0AOtherwise%2C+if+the+workingSolution+and+bestSolution+are+used+in+different+threads+%28for+example+a%0A330%0Asolver+thread+and+a+GUI+event+thread%29%2C+a+race+condition+can+occur.%0A16.5.1.2.+Cloning+Solutions+to+Avoid+Race+Conditions+in+Real-time+Planning%0AMany+types+of+changes+can+leave+a+planning+entity+uninitialized%2C+resulting+in+a+partially+initialized%0Asolution.+This+is+acceptable%2C+provided+the+first+solver+phase+can+handle+it.%0AAll+construction+heuristics+solver+phases+can+handle+a+partially+initialized+solution%2C+so+it+is%0Arecommended+to+configure+such+a+solver+phase+as+the+first+phase.%0AThe+process+occurs+as+follows%3A%0A1.+The+Solver+stops.%0A2.+Runs+the+ProblemFactChange.%0A3.+restarts.%0AThis+is+a+warm+start+because+its+initial+solution+is+the+adjusted+best+solution+of+the+previous+run.%0A4.+Each+solver+phase+runs+again.%0AThis+implies+the+construction+heuristic+runs+again%2C+but+because+little+or+no+planning+variables%0Aare+uninitialized+%28unless+you+have+a+nullable+planning+variable%29%2C+it+finishes+much+quicker+than%0Ain+a+cold+start.%0A331%0A5.+Each+configured+Termination+resets+%28both+in+solver+and+phase+configuration%29%2C+but+a+previous+call%0Ato+terminateEarly%28%29+is+not+undone.%0ATermination+is+not+usually+configured+%28except+in+daemon+mode%29%3B+instead%2C%0ASolver.terminateEarly%28%29+is+called+when+the+results+are+needed.+Alternatively%2C+configure+a%0ATermination+and+use+the+daemon+mode+in+combination+with+BestSolutionChangedEvent+as%0Adescribed+in+the+following+section.%0A16.5.2.+Daemon%3A+solve%28%29+Does+Not+Return%0AIn+real-time+planning%2C+it+is+often+useful+to+have+a+solver+thread+wait+when+it+runs+out+of+work%2C+and%0Aimmediately+resume+solving+a+problem+once+new+problem+fact+changes+are+added.+Putting+the%0ASolver+in+daemon+mode+has+the+following+effects%3A%0A%E2%80%A2+If+the+Solver%27s+Termination+terminates%2C+it+does+not+return+from+solve%28%29%2C+but+blocks+its+thread%0Ainstead+%28which+frees+up+CPU+power%29.%0A%E2%97%A6+Except+for+terminateEarly%28%29%2C+which+does+make+it+return+from+solve%28%29%2C+freeing+up+system%0Aresources+and+allowing+an+application+to+shutdown+gracefully.%0A%E2%97%A6+If+a+Solver+starts+with+an+empty+planning+entity+collection%2C+it+waits+in+the+blocked+state%0Aimmediately.%0A%E2%80%A2+If+a+ProblemFactChange+is+added%2C+it+goes+into+the+running+state%2C+applies+the+ProblemFactChange+and%0Aruns+the+Solver+again.%0ATo+use+the+Solver+in+daemon+mode%3A%0A1.+Enable+daemon+mode+on+the+Solver%3A%0A%3Csolver%3E%0A%C2%A0+%3Cdaemon%3Etrue%3C%2Fdaemon%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ADo+not+forget+to+call+Solver.terminateEarly%28%29+when+your+application+needs+to%0A%EF%81%B1+shutdown+to+avoid+killing+the+solver+thread+unnaturally.%0A2.+Subscribe+to+the+BestSolutionChangedEvent+to+process+new+best+solutions+found+by+the+solver%0Athread.%0AA+BestSolutionChangedEvent+does+not+guarantee+that+every+ProblemFactChange+has+been+processed%0Aalready%2C+nor+that+the+solution+is+initialized+and+feasible.%0A3.+To+ignore+BestSolutionChangedEvents+with+such+invalid+solutions%2C+do+the+following%3A%0A332%0A%C2%A0+++public+void+bestSolutionChanged%28BestSolutionChangedEvent%3CCloudBalance%3E+event%29+%7B%0A%C2%A0+++++++if+%28event.isEveryProblemFactChangeProcessed%28%29%0A%C2%A0+++++++++++++++%2F%2F+Ignore+infeasible+%28including+uninitialized%29+solutions%0A%C2%A0+++++++++++++++%26%26+event.getNewBestSolution%28%29.getScore%28%29.isFeasible%28%29%29+%7B%0A%C2%A0+++++++++++...%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A4.+Use+Score.isSolutionInitialized%28%29+instead+of+Score.isFeasible%28%29+to+only+ignore+uninitialized%0Asolutions%2C+but+do+accept+infeasible+solutions+too.%0A333%0AChapter+17.+Integration%0A17.1.+Overview%0APlanner%E2%80%99s+input+and+output+data+%28the+planning+problem+and+the+best+solution%29+are+plain+old%0AJavaBeans+%28POJO%E2%80%99s%29%2C+so+integration+with+other+Java+technologies+is+straightforward.+For+example%3A%0A%E2%80%A2+To+read+a+planning+problem+from+the+database+%28and+store+the+best+solution+in+it%29%2C+annotate+the%0Adomain+POJO%E2%80%99s+with+JPA+annotations.%0A%E2%80%A2+To+read+a+planning+problem+from+an+XML+file+%28and+store+the+best+solution+in+it%29%2C+annotate+the%0Adomain+POJO%E2%80%99s+with+XStream+or+JAXB+annotations.%0A%E2%80%A2+To+expose+the+Solver+as+a+REST+Service+that+reads+the+planning+problem+and+responds+with+the%0Abest+solution%2C+annotate+the+domain+POJO%E2%80%99s+with+XStream%2C+JAXB+or+Jackson+annotations+and+hook%0Athe+Solver+in+Camel+or+RESTEasy.%0A17.2.+Persistent+Storage%0A17.2.1.+Database%3A+JPA+and+Hibernate%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+JPA+annotations+to+store+them+in+a%0Adatabase+by+calling+EntityManager.persist%28%29.%0A334%0ADo+not+confuse+JPA%E2%80%99s+%40Entity+annotation+with+Planner%E2%80%99s+%40PlanningEntity%0Aannotation.+They+can+appear+both+on+the+same+class%3A%0A%EF%81%9A+%40PlanningEntity+%2F%2F+OptaPlanner+annotation%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Talk+%7B...%7D%0AAdd+a+dependency+to+the+optaplanner-persistence-jpa+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.1.1.+JPA+and+Hibernate%3A+Persisting+a+Score%0AWhen+a+Score+is+persisted+into+a+relational+database%2C+JPA+and+Hibernate+will+default+to+Java%0Aserializing+it+to+a+BLOB+column.+This+has+several+disadvantages%3A%0A%E2%80%A2+The+Java+serialization+format+of+Score+classes+is+currently+not+backwards+compatible.+Upgrading%0Ato+a+newer+Planner+version+can+break+reading+an+existing+database.%0A%E2%80%A2+The+score+is+not+easily+readable+for+a+query+executed+in+the+database+console.+This+is+annoying%0Aduring+development.%0A%E2%80%A2+The+score+cannot+be+used+in+a+SQL+or+JPA-QL+query+to+efficiently+filter+the+results%3A+for+example+to%0Aquery+all+infeasible+schedules.%0ATo+avoid+these+issues%2C+configure+it+to+instead+use+INTEGER+%28or+other%29+columns%2C+by+using+the%0Aappropriate+*ScoreHibernateType+for+your+Score+type%2C+for+example+for+a+HardSoftScore%3A%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+HardSoftScore.class%2C+typeClass+%3D+HardSoftScoreHibernateType%0A.class%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%40Column%28name+%3D+%22initScore%22%29%2C+%40Column%28name+%3D+%22hardScore%22%29%2C%0A%40Column%28name+%3D+%22softScore%22%29%7D%29%0A%C2%A0+++protected+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AConfigure+the+same+number+of+%40Column+annotations+as+the+number+of+score+levels%0A%EF%81%9A+in+the+score+plus+one+%28for+the+initScore%29%2C+otherwise+Hibernate+will+fail+fast+because%0Aa+property+mapping+has+the+wrong+number+of+columns.%0AIn+this+case%2C+the+DDL+will+look+like+this%3A%0A335%0ACREATE+TABLE+CloudBalance%28%0A%C2%A0+++...%0A%C2%A0+++initScore+INTEGER%2C%0A%C2%A0+++hardScore+INTEGER%2C%0A%C2%A0+++softScore+INTEGER%0A%29%3B%0AWhen+using+a+BigDecimal+based+Score%2C+specify+the+precision+and+scale+of+the+columns+to+avoid+silent%0Arounding%3A%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+HardSoftBigDecimalScore.class%2C+typeClass+%3D%0AHardSoftBigDecimalScoreHibernateType.class%29%0Apublic+class+CloudBalance%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%0A%C2%A0+++++++++++%40Column%28name+%3D+%22initScore%22%29%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hardScore%22%2C+precision+%3D+10%2C+scale+%3D+5%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22softScore%22%2C+precision+%3D+10%2C+scale+%3D+5%29%7D%29%0A%C2%A0+++protected+HardSoftBigDecimalScore+score%3B%0A%C2%A0+++...%0A%7D%0AIn+this+case%2C+the+DDL+will+look+like+this%3A%0ACREATE+TABLE+CloudBalance%28%0A%C2%A0+++...%0A%C2%A0+++initScore+INTEGER%2C%0A%C2%A0+++hardScore+DECIMAL%2810%2C+5%29%2C%0A%C2%A0+++softScore+DECIMAL%2810%2C+5%29%0A%29%3B%0AWhen+using+any+type+of+bendable+Score%2C+specify+the+hard+and+soft+level+sizes+as+parameters%3A%0A336%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+BendableScore.class%2C+typeClass+%3D+BendableScoreHibernateType%0A.class%2C+parameters+%3D+%7B%0A%C2%A0+++++++%40Parameter%28name+%3D+%22hardLevelsSize%22%2C+value+%3D+%223%22%29%2C%0A%C2%A0+++++++%40Parameter%28name+%3D+%22softLevelsSize%22%2C+value+%3D+%222%22%29%7D%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%0A%C2%A0+++++++++++%40Column%28name+%3D+%22initScore%22%29%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard0Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard1Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard2Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22soft0Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22soft1Score%22%29%7D%29%0A%C2%A0+++protected+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AAll+this+support+is+Hibernate+specific+because+currently+JPA+2.1%E2%80%99s+converters+do+not+support%0Aconverting+to+multiple+columns.%0A17.2.1.2.+JPA+and+Hibernate%3A+Planning+Cloning%0AIn+JPA+and+Hibernate%2C+there+is+usually+a+%40ManyToOne+relationship+from+most+problem+fact+classes+to%0Athe+planning+solution+class.+Therefore%2C+the+problem+fact+classes+reference+the+planning+solution%0Aclass%2C+which+implies+that+when+the+solution+is+planning+cloned%2C+they+need+to+be+cloned+too.+Use+an%0A%40DeepPlanningClone+on+each+such+problem+fact+class+to+enforce+that%3A%0A%40PlanningSolution+%2F%2F+OptaPlanner+annotation%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Conference+%7B%0A%C2%A0+++%40OneToMany%28mappedBy%3D%22conference%22%29%0A%C2%A0+++private+List%3CRoom%3E+roomList%3B%0A%C2%A0+++...%0A%7D%0A337%0A%40DeepPlanningClone+%2F%2F+OptaPlanner+annotation%3A+Force+the+default+planning+cloner+to%0Aplanning+clone+this+class+too%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Room+%7B%0A%C2%A0+++%40ManyToOne%0A%C2%A0+++private+Conference+conference%3B+%2F%2F+Because+of+this+reference%2C+this+problem+fact%0Aneeds+to+be+planning+cloned+too%0A%7D%0ANeglecting+to+do+this+can+lead+to+persisting+duplicate+solutions%2C+JPA+exceptions+or+other+side+effects.%0A17.2.2.+XML+or+JSON%3A+XStream%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+XStream+annotations+to+serialize%0Athem+to%2Ffrom+XML+or+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-xstream+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.2.1.+XStream%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to+XML+or+JSON+by+the+default+XStream+configuration%2C+it%E2%80%99s+verbose+and%0Augly.+To+fix+that%2C+configure+the+appropriate+ScoreXStreamConverter%3A%0A%40PlanningSolution%0A%40XStreamAlias%28%22CloudBalance%22%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XStreamConverter%28HardSoftScoreXStreamConverter.class%29%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+pretty+XML%3A%0A%3CCloudBalance%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E0hard%2F-200soft%3C%2Fscore%3E%0A%3C%2FCloudBalance%3E%0AThe+same+applies+for+a+bendable+score%3A%0A338%0A%40PlanningSolution%0A%40XStreamAlias%28%22Schedule%22%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XStreamConverter%28BendableScoreXStreamConverter.class%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate%3A%0A%3CSchedule%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%3C%2Fscore%3E%0A%3C%2FSchedule%3E%0AWhen+reading+a+bendable+score+from+an+XML+element%2C+the+implied+hardLevelsSize+and%0AsoftLevelsSize+must+always+be+in+sync+with+those+in+the+solver.%0A17.2.3.+XML+or+JSON%3A+JAXB%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+JAXB+annotations+to+serialize+them%0Ato%2Ffrom+XML+or+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-jaxb+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.3.1.+JAXB%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to+XML+or+JSON+by+the+default+JAXB+configuration%2C+it%E2%80%99s+corrupted.+To+fix%0Athat%2C+configure+the+appropriate+ScoreJaxbXmlAdapter%3A%0A%40PlanningSolution%0A%40XmlRootElement+%40XmlAccessorType%28XmlAccessType.FIELD%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XmlJavaTypeAdapter%28HardSoftScoreJaxbXmlAdapter.class%29%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+pretty+XML%3A%0A339%0A%3CcloudBalance%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E0hard%2F-200soft%3C%2Fscore%3E%0A%3C%2FcloudBalance%3E%0AThe+same+applies+for+a+bendable+score%3A%0A%40PlanningSolution%0A%40XmlRootElement+%40XmlAccessorType%28XmlAccessType.FIELD%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XmlJavaTypeAdapter%28BendableScoreJaxbXmlAdapter.class%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+with+a+hardLevelsSize+of+2+and+a+softLevelsSize+of+3%2C+that+will+generate%3A%0A%3Cschedule%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%3C%2Fscore%3E%0A%3C%2Fschedule%3E%0AThe+hardLevelsSize+and+softLevelsSize+implied%2C+when+reading+a+bendable+score+from+an+XML%0Aelement%2C+must+always+be+in+sync+with+those+in+the+solver.%0A17.2.4.+JSON%3A+Jackson%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+Jackson+annotations+to+serialize%0Athem+to%2Ffrom+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-jackson+jar+and+register%0AOptaPlannerJacksonModule%3A%0AObjectMapper+objectMapper+%3D+new+ObjectMapper%28%29%3B%0AobjectMapper.registerModule%28OptaPlannerJacksonModule.createModule%28%29%29%3B%0A17.2.4.1.+Jackson%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to%2Ffrom+JSON+by+the+default+Jackson+configuration%2C+it+fails.+The%0AOptaPlannerJacksonModule+fixes+that%2C+by+using+HardSoftScoreJacksonJsonSerializer%2C%0AHardSoftScoreJacksonJsonDeserializer%60%2C+etc.%0A340%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+this+JSON%3A%0A%7B%0A%C2%A0++%22score%22%3A%220hard%2F-200soft%22%0A%C2%A0++...%0A%7D%0AWhen+reading+a+BendableScore%2C+the+hardLevelsSize+and+softLevelsSize+implied+in%0Athe+JSON+element%2C+must+always+be+in+sync+with+those+defined+in+the+%40PlanningScore%0Aannotation+in+the+solution+class.+For+example%3A%0A%7B%0A%C2%A0++%22score%22%3A%22%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%22%0A%C2%A0++...%0A%7D%0AThis+JSON+implies+the+hardLevelsSize+is+2+and+thet+softLevelsSize+is+3%2C+which+must%0A%EF%81%9A+be+in+sync+with+the+%40PlanningScore+annotation%3A%0A%40PlanningSolution%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%28bendableHardLevelsSize+%3D+2%2C+bendableSoftLevelsSize+%3D%0A3%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AWhen+a+field+is+the+Score+supertype+%28instead+of+a+specific+type+such+as+HardSoftScore%29%2C+it+uses%0APolymorphicScoreJacksonJsonSerializer+and+PolymorphicScoreJacksonJsonDeserializer+to+record+the%0Ascore+type+in+JSON+too%2C+otherwise+it+would+be+impossible+to+deserialize+it%3A%0A341%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+Score+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+this+JSON%3A%0A%7B%0A%C2%A0++%22score%22%3A%7B%22HardSoftScore%22%3A%220hard%2F-200soft%22%7D%0A%C2%A0++...%0A%7D%0A17.3.+SOA+and+ESB%0A17.3.1.+Camel+and+Karaf%0ACamel+is+an+enterprise+integration+framework+which+includes+support+for+Planner+%28starting+from%0ACamel+2.13%29.+It+can+expose+a+use+case+as+a+REST+service%2C+a+SOAP+service%2C+a+JMS+service%2C+%E2%80%A6%0ARead+the+documentation+for+the+camel-optaplanner+component.+That+component+works+in+Karaf%0Atoo.%0A17.4.+Other+Environments%0A17.4.1.+JBoss+Modules%2C+WildFly+and+JBoss+EAP%0ABecause+of+JBoss+Modules%27+ClassLoader+magic%2C+provide+the+ClassLoader+of+your+classes+during+the%0ASolverFactory+creation%2C+so+it+can+find+the+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s%0Aand+domain+classes%29+in+your+jars.%0AIt%E2%80%99s+also+recommended+to+plug+in+WildFly%E2%80%99s+thread+factory%2C+especially+with+multithreaded+solving.%0A17.4.1.1.+Logging+on+WildFly+and+JBoss+EAP%0ATo+get+decent+logging+of+the+solver%28s%29%2C+create+a+file+src%2Fmain%2Fresources%2Fjboss-log4j.xml+%28so+it+ends+up%0Ain+the+war+as+WEB-INF%2Fclasses%2Fjboss-log4j.xml%29+with+this+content%3A%0A342%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Clog4j%3Aconfiguration+xmlns%3Alog4j%3D%22http%3A%2F%2Fjakarta.apache.org%2Flog4j%2F%22+debug%3D%22false%22%3E%0A%C2%A0+%3Cappender+name%3D%22consoleAppender%22+class%3D%22org.apache.log4j.ConsoleAppender%22%3E%0A%C2%A0+++%3Clayout+class%3D%22org.apache.log4j.PatternLayout%22%3E%0A%C2%A0+++++%3Cparam+name%3D%22ConversionPattern%22+value%3D%22%25d%7BHH%3Amm%3Ass.SSS%7D+%25-5p+%5B%25t%5D+%25m%25n%22%2F%3E%0A%C2%A0+++%3C%2Flayout%3E%0A%C2%A0+%3C%2Fappender%3E%0A%C2%A0+%3Clogger+name%3D%22org.optaplanner%22%3E%0A%C2%A0+++%3Clevel+value%3D%22debug%22%2F%3E%0A%C2%A0+%3C%2Flogger%3E%0A%C2%A0+%3Croot%3E%0A%C2%A0+++%3Clevel+value%3D%22warn%22+%2F%3E%0A%C2%A0+++%3Cappender-ref+ref%3D%22consoleAppender%22%2F%3E%0A%C2%A0+%3C%2Froot%3E%0A%3C%2Flog4j%3Aconfiguration%3E%0A17.4.1.2.+Skinny+war+on+WildFly+and+JBoss+EAP%0ATo+deploy+an+Planner+web+application+on+WildFly%2C+simply+include+the+optaplanner+dependency+jars%0Ain+the+war+file%E2%80%99s+WEB-INF%2Flib+directory+%28just+like+any+other+dependency%29+as+shown+in+the+optaplanner-%0Awebexamples-*.war.+However%2C+in+this+approach+the+war+file+can+easily+grow+to+several+MB+in+size%2C%0Awhich+is+fine+for+a+one-time+deployment%2C+but+too+heavyweight+for+frequent+redeployments%0A%28especially+over+a+slow+network+connection%29.%0AThe+remedy+is+to+use+deliver+the+optaplanner+jars+in+a+JBoss+module+to+WildFly+and+create+a+skinny%0Awar.+Let%E2%80%99s+create+an+module+called+org.optaplanner%3A%0A1.+Navigate+to+the+directory+%24%7BWILDFLY_HOME%7D%2Fmodules%2Fsystem%2Flayers%2Fbase%2F.+This+directory+contains%0Athe+JBoss+modules+of+WildFly.+Create+directory+structure+org%2Foptaplanner%2Fmain+for+our+new%0Amodule.%0Aa.+Copy+optaplanner-core-%24%7Bversion%7D.jar+and+all+its+direct+and+transitive+dependency+jars+into%0Athat+new+directory.+Use+%22mvn+dependency%3Atree%22+on+each+optaplanner+artifact+to+discover+all%0Adependencies.%0Ab.+Create+the+file+module.xml+in+that+new+directory.+Give+it+this+content%3A%0A343%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Cmodule+xmlns%3D%22urn%3Ajboss%3Amodule%3A1.3%22+name%3D%22org.optaplanner%22%3E%0A%C2%A0+%3Cresources%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22kie-api-%24%7Bversion%7D.jar%22%2F%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22optaplanner-core-%24%7Bversion%7D.jar%22%2F%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22.%22%2F%3E%0A%C2%A0+%3C%2Fresources%3E%0A%C2%A0+%3Cdependencies%3E%0A%C2%A0+++%3Cmodule+name%3D%22javaee.api%22%2F%3E%0A%C2%A0+%3C%2Fdependencies%3E%0A%3C%2Fmodule%3E%0A2.+Navigate+to+the+deployed+war+file.%0Aa.+Remove+optaplanner-core-%24%7Bversion%7D.jar+and+all+its+direct+and+transitive+dependency+jars%0Afrom+the+WEB-INF%2Flib+directory+in+the+war+file.%0Ab.+Create+the+file+jboss-deployment-structure.xml+in+the+WEB-INF%2Flib+directory.+Give+it+this%0Acontent%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22+%3F%3E%0A%3Cjboss-deployment-structure%3E%0A%C2%A0++%3Cdeployment%3E%0A%C2%A0+++++%3Cdependencies%3E%0A%C2%A0++++++++%3Cmodule+name%3D%22org.optaplanner%22+export%3D%22true%22%2F%3E%0A%C2%A0+++++%3C%2Fdependencies%3E%0A%C2%A0++%3C%2Fdeployment%3E%0A%3C%2Fjboss-deployment-structure%3E%0A17.4.2.+Spring+Boot%0ANormally+Planner+just+works+on+Spring+Boot%2C+simply+add+the+optaplanner-core+dependency.+If+it+has%0Atrouble+finding+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s+and+domain+classes%29%2C%0Aprovide+the+ClassLoader+of+your+classes+during+the+SolverFactory+creation.%0A17.4.3.+Java+Platform+Module+System+%28Jigsaw%29%0AWhen+using+Planner+from+code+on+the+modulepath+%28Java+9+and+higher%29%2C+open+your+packages+that%0Acontain+your+domain+objects%2C+DRL+files+and+solver+configuration+in+your+module-info.java+file%3A%0A344%0Amodule+org.optaplanner.cloudbalancing+%7B%0A%C2%A0+++requires+org.optaplanner.core%3B%0A%C2%A0+++...%0A%C2%A0+++opens+org.optaplanner.examples.cloudbalancing.domain%3B+%2F%2F+Domain+classes%0A%C2%A0+++opens+org.optaplanner.examples.cloudbalancing.solver%3B+%2F%2F+DRL+file+and+solver%0Aconfiguration%0A%C2%A0+++...%0A%7D%0AOtherwise+Planner+can%E2%80%99t+reach+those+classes+or+files%2C+even+if+they+are+exported.%0A17.4.4.+OSGi%0AThe+optaplanner-core+jar+includes+OSGi+metadata+in+its+MANIFEST.MF+file+to+function+properly+in+an%0AOSGi+environment+too.+Furthermore%2C+the+maven+artifact+kie-karaf-features+contains+a+features.xml%0Afile+that+supports+the+OSGi-feature+optaplanner-engine.%0ABecause+of+the+OSGi%E2%80%99s+ClassLoader+magic%2C+provide+the+ClassLoader+of+your+classes+during+the%0ASolverFactory+creation%2C+so+it+can+find+the+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s%0Aand+domain+classes%29+in+your+jars.%0APlanner+does+not+require+OSGi.+It+works+perfectly+fine+in+a+normal+Java%0A%EF%81%9A+environment+too.%0A17.4.5.+Android%0AAndroid+is+not+a+complete+JVM+%28because+some+JDK+libraries+are+missing%29%2C+but+Planner+works+on%0AAndroid+with+easy+Java+or+incremental+Java+score+calculation.+The+Drools+rule+engine+does+not+work%0Aon+Android+yet%2C+so+Drools+score+calculation+doesn%E2%80%99t+work+on+Android+and+its+dependencies+need+to%0Abe+excluded.%0AWorkaround+to+use+Planner+on+Android%3A%0A1.+Add+a+dependency+to+the+build.gradle+file+in+your+Android+project+to+exclude+org.drools+and%0Axmlpull+dependencies%3A%0Adependencies+%7B%0A%C2%A0+++...%0A%C2%A0+++compile%28%27org.optaplanner%3Aoptaplanner-core%3A...%27%29+%7B%0A%C2%A0+++++++exclude+group%3A+%27xmlpull%27%0A%C2%A0+++++++exclude+group%3A+%27org.drools%27%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A345%0A17.5.+Integration+with+Human+Planners+%28Politics%29%0AA+good+Planner+implementation+beats+any+good+human+planner+for+non-trivial+datasets.+Many%0Ahuman+planners+fail+to+accept+this%2C+often+because+they+feel+threatened+by+an+automated+system.%0ABut+despite+that%2C+both+can+benefit+if+the+human+planner+becomes+the+supervisor+of+Planner%3A%0A%E2%80%A2+The+human+planner+defines%2C+validates+and+tweaks+the+score+function.%0A%E2%97%A6+Some+examples+expose+a+Parametrization+object%2C+which+defines+the+weight+for+each+score%0Aconstraint.+The+human+planner+can+then+tweak+those+weights+at+runtime.%0A%E2%97%A6+When+the+business+changes%2C+the+score+function+often+needs+to+change+too.+The+human%0Aplanner+can+notify+the+developers+to+add%2C+change+or+remove+score+constraints.%0A%E2%80%A2+The+human+planner+is+always+in+control+of+Planner.%0A%E2%97%A6+As+shown+in+the+course+scheduling+example%2C+the+human+planner+can+pin+down+one+or+more%0Aplanning+variables+to+a+specific+planning+value.+Because+they+are+immovable%2C+Planner+does%0Anot+change+them%3A+it+optimizes+the+planning+around+the+enforcements+made+by+the+human.+If%0Athe+human+planner+pins+down+all+planning+variables%2C+he%2Fshe+sidelines+Planner+completely.%0A%E2%97%A6+In+a+prototype+implementation%2C+the+human+planner+occasionally+uses+pinning+to+intervene%2C%0Abut+as+the+implementation+matures%2C+this+should+become+obsolete.+The+feature+should+be+kept%0Aavailable+as+a+reassurance+for+the+humans%2C+and+in+the+event+that+the+business+changes%0Adramatically+before+the+score+constraints+are+adjusted+accordingly.%0AFor+this+reason%2C+it+is+recommended+the+human+planner+is+actively+involved+in+your+project.%0A346%0A347%0A17.6.+Sizing+Hardware+and+Software%0ABefore+sizing+a+Planner+service%2C+first+understand+the+typical+behaviour+of+a+Solver.solve%28%29+call%3A%0AUnderstand+these+guidelines+to+decide+the+hardware+for+a+Planner+service%3A%0A%E2%80%A2+RAM+memory%3A+Provision+plenty%2C+but+no+need+to+provide+more.%0A%E2%97%A6+The+problem+dataset%2C+loaded+before+Planner+is+called%2C+often+consumes+the+most+memory.+It%0Adepends+on+the+problem+scale.%0A%E2%96%AA+For+example%2C+in+the+Machine+Reassignment+example+some+datasets+use+over+1GB+in%0Amemory.+But+in+most+examples%2C+they+use+just+a+few+MB.%0A%E2%96%AA+If+this+is+a+problem%2C+review+the+domain+class+structure%3A+remove+classes+or+fields+that%0APlanner+doesn%E2%80%99t+need+during+solving.%0A%E2%96%AA+Planner+usually+has+up+to+three+solution+instances%3A+the+internal+working+solution%2C+the%0Abest+solution+and+the+old+best+solution+%28when+it%E2%80%99s+being+replaced%29.+However%2C+these+are+all%0Aa+planning+clone+of+each+other%2C+so+many+problem+fact+instances+are+shared+between%0Athose+solution+instances.%0A%E2%97%A6+During+solving%2C+the+memory+is+very+volatile%2C+because+solving+creates+many+short-lived%0Aobjects.+The+Garbage+Collector+deletes+these+in+bulk+and+therefore+needs+some+heap+space+as%0Aa+buffer.%0A%E2%97%A6+The+maximum+size+of+the+JVM+heap+space+can+be+in+three+states%3A%0A348%0A%E2%96%AA+Insufficient%3A+An+OutOfMemoryException+is+thrown+%28often+because+the+Garbage+Collector+is%0Ausing+more+than+98%25+of+the+CPU+time%29.%0A%E2%96%AA+Narrow%3A+The+heap+buffer+for+those+short-lived+instances+is+too+small%2C+therefore+the%0AGarbage+Collector+needs+to+run+more+than+it+would+like+to%2C+which+causes+a+performance%0Aloss.%0A%E2%96%AA+Profiling+shows+that+in+the+heap+chart%2C+the+used+heap+space+frequently+touches+the%0Amax+heap+space+during+solving.+It+also+shows+that+the+Garbage+Collector+has+a%0Asignificant+CPU+usage+impact.%0A%E2%96%AA+Adding+more+heap+space+increases+the+score+calculation+speed.%0A%E2%96%AA+Plenty%3A+There+is+enough+heap+space.+The+Garbage+Collector+is+active%2C+but+its+CPU+usage+is%0Alow.%0A%E2%96%AA+Adding+more+heap+space+does+not+increase+performance.%0A%E2%96%AA+Usually%2C+this+is+around+300+to+500MB+above+the+dataset+size%2C+regardless+of+the+problem%0Ascale+%28except+with+nearby+selection+and+caching+move+selector%2C+neither+are+used+by%0Adefault%29.%0A%E2%80%A2+CPU+power%3A+More+is+better.%0A%E2%97%A6+Improving+CPU+speed+directly+increases+the+score+calculation+speed.%0A%E2%96%AA+If+the+CPU+power+is+twice+as+fast%2C+it+takes+half+the+time+to+find+the+same+result.+However%2C%0Athis+does+not+guarantee+that+it+finds+a+better+result+in+the+same+time%2C+nor+that+it+finds+a%0Asimilar+result+for+a+problem+twice+as+a+big+in+the+same+time.%0A%E2%96%AA+Increasing+CPU+power+usually+does+not+resolve+scaling+issues%2C+because+planning%0Aproblems+scale+exponentially.+Power+tweaking+the+solver+configuration+has+far+better%0Aresults+for+scaling+issues+than+throwing+hardware+at+it.%0A%E2%97%A6+During+the+solve%28%29+method%2C+the+CPU+power+will+max+out+until+it+returns+%28except+in+daemon%0Amode+or+if+your+SolverEventListener+writes+the+best+solution+to+disk+or+the+network%29.%0A%E2%80%A2+Number+of+CPU+cores%3A+one+CPU+core+per+active+Solver%2C+plus+at+least+one+one+for+the+operating%0Asystem.%0A%E2%97%A6+So+in+a+multitenant+application%2C+which+has+one+Solver+per+tenant%2C+this+means+one+CPU+core%0Aper+tenant%2C+unless+the+number+of+solver+threads+is+limited%2C+as+that+limits+the+number+of%0Atenants+being+solved+in+parallel.%0A%E2%97%A6+With+Partitioned+Search%2C+presume+one+CPU+core+per+partition+%28per+active+tenant%29%2C+unless+the%0Anumber+of+partition+threads+is+limited.%0A%E2%96%AA+To+reduce+the+number+of+used+cores%2C+it+can+be+better+to+reduce+the+partition+threads+%28so%0Asolve+some+partitions+sequentially%29+than+to+reduce+the+number+of+partitions.%0A%E2%97%A6+In+use+cases+with+many+tenants+%28such+as+scheduling+Software+as+a+Service%29+or+many%0Apartitions%2C+it+might+not+be+affordable+to+provision+that+many+CPUs.%0A%E2%96%AA+Reduce+the+number+of+active+Solvers+at+a+time.+For+example%3A+give+each+tenant+only+one%0Aminute+of+machine+time+and+use+a+ExecutorService+with+a+fixed+thread+pool+to+queue%0Arequests.%0A%E2%96%AA+Distribute+the+Solver+runs+across+the+day+%28or+night%29.+This+is+especially+an+opportunity+in%0ASaaS+that%E2%80%99s+used+across+the+globe%2C+due+to+timezones%3A+UK+and+India+can+use+the+same+CPU%0A349%0Acore+when+scheduling+at+night.%0A%E2%97%A6+The+SolverManager+will+take+care+of+the+orchestration%2C+especially+in+those+underfunded%0Aenvironments+in+which+solvers+%28and+partitions%29+are+forced+to+share+CPU+cores+or+wait+in+line.%0A%E2%80%A2+I%2FO+%28network%2C+disk%2C+%E2%80%A6%29%3A+Not+used+during+solving.%0A%E2%97%A6+Planner+is+not+a+web+server%3A+a+solver+thread+does+not+block+%28unlike+a+servlet+thread%29%2C+each%0Aone+fully+drains+a+CPU.%0A%E2%96%AA+A+web+server+can+handle+24+active+servlets+threads+with+eight+cores+without%0Aperformance+loss%2C+because+most+servlets+threads+are+blocking+on+I%2FO.%0A%E2%96%AA+However%2C+24+active+solver+threads+with+eight+cores+will+cause+each+solver%E2%80%99s+score%0Acalculation+speed+to+be+three+times+slower%2C+causing+a+big+performance+loss.%0A%E2%97%A6+Note+that+calling+any+I%2FO+during+solving%2C+for+example+a+remote+service+in+your+score%0Acalculation%2C+causes+a+huge+performance+loss+because+it%E2%80%99s+called+thousands+of+times+per%0Asecond%2C+so+it+should+complete+in+microseconds.+So+no+good+implementation+does+that.%0AKeep+these+guidelines+in+mind+when+selecting+and+configuring+the+software.+See+our+blog+archive%0Afor+the+details+of+our+experiments%2C+which+use+our+diverse+set+of+examples.+Your+mileage+may+vary.%0A%E2%80%A2+Operating+System%0A%E2%97%A6+No+experimentally+proven+advice+yet+%28but+prefer+Linux+anyway%29.%0A%E2%80%A2+JDK%0A%E2%97%A6+Version%3A+Java+7+can+be+between+10%25+and+25%25+faster+than+Java+6.+But+Java+8+however+is%0Ausually+not+significantly+faster+than+Java+7.%0A%E2%97%A6+Garbage+Collector%3A+ParallelGC+%28the+default+in+Java+8%29+can+be+potentially+between+5%25+and+35%25%0Afaster+than+G1GC+%28the+default+in+Java+9%29.+Unlike+web+servers%2C+Planner+needs+a+GC+focused+on%0Athroughput%2C+not+latency.+Use+-XX%3A%2BUseParallelGC+to+turn+on+ParallelGC.%0A%E2%80%A2+Logging+can+have+a+severe+impact+on+performance.%0A%E2%97%A6+Debug+logging+org.drools+can+reduce+performance+by+a+factor+of+7.%0A%E2%97%A6+Debug+logging+org.optaplanner+can+be+between+0%25+and+15%25+slower+than+info+logging.+Trace%0Alogging+can+be+between+5%25+and+70%25+slower+than+info+logging.%0A%E2%97%A6+Synchronous+logging+to+a+file+has+an+additional+significant+impact+for+debug+and+trace%0Alogging+%28but+not+for+info+logging%29.%0A%E2%80%A2+Avoid+a+cloud+environment+in+which+you+share+your+CPU+core%28s%29+with+other+virtual+machines+or%0Acontainers.+Performance+%28and+therefore+solution+quality%29+can+be+unreliable+when+the+available%0ACPU+power+varies+greatly.%0AKeep+in+mind+that+the+perfect+hardware%2Fsoftware+environment+will+probably+not+solve+scaling%0Aissues+%28even+Moore%E2%80%99s+law+is+too+slow%29.+There+is+no+need+to+follow+these+guidelines+to+the+letter.%0A350%0AChapter+18.+Design+Patterns%0A18.1.+Design+Patterns+Introduction%0AThese+design+patterns+list+and+solve+common+design+challenges.%0A18.2.+Domain+Modeling+Guide%0AA+good+model+can+greatly+improve+the+success+of+your+planning+implementation.+These+guidelines%0Ahelp+to+design+a+good+model%3A%0A1.+Draw+a+class+diagram+of+your+domain+model.+Normalize+it+get+rid+of+duplicate+data.%0A%E2%97%A6+Write+down+some+sample+instances+for+each+class.%0A%E2%96%AA+For+example+in+employee+rostering%2C+the+samples+for+the+Employee+class+are+Ann%2C+Bert+and%0ACarl.%0A2.+Determine+which+relationships+%28or+fields%29+change+during+planning.+Color+them+orange.+Often%0Athere+is+only+one+such+relationship+%28or+field%29.+One+side+of+these+relationships+will+become+a%0Aplanning+variable+later+on.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+Shift+to+Employee+relationship+changes+during%0Aplanning%2C+so+it+is+orange.+Other+relationships%2C+such+as+from+Employee+to+Skill%2C+are+immutable%0Aduring+planning+because+Planner+can%E2%80%99t+decide+to+give+an+employee+an+extra+skill.%0A3.+If+there+are+multiple+relationships+%28or+fields%29%3A+check+for+shadow+variables.+A+shadow+variable%0Adoes+change+during+planning%2C+but+its+value+can+be+calculated+based+on+one+or+more+genuine%0Aplanning+variables%2C+without+dispute.+Color+those+shadow+relationships+%28or+fields%29+purple.%0A%E2%97%A6+Only+one+side+of+a+bi-directional+relationship+can+be+a+genuine+planning+variable%2C+the+other%0Aside+will+become+an+inverse+relation+shadow+variable+later+on.+Keep+those+relationships+in%0Aorange.%0A4.+Check+for+chained+planning+variables.+In+a+chained+variable+design%2C+the+focus+lies+on+deciding%0Athe+order+of+a+set+planning+entity+instances%2C+instead+of+assigning+them+to+a+date%2Ftime+%28although%0Athere+can+be+an+assigned+date%2Ftime+as+a+shadow+variable%29.+A+typical+use+case+is+vehicle+routing.%0A5.+If+there+is+an+orange+many+to+many+relationship%2C+replace+that+many+to+many+relationship+with%0Aa+one+to+many+and+a+many+to+one+relationship+to+a+new+intermediate+class.%0A%E2%97%A6+Planner+currently+doesn%E2%80%99t+support+a+%40PlanningVariable+on+a+collection.+Although+a+future%0Aversion+will+support+it+for+flexibility+reasons%2C+it+probably+has+an+inherit+performance+and%0Acomplexity+cost%2C+so+it+might+be+better+to+avoid+it+anyway.%0A%E2%97%A6+For+example+in+employee+rostering+the+ShiftAssignment+class+is+the+many+to+many%0Arelationship+between+the+Shift+and+Employee.+It%E2%80%99s+effectively+every+spot+that+needs+to+be+filled%0Awith+an+employee.%0A351%0A6.+In+a+many+to+one+relationship%2C+usually+the+many+side+is+the+planning+entity+class+with+the%0Aplanning+variable.+Annotate+it+with+a+%40PlanningEntity+annotation.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+has+an+%40PlanningEntity%0Aannotation.%0A%E2%97%A6+If+it%E2%80%99s+a+bi-directional+relationship%2C+both+sides+are+a+planning+entity+class%2C+but+usually+the%0Amany+side+has+the+planning+variable+and+the+one+side+the+shadow+variable.%0A7.+The+planning+entity+class+should+have+at+least+one+problem+property.+So+a+planning+entity%0Aclass+cannot+consist+out+of+only+planning+variables+%28or+even+an+id+and+only+planning+variables%29.%0ARemove+a+surplus+%40PlanningVariable+so+it+becomes+a+problem+property.+This+heavily+decreases%0Athe+search+space+size+and+heavily+increases+solving+efficiency.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+should+not+annotate+both+the%0Ashift+and+employee+relationship+with+%40PlanningVariable.%0A%E2%97%A6+When+all+planning+variables+are+null+%28which+occurs+when+the+planning+solution+is+still%0Auninitialized%29%2C+a+planning+entity+instance+should+still+be+describable+to+the+business+people.%0A%E2%96%AA+So+a+surrogate+ID+does+not+suffice+as+the+required+minimum+of+one+problem+property.%0A%E2%97%A6+This+way%2C+there+is+no+need+to+add+a+hard+constraint+to+assure+that+two+planning+entities+are%0Adifferent%3A+they+are+already+different+due+to+their+problem+properties.%0A%E2%97%A6+In+some+cases%2C+multiple+planning+entity+instances+have+the+same+set+of+problem+properties.%0AIn+such+cases%2C+it+can+be+useful+to+create+an+extra+problem+property+to+distinguish+them.%0A%E2%96%AA+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+has+besides+the+problem%0Aproperty+Shift+also+the+problem+property+indexInShift+%28which+is+an+int%29.%0A352%0A8.+Choose+the+model+in+which+the+number+of+planning+entities+is+fixed+during+planning.%0A%E2%97%A6+For+example+in+employee+rostering%2C+it%E2%80%99s+impossible+to+know+in+advance+how+many+shifts%0Aeach+employee+will+have+before+Planner+solves+it+%28and+it+can+even+differ+per+best+solution%0Afound%29.+On+the+other+hand%2C+the+number+of+employees+per+shift+is+known+in+advance%2C+so+it%E2%80%99s%0Abetter+to+make+the+Shift+relationship+a+problem+property+and+the+Employee+relationship+a%0Aplanning+variable.%0AFor+inspiration%2C+take+a+look+at+how+the+examples+modeled+their+domain%3A%0A353%0A%EF%81%9A+Vehicle+routing+is+special%2C+because+it+uses+a+chained+planning+variable.%0A18.3.+Assigning+Time+to+Planning+Entities%0ADealing+with+time+and+dates+in+planning+problems+may+be+problematic+because+it+is+dependent+on%0Athe+needs+of+your+use+case.%0AThere+are+several+representations+of+timestamps%2C+dates%2C+durations+and+periods+in+Java.+Choose+the%0Aright+representation+type+for+your+use+case%3A%0A%E2%80%A2+java.util.Date+%28deprecated%29%3A+a+slow%2C+error-prone+way+to+represent+timestamps.+Do+not+use.%0A%E2%80%A2+java.time.LocalDateTime%2C+LocalDate%2C+DayOfWeek%2C+Duration%2C+Period%2C+%E2%80%A6%3A+an+accurate+way+to+represent%0Aand+calculate+with+timestamps%2C+dates%2C+%E2%80%A6%0A%E2%97%A6+Supports+timezones+and+DST+%28Daylight+Saving+Time%29.%0A%E2%97%A6+Requires+Java+8+or+higher.%0A%E2%80%A2+int+or+long%3A+Caches+a+timestamp+as+a+simplified+number+of+coarse-grained+time+units+%28such+as%0Aminutes%29+from+the+start+of+the+global+planning+time+window+or+the+epoch.%0A%E2%97%A6+For+example%3A+a+LocalDateTime+of+1-JAN+08%3A00%3A00+becomes+an+int+of+400+minutes.+Similarly+1-%0AJAN+09%3A00%3A00+becomes+460+minutes.%0A%E2%97%A6+It+often+represents+an+extra+field+in+a+class%2C+alongside+the+LocalDateTime+field+from+which+it%0A354%0Awas+calculated.+The+LocalDateTime+is+used+for+user+visualization%2C+but+the+int+is+used+in+the%0Ascore+constraints.%0A%E2%97%A6+It+is+faster+in+calculations%2C+which+is+especially+useful+in+the+TimeGrain+pattern.%0A%E2%97%A6+Do+not+use+if+timezones+or+DST+affect+the+score+constraints.%0AThere+are+also+several+designs+for+assigning+a+planning+entity+to+a+starting+time+%28or+date%29%3A%0A%E2%80%A2+The+starting+time+is+fixed+beforehand.+It+is+not+a+planning+variable+%28in+such+solver%29.%0A%E2%97%A6+For+example%2C+in+the+hospital+bed+planning+example%2C+the+arrival+day+of+each+patient+is+fixed%0Abeforehand.%0A%E2%97%A6+This+is+common+in+multi+stage+planning%2C+when+the+starting+time+has+been+decided+already+in%0Aan+earlier+planning+stage.%0A%E2%80%A2+The+starting+time+is+not+fixed%2C+it+is+a+planning+variable+%28genuine+or+shadow%29.%0A%E2%97%A6+If+all+planning+entities+have+the+same+duration%2C+use+the+Timeslot+pattern.%0A%E2%96%AA+For+example+in+course+scheduling%2C+all+lectures+take+one+hour.+Therefore%2C+each+timeslot+is%0Aone+hour.%0A%E2%97%A6+If+the+duration+differs+and+time+is+rounded+to+a+specifc+time+granularity+%28for+example+5%0Aminutes%29+use+the+TimeGrain+pattern.%0A%E2%96%AA+For+example+in+meeting+scheduling%2C+all+meetings+start+at+15+minute+intervals.+All%0Ameetings+take+15%2C+30%2C+45%2C+60%2C+90+or+120+minutes.%0A%E2%97%A6+If+the+duration+differs+and+one+task+starts+immediately+after+the+previous+task+%28assigned+to%0Athe+same+executor%29+finishes%2C+use+the+Chained+Through+Time+pattern.%0A%E2%96%AA+For+example+in+time+windowed+vehicle+routing%2C+each+vehicle+departs+immediately+to+the%0Anext+customer+when+the+delivery+for+the+previous+customer+finishes.%0AChoose+the+right+pattern+depending+on+the+use+case%3A%0A355%0A18.3.1.+Timeslot+Pattern%3A+Assign+to+a+Fixed-Length+Timeslot%0AIf+all+planning+entities+have+the+same+duration+%28or+can+be+inflated+to+the+same+duration%29%2C+the%0ATimeslot+pattern+is+useful.+The+planning+entities+are+assigned+to+a+timeslot+rather+than+time.+For%0Aexample+in+course+timetabling%2C+all+lectures+take+one+hour.%0AThe+timeslots+can+start+at+any+time.+For+example%2C+the+timeslots+start+at+8%3A00%2C+9%3A00%2C+10%3A15+%28after+a+15-%0Aminute+break%29%2C+11%3A15%2C+%E2%80%A6+They+can+even+overlap%2C+but+that+is+unusual.%0AIt+is+also+usable+if+all+planning+entities+can+be+inflated+to+the+same+duration.+For+example+in+exam%0Atimetabling%2C+some+exams+take+90+minutes+and+others+120+minutes%2C+but+all+timeslots+are+120+minutes.%0AWhen+an+exam+of+90+minutes+is+assigned+to+a+timeslot%2C+for+the+remaining+30+minutes%2C+its+seats+are%0Aoccupied+too+and+cannot+be+used+by+another+exam.%0AUsually+there+is+a+second+planning+variable%2C+for+example+the+room.+In+course+timetabling%2C+two%0Alectures+are+in+conflict+if+they+share+the+same+room+at+the+same+timeslot.+However%2C+in+exam%0Atimetabling%2C+that+is+allowed%2C+if+there+is+enough+seating+capacity+in+the+room+%28although+mixed+exam%0Adurations+in+the+same+room+do+inflict+a+soft+score+penalty%29.%0A18.3.2.+TimeGrain+Pattern%3A+Assign+to+a+Starting+TimeGrain%0AAssigning+humans+to+start+a+meeting+at+four+seconds+after+9+o%E2%80%99clock+is+pointless+because+most%0Ahuman+activities+have+a+time+granularity+of+five+minutes+or+15+minutes.+Therefore+it+is+not%0Anecessary+to+allow+a+planning+entity+to+be+assigned+subsecond%2C+second+or+even+one+minute+accuracy.%0A356%0AThe+five+minute+or+15+minutes+accuracy+suffices.+The+TimeGrain+pattern+models+such+time%0Aaccuracy+by+partitioning+time+as+time+grains.+For+example+in+meeting+scheduling%2C+all+meetings%0Astart%2Fend+in+hour%2C+half+hour%2C+or+15-minute+intervals+before+or+after+each+hour%2C+therefore+the+optimal%0Asettings+for+time+grains+is+15+minutes.%0AEach+planning+entity+is+assigned+to+a+start+time+grain.+The+end+time+grain+is+calculated+by+adding+the%0Aduration+in+grains+to+the+starting+time+grain.+Overlap+of+two+entities+is+determined+by+comparing%0Atheir+start+and+end+time+grains.%0AThis+pattern+also+works+well+with+a+coarser+time+granularity+%28such+as+days%2C+half+days%2C+hours%2C+%E2%80%A6%29.%0AWith+a+finer+time+granularity+%28such+as+seconds%2C+milliseconds%2C+%E2%80%A6%29+and+a+long+time+window%2C+the+value%0Arange+%28and+therefore+the+search+space%29+can+become+too+high%2C+which+reduces+efficiency+and%0Ascalability.+However%2C+such+solution+is+not+impossible%2C+as+shown+in+cheap+time+scheduling.%0A18.3.3.+Chained+Through+Time+Pattern%3A+Assign+in+a+Chain+that+Determines%0AStarting+Time%0AIf+a+person+or+a+machine+continuously+works+on+one+task+at+a+time+in+sequence%2C+which+means%0Astarting+a+task+when+the+previous+is+finished+%28or+with+a+deterministic+delay%29%2C+the+Chained+Through%0ATime+pattern+is+useful.+For+example%2C+in+the+vehicle+routing+with+time+windows+example%2C+a+vehicle%0Adrives+from+customer+to+customer+%28thus+it+handles+one+customer+at+a+time%29.%0AIn+this+pattern%2C+the+planning+entities+are+chained.+The+anchor+determines+the+starting+time+of+its%0Afirst+planning+entity.+The+second+entity%E2%80%99s+starting+time+is+calculated+based+on+the+starting+time+and%0Aduration+of+the+first+entity.+For+example%2C+in+task+assignment%2C+Beth+%28the+anchor%29+starts+working+at%0A8%3A00%2C+thus+her+first+task+starts+at+8%3A00.+It+lasts+52+mins%2C+therefore+her+second+task+starts+at+8%3A52.+The%0Astarting+time+of+an+entity+is+usually+a+shadow+variable.%0AAn+anchor+has+only+one+chain.+Although+it+is+possible+to+split+up+the+anchor+into+two+separate%0Aanchors%2C+for+example+split+up+Beth+into+Beth%E2%80%99s+left+hand+and+Beth%E2%80%99s+right+hand+%28because+she+can+do%0Atwo+tasks+at+the+same+time%29%2C+this+model+makes+pooling+resources+difficult.+Consequently%2C+using+this%0Amodel+in+the+exam+scheduling+example+to+allow+two+or+more+exams+to+use+the+same+room+at+the%0Asame+time+is+problematic.%0ABetween+planning+entities%2C+there+are+three+ways+to+create+gaps%3A%0A%E2%80%A2+No+gaps%3A+This+is+common+when+the+anchor+is+a+machine.+For+example%2C+a+build+server+always%0Astarts+the+next+job+when+the+previous+finishes%2C+without+a+break.%0A%E2%80%A2+Only+deterministic+gaps%3A+This+is+common+for+humans.+For+example%2C+any+task+that+crosses+the%0A10%3A00+barrier+gets+an+extra+15+minutes+duration+so+the+human+can+take+a+break.%0A%E2%97%A6+A+deterministic+gap+can+be+subjected+to+complex+business+logic.+For+example+in+vehicle%0Arouting%2C+a+cross-continent+truck+driver+needs+to+rest+15+minutes+after+two+hours+of+driving%0A%28which+may+also+occur+during+loading+or+unloading+time+at+a+customer+location%29+and+also%0Aneeds+to+rest+10+hours+after+14+hours+of+work.%0A%E2%80%A2+Planning+variable+gaps%3A+This+is+uncommon%2C+because+an+extra+planning+variable+%28which+impacts%0Athe+search+space%29+reduces+efficiency+and+scalability.%0A357%0A18.4.+Multi-stage+planning%0AFor+practical+or+organizational+reasons+%28such+as+Conway%E2%80%99s+law%29%2C+complex+planning+problems+are%0Aoften+broken+down+in+multiple+stages.+A+typical+example+is+train+scheduling%2C+where+one+department%0Adecides+where+and+when+a+train+will+arrive+or+depart%2C+and+another+departments+assigns+the%0Aoperators+to+the+actual+train+cars%2Flocomotives.%0AEach+stage+has+its+own+solver+configuration+%28and+therefore+its+own+SolverFactory%29.+Do+not+confuse+it%0Awith+multi-phase+solving+which+uses+a+one-solver+configuration.%0ASimilarly+to+Partitioned+Search%2C+multi-stage+planning+leads+to+suboptimal+results.+Nevertheless%2C+it%0Amay+be+beneficial+in+order+to+simplify+the+maintenance%2C+ownership%2C+and+help+to+start+a+project.%0A358%0AChapter+19.+Development%0A19.1.+Methodology+Overview%0AThe+diagram+below+explains+the+overall+structure+of+the+OptaPlanner+source+code%3A%0AIn+the+diagram+above%2C+it%E2%80%99s+important+to+understand+the+clear+separation+between+the+configuration%0Aand+runtime+classes.%0AThe+development+philosophy+includes%3A%0A%E2%80%A2+Reuse%3A+The+examples+are+reused+as+integration+tests%2C+stress+tests+and+demo%E2%80%99s.+The+documentation%0Aimages+are+reused+as+slides.%0A%E2%80%A2+Consistent+terminology%3A+Each+example+has+a+class+App+%28executable+class%29+and+Panel+%28swing+UI%29.%0A%E2%80%A2+Consistent+structure%3A+Each+example+has+the+same+packages%3A+domain%2C+persistence%2C+app%2C+solver+and%0Aswingui.%0A%E2%80%A2+Real+world+usefulness%3A+Every+feature+is+used+in+an+example.+Most+examples+are+real+world+use%0Acases+with+real+world+constraints%2C+often+with+real+world+data.%0A%E2%80%A2+Automated+testing%3A+There+are+unit+tests%2C+integration+tests%2C+performance+regressions+tests+and%0Astress+tests.+The+test+coverage+is+high.%0A%E2%80%A2+Fail+fast+with+an+understandable+error+message%3A+Invalid+states+are+checked+as+early+as%0A359%0Apossible.%0A19.2.+Development+guidelines%0A1.+Fail+fast.+There+are+several+levels+of+fail+fast%2C+from+better+to+worse%3A%0Aa.+Fail+Fast+at+compile+time.+For+example%3A+Don%E2%80%99t+accept+an+Object+as+parameter+if+it+needs+to+be%0Aa+String+or+an+Integer.%0Ab.+Fail+Fast+at+startup+time.+For+example%3A+if+the+configuration+parameter+needs+to+be+a+positive%0Aint+and+it%E2%80%99s+negative%2C+fail+fast%0Ac.+Fail+Fast+at+runtime.+For+example%3A+if+the+request+needs+to+contain+a+double+between+0.0+and%0A1.0+and+it%E2%80%99s+bigger+than+1.0%2C+fail+fast.%0Ad.+Fail+Fast+at+runtime+in+assertion+mode+if+the+detection+performance+cost+is+high.+For%0Aexample%3A+If%2C+after+every+low+level+iteration%2C+the+variable+A+needs+to+be+equal+to+the+square%0Aroot+of+B%2C+check+it+if+and+only+if+an+assert+flag+is+set+to+true+%28usually+controlled+by+the%0AEnvironmentMode%29.%0A2.+Exception+messages%0Aa.+The+Exception+message+must+include+the+name+and+state+of+each+relevant+variable.+For%0Aexample%3A%0Aif+%28fooSize+%3C+0%29+%7B%0A%C2%A0+++throw+new+IllegalArgumentException%28%22The+fooSize+%28%22+%2B+fooSize+%2B+%22%29+of+bar+%28%22%0A%2B+this+%2B+%22%29+must+be+positive.%22%29%3B%0A%7D%0ANotice+that+the+output+clearly+explains+what%E2%80%99s+wrong%3A%0AException+in+thread+%22main%22+java.lang.IllegalArgumentException%3A+The+fooSize+%28-5%29%0Aof+bar+%28myBar%29+must+be+positive.%0A%C2%A0+++at+...%0Ab.+Whenever+possible%2C+the+Exception+message+must+include+context.%0Ac.+Whenever+the+fix+is+not+obvious%2C+the+Exception+message+should+include+advice.+Advice%0Anormally+starts+with+the+word+maybe+on+a+new+line%3A%0AException+in+thread+%22main%22+java.lang.IllegalStateException%3A+The%0AvalueRangeDescriptor+%28fooRange%29+is+nullable%2C+but+not+countable+%28false%29.%0AMaybe+the+member+%28getFooRange%29+should+return+CountableValueRange.%0A%C2%A0+++at+...%0AThe+word+maybe+is+to+indicate+that+the+advice+is+not+guaranteed+to+be+right+in+all+cases.%0A3.+Generics.+The+Solution+class+is+often+passed+as+a+generic+type+parameter+to+subsystems.+The%0APlanningEntity+class%28es%29+are+rarely+passed+as+a+generic+type+parameter.%0A360%0A
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1876)
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1474)
	at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
	at com.passer.web.servlet.TranslateServlet.service(TranslateServlet.java:63)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:467)
	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:392)
	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:311)
	at com.passer.web.servlet.UploadServlet.service(UploadServlet.java:96)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:624)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1441)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

09-Dec-2019 11:36:22.333 SEVERE [http-nio-8080-exec-8] org.apache.catalina.core.ApplicationDispatcher.invoke Servlet.service() for servlet com.passer.web.servlet.TranslateServlet threw exception
 java.io.IOException: Error writing to server
	at sun.net.www.protocol.http.HttpURLConnection.writeRequests(HttpURLConnection.java:699)
	at sun.net.www.protocol.http.HttpURLConnection.writeRequests(HttpURLConnection.java:711)
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1567)
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1474)
	at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
	at com.passer.web.servlet.TranslateServlet.service(TranslateServlet.java:63)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:467)
	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:392)
	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:311)
	at com.passer.web.servlet.UploadServlet.service(UploadServlet.java:96)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:624)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1441)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

09-Dec-2019 11:37:33.008 SEVERE [http-nio-8080-exec-11] org.apache.catalina.core.ApplicationDispatcher.invoke Servlet.service() for servlet com.passer.web.servlet.TranslateServlet threw exception
 java.io.IOException: Server returned HTTP response code: 413 for URL: https://translate.google.cn/translate_a/single?client=webapp&sl=auto&tl=zh-CN&hl=zh-CN&dt=at&dt=bd&dt=ex&dt=ld&dt=md&dt=qca&dt=rw&dt=rm&dt=ss&dt=t&source=bh&ssel=0&tsel=0&kc=1&tk=492773.110737&q=OptaPlanner+User+Guide%0AThe+OptaPlanner+Team%0AVersion+7.10.0.Final%0ATable+of+Contents%0A1.+OptaPlanner+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A01%0A1.1.+What+is+OptaPlanner%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A01%0A1.2.+What+is+a+Planning+Problem%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A02%0A1.2.1.+A+Planning+Problem+is+NP-complete+or+NP-hard+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.2.2.+A+Planning+Problem+Has+%28Hard+and+Soft%29+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.2.3.+A+Planning+Problem+Has+a+Huge+Search+Space+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.3.+Requirements.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A05%0A1.4.+Governance+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.1.+Status+of+OptaPlanner+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.2.+Release+Notes+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.3.+Backwards+Compatibility+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.4.+Community+and+Support+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A07%0A1.4.5.+Relationship+with+Drools+and+jBPM+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A07%0A1.5.+Download+and+Run+the+Examples.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A08%0A1.5.1.+Get+the+Release+zip+and+Run+the+Examples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A08%0A1.5.2.+Run+the+Webexamples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A010%0A1.5.3.+Run+the+Examples+in+an+IDE+%28IntelliJ%2C+Eclipse%2C+NetBeans%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A011%0A1.5.4.+Use+OptaPlanner+with+Maven%2C+Gradle%2C+Ivy%2C+Buildr+or+ANT+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A012%0A1.5.5.+Build+OptaPlanner+from+Source+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A013%0A2.+Getting+Started%3A+A+Cloud+Balancing+Demonstration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.+Cloud+Balancing+Tutorial+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A017%0A2.2.+Using+the+Domain+Model.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A017%0A2.2.1.+Domain+Model+Design+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A018%0A2.2.2.+Domain+Model+Implementation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A019%0A2.3.+Run+the+Cloud+Balancing+Hello+World+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A021%0A2.4.+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A023%0A2.5.+Score+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A024%0A2.5.1.+Easy+Java+Score+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A025%0A2.5.2.+Drools+Score+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A027%0A2.6.+Beyond+this+Tutorial.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A029%0A3.+Use+Cases+and+Examples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A030%0A3.1.+Examples+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A030%0A3.2.+N+Queens.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A034%0A3.2.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A034%0A3.2.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A035%0A3.2.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A035%0A3.3.+Cloud+Balancing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A037%0A3.4.+Traveling+Salesman+%28TSP+-+Traveling+Salesman+Problem%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.3.+Problem+Difficulty.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.5.+Dinner+Party+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.5.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.5.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.6.+Tennis+Club+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.7.+Meeting+Scheduling+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A041%0A3.7.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A041%0A3.7.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.+Course+Timetabling+%28ITC+2007+Track+3+-+Curriculum+Course+Scheduling%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A043%0A3.8.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A043%0A3.9.+Machine+Reassignment+%28Google+ROADEF+2012%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A044%0A3.9.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A044%0A3.9.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A045%0A3.9.3.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A046%0A3.9.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A047%0A3.10.+Vehicle+Routing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A048%0A3.10.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A048%0A3.10.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A050%0A3.10.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A050%0A3.10.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A054%0A3.11.+Project+Job+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A059%0A3.11.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A059%0A3.11.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A060%0A3.12.+Hospital+Bed+Planning+%28PAS+-+Patient+Admission+Scheduling%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A061%0A3.12.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A061%0A3.12.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A063%0A3.12.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A063%0A3.13.+Task+assigning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A064%0A3.13.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A064%0A3.13.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.13.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.13.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.14.+Exam+Timetabling+%28ITC+2007+track+1+-+Examination%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A066%0A3.14.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A066%0A3.14.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A068%0A3.14.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A068%0A3.15.+Nurse+Rostering+%28INRC+2010%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A069%0A3.15.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A069%0A3.15.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A071%0A3.15.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A071%0A3.15.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.+Traveling+Tournament+Problem+%28TTP%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A075%0A3.17.+Cheap+Time+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A076%0A3.17.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A076%0A3.17.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A077%0A3.18.+Investment+Asset+Class+Allocation+%28Portfolio+Optimization%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.18.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.18.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.+Conference+Scheduling+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A082%0A3.19.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A082%0A3.20.+Rock+Tour+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A3.20.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A3.20.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A4.+Planner+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.1.+Solver+Configuration+by+XML.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.2.+Solver+Configuration+by+Java+API+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A086%0A4.2.3.+Annotations+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A087%0A4.2.4.+Custom+Properties+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.+Model+a+Planning+Problem.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.1.+Is+This+Class+a+Problem+Fact+or+Planning+Entity%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.2.+Problem+Fact+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A090%0A4.3.3.+Planning+Entity+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A091%0A4.3.4.+Planning+Variable+%28genuine%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A094%0A4.3.5.+Planning+Value+and+Planning+Value+Range+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A096%0A4.3.6.+Planning+Problem+and+Planning+Solution.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0104%0A4.4.+Use+the+Solver+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.1.+The+Solver+Interface+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.2.+Solving+a+Problem.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.3.+Environment+Mode%3A+Are+There+Bugs+in+my+Code%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0115%0A4.4.4.+Logging+Level%3A+What+is+the+Solver+Doing%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0117%0A4.4.5.+Random+Number+Generator+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0120%0A5.+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.+Score+Terminology+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.1.+What+is+a+Score%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.2.+Formalize+the+Business+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.3.+Score+Constraint+Signum+%28Positive+or+Negative%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0123%0A5.1.4.+Score+Constraint+Weight+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0124%0A5.1.5.+Score+Constraint+Level+%28hard%2C+soft%2C+%E2%80%A6%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0125%0A5.1.6.+Pareto+Scoring+%28AKA+Multi-objective+Optimization+Scoring%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0127%0A5.1.7.+Combining+Score+Techniques+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0129%0A5.1.8.+Score+interface+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0129%0A5.1.9.+Avoid+Floating+Point+Numbers+in+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0130%0A5.2.+Choose+a+Score+Type+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.1.+SimpleScore+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.2.+HardSoftScore+%28Recommended%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.3.+HardMediumSoftScore+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.4.+BendableScore.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0133%0A5.2.5.+Implementing+a+Custom+Score.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0133%0A5.3.+Calculate+the+Score+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.1.+Score+Calculation+Types+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.2.+Easy+Java+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.3.+Incremental+Java+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0136%0A5.3.4.+Drools+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0141%0A5.3.5.+InitializingScoreTrend.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0147%0A5.3.6.+Invalid+Score+Detection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.+Score+Calculation+Performance+Tricks+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.1.+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.2.+Score+Calculation+Speed+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0149%0A5.4.3.+Incremental+Score+Calculation+%28with+Deltas%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0149%0A5.4.4.+Avoid+Calling+Remote+Services+During+Score+Calculation.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0151%0A5.4.5.+Pointless+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0151%0A5.4.6.+Built-in+Hard+Constraint+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.7.+Other+Score+Calculation+Performance+Tricks.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.8.+Score+Trap.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.9.+stepLimit+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0154%0A5.4.10.+Fairness+Score+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0154%0A5.5.+Explaining+the+Score%3A+Which+Constraints+Are+Broken%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0156%0A5.5.1.+Using+Score+Calculation+Outside+the+Solver+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0157%0A5.5.2.+Constraint+Match+Total%3A+Break+down+the+Score+by+Constraint+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0158%0A5.5.3.+Indictment+Heat+Map%3A+Visualize+the+Hot+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0159%0A5.6.+Testing+score+constraints+with+JUnit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0159%0A6.+Shadow+Variable+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0162%0A6.1.+Introduction.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0162%0A6.2.+Bi-directional+Variable+%28Inverse+Relation+Shadow+Variable%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0163%0A6.3.+Anchor+Shadow+Variable+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0165%0A6.4.+Custom+VariableListener+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0166%0A6.5.+VariableListener+triggering+order+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0168%0A7.+Optimization+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0171%0A7.1.+Search+Space+Size+in+the+Real+World+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0171%0A7.2.+Does+Planner+Find+the+Optimal+Solution%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0172%0A7.3.+Architecture+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0173%0A7.4.+Optimization+Algorithms+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0174%0A7.5.+Which+Optimization+Algorithms+Should+I+Use%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0176%0A7.6.+Power+tweaking+or+default+parameter+values.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0177%0A7.7.+Solver+Phase.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0177%0A7.8.+Scope+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0179%0A7.9.+Termination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0180%0A7.9.1.+TimeMillisSpentTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0181%0A7.9.2.+UnimprovedTimeMillisSpentTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0182%0A7.9.3.+BestScoreTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0183%0A7.9.4.+BestScoreFeasibleTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0183%0A7.9.5.+StepCountTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.6.+UnimprovedStepCountTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.7.+ScoreCalculationCountTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.8.+Combining+Multiple+Terminations+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0185%0A7.9.9.+Asynchronous+Termination+from+Another+Thread+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0185%0A7.10.+SolverEventListener+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0186%0A7.11.+Custom+Solver+Phase+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0186%0A7.12.+No+Change+Solver+Phase+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0188%0A7.13.+Multithreaded+Solving+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0189%0A7.13.1.+Custom+Thread+Factory+%28WildFly%2C+Android%2C+GAE%2C+%E2%80%A6%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0190%0A7.13.2.+Multithreaded+Incremental+Solving.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0190%0A8.+Move+and+Neighborhood+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.+Move+and+Neighborhood+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.1.+What+is+a+Move%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.2.+What+is+a+MoveSelector%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0194%0A8.1.3.+Subselecting+of+Entities%2C+Values+and+Other+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0194%0A8.2.+Generic+MoveSelectors+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0195%0A8.2.1.+changeMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0196%0A8.2.2.+swapMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0197%0A8.2.3.+pillarChangeMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0199%0A8.2.4.+pillarSwapMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0201%0A8.2.5.+tailChainSwapMoveSelector+or+2-opt+%28chained+variables+only%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0203%0A8.2.6.+subChainChangeMoveSelector+%28chained+variables+only%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0204%0A8.2.7.+subChainSwapMoveSelector+%28chained+variables+only%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0205%0A8.3.+Combining+Multiple+MoveSelectors.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0206%0A8.3.1.+unionMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0206%0A8.3.2.+cartesianProductMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0208%0A8.4.+EntitySelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0209%0A8.5.+ValueSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0209%0A8.6.+General+Selector+Features+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0210%0A8.6.1.+CacheType%3A+Create+Moves+Ahead+of+Time+or+Just+In+Time.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0210%0A8.6.2.+SelectionOrder%3A+Original%2C+Sorted%2C+Random%2C+Shuffled+or+Probabilistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0211%0A8.6.3.+Recommended+Combinations+of+CacheType+and+SelectionOrder+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0212%0A8.6.4.+Filtered+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0215%0A8.6.5.+Sorted+Selection.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0218%0A8.6.6.+Probabilistic+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0222%0A8.6.7.+Limited+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0223%0A8.6.8.+Mimic+Selection+%28Record%2FReplay%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0223%0A8.6.9.+Nearby+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0224%0A8.7.+Custom+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0227%0A8.7.1.+Which+Move+Types+Might+be+Missing+in+my+Implementation%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0227%0A8.7.2.+Custom+Moves+Introduction.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0228%0A8.7.3.+The+Interface+Move+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0228%0A8.7.4.+MoveListFactory%3A+the+Easy+Way+to+Generate+Custom+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0232%0A8.7.5.+MoveIteratorFactory%3A+Generate+Custom+Moves+Just+in+Time.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0233%0A9.+Exhaustive+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.+Brute+Force.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.1.+Algorithm+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.+Branch+And+Bound.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.1.+Algorithm+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0237%0A9.4.+Scalability+of+Exhaustive+Search.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0239%0A10.+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.+First+Fit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.+First+Fit+Decreasing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0244%0A10.4.+Weakest+Fit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.4.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.4.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.+Weakest+Fit+Decreasing.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.+Strongest+Fit.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.7.+Strongest+Fit+Decreasing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.7.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.7.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.8.+Allocate+Entity+From+Queue.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.3.+Multiple+Entity+Classes+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0249%0A10.8.4.+Pick+Early+Type+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0250%0A10.9.+Allocate+To+Value+From+Queue+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0251%0A10.9.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0251%0A10.9.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.+Cheapest+Insertion+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0253%0A10.11.+Regret+Insertion+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.11.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.11.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.+Allocate+From+Pool.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.13.+Scaling+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0255%0A10.13.1.+InitializingScoreTrend+shortcuts+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0255%0A10.13.2.+Scaling+Multiple+Planning+Variables+in+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0256%0A10.13.3.+Other+Scaling+Techniques+in+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0258%0A11.+Local+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.+Local+Search+Concepts.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.1.+Step+by+Step+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.2.+Decide+the+Next+Step+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0261%0A11.2.3.+Acceptor+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0263%0A11.2.4.+Forager+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0263%0A11.3.+Hill+Climbing+%28Simple+Local+Search%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0265%0A11.3.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0265%0A11.3.2.+Stuck+in+Local+Optima+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0266%0A11.3.3.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0266%0A11.4.+Tabu+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0267%0A11.4.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0267%0A11.4.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0268%0A11.5.+Simulated+Annealing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.5.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.5.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.6.+Late+Acceptance+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0271%0A11.6.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0271%0A11.6.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0272%0A11.7.+Step+Counting+Hill+Climbing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.7.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.7.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.8.+Strategic+Oscillation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.8.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.8.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.9.+Variable+Neighborhood+Descent+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.9.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.9.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.10.+Using+a+Custom+Termination%2C+MoveSelector%2C+EntitySelector%2C+ValueSelector+or+Acceptor+.+.+%C2%A0276%0A12.+Evolutionary+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.2.+Evolutionary+Strategies.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.3.+Genetic+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A13.+Hyperheuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0278%0A13.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0278%0A14.+Partitioned+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0279%0A14.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0279%0A14.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0280%0A14.3.+Partitioning+a+Solution+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0281%0A14.3.1.+Custom+SolutionPartitioner+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0281%0A14.4.+Runnable+Part+Thread+Limit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0283%0A15.+Benchmarking+and+Tweaking.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.1.+Find+the+Best+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.+Benchmark+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.1.+Add+a+Dependency+on+optaplanner-benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.2.+Run+a+Simple+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0287%0A15.2.3.+Configure+and+Run+an+Advanced+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0287%0A15.2.4.+SolutionFileIO%3A+Input+And+Output+Of+Solution+Files+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0289%0A15.2.5.+Warming+Up+The+HotSpot+Compiler+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0291%0A15.2.6.+Benchmark+Blueprint%3A+A+Predefined+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0292%0A15.2.7.+Write+The+Output+Solution+Of+Benchmark+Runs.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.2.8.+Benchmark+Logging+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.3.+Benchmark+Report+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.3.1.+HTML+Report+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0294%0A15.3.2.+Ranking+The+Solvers+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0294%0A15.4.+Summary+Statistics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0295%0A15.4.1.+Best+Score+Summary+%28Graph+And+Table%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0295%0A15.4.2.+Best+Score+Scalability+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0296%0A15.4.3.+Best+Score+Distribution+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0296%0A15.4.4.+Winning+Score+Difference+Summary+%28Graph+And+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.5.+Worst+Score+Difference+Percentage+%28ROI%29+Summary+%28Graph+and+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.6.+Score+Calculation+Speed+Summary+%28Graph+and+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.7.+Time+Spent+Summary+%28Graph+And+Table%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.4.8.+Time+Spent+Scalability+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.4.9.+Best+Score+Per+Time+Spent+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.+Statistic+Per+Dataset+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.1.+Enable+A+Problem+Statistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.2.+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0299%0A15.5.3.+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0301%0A15.5.4.+Score+Calculation+Speed+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0302%0A15.5.5.+Best+Solution+Mutation+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0303%0A15.5.6.+Move+Count+Per+Step+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0304%0A15.5.7.+Memory+Use+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0305%0A15.6.+Statistic+Per+Single+Benchmark+%28Graph+And+CSV%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0306%0A15.6.1.+Enable+A+Single+Statistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0306%0A15.6.2.+Constraint+Match+Total+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0307%0A15.6.3.+Constraint+Match+Total+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0308%0A15.6.4.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0309%0A15.6.5.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0310%0A15.7.+Advanced+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0311%0A15.7.1.+Benchmarking+Performance+Tricks+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0311%0A15.7.2.+Statistical+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0312%0A15.7.3.+Template+Based+Benchmarking+And+Matrix+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0313%0A15.7.4.+Benchmark+Report+Aggregation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0315%0A16.+Repeated+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.1.+Introduction+to+Repeated+Planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.2.+Backup+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.3.+Overconstrained+Planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0319%0A16.3.1.+Overconstrained+Planning+with+Nullable+Variables+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0319%0A16.3.2.+Overconstrained+Planning+with+Virtual+Values+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0320%0A16.4.+Continuous+Planning+%28Windowed+Planning%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0321%0A16.4.1.+Immovable+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0324%0A16.4.2.+Nonvolatile+Replanning+to+Minimize+Disruption+%28Semi-movable+Planning+Entities%29.+.+.+%C2%A0326%0A16.5.+Real-time+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0327%0A16.5.1.+ProblemFactChange+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0328%0A16.5.2.+Daemon%3A+solve%28%29+Does+Not+Return+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0332%0A17.+Integration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.+Persistent+Storage.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.1.+Database%3A+JPA+and+Hibernate.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.2.+XML+or+JSON%3A+XStream+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0338%0A17.2.3.+XML+or+JSON%3A+JAXB.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0339%0A17.2.4.+JSON%3A+Jackson.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0340%0A17.3.+SOA+and+ESB+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.3.1.+Camel+and+Karaf+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.+Other+Environments+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.1.+JBoss+Modules%2C+WildFly+and+JBoss+EAP+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.2.+Spring+Boot.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0344%0A17.4.3.+Java+Platform+Module+System+%28Jigsaw%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0344%0A17.4.4.+OSGi+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0345%0A17.4.5.+Android+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0345%0A17.5.+Integration+with+Human+Planners+%28Politics%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0346%0A17.6.+Sizing+Hardware+and+Software.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0348%0A18.+Design+Patterns.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.1.+Design+Patterns+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.2.+Domain+Modeling+Guide.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.3.+Assigning+Time+to+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0354%0A18.3.1.+Timeslot+Pattern%3A+Assign+to+a+Fixed-Length+Timeslot.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0356%0A18.3.2.+TimeGrain+Pattern%3A+Assign+to+a+Starting+TimeGrain+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0356%0A18.3.3.+Chained+Through+Time+Pattern%3A+Assign+in+a+Chain+that+Determines+Starting+Time.+.+.+.+%C2%A0357%0A18.4.+Multi-stage+planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0358%0A19.+Development+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0359%0A19.1.+Methodology+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0359%0A19.2.+Development+guidelines+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0360%0AChapter+1.+OptaPlanner+Introduction%0A1.1.+What+is+OptaPlanner%3F%0AEvery+organization+faces+planning+problems%3A+providing+products+or+services+with+a+limited+set+of%0Aconstrained+resources+%28employees%2C+assets%2C+time+and+money%29.+OptaPlanner+optimizes+such+planning%0Ato+do+more+business+with+less+resources.+This+is+known+as+Constraint+Satisfaction+Programming%0A%28which+is+part+of+the+Operations+Research+discipline%29.%0AOptaPlanner+is+a+lightweight%2C+embeddable+constraint+satisfaction+engine+which+optimizes+planning%0Aproblems.+It+solves+use+cases+such+as%3A%0A%E2%80%A2+Employee+shift+rostering%3A+timetabling+nurses%2C+repairmen%2C+%E2%80%A6%0A%E2%80%A2+Agenda+scheduling%3A+scheduling+meetings%2C+appointments%2C+maintenance+jobs%2C+advertisements%2C+%E2%80%A6%0A%E2%80%A2+Educational+timetabling%3A+scheduling+lessons%2C+courses%2C+exams%2C+conference+presentations%2C+%E2%80%A6%0A%E2%80%A2+Vehicle+routing%3A+planning+vehicle+routes+%28trucks%2C+trains%2C+boats%2C+airplanes%2C+%E2%80%A6%29+for+moving+freight%0Aand%2For+passengers+through+multiple+destinations+using+known+mapping+tools+%E2%80%A6%0A%E2%80%A2+Bin+packing%3A+filling+containers%2C+trucks%2C+ships%2C+and+storage+warehouses+with+items%2C+but+also%0Apacking+information+across+computer+resources%2C+as+in+cloud+computing+%E2%80%A6%0A%E2%80%A2+Job+shop+scheduling%3A+planning+car+assembly+lines%2C+machine+queue+planning%2C+workforce+task%0Aplanning%2C+%E2%80%A6%0A%E2%80%A2+Cutting+stock%3A+minimizing+waste+while+cutting+paper%2C+steel%2C+carpet%2C+%E2%80%A6%0A%E2%80%A2+Sport+scheduling%3A+planning+games+and+training+schedules+for+football+leagues%2C+baseball+leagues%2C%0A%E2%80%A6%0A%E2%80%A2+Financial+optimization%3A+investment+portfolio+optimization%2C+risk+spreading%2C+%E2%80%A6%0A1%0A1.2.+What+is+a+Planning+Problem%3F%0A2%0AA+planning+problem+has+an+optimal+goal%2C+based+on+limited+resources+and+under+specific+constraints.%0AOptimal+goals+can+be+any+number+of+things%2C+such+as%3A%0A%E2%80%A2+Maximized+profits+-+the+optimal+goal+results+in+the+highest+possible+profit.%0A%E2%80%A2+Minimized+ecological+footprint+-+the+optimal+goal+has+the+least+amount+of+environmental+impact.%0A%E2%80%A2+Maximized+satisfaction+for+employees+or+customers+-+the+optimal+goal+prioritizes+the+needs+of%0Aemployees+or+customers.%0AThe+ability+to+achieve+these+goals+relies+on+the+number+of+resources+available%2C+such+as%3A%0A%E2%80%A2+The+number+of+people.%0A%E2%80%A2+Amount+of+time.%0A%E2%80%A2+Budget.%0A%E2%80%A2+Physical+assets%2C+for+example%2C+machinery%2C+vehicles%2C+computers%2C+buildings%2C+etc.%0ASpecific+constraints+related+to+these+resources+must+also+be+taken+into+account%2C+such+as+the+number%0Aof+hours+a+person+works%2C+their+ability+to+use+certain+machines%2C+or+compatibility+between+pieces+of%0Aequipment.%0AOptaPlanner+helps+JavaTM+programmers+solve+constraint+satisfaction+problems+efficiently.+Under+the%0Ahood%2C+it+combines+optimization+heuristics+and+metaheuristics+with+very+efficient+score+calculation.%0A3%0A1.2.1.+A+Planning+Problem+is+NP-complete+or+NP-hard%0AAll+the+use+cases+above+are+probably+NP-complete%2FNP-hard%2C+which+means+in+layman%E2%80%99s+terms%3A%0A%E2%80%A2+It%E2%80%99s+easy+to+verify+a+given+solution+to+a+problem+in+reasonable+time.%0A%E2%80%A2+There+is+no+silver+bullet+to+find+the+optimal+solution+of+a+problem+in+reasonable+time+%28*%29.%0A%28*%29+At+least%2C+none+of+the+smartest+computer+scientists+in+the+world+have+found+such%0Aa+silver+bullet+yet.+But+if+they+find+one+for+1+NP-complete+problem%2C+it+will+work+for%0A%EF%81%9A+every+NP-complete+problem.%0AIn+fact%2C+there%E2%80%99s+a+%24+1%2C000%2C000+reward+for+anyone+that+proves+if+such+a+silver+bullet%0Aactually+exists+or+not.%0AThe+implication+of+this+is+pretty+dire%3A+solving+your+problem+is+probably+harder+than+you+anticipated%2C%0Abecause+the+two+common+techniques+won%E2%80%99t+suffice%3A%0A%E2%80%A2+A+Brute+Force+algorithm+%28even+a+smarter+variant%29+will+take+too+long.%0A%E2%80%A2+A+quick+algorithm%2C+for+example+in+bin+packing%2C+putting+in+the+largest+items+first%2C+will+return+a%0Asolution+that+is+far+from+optimal.%0ABy+using+advanced+optimization+algorithms%2C+OptaPlanner+does+find+a+good+solution+in%0Areasonable+time+for+such+planning+problems.%0A1.2.2.+A+Planning+Problem+Has+%28Hard+and+Soft%29+Constraints%0AUsually%2C+a+planning+problem+has+at+least+two+levels+of+constraints%3A%0A%E2%80%A2+A+%28negative%29+hard+constraint+must+not+be+broken.+For+example%3A+1+teacher+can+not+teach+2+different%0Alessons+at+the+same+time.%0A%E2%80%A2+A+%28negative%29+soft+constraint+should+not+be+broken+if+it+can+be+avoided.+For+example%3A+Teacher+A%0Adoes+not+like+to+teach+on+Friday+afternoon.%0ASome+problems+have+positive+constraints+too%3A%0A%E2%80%A2+A+positive+soft+constraint+%28or+reward%29+should+be+fulfilled+if+possible.+For+example%3A+Teacher+B+likes%0Ato+teach+on+Monday+morning.%0ASome+basic+problems+%28such+as+N+queens%29+only+have+hard+constraints.+Some+problems+have+three+or%0Amore+levels+of+constraints%2C+for+example+hard%2C+medium+and+soft+constraints.%0AThese+constraints+define+the+score+calculation+%28AKA+fitness+function%29+of+a+planning+problem.+Each%0Asolution+of+a+planning+problem+can+be+graded+with+a+score.+With+OptaPlanner%2C+score+constraints%0Aare+written+in+an+Object+Oriented+language%2C+such+as+JavaTM+code+or+Drools+rules.+Such+code+is%0Aeasy%2C+flexible+and+scalable.%0A1.2.3.+A+Planning+Problem+Has+a+Huge+Search+Space%0AA+planning+problem+has+a+number+of+solutions.+There+are+several+categories+of+solutions%3A%0A4%0A%E2%80%A2+A+possible+solution+is+any+solution%2C+whether+or+not+it+breaks+any+number+of+constraints.+Planning%0Aproblems+tend+to+have+an+incredibly+large+number+of+possible+solutions.+Many+of+those+solutions%0Aare+worthless.%0A%E2%80%A2+A+feasible+solution+is+a+solution+that+does+not+break+any+%28negative%29+hard+constraints.+The+number%0Aof+feasible+solutions+tends+to+be+relative+to+the+number+of+possible+solutions.+Sometimes+there%0Aare+no+feasible+solutions.+Every+feasible+solution+is+a+possible+solution.%0A%E2%80%A2+An+optimal+solution+is+a+solution+with+the+highest+score.+Planning+problems+tend+to+have+1+or+a%0Afew+optimal+solutions.+There+is+always+at+least+1+optimal+solution%2C+even+in+the+case+that+there+are%0Ano+feasible+solutions+and+the+optimal+solution+isn%E2%80%99t+feasible.%0A%E2%80%A2+The+best+solution+found+is+the+solution+with+the+highest+score+found+by+an+implementation+in+a%0Agiven+amount+of+time.+The+best+solution+found+is+likely+to+be+feasible+and%2C+given+enough+time%2C+it%E2%80%99s%0Aan+optimal+solution.%0ACounterintuitively%2C+the+number+of+possible+solutions+is+huge+%28if+calculated+correctly%29%2C+even+with+a%0Asmall+dataset.+As+you+can+see+in+the+examples%2C+most+instances+have+a+lot+more+possible+solutions%0Athan+the+minimal+number+of+atoms+in+the+known+universe+%2810%5E80%29.+Because+there+is+no+silver+bullet%0Ato+find+the+optimal+solution%2C+any+implementation+is+forced+to+evaluate+at+least+a+subset+of+all+those%0Apossible+solutions.%0AOptaPlanner+supports+several+optimization+algorithms+to+efficiently+wade+through+that+incredibly%0Alarge+number+of+possible+solutions.+Depending+on+the+use+case%2C+some+optimization+algorithms%0Aperform+better+than+others%2C+but+it%E2%80%99s+impossible+to+tell+in+advance.+With+OptaPlanner%2C+it+is+easy+to%0Aswitch+the+optimization+algorithm%2C+by+changing+the+solver+configuration+in+a+few+lines+of+XML+or%0Acode.%0A1.3.+Requirements%0AOptaPlanner+is+open+source+software%2C+released+under+the+Apache+Software+License+2.0.+This+license%0Ais+very+liberal+and+allows+reuse+for+commercial+purposes.+Read+the+layman%E2%80%99s+explanation.%0AOptaPlanner+is+100%25+pure+JavaTM+and+runs+on+any+JVM+8+or+higher.+It+integrates+very+easily+with%0Aother+JavaTM+technologies.+OptaPlanner+is+available+in+the+Maven+Central+Repository.%0APlanner+works+on+any+Java+Virtual+Machine+and+is+compatible+with+Standard+Java%2C+Enterprise+Java%2C%0Aand+all+JVM+languages.%0A5%0A1.4.+Governance%0A1.4.1.+Status+of+OptaPlanner%0AOptaPlanner+is+stable%2C+reliable+and+scaleable.+It+has+been+heavily+tested+with+unit%2C+integration%2C+and%0Astress+tests%2C+and+is+used+in+production+throughout+the+world.+One+example+handles+over+50+000%0Avariables+with+5000+variables+each%2C+multiple+constraint+types+and+billions+of+possible+constraint%0Amatches.%0A1.4.2.+Release+Notes%0AWe+release+every+month.+Read+the+release+notes+of+each+release+on+our+website.%0A1.4.3.+Backwards+Compatibility%0AOptaPlanner+separates+its+API+and+implementation%3A%0A%E2%80%A2+Public+API%3A+All+classes+in+the+package+namespace+org.optaplanner.core.api+are+100%25%0Abackwards+compatible+in+future+releases+%28especially+minor+and+hotfix+releases%29.+In+rare%0Acircumstances%2C+if+the+major+version+number+changes%2C+a+few+specific+classes+might+have+a+few%0Abackwards+incompatible+changes%2C+but+those+will+be+clearly+documented+in+the+upgrade+recipe.%0A%E2%80%A2+XML+configuration%3A+The+XML+solver+configuration+is+backwards+compatible+for+all+elements%2C%0Aexcept+for+elements+that+require+the+use+of+non+public+API+classes.+The+XML+solver+configuration%0A6%0Ais+defined+by+the+classes+in+the+package+namespace+org.optaplanner.core.config.%0A%E2%80%A2+Implementation+classes%3A+All+classes+in+the+package+namespace+org.optaplanner.core.impl+are%0Anot+backwards+compatible%3A+they+will+change+in+future+major+or+minor+releases+%28but+probably+not%0Ain+hotfix+releases%29.+The+upgrade+recipe+describes+every+such+relevant+change+and+on+how+to%0Aquickly+deal+with+it+when+upgrading+to+a+newer+version.%0AThis+documentation+covers+some+impl+classes+too.+Those+documented+impl+classes%0Aare+reliable+and+safe+to+use+%28unless+explicitly+marked+as+experimental+in+this%0A%EF%81%9A+documentation%29%2C+but+we%E2%80%99re+just+not+entirely+comfortable+yet+to+write+their%0Asignatures+in+stone.%0A1.4.4.+Community+and+Support%0AFor+news+and+articles%2C+check+our+blog%2C+twitter+%28including+Geoffrey%E2%80%99s+twitter%29+and+facebook.%0AIf+you%E2%80%99re+happy+with+OptaPlanner%2C+make+us+happy+by+posting+a+tweet+or+blog+article+about+it.%0APublic+questions+are+welcome+on+here.+Bugs+and+feature+requests+are+welcome+in+our+issue+tracker.%0APull+requests+are+very+welcome+on+GitHub+and+get+priority+treatment%21+By+open+sourcing+your%0Aimprovements%2C+you+%27ll+benefit+from+our+peer+review+and+from+our+improvements+made+on+top+of%0Ayour+improvements.%0ARed+Hat+sponsors+OptaPlanner+development+by+employing+the+core+team.+For+enterprise+support%0Aand+consulting%2C+take+a+look+at+these+services.%0A1.4.5.+Relationship+with+Drools+and+jBPM%0AOptaPlanner+is+part+of+the+KIE+group+of+projects.+It+releases+regularly+%28often+once+or+twice+per%0Amonth%29+together+with+the+Drools+rule+engine+and+the+jBPM+workflow+engine.%0A7%0ASee+the+architecture+overview+to+learn+more+about+the+optional+integration+with+Drools.%0A1.5.+Download+and+Run+the+Examples%0A1.5.1.+Get+the+Release+zip+and+Run+the+Examples%0ATo+try+it+now%3A%0A1.+Download+a+release+zip+of+OptaPlanner+from+the+OptaPlanner+website+and+unzip+it.%0A2.+Open+the+directory+examples+and+run+the+script.%0ALinux+or+Mac%3A%0A%24+cd+examples%0A%24+.%2FrunExamples.sh%0AWindows%3A%0A%24+cd+examples%0A%24+runExamples.bat%0A8%0AThe+Examples+GUI+application+will+open.+Pick+an+example+to+try+it+out%3A%0A9%0AOptaPlanner+itself+has+no+GUI+dependencies.+It+runs+just+as+well+on+a+server+or+a%0A%EF%81%9A+mobile+JVM+as+it+does+on+the+desktop.%0A1.5.2.+Run+the+Webexamples%0ABesides+the+GUI+examples%2C+there+are+also+a+set+of+webexamples+to+try+out.+The+webexamples+include%3A%0A%E2%80%A2+Vehicle+routing%3A+calculating+the+shortest+possible+route+to+pick+up+all+items+required+for+a%0Anumber+of+different+customers+using+either+Leaflet+or+Google+Maps+visualizations.%0A%E2%80%A2+Cloud+balancing%3A+Assigning+processes+across+computers+with+different+specifications+and+costs.%0APrerequisites%0AThe+webexamples+require+several+JEE+APIs+to+run%2C+such+as%3A%0A%E2%80%A2+Servlet%0A%E2%80%A2+JAX-RS%0A%E2%80%A2+CDI%0AThese+are+not+required+for+Planner+itself.%0ARunning+the+Webexamples+on+a+JEE+Application+Server%0A1.+Download+a+JEE+application+server%2C+such+as+JBoss+EAP+or+WildFly+and+unzip+it.%0A10%0A2.+Download+a+release+zip+of+OptaPlanner+from+the+OptaPlanner+website+and+unzip+it.%0A3.+Open+the+directory+webexamples+and+deploy+the+optaplanner-webexamples-*.war+file+on+the+JEE%0Aapplication+server.%0AIf+using+JBoss+EAP+in+standalone+mode%2C+this+can+be+done+by+adding+the+optaplanner-webexamples-%0A.war+file+to+the+jboss-eap-%2Fstandalone%2Fdeployments+folder.%0A4.+Open+the+following+address+in+a+web+browser%3A+http%3A%2F%2Flocalhost%3A8080%2Foptaplanner-webexamples-%0A*%2F+%28replace+the+*+with+the+actual+version%29.%0ADeploying+Webexamples+on+a+Servlet+Container%0ATo+successfully+deploy+the+webexamples+on+a+servlet+container+%28such+as+Jetty+or+Tomcat%29+instead+of%0Aon+a+real+JEE+application+server+%28such+as+WildFly%29%3A%0A1.+Add+the+missing+implementation+libraries+%28for+example+RestEasy+and+Weld%29+in+the+optaplanner-%0Awebexamples-*.war+manually.%0A2.+Deploy+the+optaplanner-webexamples-*.war+on+the+servlet+container.%0APick+an+example+to+try+it+out%2C+such+as+the+Vehicle+Routing+example%3A%0A1.5.3.+Run+the+Examples+in+an+IDE+%28IntelliJ%2C+Eclipse%2C+NetBeans%29%0ATo+run+the+examples+in+your+favorite+IDE%3A%0A11%0A%E2%80%A2+In+IntelliJ+IDEA%2C+NetBeans+or+a+non-vanilla+Eclipse%3A%0A1.+Open+the+file+examples%2Fsources%2Fpom.xml+as+a+new+project%2C+the+maven+integration+will+take%0Acare+of+the+rest.%0A2.+Run+the+examples+from+the+project.%0A%E2%80%A2+In+a+vanilla+Eclipse+%28which+lacks+the+M2Eclipse+plugin%29%3A%0A1.+Open+a+new+project+for+the+directory+examples%2Fsources+.%0A2.+Add+all+the+jars+to+the+classpath+from+the+directory+binaries+and+the+directory%0Aexamples%2Fbinaries+%2C+except+for+the+file+examples%2Fbinaries%2Foptaplanner-examples-*.jar+.%0A3.+Add+the+Java+source+directory+src%2Fmain%2Fjava+and+the+Java+resources+directory%0Asrc%2Fmain%2Fresources+.%0A4.+Create+a+run+configuration%3A%0A%E2%96%AA+Main+class%3A+org.optaplanner.examples.app.OptaPlannerExamplesApp%0A%E2%96%AA+VM+parameters+%28optional%29%3A+-Xmx512M+-server%0Aa.+To+run+a+specific+example+directly+and+skip+the+example+selection+window%2C+run+its+App%0Aclass+%28for+example+CloudBalancingApp%29+instead+of+OptaPlannerExamplesApp.%0A5.+Run+that+run+configuration.%0A1.5.4.+Use+OptaPlanner+with+Maven%2C+Gradle%2C+Ivy%2C+Buildr+or+ANT%0AThe+OptaPlanner+jars+are+also+available+in+the+central+maven+repository+%28and+also+in+the+JBoss%0Amaven+repository%29.%0AIf+you+use+Maven%2C+add+a+dependency+to+optaplanner-core+in+your+project%E2%80%99s+pom.xml+%3A%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eoptaplanner-core%3C%2FartifactId%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AThis+is+similar+for+Gradle%2C+Ivy+and+Buildr.+To+identify+the+latest+version%2C+check+the+central+maven%0Arepository.%0ABecause+you+might+end+up+using+other+OptaPlanner+modules+too%2C+it%E2%80%99s+recommended+to+import+the%0Aoptaplanner-bom+in+Maven%E2%80%99s+dependencyManagement+so+the+OptaPlanner+version+is+specified+only+once%3A%0A12%0A%C2%A0+%3CdependencyManagement%3E%0A%C2%A0+++%3Cdependencies%3E%0A%C2%A0+++++%3Cdependency%3E%0A%C2%A0+++++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++++%3CartifactId%3Eoptaplanner-bom%3C%2FartifactId%3E%0A%C2%A0+++++++%3Ctype%3Epom%3C%2Ftype%3E%0A%C2%A0+++++++%3Cversion%3E...%3C%2Fversion%3E%0A%C2%A0+++++++%3Cscope%3Eimport%3C%2Fscope%3E%0A%C2%A0+++++%3C%2Fdependency%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fdependencies%3E%0A%C2%A0+%3C%2FdependencyManagement%3E%0AIf+you%E2%80%99re+still+using+ANT+%28without+Ivy%29%2C+copy+all+the+jars+from+the+download+zip%E2%80%99s+binaries+directory+in%0Ayour+classpath.%0AThe+download+zip%E2%80%99s+binaries+directory+contains+far+more+jars+then+optaplanner-core%0Aactually+uses.+It+also+contains+the+jars+used+by+other+modules%2C+such+as+optaplanner-%0A%EF%81%9A+benchmark.%0ACheck+the+maven+repository+pom.xml+files+to+determine+the+minimal+dependency%0Aset+of+a+specific+module+%28for+a+specific+version%29.%0A1.5.5.+Build+OptaPlanner+from+Source%0APrerequisites%0A%E2%80%A2+Set+up+Git.%0A%E2%80%A2+Authenticate+on+GitHub+using+either+HTTPS+or+SSH.%0A%E2%97%A6+See+GitHub+for+more+information+about+setting+up+and+authenticating+Git.%0A%E2%80%A2+Set+up+Maven.%0ABuild+and+run+the+examples+from+source.%0A1.+Clone+optaplanner+from+GitHub+%28or+alternatively%2C+download+the+zipball%29%3A%0A%24+git+clone+https%3A%2F%2Fgithub.com%2Fkiegroup%2Foptaplanner.git%0A...%0A2.+Build+it+with+Maven%3A%0A%24+cd+optaplanner%0A%24+mvn+clean+install+-DskipTests%0A...%0A13%0AThe+first+time%2C+Maven+might+take+a+long+time%2C+because+it+needs+to+download%0A%EF%81%9A+jars.%0A3.+Run+the+examples%3A%0A%24+cd+optaplanner-examples%0A%24+mvn+exec%3Ajava%0A...%0A4.+Edit+the+sources+in+your+favorite+IDE.%0Aa.+Optional%3A+use+a+Java+profiler.%0A14%0AChapter+2.+Getting+Started%3A+A+Cloud%0ABalancing+Demonstration%0A2.1.+Cloud+Balancing+Tutorial%0A2.1.1.+Problem+Description%0ASuppose+your+company+owns+a+number+of+cloud+computers+and+needs+to+run+a+number+of%0Aprocesses+on+those+computers.+Assign+each+process+to+a+computer.%0AThe+following+hard+constraints+must+be+fulfilled%3A%0A%E2%80%A2+Every+computer+must+be+able+to+handle+the+minimum+hardware+requirements+of+the+sum+of+its%0Aprocesses%3A%0A%E2%97%A6+CPU+capacity%3A+The+CPU+power+of+a+computer+must+be+at+least+the+sum+of+the+CPU+power%0Arequired+by+the+processes+assigned+to+that+computer.%0A%E2%97%A6+Memory+capacity%3A+The+RAM+memory+of+a+computer+must+be+at+least+the+sum+of+the+RAM%0Amemory+required+by+the+processes+assigned+to+that+computer.%0A%E2%97%A6+Network+capacity%3A+The+network+bandwidth+of+a+computer+must+be+at+least+the+sum+of+the%0Anetwork+bandwidth+required+by+the+processes+assigned+to+that+computer.%0AThe+following+soft+constraints+should+be+optimized%3A%0A%E2%80%A2+Each+computer+that+has+one+or+more+processes+assigned%2C+incurs+a+maintenance+cost+%28which+is%0Afixed+per+computer%29.%0A%E2%97%A6+Cost%3A+Minimize+the+total+maintenance+cost.%0AThis+problem+is+a+form+of+bin+packing.+The+following+is+a+simplified+example%2C+in+which+we+assign%0Afour+processes+to+two+computers+with+two+constraints+%28CPU+and+RAM%29+with+a+simple+algorithm%3A%0A15%0AThe+simple+algorithm+used+here+is+the+First+Fit+Decreasing+algorithm%2C+which+assigns+the+bigger%0Aprocesses+first+and+assigns+the+smaller+processes+to+the+remaining+space.+As+you+can+see%2C+it+is+not%0Aoptimal%2C+as+it+does+not+leave+enough+room+to+assign+the+yellow+process+D.%0APlanner+does+find+the+more+optimal+solution+by+using+additional%2C+smarter+algorithms.+It+also+scales%3A%0Aboth+in+data+%28more+processes%2C+more+computers%29+and+constraints+%28more+hardware+requirements%2C%0Aother+constraints%29.+So+let%E2%80%99s+see+how+Planner+can+be+used+in+this+scenario.%0AHere%E2%80%99s+an+executive+summary+of+this+example+and+an+advanced+implementation+with+more%0Aconstraints%3A%0A16%0A2.1.2.+Problem+Size%0ATable+1.+Cloud+Balancing+Problem+Size%0AProblem+Size+Computers+Processes+Search+Space%0A2computers-6processes+2+6+64%0A3computers-9processes+3+9+10%5E4%0A4computers-+4+12+10%5E7%0A012processes%0A100computers-+100+300+10%5E600%0A300processes%0A200computers-+200+600+10%5E1380%0A600processes%0A400computers-+400+1200+10%5E3122%0A1200processes%0A800computers-+800+2400+10%5E6967%0A2400processes%0A2.2.+Using+the+Domain+Model%0A17%0A2.2.1.+Domain+Model+Design%0AUsing+a+domain+model+helps+determine+which+classes+are+planning+entities+and+which+of+their%0Aproperties+are+planning+variables.+It+also+helps+to+simplify+contraints%2C+improve+performance%2C+and%0Aincrease+flexibility+for+future+needs.%0A1.+Draw+a+class+diagram+of+your+domain+model.%0A2.+Normalize+it+to+remove+duplicate+data.%0A3.+Write+down+some+sample+instances+for+each+class.%0A%E2%97%A6+Computer%3A+represents+a+computer+with+certain+hardware+and+maintenance+costs.%0AIn+this+example%2C+the+sample+instances+for+the+Computer+class+are%3A+cpuPower%2C+memory%2C%0AnetworkBandwidth%2C+cost.%0A%E2%97%A6+Process%3A+represents+a+process+with+a+demand.+Needs+to+be+assigned+to+a+Computer+by+Planner.%0ASample+instances+for+Process+are%3A+requiredCpuPower%2C+requiredMemory%2C+and%0ArequiredNetworkBandwidth.%0A%E2%97%A6+CloudBalance%3A+represents+a+problem.+Contains+every+Computer+and+Process+for+a+certain+data%0Aset.%0AThe+sample+instance+for+CloudBalance+is+score.%0A4.+Determine+which+relationships+%28or+fields%29+change+during+planning.%0A%E2%97%A6+Planning+entity%3A+the+class+%28or+classes%29+that+changes+during+solving.+In+this+example%2C+it+is+the%0Aclass+Process.%0A%E2%97%A6+Planning+variable%3A+the+property+%28or+properties%29+of+a+planning+entity+class+that+changes+during%0Asolving.+In+this+example%2C+it+is+the+property+computer+on+the+class+Process.%0A%E2%97%A6+Planning+solution%3A+the+class+that+represents+a+data+set+and+contains+all+planning+entities.+In%0Athis+example+that+is+the+class+CloudBalance.%0AIn+the+UML+class+diagram+below%2C+the+Planner+concepts+are+already+annotated%3A%0A18%0A2.2.2.+Domain+Model+Implementation%0A2.2.2.1.+The+Computer+Class%0AThe+Computer+class+is+a+POJO+%28Plain+Old+Java+Object%29.+Usually%2C+you+will+have+more+of+this+kind+of%0Aclasses+with+input+data.%0AExample+1.+CloudComputer.java%0Apublic+class+CloudComputer+...+%7B%0A%C2%A0+++private+int+cpuPower%3B%0A%C2%A0+++private+int+memory%3B%0A%C2%A0+++private+int+networkBandwidth%3B%0A%C2%A0+++private+int+cost%3B%0A%C2%A0+++...+%2F%2F+getters%0A%7D%0A2.2.2.2.+The+Process+Class%0AThe+Process+class+is+particularly+important.+It+is+the+class+that+is+modified+during+solving.%0A19%0AWe+need+to+tell+Planner+that+it+can+change+the+property+computer.+To+do+this%3A+.+Annotate+the+class%0Awith+%40PlanningEntity.+.+Annotate+the+getter+getComputer%28%29+with+%40PlanningVariable.%0AOf+course%2C+the+property+computer+needs+a+setter+too%2C+so+Planner+can+change+it+during+solving.%0AExample+2.+CloudProcess.java%0A%40PlanningEntity%28...%29%0Apublic+class+CloudProcess+...+%7B%0A%C2%A0+++private+int+requiredCpuPower%3B%0A%C2%A0+++private+int+requiredMemory%3B%0A%C2%A0+++private+int+requiredNetworkBandwidth%3B%0A%C2%A0+++private+CloudComputer+computer%3B%0A%C2%A0+++...+%2F%2F+getters%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22computerRange%22%7D%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setComputer%28CloudComputer+computer%29+%7B%0A%C2%A0+++++++computer+%3D+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+************************************************************************%0A%C2%A0+++%2F%2F+Complex+methods%0A%C2%A0+++%2F%2F+************************************************************************%0A%C2%A0+++...%0A%7D%0A%E2%80%A2+Planner+needs+to+know+which+values+it+can+choose+from+to+assign+to+the+property+computer.%0AThose+values+are+retrieved+from+the+method+CloudBalance.getComputerList%28%29+on+the+planning%0Asolution%2C+which+returns+a+list+of+all+computers+in+the+current+data+set.%0A%E2%80%A2+The+%40PlanningVariable%27s+valueRangeProviderRefs+parameter+on+CloudProcess.getComputer%28%29+needs%0Ato+match+with+the+%40ValueRangeProvider%27s+id+on+CloudBalance.getComputerList%28%29.%0A%EF%81%9A+Instead+of+getter+annotations%2C+it+is+also+possible+to+use+field+annotations.%0A2.2.2.3.+The+CloudBalance+Class%0AThe+CloudBalance+class+has+a+%40PlanningSolution+annotation.%0A%E2%80%A2+It+holds+a+list+of+all+computers+and+processes.%0A20%0A%E2%80%A2+It+represents+both+the+planning+problem+and+%28if+it%E2%80%99s+initialized%29+the+planning+solution.%0A1.+Planner+needs+to+retrieve+the+collection+of+processes+that+it+can+change%2C+therefore+we%0Aannotate+the+getter+getProcessList%28%29+with+%40PlanningEntityCollectionProperty.%0A2.+The+CloudBalance+class+also+has+a+%40PlanningScore+annotated+property+score%2C+which+is+the+Score%0Aof+that+solution+in+its+current+state.+Planner+automatically+updates+it+when+it+calculates+a%0AScore+for+a+solution+instance+and+therefore+it+needs+a+setter.%0A3.+Especially+for+score+calculation+with+Drools%2C+the+property+computerList+needs+to+be+annotated%0Awith+a+%40ProblemFactCollectionProperty+so+the+computers+are+known+to+it.%0AExample+3.+CloudBalance.java%0A%40PlanningSolution%0Apublic+class+CloudBalance+...+%7B%0A%C2%A0+++private+List%3CCloudComputer%3E+computerList%3B%0A%C2%A0+++private+List%3CCloudProcess%3E+processList%3B%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22computerRange%22%29%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CCloudComputer%3E+getComputerList%28%29+%7B%0A%C2%A0+++++++return+computerList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40PlanningEntityCollectionProperty%0A%C2%A0+++public+List%3CCloudProcess%3E+getProcessList%28%29+%7B%0A%C2%A0+++++++return+processList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+HardSoftScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28HardSoftScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A2.3.+Run+the+Cloud+Balancing+Hello+World%0A1.+Download+and+configure+the+examples+in+your+preferred+IDE.%0A21%0A2.+Create+a+run+configuration+with+the+following+main+class%3A%0Aorg.optaplanner.examples.cloudbalancing.app.CloudBalancingHelloWorld%0ABy+default%2C+the+Cloud+Balancing+Hello+World+is+configured+to+run+for+120+seconds.%0AIt+will+execute+the+following+code%3A%0AExample+4.+CloudBalancingHelloWorld.java%0Apublic+class+CloudBalancingHelloWorld+%7B%0A%C2%A0+++public+static+void+main%28String%5B%5D+args%29+%7B%0A%C2%A0+++++++%2F%2F+Build+the+Solver%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%3B%0A%C2%A0+++++++Solver%3CCloudBalance%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0A%C2%A0+++++++%2F%2F+Load+a+problem+with+400+computers+and+1200+processes%0A%C2%A0+++++++CloudBalance+unsolvedCloudBalance+%3D+new+CloudBalancingGenerator%28%29%0A.createCloudBalance%28400%2C+1200%29%3B%0A%C2%A0+++++++%2F%2F+Solve+the+problem%0A%C2%A0+++++++CloudBalance+solvedCloudBalance+%3D+solver.solve%28unsolvedCloudBalance%29%3B%0A%C2%A0+++++++%2F%2F+Display+the+result%0A%C2%A0+++++++System.out.println%28%22%5CnSolved+cloudBalance+with+400+computers+and+1200%0Aprocesses%3A%5Cn%22%0A%C2%A0+++++++++++++++%2B+toDisplayString%28solvedCloudBalance%29%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0AThe+code+example+does+the+following%3A%0A1.+Build+the+Solver+based+on+a+solver+configuration+%28in+this+case+an+XML+file%2C%0AcloudBalancingSolverConfig.xml%2C+from+the+classpath%29.%0ABuilding+the+Solver+is+the+most+complicated+part+of+this+procedure.+For+more+detail%2C+see+Solver%0AConfiguration.%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%3B%0A%C2%A0+++++++Solver+solver%3CCloudBalance%3E+%3D+solverFactory.buildSolver%28%29%3B%0A22%0A2.+Load+the+problem.%0ACloudBalancingGenerator+generates+a+random+problem%3A+you+will+replace+this+with+a+class+that%0Aloads+a+real+problem%2C+for+example+from+a+database.%0A%C2%A0+++++++CloudBalance+unsolvedCloudBalance+%3D+new+CloudBalancingGenerator%28%29%0A.createCloudBalance%28400%2C+1200%29%3B%0A3.+Solve+the+problem.%0A%C2%A0+++++++CloudBalance+solvedCloudBalance+%3D+solver.solve%28unsolvedCloudBalance%29%3B%0A4.+Display+the+result.%0A%C2%A0+++++++System.out.println%28%22%5CnSolved+cloudBalance+with+400+computers+and+1200%0Aprocesses%3A%5Cn%22%0A%C2%A0+++++++++++++++%2B+toDisplayString%28solvedCloudBalance%29%29%3B%0A2.4.+Solver+Configuration%0ATake+a+look+at+the+solver+configuration%3A%0AExample+5.+cloudBalancingSolverConfig.xml%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Domain+model+configuration+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+%3C%21--+Score+configuration+--%3E%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.C%0AloudBalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%21--%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.%0Adrl%3C%2FscoreDrl%3E--%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A%C2%A0+%3C%21--+Optimization+algorithms+configuration+--%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E30%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%3C%2Fsolver%3E%0A23%0AThis+solver+configuration+consists+of+three+parts%3A%0A1.+Domain+model+configuration%3A+What+can+Planner+change%3F%0AWe+need+to+make+Planner+aware+of+our+domain+classes.+In+this+configuration%2C+it+will%0Aautomatically+scan+all+classes+in+your+classpath+%28for+a+%40PlanningEntity+or+%40PlanningSolution%0Aannotation%29%3A%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A2.+Score+configuration%3A+How+should+Planner+optimize+the+planning+variables%3F+What+is+our+goal%3F%0ASince+we+have+hard+and+soft+constraints%2C+we+use+a+HardSoftScore.+But+we+need+to+tell+Planner%0Ahow+to+calculate+the+score%2C+depending+on+our+business+requirements.+Further+down%2C+we+will%0Alook+into+two+alternatives+to+calculate+the+score%3A+using+an+easy+Java+implementation%2C+or+using%0ADrools+DRL.%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.Cl%0AoudBalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%21--%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.d%0Arl%3C%2FscoreDrl%3E--%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A3.+Optimization+algorithms+configuration%3A+How+should+Planner+optimize+it%3F%0AIn+this+case%2C+we+use+the+default+optimization+algorithms+%28because+no+explicit+optimization%0Aalgorithms+are+configured%29+for+30+seconds%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E30%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0APlanner+should+get+a+good+result+in+seconds+%28and+even+in+less+than+15+milliseconds+with+real-%0Atime+planning%29%2C+but+the+more+time+it+has%2C+the+better+the+result+will+be.+Advanced+use+cases+might%0Ause+a+different+termination+criteria+than+a+hard+time+limit.%0AThe+default+algorithms+will+already+easily+surpass+human+planners+and+most+in-house%0Aimplementations.+Use+the+Benchmarker+to+power+tweak+to+get+even+better+results.%0A2.5.+Score+Configuration%0APlanner+will+search+for+the+Solution+with+the+highest+Score.+This+example+uses+a+HardSoftScore%2C%0Awhich+means+Planner+will+look+for+the+solution+with+no+hard+constraints+broken+%28fulfill+hardware%0A24%0Arequirements%29+and+as+little+as+possible+soft+constraints+broken+%28minimize+maintenance+cost%29.%0AOf+course%2C+Planner+needs+to+be+told+about+these+domain-specific+score+constraints.+There+are+several%0Aways+to+implement+such+a+score+function%3A%0A%E2%80%A2+Easy+Java%0A%E2%80%A2+Incremental+Java%0A%E2%80%A2+Drools%0A2.5.1.+Easy+Java+Score+Configuration%0AOne+way+to+define+a+score+function+is+to+implement+the+interface+EasyScoreCalculator+in+plain+Java.%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.Cloud%0ABalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AJust+implement+the+calculateScore%28Solution%29+method+to+return+a+HardSoftScore+instance.%0AExample+6.+CloudBalancingEasyScoreCalculator.java%0A25%0Apublic+class+CloudBalancingEasyScoreCalculator+implements+EasyScoreCalculator%0A%3CCloudBalance%3E+%7B%0A%C2%A0+++%2F**%0A%C2%A0++++*+A+very+simple+implementation.+The+double+loop+can+easily+be+removed+by%0Ausing+Maps+as+shown+in%0A%C2%A0++++*+%7B%40link%0ACloudBalancingMapBasedEasyScoreCalculator%23calculateScore%28CloudBalance%29%7D.%0A%C2%A0++++*%2F%0A%C2%A0+++public+HardSoftScore+calculateScore%28CloudBalance+cloudBalance%29+%7B%0A%C2%A0+++++++int+hardScore+%3D+0%3B%0A%C2%A0+++++++int+softScore+%3D+0%3B%0A%C2%A0+++++++for+%28CloudComputer+computer+%3A+cloudBalance.getComputerList%28%29%29+%7B%0A%C2%A0+++++++++++int+cpuPowerUsage+%3D+0%3B%0A%C2%A0+++++++++++int+memoryUsage+%3D+0%3B%0A%C2%A0+++++++++++int+networkBandwidthUsage+%3D+0%3B%0A%C2%A0+++++++++++boolean+used+%3D+false%3B%0A%C2%A0+++++++++++%2F%2F+Calculate+usage%0A%C2%A0+++++++++++for+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++++++if+%28computer.equals%28process.getComputer%28%29%29%29+%7B%0A%C2%A0+++++++++++++++++++cpuPowerUsage+%2B%3D+process.getRequiredCpuPower%28%29%3B%0A%C2%A0+++++++++++++++++++memoryUsage+%2B%3D+process.getRequiredMemory%28%29%3B%0A%C2%A0+++++++++++++++++++networkBandwidthUsage+%2B%3D+process.getRequiredNetworkBandwidth%28%0A%29%3B%0A%C2%A0+++++++++++++++++++used+%3D+true%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+Hard+constraints%0A%C2%A0+++++++++++int+cpuPowerAvailable+%3D+computer.getCpuPower%28%29+-+cpuPowerUsage%3B%0A%C2%A0+++++++++++if+%28cpuPowerAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+cpuPowerAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++int+memoryAvailable+%3D+computer.getMemory%28%29+-+memoryUsage%3B%0A%C2%A0+++++++++++if+%28memoryAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+memoryAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++int+networkBandwidthAvailable+%3D+computer.getNetworkBandwidth%28%29+-%0AnetworkBandwidthUsage%3B%0A%C2%A0+++++++++++if+%28networkBandwidthAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+networkBandwidthAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+Soft+constraints%0A%C2%A0+++++++++++if+%28used%29+%7B%0A%C2%A0+++++++++++++++softScore+-%3D+computer.getCost%28%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+HardSoftScore.valueOf%28hardScore%2C+softScore%29%3B%0A%C2%A0+++%7D%0A26%0A%7D%0AEven+if+we+optimize+the+code+above+to+use+Maps+to+iterate+through+the+processList+only+once%2C+it+is+still%0Aslow+because+it+does+not+do+incremental+score+calculation.+To+fix+that%2C+either+use+incremental+Java%0Ascore+calculation+or+Drools+score+calculation.%0A2.5.2.+Drools+Score+Configuration%0ADrools+score+calculation+uses+incremental+calculation%2C+where+every+score+constraint+is+written+as%0Aone+or+more+score+rules.%0AUsing+the+Drools+rule+engine+for+score+calculation%2C+allows+you+to+integrate+with+other+Drools%0Atechnologies%2C+such+as+decision+tables+%28XLS+or+web+based%29%2C+the+KIE+Workbench%2C+%E2%80%A6%0APrerequisite+To+use+the+Drools+rule+engine+as+a+score+function%2C+simply+add+a+scoreDrl+resource+in%0Athe+classpath%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.drl%3C%0A%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A1.+We+want+to+make+sure+that+all+computers+have+enough+CPU%2C+RAM+and+network+bandwidth+to%0Asupport+all+their+processes%2C+so+we+make+these+hard+constraints%3A%0A27%0AExample+7.+cloudBalancingScoreRules.drl+-+Hard+Constraints%0A...%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudBalance%3B%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudComputer%3B%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudProcess%3B%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%2F%2F+Hard+constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0Arule+%22requiredCpuPowerTotal%22%0A%C2%A0+++when%0A%C2%A0+++++++%24computer+%3A+CloudComputer%28%24cpuPower+%3A+cpuPower%29%0A%C2%A0+++++++accumulate%28%0A%C2%A0+++++++++++CloudProcess%28%0A%C2%A0+++++++++++++++computer+%3D%3D+%24computer%2C%0A%C2%A0+++++++++++++++%24requiredCpuPower+%3A+requiredCpuPower%29%3B%0A%C2%A0+++++++++++%24requiredCpuPowerTotal+%3A+sum%28%24requiredCpuPower%29%3B%0A%C2%A0+++++++++++%24requiredCpuPowerTotal+%3E+%24cpuPower%0A%C2%A0+++++++%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addHardConstraintMatch%28kcontext%2C+%24cpuPower+-%0A%24requiredCpuPowerTotal%29%3B%0Aend%0Arule+%22requiredMemoryTotal%22%0A%C2%A0+++...%0Aend%0Arule+%22requiredNetworkBandwidthTotal%22%0A%C2%A0+++...%0Aend%0A2.+If+those+constraints+are+met%2C+we+want+to+minimize+the+maintenance+cost%2C+so+we+add+that+as+a+soft%0Aconstraint%3A%0A28%0AExample+8.+cloudBalancingScoreRules.drl+-+Soft+Constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%2F%2F+Soft+constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0Arule+%22computerCost%22%0A%C2%A0+++when%0A%C2%A0+++++++%24computer+%3A+CloudComputer%28%24cost+%3A+cost%29%0A%C2%A0+++++++exists+CloudProcess%28computer+%3D%3D+%24computer%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-+%24cost%29%3B%0Aend%0A2.6.+Beyond+this+Tutorial%0ANow+that+this+simple+example+works%2C+try+going+further.+Enrich+the+domain+model+and+add+extra%0Aconstraints+such+as+these%3A%0A%E2%80%A2+Each+Process+belongs+to+a+Service.+A+computer+might+crash%2C+so+processes+running+the+same%0Aservice+should+be+assigned+to+different+computers.%0A%E2%80%A2+Each+Computer+is+located+in+a+Building.+A+building+might+burn+down%2C+so+processes+of+the+same%0Aservices+should+be+assigned+to+computers+in+different+buildings.%0A29%0AChapter+3.+Use+Cases+and+Examples%0A3.1.+Examples+Overview%0APlanner+has+several+examples.+In+this+manual+we+explain+mainly+using+the+n+queens+example+and%0Acloud+balancing+example.+So+it+is+advisable+to+read+at+least+those+sections.%0AThe+Competition%3F+column+in+the+following+table+identifies+an+example+as+being+either+realistic+or%0Aunrealistic.+A+realistic+competition+is+an+official%2C+independent+competition%3A%0A%E2%80%A2+that+clearly+defines+a+real-word+use+case.%0A%E2%80%A2+with+real-world+constraints.%0A%E2%80%A2+with+multiple%2C+real-world+datasets.%0A%E2%80%A2+that+expects+reproducible+results+within+a+specific+time+limit+on+specific+hardware.%0A%E2%80%A2+that+has+had+serious+participation+from+the+academic+and%2For+enterprise+Operations+Research%0Acommunity.%0AThese+realistic+competitions+provide+an+objective+comparison+of+Planner+with+competitive+software%0Aand+academic+research.%0AThe+source+code+of+all+these+examples+is+available+in+the+distribution+zip+under+examples%2Fsources%0Aand+also+in+git+under+optaplanner%2Foptaplanner-examples.%0ATable+2.+Examples+Overview%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0AN+queens+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+256+%E2%80%A2+Pointless+None%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%28cheatable%29256%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E616%0ACloud+balancing+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2400+%E2%80%A2+No+%E2%80%A2+Real-time%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+planning800%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E6967%0ATraveling+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+980+%E2%80%A2+Unrealistic+%E2%80%A2+Real-time%0Asalesman%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+980+%E2%80%A2+TSP+web+planning%0Avariable+%E2%80%A2+Search+space%0A%E2%87%90+10%5E2504%0A30%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0ADinner+party+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+144+%E2%80%A2+Unrealistic+%E2%80%A2+Decision+Table%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+spreadsheet72%0A%28XLS%29+for+score%0A%E2%80%A2+Search+space+constraints%0A%E2%87%90+10%5E310%0ATennis+club+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+72+%E2%80%A2+No+%E2%80%A2+Fairness+score%0Ascheduling%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+constraints7%0A%E2%80%A2+Search+space+%E2%80%A2+Immovable%0A%E2%87%90+entities10%5E60%0AMeeting+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+10+%E2%80%A2+No+%E2%80%A2+TimeGrain%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+pattern320%0Aand+%E2%87%90+5%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E320%0ACourse+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+434+%E2%80%A2+Realistic+%E2%80%A2+Immovable%0Atimetabling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+ITC+2007+track+entities25%0Aand+%E2%87%90+20+3%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E1171%0AMachine+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+50000+%E2%80%A2+Nearly+%E2%80%A2+Real-time%0Areassignment%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+realistic+planning5000%0A%E2%80%A2+Search+space+%E2%80%A2+ROADEF+2012%0A%E2%87%90+10%5E184948%0AVehicle+routing+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2740+%E2%80%A2+Unrealistic+%E2%80%A2+Shadow%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+2795+%E2%80%A2+VRP+web+variable%0Avariable+%E2%80%A2+Search+space+%E2%80%A2+Real-time%0A%E2%80%A2+1+shadow+%E2%87%90+planning10%5E8380%0Aentity+class+%E2%80%A2+Nearby%0A%E2%97%A6+1+selection%0Aautomatic+%E2%80%A2+Real+road%0Ashadow+distances%0Avariable%0A31%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0AVehicle+routing+%E2%80%A2+All+of+Vehicle+%E2%80%A2+Entity+%E2%87%90+2740+%E2%80%A2+Unrealistic+%E2%80%A2+All+of+Vehicle%0Awith+time+routing%0Awindows+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+VRP+web%0Arouting%0A2795%0A%E2%80%A2+1+shadow+%E2%80%A2+Search+space+%E2%80%A2+Custom%0Avariable+%E2%87%90+VariableListen10%5E8380%0Aer%0AProject+job+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+640+%E2%80%A2+Nearly+%E2%80%A2+Bendable%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%3F+and+realistic+score%0A%E2%97%A6+1+shadow+%E2%87%90+%3F+%E2%80%A2+MISTA+2013+%E2%80%A2+Custom%0Avariable+%E2%80%A2+Search+space+VariableListen%0A%E2%87%90+er%3F%0A%E2%80%A2+ValueRangeFa%0Actory%0AHospital+bed+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2750+%E2%80%A2+Unrealistic+%E2%80%A2+Overconstrain%0Aplanning%0A%E2%97%A6+1+nullable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Kaho+PAS+ed+planning471%0Avariable+%E2%80%A2+Search+space%0A%E2%87%90+10%5E6851%0ATask+assigning+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+500+%E2%80%A2+No+%E2%80%A2+Bendable%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+score520%0Avariable+%E2%80%A2+Search+space+%E2%80%A2+Chained%0A%E2%97%A6+1+shadow+%E2%87%90+through+time10%5E1168%0Avariable+pattern%0A%E2%80%A2+1+shadow+%E2%80%A2+Custom%0Aentity+class+VariableListen%0Aer%0A%E2%97%A6+1%0Aautomatic+%E2%80%A2+Continuous%0Ashadow+planning%0Avariable+%E2%80%A2+Real-time%0Aplanning%0AExam+timetabling+%E2%80%A2+2+entity+classes+%E2%80%A2+Entity+%E2%87%90+1096+%E2%80%A2+Realistic+%E2%80%A2+Custom%0A%28same+%E2%80%A2+Value+%E2%87%90+80+%E2%80%A2+ITC+2007+track+VariableListen%0Ahierarchy%29+and+%E2%87%90+1+er49%0A%E2%97%A6+2+variables+%E2%80%A2+Search+space%0A%E2%87%90+10%5E3374%0A32%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0ANurse+rostering+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+752+%E2%80%A2+Realistic+%E2%80%A2+Continuous%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+INRC+2010+planning50%0A%E2%80%A2+Search+space+%E2%80%A2+Real-time%0A%E2%87%90+planning10%5E1277%0ATraveling+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+1560+%E2%80%A2+Unrealistic+%E2%80%A2+Custom%0Atournament%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+TTP+MoveListFacto78%0Ary%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E2301%0ACheap+time+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+500+%E2%80%A2+Nearly+%E2%80%A2+Field%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+realistic+annotations100%0Aand+%E2%87%90+288+%E2%80%A2+ICON+Energy+%E2%80%A2+ValueRangeFa%0A%E2%80%A2+Search+space+ctory%0A%E2%87%90+10%5E20078%0AInvestment+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+11+%E2%80%A2+No+%E2%80%A2+ValueRangeFa%0A%E2%80%A2+1+variable+%E2%80%A2+Value+%3D+ctory1000+%E2%80%A2+Defined+by+us%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E4%0AConference+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+216+%E2%80%A2+No%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+18+%E2%80%A2+Defined+by+us%0Aand+%E2%87%90+20%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E552%0ARock+Tour+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+47+%E2%80%A2+No%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+48+%E2%80%A2+Defined+by+us%0Avariable+%E2%80%A2+Search+space%0A%E2%97%A6+4+shadow+%E2%87%90+10%5E59%0Avariables%0A%E2%80%A2+1+shadow%0Aentity+class%0A%E2%97%A6+1%0Aautomatic%0Ashadow%0Avariable%0A33%0A3.2.+N+Queens%0A3.2.1.+Problem+Description%0APlace+n+queens+on+a+n+sized+chessboard+so+that+no+two+queens+can+attack+each+other.+The+most%0Acommon+n+queens+puzzle+is+the+eight+queens+puzzle%2C+with+n+%3D+8%3A%0AConstraints%3A%0A%E2%80%A2+Use+a+chessboard+of+n+columns+and+n+rows.%0A%E2%80%A2+Place+n+queens+on+the+chessboard.%0A%E2%80%A2+No+two+queens+can+attack+each+other.+A+queen+can+attack+any+other+queen+on+the+same%0Ahorizontal%2C+vertical+or+diagonal+line.%0AThis+documentation+heavily+uses+the+four+queens+puzzle+as+the+primary+example.%0AA+proposed+solution+could+be%3A%0A34%0AFigure+1.+A+Wrong+Solution+for+the+Four+Queens+Puzzle%0AThe+above+solution+is+wrong+because+queens+A1+and+B0+can+attack+each+other+%28so+can+queens+B0+and%0AD0%29.+Removing+queen+B0+would+respect+the+%22no+two+queens+can+attack+each+other%22+constraint%2C+but%0Awould+break+the+%22place+n+queens%22+constraint.%0ABelow+is+a+correct+solution%3A%0AFigure+2.+A+Correct+Solution+for+the+Four+Queens+Puzzle%0AAll+the+constraints+have+been+met%2C+so+the+solution+is+correct.%0ANote+that+most+n+queens+puzzles+have+multiple+correct+solutions.+We+will+focus+on+finding+a+single%0Acorrect+solution+for+a+given+n%2C+not+on+finding+the+number+of+possible+correct+solutions+for+a+given+n.%0A3.2.2.+Problem+Size%0A4queens+++has+++4+queens+with+a+search+space+of++++256.%0A8queens+++has+++8+queens+with+a+search+space+of+++10%5E7.%0A16queens++has++16+queens+with+a+search+space+of++10%5E19.%0A32queens++has++32+queens+with+a+search+space+of++10%5E48.%0A64queens++has++64+queens+with+a+search+space+of+10%5E115.%0A256queens+has+256+queens+with+a+search+space+of+10%5E616.%0AThe+implementation+of+the+n+queens+example+has+not+been+optimized+because+it+functions+as+a%0Abeginner+example.+Nevertheless%2C+it+can+easily+handle+64+queens.+With+a+few+changes+it+has+been%0Ashown+to+easily+handle+5000+queens+and+more.%0A3.2.3.+Domain+Model%0AThis+example+uses+the+domain+model+to+solve+the+four+queens+problem.%0A1.+Creating+a+Domain+Model+A+good+domain+model+will+make+it+easier+to+understand+and+solve%0A35%0Ayour+planning+problem.%0AThis+is+the+domain+model+for+the+n+queens+example%3A%0Apublic+class+Column+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0Apublic+class+Row+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0Apublic+class+Queen+%7B%0A%C2%A0+++private+Column+column%3B%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++public+int+getAscendingDiagonalIndex%28%29+%7B...%7D%0A%C2%A0+++public+int+getDescendingDiagonalIndex%28%29+%7B...%7D%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0A2.+Calculating+the+Search+Space.%0AA+Queen+instance+has+a+Column+%28for+example%3A+0+is+column+A%2C+1+is+column+B%2C+%E2%80%A6%29+and+a+Row+%28its+row%2C%0Afor+example%3A+0+is+row+0%2C+1+is+row+1%2C+%E2%80%A6%29.%0AThe+ascending+diagonal+line+and+the+descending+diagonal+line+can+be+calculated+based+on+the%0Acolumn+and+the+row.%0AThe+column+and+row+indexes+start+from+the+upper+left+corner+of+the+chessboard.%0A36%0Apublic+class+NQueens+%7B%0A%C2%A0+++private+int+n%3B%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0A3.+Finding+the+Solution%0AA+single+NQueens+instance+contains+a+list+of+all+Queen+instances.+It+is+the+Solution+implementation%0Awhich+will+be+supplied+to%2C+solved+by%2C+and+retrieved+from+the+Solver.%0ANotice+that+in+the+four+queens+example%2C+NQueens%E2%80%99s+getN%28%29+method+will+always+return+four.%0ATable+3.+A+Solution+for+Four+Queens+Shown+in+the+Domain+Model%0AA+solution+Queen+column+rowInd+ascend+descen%0AIndex+ex+ingDia+dingDi%0AgonalI+agonalI%0Andex+ndex%0A%28colum+%28colum%0AnIndex+nIndex%0A%2B+-%0ArowInd+rowInd%0Aex%29+ex%29%0AA1+0+1+1+%28**%29+-1%0AB0+1+0+%28*%29+1+%28**%29+1%0AC2+2+2+4+0%0AD0+3+0+%28*%29+3+3%0AWhen+two+queens+share+the+same+column%2C+row+or+diagonal+line%2C+such+as+%28*%29+and+%28**%29%2C+they+can+attack%0Aeach+other.%0A3.3.+Cloud+Balancing%0AThis+example+is+explained+in+a+tutorial.%0A37%0A3.4.+Traveling+Salesman+%28TSP+-+Traveling+Salesman%0AProblem%29%0A3.4.1.+Problem+Description%0AGiven+a+list+of+cities%2C+find+the+shortest+tour+for+a+salesman+that+visits+each+city+exactly+once.%0AThe+problem+is+defined+by+Wikipedia.+It+is+one+of+the+most+intensively+studied+problems+in%0Acomputational+mathematics.+Yet%2C+in+the+real+world%2C+it+is+often+only+part+of+a+planning+problem%2C+along%0Awith+other+constraints%2C+such+as+employee+shift+rostering+constraints.%0A3.4.2.+Problem+Size%0Adj38+++++has++38+cities+with+a+search+space+of+++10%5E43.%0Aeurope40+has++40+cities+with+a+search+space+of+++10%5E46.%0Ast70+++++has++70+cities+with+a+search+space+of+++10%5E98.%0Apcb442+++has+442+cities+with+a+search+space+of++10%5E976.%0Alu980++++has+980+cities+with+a+search+space+of+10%5E2504.%0A3.4.3.+Problem+Difficulty%0ADespite+TSP%E2%80%99s+simple+definition%2C+the+problem+is+surprisingly+hard+to+solve.+Because+it+is+an+NP-hard%0Aproblem+%28like+most+planning+problems%29%2C+the+optimal+solution+for+a+specific+problem+dataset+can%0Achange+a+lot+when+that+problem+dataset+is+slightly+altered%3A%0A38%0A3.5.+Dinner+Party%0A3.5.1.+Problem+Description%0AMiss+Manners+is+throwing+another+dinner+party.%0A%E2%80%A2+This+time+she+invited+144+guests+and+prepared+12+round+tables+with+12+seats+each.%0A%E2%80%A2+Every+guest+should+sit+next+to+someone+%28left+and+right%29+of+the+opposite+gender.%0A%E2%80%A2+And+that+neighbour+should+have+at+least+one+hobby+in+common+with+the+guest.%0A%E2%80%A2+At+every+table%2C+there+should+be+two+politicians%2C+two+doctors%2C+two+socialites%2C+two+coaches%2C+two%0Ateachers+and+two+programmers.%0A%E2%80%A2+And+the+two+politicians%2C+two+doctors%2C+two+coaches+and+two+programmers+should+not+be+the+same%0Akind+at+a+table.%0ADrools+Expert+also+has+the+normal+Miss+Manners+example+%28which+is+much+smaller%29+and+employs+an%0Aexhaustive+heuristic+to+solve+it.+Planner%E2%80%99s+implementation+is+far+more+scalable+because+it+uses%0Aheuristics+to+find+the+best+solution+and+Drools+Expert+to+calculate+the+score+of+each+solution.%0A3.5.2.+Problem+Size%0A39%0Awedding01+has+18+jobs%2C+144+guests%2C+288+hobby+practicians%2C+12+tables+and+144+seats+with%0Aa+search+space+of+10%5E310.%0A3.6.+Tennis+Club+Scheduling%0A3.6.1.+Problem+Description%0AEvery+week+the+tennis+club+has+four+teams+playing+round+robin+against+each+other.+Assign+those%0Afour+spots+to+the+teams+fairly.%0AHard+constraints%3A%0A%E2%80%A2+Conflict%3A+A+team+can+only+play+once+per+day.%0A%E2%80%A2+Unavailability%3A+Some+teams+are+unavailable+on+some+dates.%0AMedium+constraints%3A%0A%E2%80%A2+Fair+assignment%3A+All+teams+should+play+an+%28almost%29+equal+number+of+times.%0ASoft+constraints%3A%0A%E2%80%A2+Evenly+confrontation%3A+Each+team+should+play+against+every+other+team+an+equal+number+of%0Atimes.%0A3.6.2.+Problem+Size%0Amunich-7teams+has+7+teams%2C+18+days%2C+12+unavailabilityPenalties+and+72+teamAssignments%0Awith+a+search+space+of+10%5E60.%0A3.6.3.+Domain+Model%0A40%0A3.7.+Meeting+Scheduling%0A3.7.1.+Problem+Description%0AAssign+each+meeting+to+a+starting+time+and+a+room.+Meetings+have+different+durations.%0AHard+constraints%3A%0A%E2%80%A2+Room+conflict%3A+two+meetings+must+not+use+the+same+room+at+the+same+time.%0A%E2%80%A2+Required+attendance%3A+A+person+cannot+have+two+required+meetings+at+the+same+time.%0A%E2%80%A2+Required+room+capacity%3A+A+meeting+must+not+be+in+a+room+that+doesn%E2%80%99t+fit+all+of+the+meeting%E2%80%99s%0Aattendees.%0A%E2%80%A2+Start+and+end+on+same+day%3A+A+meeting+shouldn%E2%80%99t+be+scheduled+over+multiple+days.%0AMedium+constraints%3A%0A%E2%80%A2+Preferred+attendance%3A+A+person+cannot+have+two+preferred+meetings+at+the+same+time%2C+nor+a%0Apreferred+and+a+required+meeting+at+the+same+time.%0ASoft+constraints%3A%0A%E2%80%A2+Sooner+rather+than+later%3A+Schedule+all+meetings+as+soon+as+possible.%0A41%0A%E2%80%A2+A+break+between+meetings%3A+Any+two+meetings+should+have+at+least+one+time+grain+break%0Abetween+them.%0A%E2%80%A2+Overlapping+meetings%3A+To+minimize+the+number+of+meetings+in+parallel+so+people+don%E2%80%99t+have+to%0Achoose+one+meeting+over+the+other.%0A%E2%80%A2+Assign+larger+rooms+first%3A+If+a+larger+room+is+available+any+meeting+should+be+assigned+to+that%0Aroom+in+order+to+accommodate+as+many+people+as+possible+even+if+they+haven%E2%80%99t+signed+up+to+that%0Ameeting.%0A%E2%80%A2+Room+stability%3A+If+a+person+has+two+consecutive+meetings+with+two+or+less+time+grains+break%0Abetween+them+they+better+be+in+the+same+room.%0A3.7.2.+Problem+Size%0A50meetings-160timegrains-5rooms++has++50+meetings%2C+160+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E145.%0A100meetings-320timegrains-5rooms+has+100+meetings%2C+320+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E320.%0A200meetings-640timegrains-5rooms+has+200+meetings%2C+640+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E701.%0A400meetings-1280timegrains-5rooms+has+400+meetings%2C+1280+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E1522.%0A800meetings-2560timegrains-5rooms+has+800+meetings%2C+2560+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E3285.%0A3.8.+Course+Timetabling+%28ITC+2007+Track+3+-+Curriculum%0ACourse+Scheduling%29%0A3.8.1.+Problem+Description%0ASchedule+each+lecture+into+a+timeslot+and+into+a+room.%0AHard+constraints%3A%0A%E2%80%A2+Teacher+conflict%3A+A+teacher+must+not+have+two+lectures+in+the+same+period.%0A%E2%80%A2+Curriculum+conflict%3A+A+curriculum+must+not+have+two+lectures+in+the+same+period.%0A%E2%80%A2+Room+occupancy%3A+two+lectures+must+not+be+in+the+same+room+in+the+same+period.%0A%E2%80%A2+Unavailable+period+%28specified+per+dataset%29%3A+A+specific+lecture+must+not+be+assigned+to+a+specific%0Aperiod.%0ASoft+constraints%3A%0A%E2%80%A2+Room+capacity%3A+A+room%E2%80%99s+capacity+should+not+be+less+than+the+number+of+students+in+its+lecture.%0A%E2%80%A2+Minimum+working+days%3A+Lectures+of+the+same+course+should+be+spread+out+into+a+minimum%0Anumber+of+days.%0A%E2%80%A2+Curriculum+compactness%3A+Lectures+belonging+to+the+same+curriculum+should+be+adjacent+to+each%0A42%0Aother+%28so+in+consecutive+periods%29.%0A%E2%80%A2+Room+stability%3A+Lectures+of+the+same+course+should+be+assigned+to+the+same+room.%0AThe+problem+is+defined+by+the+International+Timetabling+Competition+2007+track+3.%0A3.8.2.+Problem+Size%0Acomp01+has+24+teachers%2C++14+curricula%2C++30+courses%2C+160+lectures%2C+30+periods%2C++6+rooms%0Aand+++53+unavailable+period+constraints+with+a+search+space+of++10%5E360.%0Acomp02+has+71+teachers%2C++70+curricula%2C++82+courses%2C+283+lectures%2C+25+periods%2C+16+rooms%0Aand++513+unavailable+period+constraints+with+a+search+space+of++10%5E736.%0Acomp03+has+61+teachers%2C++68+curricula%2C++72+courses%2C+251+lectures%2C+25+periods%2C+16+rooms%0Aand++382+unavailable+period+constraints+with+a+search+space+of++10%5E653.%0Acomp04+has+70+teachers%2C++57+curricula%2C++79+courses%2C+286+lectures%2C+25+periods%2C+18+rooms%0Aand++396+unavailable+period+constraints+with+a+search+space+of++10%5E758.%0Acomp05+has+47+teachers%2C+139+curricula%2C++54+courses%2C+152+lectures%2C+36+periods%2C++9+rooms%0Aand++771+unavailable+period+constraints+with+a+search+space+of++10%5E381.%0Acomp06+has+87+teachers%2C++70+curricula%2C+108+courses%2C+361+lectures%2C+25+periods%2C+18+rooms%0Aand++632+unavailable+period+constraints+with+a+search+space+of++10%5E957.%0Acomp07+has+99+teachers%2C++77+curricula%2C+131+courses%2C+434+lectures%2C+25+periods%2C+20+rooms%0Aand++667+unavailable+period+constraints+with+a+search+space+of+10%5E1171.%0Acomp08+has+76+teachers%2C++61+curricula%2C++86+courses%2C+324+lectures%2C+25+periods%2C+18+rooms%0Aand++478+unavailable+period+constraints+with+a+search+space+of++10%5E859.%0Acomp09+has+68+teachers%2C++75+curricula%2C++76+courses%2C+279+lectures%2C+25+periods%2C+18+rooms%0Aand++405+unavailable+period+constraints+with+a+search+space+of++10%5E740.%0Acomp10+has+88+teachers%2C++67+curricula%2C+115+courses%2C+370+lectures%2C+25+periods%2C+18+rooms%0Aand++694+unavailable+period+constraints+with+a+search+space+of++10%5E981.%0Acomp11+has+24+teachers%2C++13+curricula%2C++30+courses%2C+162+lectures%2C+45+periods%2C++5+rooms%0Aand+++94+unavailable+period+constraints+with+a+search+space+of++10%5E381.%0Acomp12+has+74+teachers%2C+150+curricula%2C++88+courses%2C+218+lectures%2C+36+periods%2C+11+rooms%0Aand+1368+unavailable+period+constraints+with+a+search+space+of++10%5E566.%0Acomp13+has+77+teachers%2C++66+curricula%2C++82+courses%2C+308+lectures%2C+25+periods%2C+19+rooms%0Aand++468+unavailable+period+constraints+with+a+search+space+of++10%5E824.%0Acomp14+has+68+teachers%2C++60+curricula%2C++85+courses%2C+275+lectures%2C+25+periods%2C+17+rooms%0Aand++486+unavailable+period+constraints+with+a+search+space+of++10%5E722.%0A3.8.3.+Domain+Model%0A43%0A3.9.+Machine+Reassignment+%28Google+ROADEF+2012%29%0A3.9.1.+Problem+Description%0AAssign+each+process+to+a+machine.+All+processes+already+have+an+original+%28unoptimized%29+assignment.%0AEach+process+requires+an+amount+of+each+resource+%28such+as+CPU%2C+RAM%2C+%E2%80%A6%29.+This+is+a+more+complex%0Aversion+of+the+Cloud+Balancing+example.%0AHard+constraints%3A%0A%E2%80%A2+Maximum+capacity%3A+The+maximum+capacity+for+each+resource+for+each+machine+must+not+be%0Aexceeded.%0A%E2%80%A2+Conflict%3A+Processes+of+the+same+service+must+run+on+distinct+machines.%0A%E2%80%A2+Spread%3A+Processes+of+the+same+service+must+be+spread+out+across+locations.%0A%E2%80%A2+Dependency%3A+The+processes+of+a+service+depending+on+another+service+must+run+in+the%0Aneighborhood+of+a+process+of+the+other+service.%0A%E2%80%A2+Transient+usage%3A+Some+resources+are+transient+and+count+towards+the+maximum+capacity+of%0Aboth+the+original+machine+as+the+newly+assigned+machine.%0ASoft+constraints%3A%0A%E2%80%A2+Load%3A+The+safety+capacity+for+each+resource+for+each+machine+should+not+be+exceeded.%0A44%0A%E2%80%A2+Balance%3A+Leave+room+for+future+assignments+by+balancing+the+available+resources+on+each%0Amachine.%0A%E2%80%A2+Process+move+cost%3A+A+process+has+a+move+cost.%0A%E2%80%A2+Service+move+cost%3A+A+service+has+a+move+cost.%0A%E2%80%A2+Machine+move+cost%3A+Moving+a+process+from+machine+A+to+machine+B+has+another+A-B+specific%0Amove+cost.%0AThe+problem+is+defined+by+the+Google+ROADEF%2FEURO+Challenge+2012.%0A3.9.2.+Value+Proposition%0A45%0A3.9.3.+Problem+Size%0A46%0Amodel_a1_1+has++2+resources%2C++1+neighborhoods%2C+++4+locations%2C++++4+machines%2C++++79%0Aservices%2C+++100+processes+and+1+balancePenalties+with+a+search+space+of+++++10%5E60.%0Amodel_a1_2+has++4+resources%2C++2+neighborhoods%2C+++4+locations%2C++100+machines%2C+++980%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a1_3+has++3+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++216%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a1_4+has++3+resources%2C+50+neighborhoods%2C++50+locations%2C+++50+machines%2C+++142%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_a1_5+has++4+resources%2C++2+neighborhoods%2C+++4+locations%2C+++12+machines%2C+++981%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1079.%0Amodel_a2_1+has++3+resources%2C++1+neighborhoods%2C+++1+locations%2C++100+machines%2C++1000%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_2+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++170%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_3+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++129%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_4+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C+++50+machines%2C+++180%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_a2_5+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C+++50+machines%2C+++153%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_b_1++has+12+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C++2512%0Aservices%2C++5000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E10000.%0Amodel_b_2++has+12+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C++2462%0Aservices%2C++5000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E10000.%0Amodel_b_3++has++6+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+15025%0Aservices%2C+20000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E40000.%0Amodel_b_4++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C++500+machines%2C++1732%0Aservices%2C+20000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E53979.%0Amodel_b_5++has++6+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+35082%0Aservices%2C+40000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E80000.%0Amodel_b_6++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C++200+machines%2C+14680%0Aservices%2C+40000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E92041.%0Amodel_b_7++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C+4000+machines%2C+15050%0Aservices%2C+40000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E144082.%0Amodel_b_8++has++3+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+45030%0Aservices%2C+50000+processes+and+0+balancePenalties+with+a+search+space+of+10%5E100000.%0Amodel_b_9++has++3+resources%2C++5+neighborhoods%2C+100+locations%2C+1000+machines%2C++4609%0Aservices%2C+50000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E150000.%0Amodel_b_10+has++3+resources%2C++5+neighborhoods%2C+100+locations%2C+5000+machines%2C++4896%0Aservices%2C+50000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E184948.%0A3.9.4.+Domain+Model%0A47%0A3.10.+Vehicle+Routing%0A3.10.1.+Problem+Description%0AUsing+a+fleet+of+vehicles%2C+pick+up+the+objects+of+each+customer+and+bring+them+to+the+depot.+Each%0Avehicle+can+service+multiple+customers%2C+but+it+has+a+limited+capacity.%0A48%0ABesides+the+basic+case+%28CVRP%29%2C+there+is+also+a+variant+with+time+windows+%28CVRPTW%29.%0AHard+constraints%3A%0A%E2%80%A2+Vehicle+capacity%3A+a+vehicle+cannot+carry+more+items+then+its+capacity.%0A%E2%80%A2+Time+windows+%28only+in+CVRPTW%29%3A%0A%E2%97%A6+Travel+time%3A+Traveling+from+one+location+to+another+takes+time.%0A%E2%97%A6+Customer+service+duration%3A+a+vehicle+must+stay+at+the+customer+for+the+length+of+the+service%0Aduration.%0A%E2%97%A6+Customer+ready+time%3A+a+vehicle+may+arrive+before+the+customer%E2%80%99s+ready+time%2C+but+it+must%0Await+until+the+ready+time+before+servicing.%0A%E2%97%A6+Customer+due+time%3A+a+vehicle+must+arrive+on+time%2C+before+the+customer%E2%80%99s+due+time.%0ASoft+constraints%3A%0A%E2%80%A2+Total+distance%3A+minimize+the+total+distance+driven+%28fuel+consumption%29+of+all+vehicles.%0AThe+capacitated+vehicle+routing+problem+%28CVRP%29+and+its+timewindowed+variant+%28CVRPTW%29+are%0A49%0Adefined+by+the+VRP+web.%0A3.10.2.+Value+Proposition%0A3.10.3.+Problem+Size%0ACVRP+instances+%28without+time+windows%29%3A%0Abelgium-n50-k10+++++++++++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-n100-k10++++++++++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-n500-k20++++++++++++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-n1000-k20+++++++++++has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-n2750-k55+++++++++++has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-road-km-n50-k10+++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-road-km-n100-k10++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-road-km-n500-k20++++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0A50%0Abelgium-road-km-n1000-k20+++has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-road-km-n2750-k55+++has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-road-time-n50-k10+++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-road-time-n100-k10++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-road-time-n500-k20++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-road-time-n1000-k20+has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-road-time-n2750-k55+has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-d2-n50-k10++++++++++has++2+depots%2C+10+vehicles+and+++48+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-d3-n100-k10+++++++++has++3+depots%2C+10+vehicles+and+++97+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-d5-n500-k20+++++++++has++5+depots%2C+20+vehicles+and++495+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-d8-n1000-k20++++++++has++8+depots%2C+20+vehicles+and++992+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-d10-n2750-k55+++++++has+10+depots%2C+55+vehicles+and+2740+customers+with+a%0Asearch+space+of+10%5E8380.%0AA-n32-k5++has+1+depots%2C++5+vehicles+and++31+customers+with+a+search+space+of++10%5E40.%0AA-n33-k5++has+1+depots%2C++5+vehicles+and++32+customers+with+a+search+space+of++10%5E41.%0AA-n33-k6++has+1+depots%2C++6+vehicles+and++32+customers+with+a+search+space+of++10%5E42.%0AA-n34-k5++has+1+depots%2C++5+vehicles+and++33+customers+with+a+search+space+of++10%5E43.%0AA-n36-k5++has+1+depots%2C++5+vehicles+and++35+customers+with+a+search+space+of++10%5E46.%0AA-n37-k5++has+1+depots%2C++5+vehicles+and++36+customers+with+a+search+space+of++10%5E48.%0AA-n37-k6++has+1+depots%2C++6+vehicles+and++36+customers+with+a+search+space+of++10%5E49.%0AA-n38-k5++has+1+depots%2C++5+vehicles+and++37+customers+with+a+search+space+of++10%5E49.%0AA-n39-k5++has+1+depots%2C++5+vehicles+and++38+customers+with+a+search+space+of++10%5E51.%0AA-n39-k6++has+1+depots%2C++6+vehicles+and++38+customers+with+a+search+space+of++10%5E52.%0AA-n44-k7++has+1+depots%2C++7+vehicles+and++43+customers+with+a+search+space+of++10%5E61.%0AA-n45-k6++has+1+depots%2C++6+vehicles+and++44+customers+with+a+search+space+of++10%5E62.%0AA-n45-k7++has+1+depots%2C++7+vehicles+and++44+customers+with+a+search+space+of++10%5E63.%0AA-n46-k7++has+1+depots%2C++7+vehicles+and++45+customers+with+a+search+space+of++10%5E65.%0AA-n48-k7++has+1+depots%2C++7+vehicles+and++47+customers+with+a+search+space+of++10%5E68.%0AA-n53-k7++has+1+depots%2C++7+vehicles+and++52+customers+with+a+search+space+of++10%5E77.%0AA-n54-k7++has+1+depots%2C++7+vehicles+and++53+customers+with+a+search+space+of++10%5E79.%0AA-n55-k9++has+1+depots%2C++9+vehicles+and++54+customers+with+a+search+space+of++10%5E82.%0AA-n60-k9++has+1+depots%2C++9+vehicles+and++59+customers+with+a+search+space+of++10%5E91.%0AA-n61-k9++has+1+depots%2C++9+vehicles+and++60+customers+with+a+search+space+of++10%5E93.%0AA-n62-k8++has+1+depots%2C++8+vehicles+and++61+customers+with+a+search+space+of++10%5E94.%0AA-n63-k9++has+1+depots%2C++9+vehicles+and++62+customers+with+a+search+space+of++10%5E97.%0AA-n63-k10+has+1+depots%2C+10+vehicles+and++62+customers+with+a+search+space+of++10%5E98.%0AA-n64-k9++has+1+depots%2C++9+vehicles+and++63+customers+with+a+search+space+of++10%5E99.%0AA-n65-k9++has+1+depots%2C++9+vehicles+and++64+customers+with+a+search+space+of+10%5E101.%0AA-n69-k9++has+1+depots%2C++9+vehicles+and++68+customers+with+a+search+space+of+10%5E108.%0A51%0AA-n80-k10+has+1+depots%2C+10+vehicles+and++79+customers+with+a+search+space+of+10%5E130.%0AF-n45-k4++has+1+depots%2C++4+vehicles+and++44+customers+with+a+search+space+of++10%5E60.%0AF-n72-k4++has+1+depots%2C++4+vehicles+and++71+customers+with+a+search+space+of+10%5E108.%0AF-n135-k7+has+1+depots%2C++7+vehicles+and+134+customers+with+a+search+space+of+10%5E240.%0ACVRPTW+instances+%28with+time+windows%29%3A%0Abelgium-tw-d2-n50-k10++++has++2+depots%2C+10+vehicles+and+++48+customers+with+a+search%0Aspace+of+++10%5E74.%0Abelgium-tw-d3-n100-k10+++has++3+depots%2C+10+vehicles+and+++97+customers+with+a+search%0Aspace+of++10%5E170.%0Abelgium-tw-d5-n500-k20+++has++5+depots%2C+20+vehicles+and++495+customers+with+a+search%0Aspace+of+10%5E1168.%0Abelgium-tw-d8-n1000-k20++has++8+depots%2C+20+vehicles+and++992+customers+with+a+search%0Aspace+of+10%5E2607.%0Abelgium-tw-d10-n2750-k55+has+10+depots%2C+55+vehicles+and+2740+customers+with+a+search%0Aspace+of+10%5E8380.%0Abelgium-tw-n50-k10+++++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a+search%0Aspace+of+++10%5E74.%0Abelgium-tw-n100-k10++++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a+search%0Aspace+of++10%5E170.%0Abelgium-tw-n500-k20++++++has++1+depots%2C+20+vehicles+and++499+customers+with+a+search%0Aspace+of+10%5E1168.%0Abelgium-tw-n1000-k20+++++has++1+depots%2C+20+vehicles+and++999+customers+with+a+search%0Aspace+of+10%5E2607.%0Abelgium-tw-n2750-k55+++++has++1+depots%2C+55+vehicles+and+2749+customers+with+a+search%0Aspace+of+10%5E8380.%0ASolomon_025_C101+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_C201+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_R101+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_R201+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_RC101++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_RC201++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_100_C101+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_C201+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_R101+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_R201+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_RC101++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0A52%0ASolomon_100_RC201++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0AHomberger_0200_C1_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_C2_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_R1_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_R2_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_RC1_2_1+has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_RC2_2_1+has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0400_C1_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_C2_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_R1_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_R2_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_RC1_4_1+has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_RC2_4_1+has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0600_C1_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_C2_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_R1_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_R2_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_RC1_6_1+has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_RC2_6_1+has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0800_C1_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_C2_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_R1_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_R2_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_RC1_8_1+has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_RC2_8_1+has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_1000_C110_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0A53%0Aspace+of+10%5E2840.%0AHomberger_1000_C210_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_R110_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_R210_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_RC110_1+has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_RC210_1+has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0A3.10.4.+Domain+Model%0AThe+vehicle+routing+with+timewindows+domain+model+makes+heavily+use+of+shadow+variables.+This%0Aallows+it+to+express+its+constraints+more+naturally%2C+because+properties+such+as+arrivalTime+and%0AdepartureTime%2C+are+directly+available+on+the+domain+model.%0A3.10.4.1.+Road+Distances+Instead+of+Air+Distances%0AIn+the+real+world%2C+vehicles+cannot+follow+a+straight+line+from+location+to+location%3A+they+have+to+use%0Aroads+and+highways.+From+a+business+point+of+view%2C+this+matters+a+lot%3A%0A54%0AFor+the+optimization+algorithm%2C+this+does+not+matter+much%2C+as+long+as+the+distance+between+two%0Apoints+can+be+looked+up+%28and+are+preferably+precalculated%29.+The+road+cost+does+not+even+need+to+be%0Aa+distance%2C+it+can+also+be+travel+time%2C+fuel+cost%2C+or+a+weighted+function+of+those.+There+are+several%0Atechnologies+available+to+precalculate+road+costs%2C+such+as+GraphHopper+%28embeddable%2C+offline+Java%0Aengine%29%2C+Open+MapQuest+%28web+service%29+and+Google+Maps+Client+API+%28web+service%29.%0A55%0AThere+are+also+several+technologies+to+render+it%2C+such+as+Leaflet+and+Google+Maps+for+developers%3A+the%0Aoptaplanner-webexamples-*.war+has+an+example+which+demonstrates+such+rendering%3A%0A56%0AIt+is+even+possible+to+render+the+actual+road+routes+with+GraphHopper+or+Google+Map+Directions%2C%0Abut+because+of+route+overlaps+on+highways%2C+it+can+become+harder+to+see+the+standstill+order%3A%0A57%0ATake+special+care+that+the+road+costs+between+two+points+use+the+same+optimization+criteria+as+the%0Aone+used+in+Planner.+For+example%2C+GraphHopper+etc+will+by+default+return+the+fastest+route%2C+not+the%0Ashortest+route.+Don%E2%80%99t+use+the+km+%28or+miles%29+distances+of+the+fastest+GPS+routes+to+optimize+the%0Ashortest+trip+in+Planner%3A+this+leads+to+a+suboptimal+solution+as+shown+below%3A%0A58%0AContrary+to+popular+belief%2C+most+users+do+not+want+the+shortest+route%3A+they+want+the+fastest+route%0Ainstead.+They+prefer+highways+over+normal+roads.+They+prefer+normal+roads+over+dirt+roads.+In+the%0Areal+world%2C+the+fastest+and+shortest+route+are+rarely+the+same.%0A3.11.+Project+Job+Scheduling%0A3.11.1.+Problem+Description%0ASchedule+all+jobs+in+time+and+execution+mode+to+minimize+project+delays.+Each+job+is+part+of+a%0Aproject.+A+job+can+be+executed+in+different+ways%3A+each+way+is+an+execution+mode+that+implies+a%0Adifferent+duration+but+also+different+resource+usages.+This+is+a+form+of+flexible+job+shop+scheduling.%0A59%0AHard+constraints%3A%0A%E2%80%A2+Job+precedence%3A+a+job+can+only+start+when+all+its+predecessor+jobs+are+finished.%0A%E2%80%A2+Resource+capacity%3A+do+not+use+more+resources+than+available.%0A%E2%97%A6+Resources+are+local+%28shared+between+jobs+of+the+same+project%29+or+global+%28shared+between+all%0Ajobs%29%0A%E2%97%A6+Resource+are+renewable+%28capacity+available+per+day%29+or+nonrenewable+%28capacity+available%0Afor+all+days%29%0AMedium+constraints%3A%0A%E2%80%A2+Total+project+delay%3A+minimize+the+duration+%28makespan%29+of+each+project.%0ASoft+constraints%3A%0A%E2%80%A2+Total+makespan%3A+minimize+the+duration+of+the+whole+multi-project+schedule.%0AThe+problem+is+defined+by+the+MISTA+2013+challenge.%0A3.11.2.+Problem+Size%0A60%0ASchedule+A-1++has++2+projects%2C++24+jobs%2C+++64+execution+modes%2C++7+resources+and++150%0Aresource+requirements.%0ASchedule+A-2++has++2+projects%2C++44+jobs%2C++124+execution+modes%2C++7+resources+and++420%0Aresource+requirements.%0ASchedule+A-3++has++2+projects%2C++64+jobs%2C++184+execution+modes%2C++7+resources+and++630%0Aresource+requirements.%0ASchedule+A-4++has++5+projects%2C++60+jobs%2C++160+execution+modes%2C+16+resources+and++390%0Aresource+requirements.%0ASchedule+A-5++has++5+projects%2C+110+jobs%2C++310+execution+modes%2C+16+resources+and++900%0Aresource+requirements.%0ASchedule+A-6++has++5+projects%2C+160+jobs%2C++460+execution+modes%2C+16+resources+and+1440%0Aresource+requirements.%0ASchedule+A-7++has+10+projects%2C+120+jobs%2C++320+execution+modes%2C+22+resources+and++900%0Aresource+requirements.%0ASchedule+A-8++has+10+projects%2C+220+jobs%2C++620+execution+modes%2C+22+resources+and+1860%0Aresource+requirements.%0ASchedule+A-9++has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+2880%0Aresource+requirements.%0ASchedule+A-10+has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+2970%0Aresource+requirements.%0ASchedule+B-1++has+10+projects%2C+120+jobs%2C++320+execution+modes%2C+31+resources+and++900%0Aresource+requirements.%0ASchedule+B-2++has+10+projects%2C+220+jobs%2C++620+execution+modes%2C+22+resources+and+1740%0Aresource+requirements.%0ASchedule+B-3++has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+3060%0Aresource+requirements.%0ASchedule+B-4++has+15+projects%2C+180+jobs%2C++480+execution+modes%2C+46+resources+and+1530%0Aresource+requirements.%0ASchedule+B-5++has+15+projects%2C+330+jobs%2C++930+execution+modes%2C+46+resources+and+2760%0Aresource+requirements.%0ASchedule+B-6++has+15+projects%2C+480+jobs%2C+1380+execution+modes%2C+46+resources+and+4500%0Aresource+requirements.%0ASchedule+B-7++has+20+projects%2C+240+jobs%2C++640+execution+modes%2C+61+resources+and+1710%0Aresource+requirements.%0ASchedule+B-8++has+20+projects%2C+440+jobs%2C+1240+execution+modes%2C+42+resources+and+3180%0Aresource+requirements.%0ASchedule+B-9++has+20+projects%2C+640+jobs%2C+1840+execution+modes%2C+61+resources+and+5940%0Aresource+requirements.%0ASchedule+B-10+has+20+projects%2C+460+jobs%2C+1300+execution+modes%2C+42+resources+and+4260%0Aresource+requirements.%0A3.12.+Hospital+Bed+Planning+%28PAS+-+Patient+Admission%0AScheduling%29%0A3.12.1.+Problem+Description%0AAssign+each+patient+%28that+will+come+to+the+hospital%29+into+a+bed+for+each+night+that+the+patient+will%0Astay+in+the+hospital.+Each+bed+belongs+to+a+room+and+each+room+belongs+to+a+department.+The%0A61%0Aarrival+and+departure+dates+of+the+patients+is+fixed%3A+only+a+bed+needs+to+be+assigned+for+each+night.%0AThis+problem+features+overconstrained+datasets.%0AHard+constraints%3A%0A%E2%80%A2+Two+patients+must+not+be+assigned+to+the+same+bed+in+the+same+night.+Weight%3A+-1000hard+*%0AconflictNightCount.%0A%E2%80%A2+A+room+can+have+a+gender+limitation%3A+only+females%2C+only+males%2C+the+same+gender+in+the+same%0Anight+or+no+gender+limitation+at+all.+Weight%3A+-50hard+*+nightCount.%0A%E2%80%A2+A+department+can+have+a+minimum+or+maximum+age.+Weight%3A+-100hard+*+nightCount.%0A%E2%80%A2+A+patient+can+require+a+room+with+specific+equipment%28s%29.+Weight%3A+-50hard+*+nightCount.%0AMedium+constraints%3A%0A%E2%80%A2+Assign+every+patient+to+a+bed%2C+unless+the+dataset+is+overconstrained.+Weight%3A+-1medium+*%0AnightCount.%0ASoft+constraints%3A%0A%E2%80%A2+A+patient+can+prefer+a+maximum+room+size%2C+for+example+if+he%2Fshe+wants+a+single+room.+Weight%3A%0A-8soft+*+nightCount.%0A%E2%80%A2+A+patient+is+best+assigned+to+a+department+that+specializes+in+his%2Fher+problem.+Weight%3A+-10soft+*%0A62%0AnightCount.%0A%E2%80%A2+A+patient+is+best+assigned+to+a+room+that+specializes+in+his%2Fher+problem.+Weight%3A+-20soft+*%0AnightCount.%0A%E2%97%A6+That+room+speciality+should+be+priority+1.+Weight%3A+-10soft+*+%28priority+-+1%29+*+nightCount.%0A%E2%80%A2+A+patient+can+prefer+a+room+with+specific+equipment%28s%29.+Weight%3A+-20soft+*+nightCount.%0AThe+problem+is+a+variant+on+Kaho%E2%80%99s+Patient+Scheduling+and+the+datasets+come+from+real+world%0Ahospitals.%0A3.12.2.+Problem+Size%0Atestdata01+has+4+specialisms%2C+2+equipments%2C+4+departments%2C++98+rooms%2C+286+beds%2C+14%0Anights%2C++652+patients+and++652+admissions+with+a+search+space+of+10%5E1601.%0Atestdata02+has+6+specialisms%2C+2+equipments%2C+6+departments%2C+151+rooms%2C+465+beds%2C+14%0Anights%2C++755+patients+and++755+admissions+with+a+search+space+of+10%5E2013.%0Atestdata03+has+5+specialisms%2C+2+equipments%2C+5+departments%2C+131+rooms%2C+395+beds%2C+14%0Anights%2C++708+patients+and++708+admissions+with+a+search+space+of+10%5E1838.%0Atestdata04+has+6+specialisms%2C+2+equipments%2C+6+departments%2C+155+rooms%2C+471+beds%2C+14%0Anights%2C++746+patients+and++746+admissions+with+a+search+space+of+10%5E1994.%0Atestdata05+has+4+specialisms%2C+2+equipments%2C+4+departments%2C+102+rooms%2C+325+beds%2C+14%0Anights%2C++587+patients+and++587+admissions+with+a+search+space+of+10%5E1474.%0Atestdata06+has+4+specialisms%2C+2+equipments%2C+4+departments%2C+104+rooms%2C+313+beds%2C+14%0Anights%2C++685+patients+and++685+admissions+with+a+search+space+of+10%5E1709.%0Atestdata07+has+6+specialisms%2C+4+equipments%2C+6+departments%2C+162+rooms%2C+472+beds%2C+14%0Anights%2C++519+patients+and++519+admissions+with+a+search+space+of+10%5E1387.%0Atestdata08+has+6+specialisms%2C+4+equipments%2C+6+departments%2C+148+rooms%2C+441+beds%2C+21%0Anights%2C++895+patients+and++895+admissions+with+a+search+space+of+10%5E2366.%0Atestdata09+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+105+rooms%2C+310+beds%2C+28%0Anights%2C+1400+patients+and+1400+admissions+with+a+search+space+of+10%5E3487.%0Atestdata10+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+104+rooms%2C+308+beds%2C+56%0Anights%2C+1575+patients+and+1575+admissions+with+a+search+space+of+10%5E3919.%0Atestdata11+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+107+rooms%2C+318+beds%2C+91%0Anights%2C+2514+patients+and+2514+admissions+with+a+search+space+of+10%5E6291.%0Atestdata12+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+105+rooms%2C+310+beds%2C+84%0Anights%2C+2750+patients+and+2750+admissions+with+a+search+space+of+10%5E6851.%0Atestdata13+has+5+specialisms%2C+4+equipments%2C+5+departments%2C+125+rooms%2C+368+beds%2C+28%0Anights%2C++907+patients+and+1109+admissions+with+a+search+space+of+10%5E2845.%0A3.12.3.+Domain+Model%0A63%0A3.13.+Task+assigning%0A3.13.1.+Problem+Description%0AAssign+each+task+to+a+spot+in+an+employee%E2%80%99s+queue.+Each+task+has+a+duration+which+is+affected+by+the%0Aemployee%E2%80%99s+affinity+level+with+the+task%E2%80%99s+customer.%0AHard+constraints%3A%0A%E2%80%A2+Skill%3A+Each+task+requires+one+or+more+skills.+The+employee+must+posses+all+these+skills.%0ASoft+level+0+constraints%3A%0A%E2%80%A2+Critical+tasks%3A+Complete+critical+tasks+first%2C+sooner+than+major+and+minor+tasks.%0ASoft+level+1+constraints%3A%0A%E2%80%A2+Minimize+makespan%3A+Reduce+the+time+to+complete+all+tasks.%0A%E2%97%A6+Start+with+the+longest+working+employee+first%2C+then+the+second+longest+working+employee%0Aand+so+forth%2C+to+creates+fairness+and+load+balancing.%0ASoft+level+2+constraints%3A%0A%E2%80%A2+Major+tasks%3A+Complete+major+tasks+as+soon+as+possible%2C+sooner+than+minor+tasks.%0A64%0ASoft+level+3+constraints%3A%0A%E2%80%A2+Minor+tasks%3A+Complete+minor+tasks+as+soon+as+possible.%0A3.13.2.+Value+Proposition%0A3.13.3.+Problem+Size%0A24tasks-8employees+++has++24+tasks%2C+6+skills%2C++8+employees%2C+++4+task+types+and++4%0Acustomers+with+a+search+space+of+++10%5E30.%0A50tasks-5employees+++has++50+tasks%2C+5+skills%2C++5+employees%2C++10+task+types+and+10%0Acustomers+with+a+search+space+of+++10%5E69.%0A100tasks-5employees++has+100+tasks%2C+5+skills%2C++5+employees%2C++20+task+types+and+15%0Acustomers+with+a+search+space+of++10%5E164.%0A500tasks-20employees+has+500+tasks%2C+6+skills%2C+20+employees%2C+100+task+types+and+60%0Acustomers+with+a+search+space+of+10%5E1168.%0A3.13.4.+Domain+Model%0A65%0A3.14.+Exam+Timetabling+%28ITC+2007+track+1+-%0AExamination%29%0A3.14.1.+Problem+Description%0ASchedule+each+exam+into+a+period+and+into+a+room.+Multiple+exams+can+share+the+same+room+during%0Athe+same+period.%0A66%0AHard+constraints%3A%0A%E2%80%A2+Exam+conflict%3A+two+exams+that+share+students+must+not+occur+in+the+same+period.%0A%E2%80%A2+Room+capacity%3A+A+room%E2%80%99s+seating+capacity+must+suffice+at+all+times.%0A%E2%80%A2+Period+duration%3A+A+period%E2%80%99s+duration+must+suffice+for+all+of+its+exams.%0A%E2%80%A2+Period+related+hard+constraints+%28specified+per+dataset%29%3A%0A%E2%97%A6+Coincidence%3A+two+specified+exams+must+use+the+same+period+%28but+possibly+another+room%29.%0A%E2%97%A6+Exclusion%3A+two+specified+exams+must+not+use+the+same+period.%0A%E2%97%A6+After%3A+A+specified+exam+must+occur+in+a+period+after+another+specified+exam%E2%80%99s+period.%0A%E2%80%A2+Room+related+hard+constraints+%28specified+per+dataset%29%3A%0A%E2%97%A6+Exclusive%3A+one+specified+exam+should+not+have+to+share+its+room+with+any+other+exam.%0ASoft+constraints+%28each+of+which+has+a+parametrized+penalty%29%3A%0A%E2%80%A2+The+same+student+should+not+have+two+exams+in+a+row.%0A%E2%80%A2+The+same+student+should+not+have+two+exams+on+the+same+day.%0A%E2%80%A2+Period+spread%3A+two+exams+that+share+students+should+be+a+number+of+periods+apart.%0A%E2%80%A2+Mixed+durations%3A+two+exams+that+share+a+room+should+not+have+different+durations.%0A%E2%80%A2+Front+load%3A+Large+exams+should+be+scheduled+earlier+in+the+schedule.%0A67%0A%E2%80%A2+Period+penalty+%28specified+per+dataset%29%3A+Some+periods+have+a+penalty+when+used.%0A%E2%80%A2+Room+penalty+%28specified+per+dataset%29%3A+Some+rooms+have+a+penalty+when+used.%0AIt+uses+large+test+data+sets+of+real-life+universities.%0AThe+problem+is+defined+by+the+International+Timetabling+Competition+2007+track+1.+Geoffrey+De%0ASmet+finished+4th+in+that+competition+with+a+very+early+version+of+Planner.+Many+improvements%0Ahave+been+made+since+then.%0A3.14.2.+Problem+Size%0Aexam_comp_set1+has++7883+students%2C++607+exams%2C+54+periods%2C++7+rooms%2C++12+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E1564.%0Aexam_comp_set2+has+12484+students%2C++870+exams%2C+40+periods%2C+49+rooms%2C++12+period%0Aconstraints+and++2+room+constraints+with+a+search+space+of+10%5E2864.%0Aexam_comp_set3+has+16365+students%2C++934+exams%2C+36+periods%2C+48+rooms%2C+168+period%0Aconstraints+and+15+room+constraints+with+a+search+space+of+10%5E3023.%0Aexam_comp_set4+has++4421+students%2C++273+exams%2C+21+periods%2C++1+rooms%2C++40+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of++10%5E360.%0Aexam_comp_set5+has++8719+students%2C+1018+exams%2C+42+periods%2C++3+rooms%2C++27+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E2138.%0Aexam_comp_set6+has++7909+students%2C++242+exams%2C+16+periods%2C++8+rooms%2C++22+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of++10%5E509.%0Aexam_comp_set7+has+13795+students%2C+1096+exams%2C+80+periods%2C+15+rooms%2C++28+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E3374.%0Aexam_comp_set8+has++7718+students%2C++598+exams%2C+80+periods%2C++8+rooms%2C++20+period%0Aconstraints+and++1+room+constraints+with+a+search+space+of+10%5E1678.%0A3.14.3.+Domain+Model%0ABelow+you+can+see+the+main+examination+domain+classes%3A%0A68%0AFigure+3.+Examination+Domain+Class+Diagram%0ANotice+that+we%E2%80%99ve+split+up+the+exam+concept+into+an+Exam+class+and+a+Topic+class.+The+Exam+instances%0Achange+during+solving+%28this+is+the+planning+entity+class%29%2C+when+their+period+or+room+property%0Achanges.+The+Topic%2C+Period+and+Room+instances+never+change+during+solving+%28these+are+problem+facts%2C%0Ajust+like+some+other+classes%29.%0A3.15.+Nurse+Rostering+%28INRC+2010%29%0A3.15.1.+Problem+Description%0AFor+each+shift%2C+assign+a+nurse+to+work+that+shift.%0A69%0AHard+constraints%3A%0A%E2%80%A2+No+unassigned+shifts+%28built-in%29%3A+Every+shift+need+to+be+assigned+to+an+employee.%0A%E2%80%A2+Shift+conflict%3A+An+employee+can+have+only+one+shift+per+day.%0ASoft+constraints%3A%0A%E2%80%A2+Contract+obligations.+The+business+frequently+violates+these%2C+so+they+decided+to+define+these+as%0Asoft+constraints+instead+of+hard+constraints.%0A%E2%97%A6+Minimum+and+maximum+assignments%3A+Each+employee+needs+to+work+more+than+x+shifts%0Aand+less+than+y+shifts+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+working+days%3A+Each+employee+needs+to+work%0Abetween+x+and+y+days+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+free+days%3A+Each+employee+needs+to+be+free+between%0Ax+and+y+days+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+working+weekends%3A+Each+employee+needs+to+work%0Abetween+x+and+y+weekends+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Complete+weekends%3A+Each+employee+needs+to+work+every+day+in+a+weekend+or+not+at+all.%0A%E2%97%A6+Identical+shift+types+during+weekend%3A+Each+weekend+shift+for+the+same+weekend+of+the%0Asame+employee+must+be+the+same+shift+type.%0A%E2%97%A6+Unwanted+patterns%3A+A+combination+of+unwanted+shift+types+in+a+row.+For+example%3A+a+late%0A70%0Ashift+followed+by+an+early+shift+followed+by+a+late+shift.%0A%E2%80%A2+Employee+wishes%3A%0A%E2%97%A6+Day+on+request%3A+An+employee+wants+to+work+on+a+specific+day.%0A%E2%97%A6+Day+off+request%3A+An+employee+does+not+want+to+work+on+a+specific+day.%0A%E2%97%A6+Shift+on+request%3A+An+employee+wants+to+be+assigned+to+a+specific+shift.%0A%E2%97%A6+Shift+off+request%3A+An+employee+does+not+want+to+be+assigned+to+a+specific+shift.%0A%E2%80%A2+Alternative+skill%3A+An+employee+assigned+to+a+skill+should+have+a+proficiency+in+every+skill%0Arequired+by+that+shift.%0AThe+problem+is+defined+by+the+International+Nurse+Rostering+Competition+2010.%0A3.15.2.+Value+Proposition%0A3.15.3.+Problem+Size%0AThere+are+three+dataset+types%3A%0A%E2%80%A2+sprint%3A+must+be+solved+in+seconds.%0A%E2%80%A2+medium%3A+must+be+solved+in+minutes.%0A%E2%80%A2+long%3A+must+be+solved+in+hours.%0A71%0Atoy1++++++++++has+1+skills%2C+3+shiftTypes%2C+2+patterns%2C+1+contracts%2C++6+employees%2C++7%0AshiftDates%2C++35+shiftAssignments+and+++0+requests+with+a+search+space+of+++10%5E27.%0Atoy2++++++++++has+1+skills%2C+3+shiftTypes%2C+3+patterns%2C+2+contracts%2C+20+employees%2C+28%0AshiftDates%2C+180+shiftAssignments+and+140+requests+with+a+search+space+of++10%5E234.%0Asprint01++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint02++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint03++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint04++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint05++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint06++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint07++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint08++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint09++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint10++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint01+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint02+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint03+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late01+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late02+has+1+skills%2C+3+shiftTypes%2C+4+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+144+shiftAssignments+and+139+requests+with+a+search+space+of++10%5E144.%0Asprint_late03+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+160+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E160.%0Asprint_late04+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+160+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E160.%0Asprint_late05+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late06+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late07+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late08+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+++0+requests+with+a+search+space+of++10%5E152.%0Asprint_late09+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+++0+requests+with+a+search+space+of++10%5E152.%0Asprint_late10+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0A72%0Amedium01++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium02++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium03++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium04++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium05++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium_hint01+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_hint02+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_hint03+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late01+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+424+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E626.%0Amedium_late02+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late03+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late04+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+416+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E614.%0Amedium_late05+has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+452+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E667.%0Along01++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along02++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along03++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along04++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along05++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along_hint01+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_hint02+++has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_hint03+++has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_late01+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late02+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+4+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late03+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late04+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+4+contracts%2C+50+employees%2C+28%0A73%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late05+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0A3.15.4.+Domain+Model%0A3.16.+Traveling+Tournament+Problem+%28TTP%29%0A3.16.1.+Problem+Description%0ASchedule+matches+between+n+teams.%0A74%0AHard+constraints%3A%0A%E2%80%A2+Each+team+plays+twice+against+every+other+team%3A+once+home+and+once+away.%0A%E2%80%A2+Each+team+has+exactly+one+match+on+each+timeslot.%0A%E2%80%A2+No+team+must+have+more+than+three+consecutive+home+or+three+consecutive+away+matches.%0A%E2%80%A2+No+repeaters%3A+no+two+consecutive+matches+of+the+same+two+opposing+teams.%0ASoft+constraints%3A%0A%E2%80%A2+Minimize+the+total+distance+traveled+by+all+teams.%0AThe+problem+is+defined+on+Michael+Trick%E2%80%99s+website+%28which+contains+the+world+records+too%29.%0A3.16.2.+Problem+Size%0A75%0A1-nl04+++++has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A1-nl06+++++has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A1-nl08+++++has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A1-nl10+++++has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A1-nl12+++++has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A1-nl14+++++has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A1-nl16+++++has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A2-bra24++++has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A3-nfl16++++has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A3-nfl18++++has+34+days%2C+18+teams+and++306+matches+with+a+search+space+of++10%5E346.%0A3-nfl20++++has+38+days%2C+20+teams+and++380+matches+with+a+search+space+of++10%5E447.%0A3-nfl22++++has+42+days%2C+22+teams+and++462+matches+with+a+search+space+of++10%5E562.%0A3-nfl24++++has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A3-nfl26++++has+50+days%2C+26+teams+and++650+matches+with+a+search+space+of++10%5E838.%0A3-nfl28++++has+54+days%2C+28+teams+and++756+matches+with+a+search+space+of++10%5E999.%0A3-nfl30++++has+58+days%2C+30+teams+and++870+matches+with+a+search+space+of+10%5E1175.%0A3-nfl32++++has+62+days%2C+32+teams+and++992+matches+with+a+search+space+of+10%5E1367.%0A4-super04++has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A4-super06++has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A4-super08++has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A4-super10++has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A4-super12++has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A4-super14++has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A5-galaxy04+has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A5-galaxy06+has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A5-galaxy08+has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A5-galaxy10+has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A5-galaxy12+has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A5-galaxy14+has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A5-galaxy16+has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A5-galaxy18+has+34+days%2C+18+teams+and++306+matches+with+a+search+space+of++10%5E346.%0A5-galaxy20+has+38+days%2C+20+teams+and++380+matches+with+a+search+space+of++10%5E447.%0A5-galaxy22+has+42+days%2C+22+teams+and++462+matches+with+a+search+space+of++10%5E562.%0A5-galaxy24+has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A5-galaxy26+has+50+days%2C+26+teams+and++650+matches+with+a+search+space+of++10%5E838.%0A5-galaxy28+has+54+days%2C+28+teams+and++756+matches+with+a+search+space+of++10%5E999.%0A5-galaxy30+has+58+days%2C+30+teams+and++870+matches+with+a+search+space+of+10%5E1175.%0A5-galaxy32+has+62+days%2C+32+teams+and++992+matches+with+a+search+space+of+10%5E1367.%0A5-galaxy34+has+66+days%2C+34+teams+and+1122+matches+with+a+search+space+of+10%5E1576.%0A5-galaxy36+has+70+days%2C+36+teams+and+1260+matches+with+a+search+space+of+10%5E1801.%0A5-galaxy38+has+74+days%2C+38+teams+and+1406+matches+with+a+search+space+of+10%5E2042.%0A5-galaxy40+has+78+days%2C+40+teams+and+1560+matches+with+a+search+space+of+10%5E2301.%0A3.17.+Cheap+Time+Scheduling%0A3.17.1.+Problem+Description%0ASchedule+all+tasks+in+time+and+on+a+machine+to+minimize+power+cost.+Power+prices+differs+in+time.%0AThis+is+a+form+of+job+shop+scheduling.%0A76%0AHard+constraints%3A%0A%E2%80%A2+Start+time+limits%3A+each+task+must+start+between+its+earliest+start+and+latest+start+limit.%0A%E2%80%A2+Maximum+capacity%3A+the+maximum+capacity+for+each+resource+for+each+machine+must+not+be%0Aexceeded.%0A%E2%80%A2+Startup+and+shutdown%3A+each+machine+must+be+active+in+the+periods+during+which+it+has+assigned%0Atasks.+Between+tasks+it+is+allowed+to+be+idle+to+avoid+startup+and+shutdown+costs.%0AMedium+constraints%3A%0A%E2%80%A2+Power+cost%3A+minimize+the+total+power+cost+of+the+whole+schedule.%0A%E2%97%A6+Machine+power+cost%3A+Each+active+or+idle+machine+consumes+power%2C+which+infers+a+power%0Acost+%28depending+on+the+power+price+during+that+time%29.%0A%E2%97%A6+Task+power+cost%3A+Each+task+consumes+power+too%2C+which+infers+a+power+cost+%28depending+on%0Athe+power+price+during+its+time%29.%0A%E2%97%A6+Machine+startup+and+shutdown+cost%3A+Every+time+a+machine+starts+up+or+shuts+down%2C+an+extra%0Acost+is+inflicted.%0ASoft+constraints+%28addendum+to+the+original+problem+definition%29%3A%0A%E2%80%A2+Start+early%3A+prefer+starting+a+task+sooner+rather+than+later.%0AThe+problem+is+defined+by+the+ICON+challenge.%0A3.17.2.+Problem+Size%0Asample01+++has+3+resources%2C+++2+machines%2C+288+periods+and+++25+tasks+with+a+search%0Aspace+of++++10%5E53.%0Asample02+++has+3+resources%2C+++2+machines%2C+288+periods+and+++50+tasks+with+a+search%0Aspace+of+++10%5E114.%0Asample03+++has+3+resources%2C+++2+machines%2C+288+periods+and++100+tasks+with+a+search%0Aspace+of+++10%5E226.%0Asample04+++has+3+resources%2C+++5+machines%2C+288+periods+and++100+tasks+with+a+search%0Aspace+of+++10%5E266.%0Asample05+++has+3+resources%2C+++2+machines%2C+288+periods+and++250+tasks+with+a+search%0Aspace+of+++10%5E584.%0Asample06+++has+3+resources%2C+++5+machines%2C+288+periods+and++250+tasks+with+a+search%0Aspace+of+++10%5E673.%0Asample07+++has+3+resources%2C+++2+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E2388.%0Asample08+++has+3+resources%2C+++5+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E2748.%0Asample09+++has+4+resources%2C++20+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E6668.%0Ainstance00+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E595.%0Ainstance01+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E599.%0A77%0Ainstance02+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E599.%0Ainstance03+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E591.%0Ainstance04+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E590.%0Ainstance05+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E667.%0Ainstance06+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E660.%0Ainstance07+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E662.%0Ainstance08+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E651.%0Ainstance09+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E659.%0Ainstance10+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1657.%0Ainstance11+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1644.%0Ainstance12+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1637.%0Ainstance13+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1659.%0Ainstance14+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1643.%0Ainstance15+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1782.%0Ainstance16+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1778.%0Ainstance17+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1764.%0Ainstance18+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1769.%0Ainstance19+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1778.%0Ainstance20+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3689.%0Ainstance21+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3678.%0Ainstance22+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3706.%0Ainstance23+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3676.%0Ainstance24+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3681.%0Ainstance25+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3774.%0Ainstance26+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3737.%0Ainstance27+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0A78%0Aspace+of++10%5E3744.%0Ainstance28+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3731.%0Ainstance29+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3746.%0Ainstance30+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7718.%0Ainstance31+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7740.%0Ainstance32+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7686.%0Ainstance33+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7672.%0Ainstance34+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7695.%0Ainstance35+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7807.%0Ainstance36+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7814.%0Ainstance37+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7764.%0Ainstance38+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7736.%0Ainstance39+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7783.%0Ainstance40+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15976.%0Ainstance41+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15935.%0Ainstance42+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15887.%0Ainstance43+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15896.%0Ainstance44+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15885.%0Ainstance45+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20173.%0Ainstance46+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20132.%0Ainstance47+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20126.%0Ainstance48+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20110.%0Ainstance49+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20078.%0A79%0A3.18.+Investment+Asset+Class+Allocation+%28Portfolio%0AOptimization%29%0A3.18.1.+Problem+Description%0ADecide+the+relative+quantity+to+invest+in+each+asset+class.%0AHard+constraints%3A%0A%E2%80%A2+Risk+maximum%3A+the+total+standard+deviation+must+not+be+higher+than+the+standard+deviation%0Amaximum.%0A%E2%97%A6+Total+standard+deviation+calculation+takes+asset+class+correlations+into+account+by+applying%0AMarkowitz+Portfolio+Theory.%0A%E2%80%A2+Region+maximum%3A+Each+region+has+a+quantity+maximum.%0A%E2%80%A2+Sector+maximum%3A+Each+sector+has+a+quantity+maximum.%0ASoft+constraints%3A%0A%E2%80%A2+Maximize+expected+return.%0A3.18.2.+Problem+Size%0Ade_smet_1+has+1+regions%2C+3+sectors+and+11+asset+classes+with+a+search+space+of+10%5E4.%0Airrinki_1+has+2+regions%2C+3+sectors+and+6+asset+classes+with+a+search+space+of+10%5E3.%0ALarger+datasets+have+not+been+created+or+tested+yet%2C+but+should+not+pose+a+problem.+A+good+source%0Aof+data+is+this+Asset+Correlation+website.%0A3.19.+Conference+Scheduling%0A3.19.1.+Problem+Description%0AAssign+each+conference+talk+to+a+timeslot+and+a+room.+Timeslots+can+overlap.+Read%2Fwrite+to%2Ffrom+an%0A*.xlsx+file+that+can+be+edited+with+LibreOffice+or+Excel+too.%0AHard+constraints%3A%0A%E2%80%A2+Talk+type+of+timeslot%3A+The+type+of+a+talk+must+match+the+timeslot%E2%80%99s+talk+type.%0A%E2%80%A2+Room+unavailable+timeslots%3A+A+talk%E2%80%99s+room+must+be+available+during+the+talk%E2%80%99s+timeslot.%0A%E2%80%A2+Room+conflict%3A+Two+talks+can%E2%80%99t+use+the+same+room+during+overlapping+timeslots.%0A%E2%80%A2+Speaker+unavailable+timeslots%3A+Every+talk%E2%80%99s+speaker+must+be+available+during+the+talk%E2%80%99s+timeslot.%0A%E2%80%A2+Speaker+conflict%3A+Two+talks+can%E2%80%99t+share+a+speaker+during+overlapping+timeslots.%0A%E2%80%A2+Generic+purpose+timeslot+and+room+tags%0A80%0A%E2%97%A6+Speaker+required+timeslot+tag%3A+If+a+speaker+has+a+required+timeslot+tag%2C+then+all+his%2Fher+talks%0Amust+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+prohibited+timeslot+tag%3A+If+a+speaker+has+a+prohibited+timeslot+tag%2C+then+all+his%2Fher%0Atalks+cannot+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+required+timeslot+tag%3A+If+a+talk+has+a+required+timeslot+tag%2C+then+it+must+be+assigned+to+a%0Atimeslot+with+that+tag.%0A%E2%97%A6+Talk+prohibited+timeslot+tag%3A+If+a+talk+has+a+prohibited+timeslot+tag%2C+then+it+cannot+be%0Aassigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+required+room+tag%3A+If+a+speaker+has+a+required+room+tag%2C+then+all+his%2Fher+talks+must%0Abe+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Speaker+prohibited+room+tag%3A+If+a+speaker+has+a+prohibited+room+tag%2C+then+all+his%2Fher+talks%0Acannot+be+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Talk+required+room+tag%3A+If+a+talk+has+a+required+room+tag%2C+then+it+must+be+assigned+to+a+room%0Awith+that+tag.%0A%E2%97%A6+Talk+prohibited+room+tag%3A+If+a+talk+has+a+prohibited+room+tag%2C+then+it+cannot+be+assigned+to+a%0Aroom+with+that+tag.%0ASoft+constraints%3A%0A%E2%80%A2+Theme+track+conflict%3A+Minimize+the+number+of+talks+that+share+a+same+theme+tag+during%0Aoverlapping+timeslots.%0A%E2%80%A2+Sector+conflict%3A+Minimize+the+number+of+talks+that+share+a+same+sector+tag+during+overlapping%0Atimeslots.%0A%E2%80%A2+Content+audience+level+flow+violation%3A+For+every+content+tag%2C+schedule+the+introductory+talks%0Abefore+the+advanced+talks.%0A%E2%80%A2+Audience+level+diversity%3A+For+every+timeslot%2C+maximize+the+number+of+talks+with+a+different%0Aaudience+level.%0A%E2%80%A2+Language+diversity%3A+For+every+timeslot%2C+maximize+the+number+of+talks+with+a+different+language.%0A%E2%80%A2+Generic+purpose+timeslot+and+room+tags%0A%E2%97%A6+Speaker+preferred+timeslot+tag%3A+If+a+speaker+has+a+preferred+timeslot+tag%2C+then+all+his%2Fher%0Atalks+should+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+undesired+timeslot+tag%3A+If+a+speaker+has+a+undesired+timeslot+tag%2C+then+all+his%2Fher%0Atalks+should+not+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+preferred+timeslot+tag%3A+If+a+talk+has+a+preferred+timeslot+tag%2C+then+it+should+be+assigned%0Ato+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+undesired+timeslot+tag%3A+If+a+talk+has+a+undesired+timeslot+tag%2C+then+it+should+not+be%0Aassigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+preferred+room+tag%3A+If+a+speaker+has+a+preferred+room+tag%2C+then+all+his%2Fher+talks%0Ashould+be+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Speaker+undesired+room+tag%3A+If+a+speaker+has+a+undesired+room+tag%2C+then+all+his%2Fher+talks%0Ashould+not+be+assigned+to+a+room+with+that+tag.%0A81%0A%E2%97%A6+Talk+preferred+room+tag%3A+If+a+talk+has+a+preferred+room+tag%2C+then+it+should+be+assigned+to+a%0Aroom+with+that+tag.%0A%E2%97%A6+Talk+undesired+room+tag%3A+If+a+talk+has+a+undesired+room+tag%2C+then+it+should+not+be+assigned+to%0Aa+room+with+that+tag.%0A3.19.2.+Value+Proposition%0A3.19.3.+Problem+Size%0A18talks-6timeslots-5rooms++++has++18+talks%2C++6+timeslots+and++5+rooms+with+a+search%0Aspace+of++10%5E26.%0A36talks-12timeslots-5rooms+++has++36+talks%2C+12+timeslots+and++5+rooms+with+a+search%0Aspace+of++10%5E64.%0A72talks-12timeslots-10rooms++has++72+talks%2C+12+timeslots+and+10+rooms+with+a+search%0Aspace+of+10%5E149.%0A108talks-18timeslots-10rooms+has+108+talks%2C+18+timeslots+and+10+rooms+with+a+search%0Aspace+of+10%5E243.%0A216talks-18timeslots-20rooms+has+216+talks%2C+18+timeslots+and+20+rooms+with+a+search%0Aspace+of+10%5E552.%0A82%0A3.20.+Rock+Tour%0A3.20.1.+Problem+Description%0ADrive+the+rock+bus+from+show+to+show%2C+but+schedule+shows+only+on+available+days.%0AHard+constraints%3A%0A%E2%80%A2+Schedule+every+required+show.%0A%E2%80%A2+Schedule+as+many+shows+as+possible.%0AMedium+constraints%3A%0A%E2%80%A2+Maximize+revenue+opportunity.%0A%E2%80%A2+Minimize+driving+time.%0A%E2%80%A2+Visit+sooner+than+later.%0ASoft+constraints%3A%0A%E2%80%A2+Avoid+long+driving+times.%0A3.20.2.+Problem+Size%0A47shows+has+47+shows+with+a+search+space+of+10%5E59.%0A83%0AChapter+4.+Planner+Configuration%0A4.1.+Overview%0ASolving+a+planning+problem+with+Planner+consists+of+the+following+steps%3A%0A1.+Model+your+planning+problem+as+a+class+that+implements+the+interface+Solution%2C+for+example%0Athe+class+NQueens.%0A2.+Configure+a+Solver%2C+for+example+a+First+Fit+and+Tabu+Search+solver+for+any+NQueens+instance.%0A3.+Load+a+problem+data+set+from+your+data+layer%2C+for+example+a+Four+Queens+instance.+That+is+the%0Aplanning+problem.%0A4.+Solve+it+with+Solver.solve%28problem%29+which+returns+the+best+solution+found.%0A4.2.+Solver+Configuration%0A4.2.1.+Solver+Configuration+by+XML%0ABuild+a+Solver+instance+with+the+SolverFactory.+Configure+the+SolverFactory+with+a+solver%0Aconfiguration+XML+file%2C+provided+as+a+classpath+resource+%28as+defined+by+ClassLoader.getResource%28%29%29%3A%0A84%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0++++++++++++++%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0AIn+a+typical+project+%28following+the+Maven+directory+structure%29%2C+that+solverConfig+XML+file+would+be%0Alocated+at%0A%24PROJECT_DIR%2Fsrc%2Fmain%2Fresources%2Forg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%0A.+Alternatively%2C+a+SolverFactory+can+be+created+from+a+File%2C+an+InputStream+or+a+Reader+with+methods%0Asuch+as+SolverFactory.createFromXmlFile%28%29.+However%2C+for+portability+reasons%2C+a+classpath+resource+is%0Arecommended.%0AOn+some+environments+%28OSGi%2C+JBoss+modules%2C+%E2%80%A6%29%2C+classpath+resources+%28such+as+the%0Asolver+config%2C+score+DRL%E2%80%99s+and+domain+classes%29+in+your+jars+might+not+be+available%0Ato+the+default+ClassLoader+of+the+optaplanner-core+jar.+In+those+cases%2C+provide+the%0AClassLoader+of+your+classes+as+a+parameter%3A%0A%EF%81%9A%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0++++++++++++++%22...%2FnqueensSolverConfig.xml%22%2C+getClass%28%29.%0AgetClassLoader%28%29%29%3B%0AWhen+using+Workbench+or+Execution+Server+or+to+take+advantage+of+Drools%E2%80%99s%0AKieContainer+features%2C+provide+the+KieContainer+as+a+parameter%3A%0A%C2%A0++++++KieServices+kieServices+%3D+KieServices.Factory.get%28%29%3B%0A%C2%A0++++++KieContainer+kieContainer+%3D+kieServices.newKieContainer%28%0A%EF%81%9A+%C2%A0++++++++++++++kieServices.newReleaseId%28%22org.nqueens%22%2C+%22nqueens%22%2C%221.0.0%22%29%29%3B%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory%0A.createFromKieContainerXmlResource%28%0A%C2%A0++++++++++++++kieContainer%2C+%22...%2FnqueensSolverConfig.xml%22%29%3B%0AAlso+use+a+ksessionName+in+the+solver+configuration.%0ABoth+a+Solver+and+a+SolverFactory+have+a+generic+type+called+Solution_%2C+which+is+the+class%0Arepresenting+a+planning+problem+and+solution.%0AA+solver+configuration+XML+file+looks+like+this%3A%0A85%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+%3C%21--+Define+the+score+function+--%3E%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A%C2%A0+%3C%21--+Configure+the+optimization+algorithms+%28optional%29+--%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0ANotice+the+three+parts+in+it%3A%0A%E2%80%A2+Define+the+model.%0A%E2%80%A2+Define+the+score+function.%0A%E2%80%A2+Optionally+configure+the+optimization+algorithm%28s%29.%0AThese+various+parts+of+a+configuration+are+explained+further+in+this+manual.%0APlanner+makes+it+relatively+easy+to+switch+optimization+algorithm%28s%29+just+by+changing+the%0Aconfiguration.+There+is+even+a+Benchmarker+which+allows+you+to+play+out+different+configurations%0Aagainst+each+other+and+report+the+most+appropriate+configuration+for+your+use+case.%0A4.2.2.+Solver+Configuration+by+Java+API%0AA+solver+configuration+can+also+be+configured+with+the+SolverConfig+API.+This+is+especially+useful+to%0Achange+some+values+dynamically+at+runtime.+For+example%2C+to+change+the+running+time+based+on%0Auser+input%2C+before+building+the+Solver%3A%0A86%0A%C2%A0+++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0+++++++TerminationConfig+terminationConfig+%3D+new+TerminationConfig%28%29%3B%0A%C2%A0+++++++terminationConfig.setMinutesSpentLimit%28userInput%29%3B%0A%C2%A0+++++++solverFactory.getSolverConfig%28%29.setTerminationConfig%28terminationConfig%29%3B%0A%C2%A0+++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0AEvery+element+in+the+solver+configuration+XML+is+available+as+a+*Config+class+or+a+property+on+a%0A*Config+class+in+the+package+namespace+org.optaplanner.core.config.+These+*Config+classes+are+the%0AJava+representation+of+the+XML+format.+They+build+the+runtime+components+%28of+the+package%0Anamespace+org.optaplanner.core.impl%29+and+assemble+them+into+an+efficient+Solver.%0AThe+SolverFactory+is+only+thread-safe+after+it%E2%80%99s+configured.+So+the+getSolverConfig%28%29%0Amethod+is+not+thread-safe.+To+configure+a+SolverFactory+dynamically+for+each+user%0Arequest%2C+build+a+basic+SolverFactory+during+initialization+and+clone+it+with+the%0AcloneSolverFactory%28%29+method+for+a+user+request%3A%0A%C2%A0+++private+SolverFactory%3CNQueens%3E+base%3B%0A%C2%A0+++public+void+init%28%29+%7B%0A%C2%A0+++++++base+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0+++++++base.getSolverConfig%28%29.setTerminationConfig%28new%0A%EF%81%AA+TerminationConfig%28%29%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+Called+concurrently+from+different+threads%0A%C2%A0+++public+void+userRequest%28...%2C+long+userInput%29%0A%C2%A0+++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+base.cloneSolverFactory%0A%28%29%3B%0A%C2%A0+++++++solverFactory.getSolverConfig%28%29.getTerminationConfig%28%29%0A.setMinutesSpentLimit%28userInput%29%3B%0A%C2%A0+++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A4.2.3.+Annotations+Configuration%0A4.2.3.1.+Automatic+Scanning+for+Annotations%0AInstead+of+the+declaring+the+classes+that+have+a+%40PlanningSolution+or+%40PlanningEntity+manually%3A%0A87%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0APlanner+can+find+scan+the+classpath+and+find+them+automatically%3A%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AOn+environments+such+as+OSGi+and+Android%2C+which+use+a+non-standard%0A%EF%81%9A+ClassLoader%2C+automated+scanning+might+not+find+the+%40PlanningSolution+or%0A%40PlanningEntity+classes.%0AAutomated+scanning+inflicts+a+performance+cost+during+bootstrap.+To+speed+up+scanning+or+if+there%0Aare+multiple+models+in+your+classpath%2C+specify+the+packages+to+scan%3A%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%3E%0A%C2%A0+++%3CpackageInclude%3Eorg.optaplanner.examples.cloudbalancing%3C%2FpackageInclude%3E%0A%C2%A0+%3C%2FscanAnnotatedClasses%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThis+finds+all+solution+and+entity+classes+in+that+package+or+its+subpackages.%0AIf+scanAnnotatedClasses+is+not+specified%2C+the+org.reflections+transitive+maven%0A%EF%81%9A+dependency+can+be+excluded.%0A4.2.3.2.+Annotation+Alternatives%0APlanner+needs+to+be+told+which+classes+in+your+domain+model+are+planning+entities%2C+which%0Aproperties+are+planning+variables%2C+etc.+There+are+several+ways+to+deliver+this+information%3A%0A%E2%80%A2+Add+class+annotations+and+JavaBean+property+annotations+on+the+domain+model%0A%28recommended%29.+The+property+annotations+must+be+on+the+getter+method%2C+not+on+the+setter%0Amethod.+Such+a+getter+does+not+need+to+be+public.%0A88%0A%E2%80%A2+Add+class+annotations+and+field+annotations+on+the+domain+model.+Such+a+field+does+not+need+to%0Abe+public.%0A%E2%80%A2+No+annotations%3A+externalize+the+domain+configuration+in+an+XML+file.+This+is+not+yet+supported.%0AThis+manual+focuses+on+the+first+manner%2C+but+every+feature+supports+all+three+manners%2C+even+if+it%E2%80%99s%0Anot+explicitly+mentioned.%0A4.2.4.+Custom+Properties+Configuration%0ASolver+configuration+elements%2C+that+instantiate+classes+and+explicitly+mention+it%2C+support+custom%0Aproperties.+Custom+properties+are+useful+to+tweak+dynamic+values+through+the+Benchmarker.+For%0Aexample%2C+presume+your+EasyScoreCalculator+has+heavy+calculations+%28which+are+cached%29+and+you%0Awant+to+increase+the+cache+size+in+one+benchmark%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CeasyScoreCalculatorClass%3E...MyEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3CeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%3C%21--+Override+value+--%3E%0A%C2%A0+++%3C%2FeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AAdd+a+public+setter+for+each+custom+property%2C+which+is+called+when+a+Solver+is+build.%0Apublic+class+MyEasyScoreCalculator+extends+EasyScoreCalculator%3CMySolution%3E+%7B%0A%C2%A0+++++++private+int+myCacheSize+%3D+500%3B+%2F%2F+Default+value%0A%C2%A0+++++++%40SuppressWarnings%28%22unused%22%29%0A%C2%A0+++++++public+void+setMyCacheSize%28int+myCacheSize%29+%7B%0A%C2%A0+++++++++++this.myCacheSize+%3D+myCacheSize%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++...%0A%7D%0AMost+value+types+are+supported+%28including+boolean%2C+int%2C+double%2C+BigDecimal%2C+String+and+enums%29.%0A4.3.+Model+a+Planning+Problem%0A4.3.1.+Is+This+Class+a+Problem+Fact+or+Planning+Entity%3F%0ALook+at+a+dataset+of+your+planning+problem.+You+will+recognize+domain+classes+in+there%2C+each+of%0Awhich+can+be+categorized+as+one+of+the+following%3A%0A%E2%80%A2+An+unrelated+class%3A+not+used+by+any+of+the+score+constraints.+From+a+planning+standpoint%2C+this%0Adata+is+obsolete.%0A89%0A%E2%80%A2+A+problem+fact+class%3A+used+by+the+score+constraints%2C+but+does+NOT+change+during+planning+%28as%0Along+as+the+problem+stays+the+same%29.+For+example%3A+Bed%2C+Room%2C+Shift%2C+Employee%2C+Topic%2C+Period%2C+%E2%80%A6+All%0Athe+properties+of+a+problem+fact+class+are+problem+properties.%0A%E2%80%A2+A+planning+entity+class%3A+used+by+the+score+constraints+and+changes+during+planning.+For%0Aexample%3A+BedDesignation%2C+ShiftAssignment%2C+Exam%2C+%E2%80%A6+The+properties+that+change+during+planning%0Aare+planning+variables.+The+other+properties+are+problem+properties.%0AAsk+yourself%3A+What+class+changes+during+planning%3F+Which+class+has+variables+that+I+want+the+Solver%0Ato+change+for+me%3F+That+class+is+a+planning+entity.+Most+use+cases+have+only+one+planning+entity+class.%0AMost+use+cases+also+have+only+one+planning+variable+per+planning+entity+class.%0AIn+real-time+planning%2C+even+though+the+problem+itself+changes%2C+problem+facts+do%0A%EF%81%9A+not+really+change+during+planning%2C+instead+they+change+between+planning%0A%28because+the+Solver+temporarily+stops+to+apply+the+problem+fact+changes%29.%0ATo+create+a+good+domain+model%2C+read+the+domain+modeling+guide.%0AIn+Planner%2C+all+problem+facts+and+planning+entities+are+plain+old+JavaBeans+%28POJOs%29.+Load+them%0Afrom+a+database%2C+an+XML+file%2C+a+data+repository%2C+a+REST+service%2C+a+noSQL+cloud%2C+%E2%80%A6+%28see+integration%29%3A%0Ait+doesn%E2%80%99t+matter.%0A4.3.2.+Problem+Fact%0AA+problem+fact+is+any+JavaBean+%28POJO%29+with+getters+that+does+not+change+during+planning.%0AImplementing+the+interface+Serializable+is+recommended+%28but+not+required%29.+For+example+in+n%0Aqueens%2C+the+columns+and+rows+are+problem+facts%3A%0Apublic+class+Column+implements+Serializable+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0Apublic+class+Row+implements+Serializable+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0AA+problem+fact+can+reference+other+problem+facts+of+course%3A%0A90%0Apublic+class+Course+implements+Serializable+%7B%0A%C2%A0+++private+String+code%3B%0A%C2%A0+++private+Teacher+teacher%3B+%2F%2F+Other+problem+fact%0A%C2%A0+++private+int+lectureSize%3B%0A%C2%A0+++private+int+minWorkingDaySize%3B%0A%C2%A0+++private+List%3CCurriculum%3E+curriculumList%3B+%2F%2F+Other+problem+facts%0A%C2%A0+++private+int+studentSize%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0AA+problem+fact+class+does+not+require+any+Planner+specific+code.+For+example%2C+you+can+reuse+your%0Adomain+classes%2C+which+might+have+JPA+annotations.%0AGenerally%2C+better+designed+domain+classes+lead+to+simpler+and+more+efficient+score%0Aconstraints.+Therefore%2C+when+dealing+with+a+messy+%28denormalized%29+legacy+system%2C%0Ait+can+sometimes+be+worthwhile+to+convert+the+messy+domain+model+into+a+Planner%0Aspecific+model+first.+For+example%3A+if+your+domain+model+has+two+Teacher+instances%0A%EF%81%9A+for+the+same+teacher+that+teaches+at+two+different+departments%2C+it+is+harder+towrite+a+correct+score+constraint+that+constrains+a+teacher%E2%80%99s+spare+time+on+the%0Aoriginal+model+than+on+an+adjusted+model.%0AAlternatively%2C+you+can+sometimes+also+introduce+a+cached+problem+fact+to+enrich%0Athe+domain+model+for+planning+only.%0A4.3.3.+Planning+Entity%0A4.3.3.1.+Planning+Entity+Annotation%0AA+planning+entity+is+a+JavaBean+%28POJO%29+that+changes+during+solving%2C+for+example+a+Queen+that%0Achanges+to+another+row.+A+planning+problem+has+multiple+planning+entities%2C+for+example+for+a%0Asingle+n+queens+problem%2C+each+Queen+is+a+planning+entity.+But+there+is+usually+only+one+planning%0Aentity+class%2C+for+example+the+Queen+class.%0AA+planning+entity+class+needs+to+be+annotated+with+the+%40PlanningEntity+annotation.%0AEach+planning+entity+class+has+one+or+more+planning+variables+%28which+can+be+genuine+or+shadows%29.%0AIt+should+also+have+one+or+more+defining+properties.+For+example+in+n+queens%2C+a+Queen+is+defined+by%0Aits+Column+and+has+a+planning+variable+Row.+This+means+that+a+Queen%E2%80%99s+column+never+changes+during%0Asolving%2C+while+its+row+does+change.%0A91%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++private+Column+column%3B%0A%C2%A0+++%2F%2F+Planning+variables%3A+changes+during+planning%2C+between+score+calculations.%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0AA+planning+entity+class+can+have+multiple+planning+variables.+For+example%2C+a+Lecture+is+defined+by%0Aits+Course+and+its+index+in+that+course+%28because+one+course+has+multiple+lectures%29.+Each+Lecture%0Aneeds+to+be+scheduled+into+a+Period+and+a+Room+so+it+has+two+planning+variables+%28period+and+room%29.%0AFor+example%3A+the+course+Mathematics+has+eight+lectures+per+week%2C+of+which+the+first+lecture+is%0AMonday+morning+at+08%3A00+in+room+212.%0A%40PlanningEntity%0Apublic+class+Lecture+%7B%0A%C2%A0+++private+Course+course%3B%0A%C2%A0+++private+int+lectureIndexInCourse%3B%0A%C2%A0+++%2F%2F+Planning+variables%3A+changes+during+planning%2C+between+score+calculations.%0A%C2%A0+++private+Period+period%3B%0A%C2%A0+++private+Room+room%3B%0A%C2%A0+++%2F%2F+...%0A%7D%0AWithout+automated+scanning%2C+the+solver+configuration+also+needs+to+declare+each+planning+entity%0Aclass%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ASome+uses+cases+have+multiple+planning+entity+classes.+For+example%3A+route+freight+and+trains+into%0Arailway+network+arcs%2C+where+each+freight+can+use+multiple+trains+over+its+journey+and+each+train%0Acan+carry+multiple+freights+per+arc.+Having+multiple+planning+entity+classes+directly+raises+the%0Aimplementation+complexity+of+your+use+case.%0A92%0ADo+not+create+unnecessary+planning+entity+classes.+This+leads+to+difficult+Move%0Aimplementations+and+slower+score+calculation.%0AFor+example%2C+do+not+create+a+planning+entity+class+to+hold+the+total+free+time+of+a%0Ateacher%2C+which+needs+to+be+kept+up+to+date+as+the+Lecture+planning+entities+change.%0AInstead%2C+calculate+the+free+time+in+the+score+constraints+%28or+as+a+shadow+variable%29%0A%EF%81%9A+and+put+the+result+per+teacher+into+a+logically+inserted+score+object.%0AIf+historic+data+needs+to+be+considered+too%2C+then+create+problem+fact+to+hold+the%0Atotal+of+the+historic+assignments+up+to%2C+but+not+including%2C+the+planning+window+%28so%0Athat+it+does+not+change+when+a+planning+entity+changes%29+and+let+the+score%0Aconstraints+take+it+into+account.%0A4.3.3.2.+Planning+Entity+Difficulty%0ASome+optimization+algorithms+work+more+efficiently+if+they+have+an+estimation+of+which+planning%0Aentities+are+more+difficult+to+plan.+For+example%3A+in+bin+packing+bigger+items+are+harder+to+fit%2C+in%0Acourse+scheduling+lectures+with+more+students+are+more+difficult+to+schedule%2C+and+in+n+queens+the%0Amiddle+queens+are+more+difficult+to+fit+on+the+board.%0ADo+not+try+to+use+planning+entity+difficulty+to+implement+a+business%0Aconstraint.+It+will+not+affect+the+score+function%3A+if+we+have+infinite+solving+time%2C%0Athe+returned+solution+will+be+the+same.%0A%EF%81%9A+To+attain+a+schedule+in+which+certain+entities+are+scheduled+earlier+in+the+schedule%2C%0Aadd+a+score+constraint+to+change+the+score+function+so+it+prefers+such+solutions.%0AOnly+consider+adding+planning+entity+difficulty+too+if+it+can+make+the+solver+more%0Aefficient.%0ATo+allow+the+heuristics+to+take+advantage+of+that+domain+specific+information%2C+set+a%0AdifficultyComparatorClass+to+the+%40PlanningEntity+annotation%3A%0A%40PlanningEntity%28difficultyComparatorClass+%3D+CloudProcessDifficultyComparator.class%29%0Apublic+class+CloudProcess+%7B%0A%C2%A0+++%2F%2F+...%0A%7D%0Apublic+class+CloudProcessDifficultyComparator+implements+Comparator%3CCloudProcess%3E+%7B%0A%C2%A0+++public+int+compare%28CloudProcess+a%2C+CloudProcess+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getRequiredMultiplicand%28%29%2C+b.getRequiredMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0A93%0AAlternatively%2C+you+can+also+set+a+difficultyWeightFactoryClass+to+the+%40PlanningEntity+annotation%2C+so%0Athat+you+have+access+to+the+rest+of+the+problem+facts+from+the+Solution+too%3A%0A%40PlanningEntity%28difficultyWeightFactoryClass+%3D+QueenDifficultyWeightFactory.class%29%0Apublic+class+Queen+%7B%0A%C2%A0+++%2F%2F+...%0A%7D%0ASee+sorted+selection+for+more+information.%0ADifficulty+should+be+implemented+ascending%3A+easy+entities+are+lower%2C+difficult%0Aentities+are+higher.+For+example%2C+in+bin+packing%3A+small+item+%3C+medium+item+%3C+big%0A%EF%81%AA+item.%0AAlthough+most+algorithms+start+with+the+more+difficult+entities+first%2C+they+just%0Areverse+the+ordering.%0ANone+of+the+current+planning+variable+states+should+be+used+to+compare+planning+entity+difficulty.%0ADuring+Construction+Heuristics%2C+those+variables+are+likely+to+be+null+anyway.+For+example%2C+a+Queen%27s%0Arow+variable+should+not+be+used.%0A4.3.4.+Planning+Variable+%28genuine%29%0A4.3.4.1.+Planning+Variable+Annotation%0AA+planning+variable+is+a+JavaBean+property+%28so+a+getter+and+setter%29+on+a+planning+entity.+It+points+to%0Aa+planning+value%2C+which+changes+during+planning.+For+example%2C+a+Queen%27s+row+property+is+a+genuine%0Aplanning+variable.+Note+that+even+though+a+Queen%27s+row+property+changes+to+another+Row+during%0Aplanning%2C+no+Row+instance+itself+is+changed.+Normally+planning+variables+are+genuine%2C+but+advanced%0Acases+can+also+have+shadows.%0AA+genuine+planning+variable+getter+needs+to+be+annotated+with+the+%40PlanningVariable+annotation%2C%0Awhich+needs+a+non-empty+valueRangeProviderRefs+property.%0A94%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++...%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setRow%28Row+row%29+%7B%0A%C2%A0+++++++this.row+%3D+row%3B%0A%C2%A0+++%7D%0A%7D%0AThe+valueRangeProviderRefs+property+defines+what+are+the+possible+planning+values+for+this%0Aplanning+variable.+It+references+one+or+more+%40ValueRangeProvider+id%27s.%0AA+%40PlanningVariable+annotation+needs+to+be+on+a+member+in+a+class+with+a%0A%EF%81%9A+%40PlanningEntity+annotation.+It+is+ignored+on+parent+classes+or+subclasses+without%0Athat+annotation.%0AAnnotating+the+field+instead+of+the+property+works+too%3A%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++private+Row+row%3B%0A%7D%0A4.3.4.2.+Nullable+Planning+Variable%0ABy+default%2C+an+initialized+planning+variable+cannot+be+null%2C+so+an+initialized+solution+will+never+use%0Anull+for+any+of+its+planning+variables.+In+an+over-constrained+use+case%2C+this+can+be%0Acounterproductive.+For+example%3A+in+task+assignment+with+too+many+tasks+for+the+workforce%2C+we%0Awould+rather+leave+low+priority+tasks+unassigned+instead+of+assigning+them+to+an+overloaded%0Aworker.%0ATo+allow+an+initialized+planning+variable+to+be+null%2C+set+nullable+to+true%3A%0A95%0A%C2%A0+++%40PlanningVariable%28...%2C+nullable+%3D+true%29%0A%C2%A0+++public+Worker+getWorker%28%29+%7B%0A%C2%A0+++++++return+worker%3B%0A%C2%A0+++%7D%0APlanner+will+automatically+add+the+value+null+to+the+value+range.+There+is+no+need%0A%EF%81%AA+to+add+null+in+a+collection+used+by+a+ValueRangeProvider.%0AUsing+a+nullable+planning+variable+implies+that+your+score+calculation+is%0A%EF%81%9A+responsible+for+punishing+%28or+even+rewarding%29+variables+with+a+null+value.%0ARepeated+planning+%28especially+real-time+planning%29+does+not+mix+well+with+a+nullable+planning%0Avariable.+Every+time+the+Solver+starts+or+a+problem+fact+change+is+made%2C+the+Construction+Heuristics%0Awill+try+to+initialize+all+the+null+variables+again%2C+which+can+be+a+huge+waste+of+time.+One+way+to+deal%0Awith+this%2C+is+to+change+when+a+planning+entity+should+be+reinitialized+with+an%0AreinitializeVariableEntityFilter%3A%0A%C2%A0+++%40PlanningVariable%28...%2C+nullable+%3D+true%2C+reinitializeVariableEntityFilter+%3D%0AReinitializeTaskFilter.class%29%0A%C2%A0+++public+Worker+getWorker%28%29+%7B%0A%C2%A0+++++++return+worker%3B%0A%C2%A0+++%7D%0A4.3.4.3.+When+is+a+Planning+Variable+Considered+Initialized%3F%0AA+planning+variable+is+considered+initialized+if+its+value+is+not+null+or+if+the+variable+is+nullable.+So+a%0Anullable+variable+is+always+considered+initialized%2C+even+when+a+custom%0AreinitializeVariableEntityFilter+triggers+a+reinitialization+during+construction+heuristics.%0AA+planning+entity+is+initialized+if+all+of+its+planning+variables+are+initialized.%0AA+Solution+is+initialized+if+all+of+its+planning+entities+are+initialized.%0A4.3.5.+Planning+Value+and+Planning+Value+Range%0A4.3.5.1.+Planning+Value%0AA+planning+value+is+a+possible+value+for+a+genuine+planning+variable.+Usually%2C+a+planning+value+is+a%0Aproblem+fact%2C+but+it+can+also+be+any+object%2C+for+example+a+double.+It+can+even+be+another+planning%0Aentity+or+even+a+interface+implemented+by+both+a+planning+entity+and+a+problem+fact.%0AA+planning+value+range+is+the+set+of+possible+planning+values+for+a+planning+variable.+This+set+can+be%0Aa+countable+%28for+example+row+1%2C+2%2C+3+or+4%29+or+uncountable+%28for+example+any+double+between+0.0+and%0A1.0%29.%0A96%0A4.3.5.2.+Planning+Value+Range+Provider%0A4.3.5.2.1.+Overview%0AThe+value+range+of+a+planning+variable+is+defined+with+the+%40ValueRangeProvider+annotation.+A%0A%40ValueRangeProvider+annotation+always+has+a+property+id%2C+which+is+referenced+by+the%0A%40PlanningVariable%27s+property+valueRangeProviderRefs.%0AThis+annotation+can+be+located+on+two+types+of+methods%3A%0A%E2%80%A2+On+the+Solution%3A+All+planning+entities+share+the+same+value+range.%0A%E2%80%A2+On+the+planning+entity%3A+The+value+range+differs+per+planning+entity.+This+is+less+common.%0AA+%40ValueRangeProvider+annotation+needs+to+be+on+a+member+in+a+class+with+a%0A%EF%81%9A+%40PlanningSolution+or+a+%40PlanningEntity+annotation.+It+is+ignored+on+parent%0Aclasses+or+subclasses+without+those+annotations.%0AThe+return+type+of+that+method+can+be+three+types%3A%0A%E2%80%A2+Collection%3A+The+value+range+is+defined+by+a+Collection+%28usually+a+List%29+of+its+possible+values.%0A%E2%80%A2+Array%3A+The+value+range+is+defined+by+an+array+of+its+possible+values.%0A%E2%80%A2+ValueRange%3A+The+value+range+is+defined+by+its+bounds.+This+is+less+common.%0A4.3.5.2.2.+ValueRangeProvider+on+the+Solution%0AAll+instances+of+the+same+planning+entity+class+share+the+same+set+of+possible+planning+values+for%0Athat+planning+variable.+This+is+the+most+common+way+to+configure+a+value+range.%0AThe+Solution+implementation+has+method+that+returns+a+Collection+%28or+a+ValueRange%29.+Any+value%0Afrom+that+Collection+is+a+possible+planning+value+for+this+planning+variable.%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22rowRange%22%29%0A%C2%A0+++public+List%3CRow%3E+getRowList%28%29+%7B%0A%C2%A0+++++++return+rowList%3B%0A%C2%A0+++%7D%0A%7D%0A97%0AThat+Collection+%28or+ValueRange%29+must+not+contain+the+value+null%2C+not+even+for+a%0A%EF%81%AA+nullable+planning+variable.%0AAnnotating+the+field+instead+of+the+property+works+too%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22rowRange%22%29%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%7D%0A4.3.5.2.3.+ValueRangeProvider+on+the+Planning+Entity%0AEach+planning+entity+has+its+own+value+range+%28a+set+of+possible+planning+values%29+for+the+planning%0Avariable.+For+example%2C+if+a+teacher+can+never+teach+in+a+room+that+does+not+belong+to+his%0Adepartment%2C+lectures+of+that+teacher+can+limit+their+room+value+range+to+the+rooms+of+his%0Adepartment.%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22departmentRoomRange%22%7D%29%0A%C2%A0+++public+Room+getRoom%28%29+%7B%0A%C2%A0+++++++return+room%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22departmentRoomRange%22%29%0A%C2%A0+++public+List%3CRoom%3E+getPossibleRoomList%28%29+%7B%0A%C2%A0+++++++return+getCourse%28%29.getTeacher%28%29.getDepartment%28%29.getRoomList%28%29%3B%0A%C2%A0+++%7D%0ANever+use+this+to+enforce+a+soft+constraint+%28or+even+a+hard+constraint+when+the+problem+might+not%0Ahave+a+feasible+solution%29.+For+example%3A+Unless+there+is+no+other+way%2C+a+teacher+can+not+teach+in+a%0Aroom+that+does+not+belong+to+his+department.+In+this+case%2C+the+teacher+should+not+be+limited+in+his%0Aroom+value+range+%28because+sometimes+there+is+no+other+way%29.%0ABy+limiting+the+value+range+specifically+of+one+planning+entity%2C+you+are+effectively%0Acreating+a+built-in+hard+constraint.+This+can+have+the+benefit+of+severely+lowering%0A%EF%81%9A+the+number+of+possible+solutions%3B+however%2C+it+can+also+take+away+the+freedom+of%0Athe+optimization+algorithms+to+temporarily+break+that+constraint+in+order+to+escape%0Afrom+a+local+optimum.%0AA+planning+entity+should+not+use+other+planning+entities+to+determinate+its+value+range.+That+would%0Aonly+try+to+make+the+planning+entity+solve+the+planning+problem+itself+and+interfere+with+the%0Aoptimization+algorithms.%0AEvery+entity+has+its+own+List+instance%2C+unless+multiple+entities+have+the+same+value+range.+For%0A98%0Aexample%2C+if+teacher+A+and+B+belong+to+the+same+department%2C+they+use+the+same+List%3CRoom%3E+instance.%0AFurthermore%2C+each+List+contains+a+subset+of+the+same+set+of+planning+value+instances.+For+example%2C%0Aif+department+A+and+B+can+both+use+room+X%2C+then+their+List%3CRoom%3E+instances+contain+the+same+Room%0Ainstance.%0AA+ValueRangeProvider+on+the+planning+entity+consumes+more+memory+than%0A%EF%81%9A+ValueRangeProvider+on+the+Solution+and+disables+certain+automatic+performance%0Aoptimizations.%0AA+ValueRangeProvider+on+the+planning+entity+is+not+currently+compatible+with+a%0A%EF%81%B1+chained+variable.%0A4.3.5.2.4.+ValueRangeFactory%0AInstead+of+a+Collection%2C+you+can+also+return+a+ValueRange+or+CountableValueRange%2C+build+by+the%0AValueRangeFactory%3A%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22delayRange%22%29%0A%C2%A0+++public+CountableValueRange%3CInteger%3E+getDelayRange%28%29+%7B%0A%C2%A0+++++++return+ValueRangeFactory.createIntValueRange%280%2C+5000%29%3B%0A%C2%A0+++%7D%0AA+ValueRange+uses+far+less+memory%2C+because+it+only+holds+the+bounds.+In+the+example+above%2C+a%0ACollection+would+need+to+hold+all+5000+ints%2C+instead+of+just+the+two+bounds.%0AFurthermore%2C+an+incrementUnit+can+be+specified%2C+for+example+if+you+have+to+buy+stocks+in+units+of%0A200+pieces%3A%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22stockAmountRange%22%29%0A%C2%A0+++public+CountableValueRange%3CInteger%3E+getStockAmountRange%28%29+%7B%0A%C2%A0++++++++%2F%2F+Range%3A+0%2C+200%2C+400%2C+600%2C+...%2C+9999600%2C+9999800%2C+10000000%0A%C2%A0+++++++return+ValueRangeFactory.createIntValueRange%280%2C+10000000%2C+200%29%3B%0A%C2%A0+++%7D%0AReturn+CountableValueRange+instead+of+ValueRange+whenever+possible+%28so+Planner%0A%EF%81%9A+knows+that+it%E2%80%99s+countable%29.%0AThe+ValueRangeFactory+has+creation+methods+for+several+value+class+types%3A%0A%E2%80%A2+boolean%3A+A+boolean+range.%0A%E2%80%A2+int%3A+A+32bit+integer+range.%0A%E2%80%A2+long%3A+A+64bit+integer+range.%0A%E2%80%A2+double%3A+A+64bit+floating+point+range+which+only+supports+random+selection+%28because+it+does+not%0Aimplement+CountableValueRange%29.%0A%E2%80%A2+BigInteger%3A+An+arbitrary-precision+integer+range.%0A99%0A%E2%80%A2+BigDecimal%3A+A+decimal+point+range.+By+default%2C+the+increment+unit+is+the+lowest+non-zero+value+in%0Athe+scale+of+the+bounds.%0A%E2%80%A2+Temporal+%28such+as+LocalDate%2C+LocalDateTime%2C+%E2%80%A6%29%3A+A+time+range.%0A4.3.5.2.5.+Combine+ValueRangeProviders%0AValue+range+providers+can+be+combined%2C+for+example%3A%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22companyCarRange%22%2C+%22personalCarRange%22%0A%7D%29%0A%C2%A0+++public+Car+getCar%28%29+%7B%0A%C2%A0+++++++return+car%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22companyCarRange%22%29%0A%C2%A0+++public+List%3CCompanyCar%3E+getCompanyCarList%28%29+%7B%0A%C2%A0+++++++return+companyCarList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22personalCarRange%22%29%0A%C2%A0+++public+List%3CPersonalCar%3E+getPersonalCarList%28%29+%7B%0A%C2%A0+++++++return+personalCarList%3B%0A%C2%A0+++%7D%0A4.3.5.3.+Planning+Value+Strength%0ASome+optimization+algorithms+work+a+bit+more+efficiently+if+they+have+an+estimation+of+which%0Aplanning+values+are+stronger%2C+which+means+they+are+more+likely+to+satisfy+a+planning+entity.+For%0Aexample%3A+in+bin+packing+bigger+containers+are+more+likely+to+fit+an+item+and+in+course+scheduling%0Abigger+rooms+are+less+likely+to+break+the+student+capacity+constraint.+Usually%2C+the+efficiency+gain+of%0Aplanning+value+strength+is+far+less+than+that+of+planning+entity+difficulty.%0ADo+not+try+to+use+planning+value+strength+to+implement+a+business+constraint.%0AIt+will+not+affect+the+score+function%3A+if+we+have+infinite+solving+time%2C+the+returned%0A%EF%81%9A+solution+will+be+the+same.%0ATo+affect+the+score+function%2C+add+a+score+constraint.+Only+consider+adding+planning%0Avalue+strength+too+if+it+can+make+the+solver+more+efficient.%0ATo+allow+the+heuristics+to+take+advantage+of+that+domain+specific+information%2C+set+a%0AstrengthComparatorClass+to+the+%40PlanningVariable+annotation%3A%0A100%0A%C2%A0+++%40PlanningVariable%28...%2C+strengthComparatorClass+%3D+CloudComputerStrengthComparator%0A.class%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0Apublic+class+CloudComputerStrengthComparator+implements+Comparator%3CCloudComputer%3E+%7B%0A%C2%A0+++public+int+compare%28CloudComputer+a%2C+CloudComputer+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getMultiplicand%28%29%2C+b.getMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28b.getCost%28%29%2C+a.getCost%28%29%29+%2F%2F+Descending+%28but+this+is%0Adebatable%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AIf+you+have+multiple+planning+value+classes+in+the+same+value+range%2C+the%0AstrengthComparatorClass+needs+to+implement+a+Comparator+of+a+common+superclass%0A%EF%81%9A+%28for+example+Comparator%3CObject%3E%29+and+be+able+to+handle+comparing+instances+of%0Athose+different+classes.%0AAlternatively%2C+you+can+also+set+a+strengthWeightFactoryClass+to+the+%40PlanningVariable+annotation%2C+so%0Ayou+have+access+to+the+rest+of+the+problem+facts+from+the+solution+too%3A%0A%C2%A0+++%40PlanningVariable%28...%2C+strengthWeightFactoryClass+%3D+RowStrengthWeightFactory.%0Aclass%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0ASee+sorted+selection+for+more+information.%0AStrength+should+be+implemented+ascending%3A+weaker+values+are+lower%2C+stronger%0A%EF%81%AA+values+are+higher.+For+example+in+bin+packing%3A+small+container+%3C+medium%0Acontainer+%3C+big+container.%0ANone+of+the+current+planning+variable+state+in+any+of+the+planning+entities+should+be+used+to+compare%0Aplanning+values.+During+construction+heuristics%2C+those+variables+are+likely+to+be+null.+For+example%2C%0Anone+of+the+row+variables+of+any+Queen+may+be+used+to+determine+the+strength+of+a+Row.%0A4.3.5.4.+Chained+Planning+Variable+%28TSP%2C+VRP%2C+%E2%80%A6%29%0ASome+use+cases%2C+such+as+TSP+and+Vehicle+Routing%2C+require+chaining.+This+means+the+planning+entities%0A101%0Apoint+to+each+other+and+form+a+chain.+By+modeling+the+problem+as+a+set+of+chains+%28instead+of+a+set+of%0Atrees%2Floops%29%2C+the+search+space+is+heavily+reduced.%0AA+planning+variable+that+is+chained+either%3A%0A%E2%80%A2+Directly+points+to+a+problem+fact+%28or+planning+entity%29%2C+which+is+called+an+anchor.%0A%E2%80%A2+Points+to+another+planning+entity+with+the+same+planning+variable%2C+which+recursively+points+to%0Aan+anchor.%0AHere+are+some+example+of+valid+and+invalid+chains%3A%0AEvery+initialized+planning+entity+is+part+of+an+open-ended+chain+that+begins+from+an+anchor.+A%0Avalid+model+means+that%3A%0A%E2%80%A2+A+chain+is+never+a+loop.+The+tail+is+always+open.%0A%E2%80%A2+Every+chain+always+has+exactly+one+anchor.+The+anchor+is+a+problem+fact%2C+never+a+planning%0Aentity.%0A%E2%80%A2+A+chain+is+never+a+tree%2C+it+is+always+a+line.+Every+anchor+or+planning+entity+has+at+most+one%0Atrailing+planning+entity.%0A%E2%80%A2+Every+initialized+planning+entity+is+part+of+a+chain.%0A%E2%80%A2+An+anchor+with+no+planning+entities+pointing+to+it%2C+is+also+considered+a+chain.%0A102%0A%EF%81%B1+A+planning+problem+instance+given+to+the+Solver+must+be+valid.%0AIf+your+constraints+dictate+a+closed+chain%2C+model+it+as+an+open-ended+chain+%28which%0A%EF%81%9A+is+easier+to+persist+in+a+database%29+and+implement+a+score+constraint+for+the+last%0Aentity+back+to+the+anchor.%0AThe+optimization+algorithms+and+built-in+Moves+do+chain+correction+to+guarantee+that+the+model%0Astays+valid%3A%0A%EF%81%B1+A+custom+Move+implementation+must+leave+the+model+in+a+valid+state.%0AFor+example%2C+in+TSP+the+anchor+is+a+Domicile+%28in+vehicle+routing+it+is+Vehicle%29%3A%0Apublic+class+Domicile+...+implements+Standstill+%7B%0A%C2%A0+++...%0A%C2%A0+++public+City+getCity%28%29+%7B...%7D%0A%7D%0AThe+anchor+%28which+is+a+problem+fact%29+and+the+planning+entity+implement+a+common+interface%2C+for%0Aexample+TSP%E2%80%99s+Standstill%3A%0A103%0Apublic+interface+Standstill+%7B%0A%C2%A0+++City+getCity%28%29%3B%0A%7D%0AThat+interface+is+the+return+type+of+the+planning+variable.+Furthermore%2C+the+planning+variable+is%0Achained.+For+example+TSP%E2%80%99s+Visit+%28in+vehicle+routing+it+is+Customer%29%3A%0A%40PlanningEntity%0Apublic+class+Visit+...+implements+Standstill+%7B%0A%C2%A0+++...%0A%C2%A0+++public+City+getCity%28%29+%7B...%7D%0A%C2%A0+++%40PlanningVariable%28graphType+%3D+PlanningVariableGraphType.CHAINED%2C%0A%C2%A0+++++++valueRangeProviderRefs+%3D+%7B%22domicileRange%22%2C+%22visitRange%22%7D%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setPreviousStandstill%28Standstill+previousStandstill%29+%7B%0A%C2%A0+++++++this.previousStandstill+%3D+previousStandstill%3B%0A%C2%A0+++%7D%0A%7D%0ANotice+how+two+value+range+providers+are+usually+combined%3A%0A%E2%80%A2+The+value+range+provider+that+holds+the+anchors%2C+for+example+domicileList.%0A%E2%80%A2+The+value+range+provider+that+holds+the+initialized+planning+entities%2C+for+example+visitList.%0A4.3.6.+Planning+Problem+and+Planning+Solution%0A4.3.6.1.+Planning+Problem+Instance%0AA+dataset+for+a+planning+problem+needs+to+be+wrapped+in+a+class+for+the+Solver+to+solve.+That%0Asolution+class+represents+both+the+planning+problem+and+%28if+solved%29+a+solution.+It+is+annotated+with+a%0A%40PlanningSolution+annotation.+For+example+in+n+queens%2C+the+solution+class+is+the+NQueens+class%2C+which%0Acontains+a+Column+list%2C+a+Row+list%2C+and+a+Queen+list.%0AA+planning+problem+is+actually+an+unsolved+planning+solution+or+-+stated+differently+-+an%0Auninitialized+solution.+For+example+in+n+queens%2C+that+NQueens+class+has+the+%40PlanningSolution%0Aannotation%2C+yet+every+Queen+in+an+unsolved+NQueens+class+is+not+yet+assigned+to+a+Row+%28their+row%0Aproperty+is+null%29.+That%E2%80%99s+not+a+feasible+solution.+It%E2%80%99s+not+even+a+possible+solution.+It%E2%80%99s+an+uninitialized%0Asolution.%0A104%0A4.3.6.2.+Solution+Class%0AA+solution+class+holds+all+problem+facts%2C+planning+entities+and+a+score.+It+is+annotated+with+a%0A%40PlanningSolution+annotation.+For+example%2C+an+NQueens+instance+holds+a+list+of+all+columns%2C+all+rows%0Aand+all+Queen+instances%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++%2F%2F+Problem+facts%0A%C2%A0+++private+int+n%3B%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++%2F%2F+Planning+entities%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++...%0A%7D%0AWithout+automated+scanning%2C+the+solver+configuration+also+needs+to+declare+the+planning+solution%0Aclass%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0A4.3.6.3.+Planning+Entities+of+a+Solution+%28%40PlanningEntityCollectionProperty%29%0APlanner+needs+to+extract+the+entity+instances+from+the+solution+instance.+It+gets+those+collection%28s%29+by%0Acalling+every+getter+%28or+field%29+that+is+annotated+with+%40PlanningEntityCollectionProperty%3A%0A105%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++%40PlanningEntityCollectionProperty%0A%C2%A0+++public+List%3CQueen%3E+getQueenList%28%29+%7B%0A%C2%A0+++++++return+queenList%3B%0A%C2%A0+++%7D%0A%7D%0AThere+can+be+multiple+%40PlanningEntityCollectionProperty+annotated+members.+Those+can+even%0Areturn+a+Collection+with+the+same+entity+class+type.+Instead+of+Collection%2C+it+can+also+return+an%0Aarray.%0AA+%40PlanningEntityCollectionProperty+annotation+needs+to+be+on+a+member+in+a%0A%EF%81%9A+class+with+a+%40PlanningSolution+annotation.+It+is+ignored+on+parent+classes+or%0Asubclasses+without+that+annotation.%0AIn+rare+cases%2C+a+planning+entity+might+be+a+singleton%3A+use+%40PlanningEntityProperty+on+its+getter+%28or%0Afield%29+instead.%0ABoth+annotations+can+also+be+auto+discovered+if+enabled.%0A4.3.6.4.+Score+of+a+Solution+%28%40PlanningScore%29%0AA+Solution+requires+a+score+property+%28or+field%29%2C+which+is+annotated+with+a+%40PlanningScore%0Aannotation.+The+score+property+is+null+if+the+the+score+hasn%E2%80%99t+been+calculated+yet.+The+score+property%0Ais+typed+to+the+specific+Score+implementation+of+your+use+case.+For+example%2C+NQueens+uses+a%0ASimpleScore%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+SimpleScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28SimpleScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%7D%0A106%0AMost+use+cases+use+a+HardSoftScore+instead%3A%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++...%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+HardSoftScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28HardSoftScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%7D%0ASome+use+cases+use+other+score+types.%0AThis+annotation+can+also+be+auto+discovered+if+enabled.%0A4.3.6.5.+Problem+Facts+of+a+Solution+%28%40ProblemFactCollectionProperty%29%0AFor+Drools+score+calculation%2C+Planner+needs+to+extract+the+problem+fact+instances+from+the+solution%0Ainstance.+It+gets+those+collection%28s%29+by+calling+every+method+%28or+field%29+that+is+annotated+with%0A%40ProblemFactCollectionProperty.+All+objects+returned+by+those+methods+will+be+inserted+into+the%0ADrools+session%2C+so+the+score+rules+can+access+them.+For+example+in+NQueens+all+Column+and+Row%0Ainstances+are+problem+facts.%0A107%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CColumn%3E+getColumnList%28%29+%7B%0A%C2%A0+++++++return+columnList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CRow%3E+getRowList%28%29+%7B%0A%C2%A0+++++++return+rowList%3B%0A%C2%A0+++%7D%0A%7D%0AAll+planning+entities+are+automatically+inserted+into+the+Drools+working+memory.+Do+note+add+an%0Aannotation+on+their+properties.%0AThe+problem+facts+methods+are+not+called+often%3A+at+most+only+once+per+solver+phase%0A%EF%81%9A+per+solver+thread.%0AThere+can+be+multiple+%40ProblemFactCollectionProperty+annotated+members.+Those+can+even+return%0Aa+Collection+with+the+same+class+type%2C+but+they+shouldn%E2%80%99t+return+the+same+instance+twice.+Instead+of%0ACollection%2C+it+can+also+return+an+array.%0AA+%40ProblemFactCollectionProperty+annotation+needs+to+be+on+a+member+in+a+class%0A%EF%81%9A+with+a+%40PlanningSolution+annotation.+It+is+ignored+on+parent+classes+or+subclasses%0Awithout+that+annotation.%0AIn+rare+cases%2C+a+problem+fact+might+be+a+singleton%3A+use+%40ProblemFactProperty+on+its+method+%28or+field%29%0Ainstead.%0ABoth+annotations+can+also+be+auto+discovered+if+enabled.%0A4.3.6.5.1.+Cached+Problem+Fact%0AA+cached+problem+fact+is+a+problem+fact+that+does+not+exist+in+the+real+domain+model%2C+but+is%0Acalculated+before+the+Solver+really+starts+solving.+The+problem+facts+methods+have+the+opportunity%0Ato+enrich+the+domain+model+with+such+cached+problem+facts%2C+which+can+lead+to+simpler+and+faster%0Ascore+constraints.%0AFor+example+in+examination%2C+a+cached+problem+fact+TopicConflict+is+created+for+every+two+Topics%0Awhich+share+at+least+one+Student.%0A108%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++private+List%3CTopicConflict%3E+calculateTopicConflictList%28%29+%7B%0A%C2%A0+++++++List%3CTopicConflict%3E+topicConflictList+%3D+new+ArrayList%3CTopicConflict%3E%28%29%3B%0A%C2%A0+++++++for+%28Topic+leftTopic+%3A+topicList%29+%7B%0A%C2%A0+++++++++++for+%28Topic+rightTopic+%3A+topicList%29+%7B%0A%C2%A0+++++++++++++++if+%28leftTopic.getId%28%29+%3C+rightTopic.getId%28%29%29+%7B%0A%C2%A0+++++++++++++++++++int+studentSize+%3D+0%3B%0A%C2%A0+++++++++++++++++++for+%28Student+student+%3A+leftTopic.getStudentList%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++if+%28rightTopic.getStudentList%28%29.contains%28student%29%29+%7B%0A%C2%A0+++++++++++++++++++++++++++studentSize%2B%2B%3B%0A%C2%A0+++++++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28studentSize+%3E+0%29+%7B%0A%C2%A0+++++++++++++++++++++++topicConflictList.add%28new+TopicConflict%28leftTopic%2C+rightTopic%2C%0AstudentSize%29%29%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+topicConflictList%3B%0A%C2%A0+++%7D%0AWhere+a+score+constraint+needs+to+check+that+no+two+exams+with+a+topic+that+shares+a+student+are%0Ascheduled+close+together+%28depending+on+the+constraint%3A+at+the+same+time%2C+in+a+row%2C+or+in+the+same%0Aday%29%2C+the+TopicConflict+instance+can+be+used+as+a+problem+fact%2C+rather+than+having+to+combine+every%0Atwo+Student+instances.%0A4.3.6.6.+Auto+Discover+Solution+Properties%0AInstead+of+configuring+each+property+%28or+field%29+annotation+explicitly%2C+some+can+also+be+deduced%0Aautomatically+by+Planner.+For+example%2C+on+the+cloud+balancing+example%3A%0A%40PlanningSolution%28autoDiscoverMemberType+%3D+AutoDiscoverMemberType.FIELD%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40ProblemFactCollectionProperty%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22computerRange%22%29+%2F%2F+Not+%28yet%29+auto+discovered%0A%C2%A0+++private+List%3CCloudComputer%3E+computerList%3B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40PlanningEntityCollectionProperty%0A%C2%A0+++private+List%3CCloudProcess%3E+processList%3B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0A109%0AThe+AutoDiscoverMemberType+can+be%3A%0A%E2%80%A2+NONE%3A+No+auto+discovery.%0A%E2%80%A2+FIELD%3A+Auto+discover+all+fields+on+the+%40PlanningSolution+class%0A%E2%80%A2+GETTER%3A+Auto+discover+all+getters+on+the+%40PlanningSolution+class%0AThe+automatic+annotation+is+based+on+the+field+type+%28or+getter+return+type%29%3A%0A%E2%80%A2+%40ProblemFactProperty%3A+when+it+isn%E2%80%99t+a+Collection%2C+an+array%2C+a+%40PlanningEntity+class+or+a+Score%0A%E2%80%A2+%40ProblemFactCollectionProperty%3A+when+it%E2%80%99s+a+Collection+%28or+array%29+of+a+type+that+isn%E2%80%99t+a%0A%40PlanningEntity+class%0A%E2%80%A2+%40PlanningEntityProperty%3A+when+it+is+a+configured+%40PlanningEntity+class+or+subclass%0A%E2%80%A2+%40PlanningEntityCollectionProperty%3A+when+it%E2%80%99s+a+Collection+%28or+array%29+of+a+type+that+is+a%0Aconfigured+%40PlanningEntity+class+or+subclass%0A%E2%80%A2+%40PlanningScore%3A+when+it+is+a+Score+or+subclass%0AThese+automatic+annotation+can+still+be+overwritten+per+field+%28or+getter%29.+Specifically%2C+a%0ABendableScore+always+needs+to+override+with+an+explicit+%40PlanningScore+annotation+to+define+the%0Anumber+of+hard+and+soft+levels.%0A4.3.6.7.+Cloning+a+Solution%0AMost+%28if+not+all%29+optimization+algorithms+clone+the+solution+each+time+they+encounter+a+new+best%0Asolution+%28so+they+can+recall+it+later%29+or+to+work+with+multiple+solutions+in+parallel.%0AThere+are+many+ways+to+clone%2C+such+as+a+shallow+clone%2C+deep+clone%2C+%E2%80%A6+This+context%0A%EF%81%9A+focuses+on+a+planning+clone.%0AA+planning+clone+of+a+solution+must+fulfill+these+requirements%3A%0A%E2%80%A2+The+clone+must+represent+the+same+planning+problem.+Usually+it+reuses+the+same+instances+of%0Athe+problem+facts+and+problem+fact+collections+as+the+original.%0A%E2%80%A2+The+clone+must+use+different%2C+cloned+instances+of+the+entities+and+entity+collections.+Changes+to%0Aan+original+Solution+entity%E2%80%99s+variables+must+not+affect+its+clone.%0A110%0AImplementing+a+planning+clone+method+is+hard%2C+therefore+you+do+not+need+to+implement+it.%0A4.3.6.7.1.+FieldAccessingSolutionCloner%0AThis+SolutionCloner+is+used+by+default.+It+works+well+for+most+use+cases.%0AWhen+the+FieldAccessingSolutionCloner+clones+one+of+your+collections+or+maps%2C+it%0Amay+not+recognize+the+implementation+and+replace+it+with+ArrayList%2C%0A%EF%81%B1+LinkedHashSet%2C+TreeSet%2C+LinkedHashMap+or+TreeMap+%28whichever+is+more+applicable%29+.+It%0Arecognizes+most+of+the+common+JDK+collection+and+map+implementations.%0AThe+FieldAccessingSolutionCloner+does+not+clone+problem+facts+by+default.+If+any+of+your+problem%0Afacts+needs+to+be+deep+cloned+for+a+planning+clone%2C+for+example+if+the+problem+fact+references+a%0Aplanning+entity+or+the+planning+solution%2C+mark+it+with+a+%40DeepPlanningClone+annotation%3A%0A%40DeepPlanningClone%0Apublic+class+SeatDesignationDependency+%7B%0A%C2%A0+++private+SeatDesignation+leftSeatDesignation%3B+%2F%2F+planning+entity%0A%C2%A0+++private+SeatDesignation+rightSeatDesignation%3B+%2F%2F+planning+entity%0A%C2%A0+++...%0A%7D%0AIn+the+example+above%2C+because+SeatDesignation+is+a+planning+entity+%28which+is+deep+planning+cloned%0A111%0Aautomatically%29%2C+SeatDesignationDependency+must+also+be+deep+planning+cloned.%0AAlternatively%2C+the+%40DeepPlanningClone+annotation+can+also+be+used+on+a+getter+method.%0A4.3.6.7.2.+Custom+Cloning+with+a+SolutionCloner%0ATo+use+a+custom+cloner%2C+configure+it+on+the+planning+solution%3A%0A%40PlanningSolution%28solutionCloner+%3D+NQueensSolutionCloner.class%29%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+a+NQueens+planning+clone+only+deep+clones+all+Queen+instances.+So+when+the+original%0Asolution+changes+%28later+on+during+planning%29+and+one+or+more+Queen+instances+change%2C+the+planning%0Aclone+isn%E2%80%99t+affected.%0Apublic+class+NQueensSolutionCloner+implements+SolutionCloner%3CNQueens%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+NQueens+cloneSolution%28CloneLedger+ledger%2C+NQueens+original%29+%7B%0A%C2%A0+++++++NQueens+clone+%3D+new+NQueens%28%29%3B%0A%C2%A0+++++++ledger.registerClone%28original%2C+clone%29%3B%0A%C2%A0+++++++clone.setId%28original.getId%28%29%29%3B%0A%C2%A0+++++++clone.setN%28original.getN%28%29%29%3B%0A%C2%A0+++++++clone.setColumnList%28original.getColumnList%28%29%29%3B%0A%C2%A0+++++++clone.setRowList%28original.getRowList%28%29%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+original.getQueenList%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+clonedQueenList+%3D+new+ArrayList%3CQueen%3E%28queenList.size%28%29%29%3B%0A%C2%A0+++++++for+%28Queen+originalQueen+%3A+queenList%29+%7B%0A%C2%A0+++++++++++Queen+cloneQueen+%3D+new+Queen%28%29%3B%0A%C2%A0+++++++++++ledger.registerClone%28originalQueen%2C+cloneQueen%29%3B%0A%C2%A0+++++++++++cloneQueen.setId%28originalQueen.getId%28%29%29%3B%0A%C2%A0+++++++++++cloneQueen.setColumn%28originalQueen.getColumn%28%29%29%3B%0A%C2%A0+++++++++++cloneQueen.setRow%28originalQueen.getRow%28%29%29%3B%0A%C2%A0+++++++++++clonedQueenList.add%28cloneQueen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++clone.setQueenList%28clonedQueenList%29%3B%0A%C2%A0+++++++clone.setScore%28original.getScore%28%29%29%3B%0A%C2%A0+++++++return+clone%3B%0A%C2%A0+++%7D%0A%7D%0AThe+cloneSolution%28%29+method+should+only+deep+clone+the+planning+entities.+Notice+that+the+problem%0Afacts%2C+such+as+Column+and+Row+are+normally+not+cloned%3A+even+their+List+instances+are+not+cloned.+If+the%0Aproblem+facts+were+cloned+too%2C+then+you+would+have+to+make+sure+that+the+new+planning+entity%0Aclones+also+refer+to+the+new+problem+facts+clones+used+by+the+cloned+solution.+For+example%2C+if+you%0A112%0Awere+to+clone+all+Row+instances%2C+then+each+Queen+clone+and+the+NQueens+clone+itself+should+refer+to%0Athose+new+Row+clones.%0ACloning+an+entity+with+a+chained+variable+is+devious%3A+a+variable+of+an+entity+A%0A%EF%81%B1+might+point+to+another+entity+B.+If+A+is+cloned%2C+then+its+variable+must+point+to+the%0Aclone+of+B%2C+not+the+original+B.%0A4.3.6.8.+Create+an+Uninitialized+Solution%0ACreate+a+Solution+instance+to+represent+your+planning+problem%E2%80%99s+dataset%2C+so+it+can+be+set+on+the%0ASolver+as+the+planning+problem+to+solve.+For+example+in+n+queens%2C+an+NQueens+instance+is+created%0Awith+the+required+Column+and+Row+instances+and+every+Queen+set+to+a+different+column+and+every+row%0Aset+to+null.%0A%C2%A0+++private+NQueens+createNQueens%28int+n%29+%7B%0A%C2%A0+++++++NQueens+nQueens+%3D+new+NQueens%28%29%3B%0A%C2%A0+++++++nQueens.setId%280L%29%3B%0A%C2%A0+++++++nQueens.setN%28n%29%3B%0A%C2%A0+++++++nQueens.setColumnList%28createColumnList%28nQueens%29%29%3B%0A%C2%A0+++++++nQueens.setRowList%28createRowList%28nQueens%29%29%3B%0A%C2%A0+++++++nQueens.setQueenList%28createQueenList%28nQueens%29%29%3B%0A%C2%A0+++++++return+nQueens%3B%0A%C2%A0+++%7D%0A%C2%A0+++private+List%3CQueen%3E+createQueenList%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+new+ArrayList%3CQueen%3E%28n%29%3B%0A%C2%A0+++++++long+id+%3D+0L%3B%0A%C2%A0+++++++for+%28Column+column+%3A+nQueens.getColumnList%28%29%29+%7B%0A%C2%A0+++++++++++Queen+queen+%3D+new+Queen%28%29%3B%0A%C2%A0+++++++++++queen.setId%28id%29%3B%0A%C2%A0+++++++++++id%2B%2B%3B%0A%C2%A0+++++++++++queen.setColumn%28column%29%3B%0A%C2%A0+++++++++++%2F%2F+Notice+that+we+leave+the+PlanningVariable+properties+on+null%0A%C2%A0+++++++++++queenList.add%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+queenList%3B%0A%C2%A0+++%7D%0AFigure+4.+Uninitialized+Solution+for+the+Four+Queens+Puzzle%0A113%0AUsually%2C+most+of+this+data+comes+from+your+data+layer%2C+and+your+Solution+implementation+just%0Aaggregates+that+data+and+creates+the+uninitialized+planning+entity+instances+to+plan%3A%0A%C2%A0+++++++private+void+createLectureList%28CourseSchedule+schedule%29+%7B%0A%C2%A0+++++++++++List%3CCourse%3E+courseList+%3D+schedule.getCourseList%28%29%3B%0A%C2%A0+++++++++++List%3CLecture%3E+lectureList+%3D+new+ArrayList%3CLecture%3E%28courseList.size%28%29%29%3B%0A%C2%A0+++++++++++long+id+%3D+0L%3B%0A%C2%A0+++++++++++for+%28Course+course+%3A+courseList%29+%7B%0A%C2%A0+++++++++++++++for+%28int+i+%3D+0%3B+i+%3C+course.getLectureSize%28%29%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++++++++++Lecture+lecture+%3D+new+Lecture%28%29%3B%0A%C2%A0+++++++++++++++++++lecture.setId%28id%29%3B%0A%C2%A0+++++++++++++++++++id%2B%2B%3B%0A%C2%A0+++++++++++++++++++lecture.setCourse%28course%29%3B%0A%C2%A0+++++++++++++++++++lecture.setLectureIndexInCourse%28i%29%3B%0A%C2%A0+++++++++++++++++++%2F%2F+Notice+that+we+leave+the+PlanningVariable+properties+%28period%0Aand+room%29+on+null%0A%C2%A0+++++++++++++++++++lectureList.add%28lecture%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++schedule.setLectureList%28lectureList%29%3B%0A%C2%A0+++++++%7D%0A4.4.+Use+the+Solver%0A4.4.1.+The+Solver+Interface%0AA+Solver+implementation+will+solve+your+planning+problem.%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++Solution_+solve%28Solution_+problem%29%3B%0A%C2%A0+++...%0A%7D%0AA+Solver+can+only+solve+one+planning+problem+instance+at+a+time.+A+Solver+should+only+be+accessed%0Afrom+a+single+thread%2C+except+for+the+methods+that+are+specifically+javadocced+as+being+thread-safe.+It%0Ais+built+with+a+SolverFactory%2C+there+is+no+need+to+implement+it+yourself.%0A4.4.2.+Solving+a+Problem%0ASolving+a+problem+is+quite+easy+once+you+have%3A%0A%E2%80%A2+A+Solver+built+from+a+solver+configuration%0A%E2%80%A2+A+Solution+that+represents+the+planning+problem+instance%0AJust+provide+the+planning+problem+as+argument+to+the+solve%28%29+method+and+it+will+return+the+best%0A114%0Asolution+found%3A%0A%C2%A0+++NQueens+bestSolution+%3D+solver.solve%28problem%29%3B%0AFor+example+in+n+queens%2C+the+solve%28%29+method+will+return+an+NQueens+instance+with+every+Queen%0Aassigned+to+a+Row.%0AFigure+5.+Best+Solution+for+the+Four+Queens+Puzzle+in+8ms+%28Also+an+Optimal+Solution%29%0AThe+solve%28Solution%29+method+can+take+a+long+time+%28depending+on+the+problem+size+and+the+solver%0Aconfiguration%29.+The+Solver+intelligently+wades+through+the+search+space+of+possible+solutions+and%0Aremembers+the+best+solution+it+encounters+during+solving.+Depending+on+a+number+of+factors%0A%28including+problem+size%2C+how+much+time+the+Solver+has%2C+the+solver+configuration%2C+%E2%80%A6%29%2C+that+best%0Asolution+might+or+might+not+be+an+optimal+solution.%0AThe+Solution+instance+given+to+the+method+solve%28Solution%29+is+changed+by+the%0ASolver%2C+but+do+not+mistake+it+for+the+best+solution.%0A%EF%81%9A+The+Solution+instance+returned+by+the+methods+solve%28Solution%29+or%0AgetBestSolution%28%29+is+most+likely+a+planning+clone+of+the+instance+given+to+the%0Amethod+solve%28Solution%29%2C+which+implies+it+is+a+different+instance.%0AThe+Solution+instance+given+to+the+solve%28Solution%29+method+does+not+need+to+be%0A%EF%81%9A+uninitialized.+It+can+be+partially+or+fully+initialized%2C+which+is+often+the+case+in%0Arepeated+planning.%0A4.4.3.+Environment+Mode%3A+Are+There+Bugs+in+my+Code%3F%0AThe+environment+mode+allows+you+to+detect+common+bugs+in+your+implementation.+It+does+not%0Aaffect+the+logging+level.%0AYou+can+set+the+environment+mode+in+the+solver+configuration+XML+file%3A%0A%3Csolver%3E%0A%C2%A0+%3CenvironmentMode%3EFAST_ASSERT%3C%2FenvironmentMode%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AA+solver+has+a+single+Random+instance.+Some+solver+configurations+use+the+Random+instance+a+lot+more%0A115%0Athan+others.+For+example%2C+Simulated+Annealing+depends+highly+on+random+numbers%2C+while+Tabu%0ASearch+only+depends+on+it+to+deal+with+score+ties.+The+environment+mode+influences+the+seed+of+that%0ARandom+instance.%0AThese+are+the+environment+modes%3A%0A4.4.3.1.+FULL_ASSERT%0AThe+FULL_ASSERT+mode+turns+on+all+assertions+%28such+as+assert+that+the+incremental+score%0Acalculation+is+uncorrupted+for+each+move%29+to+fail-fast+on+a+bug+in+a+Move+implementation%2C+a+score%0Arule%2C+the+rule+engine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+also+intrusive+because+it+calls+the%0Amethod+calculateScore%28%29+more+frequently+than+a+non-assert+mode.%0AThe+FULL_ASSERT+mode+is+horribly+slow+%28because+it+does+not+rely+on+incremental+score%0Acalculation%29.%0A4.4.3.2.+NON_INTRUSIVE_FULL_ASSERT%0AThe+NON_INTRUSIVE_FULL_ASSERT+turns+on+several+assertions+to+fail-fast+on+a+bug+in+a+Move%0Aimplementation%2C+a+score+rule%2C+the+rule+engine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+non-intrusive+because+it+does+not+call%0Athe+method+calculateScore%28%29+more+frequently+than+a+non+assert+mode.%0AThe+NON_INTRUSIVE_FULL_ASSERT+mode+is+horribly+slow+%28because+it+does+not+rely+on+incremental%0Ascore+calculation%29.%0A4.4.3.3.+FAST_ASSERT%0AThe+FAST_ASSERT+mode+turns+on+most+assertions+%28such+as+assert+that+an+undoMove%E2%80%99s+score+is+the%0Asame+as+before+the+Move%29+to+fail-fast+on+a+bug+in+a+Move+implementation%2C+a+score+rule%2C+the+rule%0Aengine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+also+intrusive+because+it+calls+the%0Amethod+calculateScore%28%29+more+frequently+than+a+non+assert+mode.%0AThe+FAST_ASSERT+mode+is+slow.%0AIt+is+recommended+to+write+a+test+case+that+does+a+short+run+of+your+planning+problem+with+the%0AFAST_ASSERT+mode+on.%0A4.4.3.4.+REPRODUCIBLE+%28default%29%0AThe+reproducible+mode+is+the+default+mode+because+it+is+recommended+during+development.+In+this%0Amode%2C+two+runs+in+the+same+Planner+version+will+execute+the+same+code+in+the+same+order.+Those%0Atwo+runs+will+have+the+same+result+at+every+step%2C+except+if+the+note+below+applies.+This+enables%0Ayou+to+reproduce+bugs+consistently.+It+also+allows+you+to+benchmark+certain+refactorings+%28such+as+a%0Ascore+constraint+performance+optimization%29+fairly+across+runs.%0A116%0ADespite+the+reproducible+mode%2C+your+application+might+still+not+be+fully%0Areproducible+because+of%3A%0A%E2%80%A2+Use+of+HashSet+%28or+another+Collection+which+has+an+inconsistent+order+between%0AJVM+runs%29+for+collections+of+planning+entities+or+planning+values+%28but+not%0Anormal+problem+facts%29%2C+especially+in+the+Solution+implementation.+Replace+it%0A%EF%81%9A+with+LinkedHashSet.%0A%E2%80%A2+Combining+a+time+gradient+dependent+algorithms+%28most+notably+Simulated%0AAnnealing%29+together+with+time+spent+termination.+A+sufficiently+large%0Adifference+in+allocated+CPU+time+will+influence+the+time+gradient+values.%0AReplace+Simulated+Annealing+with+Late+Acceptance.+Or+instead%2C+replace+time%0Aspent+termination+with+step+count+termination.%0AThe+reproducible+mode+can+be+slightly+slower+than+the+non-reproducible+mode.+If+your+production%0Aenvironment+can+benefit+from+reproducibility%2C+use+this+mode+in+production.%0AIn+practice%2C+this+mode+uses+the+default%2C+fixed+random+seed+if+no+seed+is+specified%2C+and+it+also+disables%0Acertain+concurrency+optimizations+%28such+as+work+stealing%29.%0A4.4.3.5.+NON_REPRODUCIBLE%0AThe+non-reproducible+mode+can+be+slightly+faster+than+the+reproducible+mode.+Avoid+using+it%0Aduring+development+as+it+makes+debugging+and+bug+fixing+painful.+If+your+production+environment%0Adoesn%E2%80%99t+care+about+reproducibility%2C+use+this+mode+in+production.%0AIn+practice%2C+this+mode+uses+no+fixed+random+seed+if+no+seed+is+specified.%0A4.4.4.+Logging+Level%3A+What+is+the+Solver+Doing%3F%0AThe+best+way+to+illuminate+the+black+box+that+is+a+Solver%2C+is+to+play+with+the+logging+level%3A%0A%E2%80%A2+error%3A+Log+errors%2C+except+those+that+are+thrown+to+the+calling+code+as+a+RuntimeException.%0AIf+an+error+happens%2C+Planner+normally+fails+fast%3A+it+throws+a+subclass+of%0ARuntimeException+with+a+detailed+message+to+the+calling+code.+It+does+not+log+it%0Aas+an+error+itself+to+avoid+duplicate+log+messages.+Except+if+the+calling+code%0A%EF%81%9A+explicitly+catches+and+eats+that+RuntimeException%2C+a+Thread%27s+default%0AExceptionHandler+will+log+it+as+an+error+anyway.+Meanwhile%2C+the+code+is%0Adisrupted+from+doing+further+harm+or+obfuscating+the+error.%0A%E2%80%A2+warn%3A+Log+suspicious+circumstances.%0A%E2%80%A2+info%3A+Log+every+phase+and+the+solver+itself.+See+scope+overview.%0A%E2%80%A2+debug%3A+Log+every+step+of+every+phase.+See+scope+overview.%0A%E2%80%A2+trace%3A+Log+every+move+of+every+step+of+every+phase.+See+scope+overview.%0A117%0ATurning+on+trace+logging%2C+will+slow+down+performance+considerably%3A+it+is+often%0Afour+times+slower.+However%2C+it+is+invaluable+during+development+to+discover+a%0Abottleneck.%0AEven+debug+logging+can+slow+down+performance+considerably+for+fast+stepping%0Aalgorithms+%28such+as+Late+Acceptance+and+Simulated+Annealing%29%2C+but+not+for+slow%0A%EF%81%9A+stepping+algorithms+%28such+as+Tabu+Search%29.%0ABoth+cause+congestion+in+multithreaded+solving+with+most+appenders%2C+see+below.%0AIn+Eclipse%2C+debug+logging+to+the+console+tends+to+cause+congestion+with+a+score%0Acalculation+speeds+above+10+000+per+second.+Nor+IntelliJ%2C+nor+the+Maven+command%0Aline+suffer+from+this+problem.%0AFor+example%2C+set+it+to+debug+logging%2C+to+see+when+the+phases+end+and+how+fast+steps+are+taken%3A%0AINFO++Solving+started%3A+time+spent+%283%29%2C+best+score+%28-4init%2F0%29%2C+random+%28JDK+with+seed%0A0%29.%0ADEBUG+++++CH+step+%280%29%2C+time+spent+%285%29%2C+score+%28-3init%2F0%29%2C+selected+move+count+%281%29%2C%0Apicked+move+%28Queen-2+%7Bnull+-%3E+Row-0%7D%29.%0ADEBUG+++++CH+step+%281%29%2C+time+spent+%287%29%2C+score+%28-2init%2F0%29%2C+selected+move+count+%283%29%2C%0Apicked+move+%28Queen-1+%7Bnull+-%3E+Row-2%7D%29.%0ADEBUG+++++CH+step+%282%29%2C+time+spent+%2810%29%2C+score+%28-1init%2F0%29%2C+selected+move+count+%284%29%2C%0Apicked+move+%28Queen-3+%7Bnull+-%3E+Row-3%7D%29.%0ADEBUG+++++CH+step+%283%29%2C+time+spent+%2812%29%2C+score+%28-1%29%2C+selected+move+count+%284%29%2C+picked%0Amove+%28Queen-0+%7Bnull+-%3E+Row-1%7D%29.%0AINFO++Construction+Heuristic+phase+%280%29+ended%3A+time+spent+%2812%29%2C+best+score+%28-1%29%2C+score%0Acalculation+speed+%289000%2Fsec%29%2C+step+total+%284%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%2819%29%2C+score+%28-1%29%2C+++++best+score+%28-1%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-2+-%3E+Row-3%7D%29.%0ADEBUG+++++LS+step+%281%29%2C+time+spent+%2824%29%2C+score+%280%29%2C+new+best+score+%280%29%2C%0Aaccepted%2Fselected+move+count+%289%2F12%29%2C+picked+move+%28Queen-3+%7BRow-3+-%3E+Row-2%7D%29.%0AINFO++Local+Search+phase+%281%29+ended%3A+time+spent+%2824%29%2C+best+score+%280%29%2C+score+calculation%0Aspeed+%284000%2Fsec%29%2C+step+total+%282%29.%0AINFO++Solving+ended%3A+time+spent+%2824%29%2C+best+score+%280%29%2C+score+calculation+speed%0A%287000%2Fsec%29%2C+phase+total+%282%29%2C+environment+mode+%28REPRODUCIBLE%29.%0AAll+time+spent+values+are+in+milliseconds.%0AEverything+is+logged+to+SLF4J%2C+which+is+a+simple+logging+facade+which+delegates+every+log+message%0Ato+Logback%2C+Apache+Commons+Logging%2C+Log4j+or+java.util.logging.+Add+a+dependency+to+the+logging%0Aadaptor+for+your+logging+framework+of+choice.%0AIf+you+are+not+using+any+logging+framework+yet%2C+use+Logback+by+adding+this+Maven+dependency%0A%28there+is+no+need+to+add+an+extra+bridge+dependency%29%3A%0A118%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Ech.qos.logback%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Elogback-classic%3C%2FartifactId%3E%0A%C2%A0+++++%3Cversion%3E1.x%3C%2Fversion%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AConfigure+the+logging+level+on+the+org.optaplanner+package+in+your+logback.xml+file%3A%0A%3Cconfiguration%3E%0A%C2%A0+%3Clogger+name%3D%22org.optaplanner%22+level%3D%22debug%22%2F%3E%0A%C2%A0+...%0A%3C%2Fconfiguration%3E%0AIf+it+isn%E2%80%99t+picked+up%2C+temporarily+add+the+system+property+-Dlogback.debug%3Dtrue+to+figure+out+why.%0AWhen+running+multiple+solvers+or+one+multithreaded+solver%2C+most+appenders%0A%EF%81%9A+%28including+the+console%29+cause+congestion+with+debug+and+trace+logging.+Switch+to+an%0Aasync+appender+to+avoid+this+problem+or+turn+off+debug+logging.%0AIf+instead%2C+you+are+still+using+Log4J+1.x+%28and+you+do+not+want+to+switch+to+its+faster+successor%2C%0ALogback%29%2C+add+the+bridge+dependency%3A%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.slf4j%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eslf4j-log4j12%3C%2FartifactId%3E%0A%C2%A0+++++%3Cversion%3E1.x%3C%2Fversion%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AAnd+configure+the+logging+level+on+the+package+org.optaplanner+in+your+log4j.xml+file%3A%0A%3Clog4j%3Aconfiguration+xmlns%3Alog4j%3D%22http%3A%2F%2Fjakarta.apache.org%2Flog4j%2F%22%3E%0A%C2%A0+%3Ccategory+name%3D%22org.optaplanner%22%3E%0A%C2%A0+++%3Cpriority+value%3D%22debug%22+%2F%3E%0A%C2%A0+%3C%2Fcategory%3E%0A%C2%A0+...%0A%3C%2Flog4j%3Aconfiguration%3E%0A119%0AIn+a+multitenant+application%2C+multiple+Solver+instances+might+be+running+at+the%0Asame+time.+To+separate+their+logging+into+distinct+files%2C+surround+the+solve%28%29+call%0Awith+an+MDC%3A%0A%C2%A0+++++++MDC.put%28%22tenant.name%22%2CtenantName%29%3B%0A%C2%A0+++++++MySolution+bestSolution+%3D+solver.solve%28problem%29%3B%0A%C2%A0+++++++MDC.remove%28%22tenant.name%22%29%3B%0AThen+configure+your+logger+to+use+different+files+for+each+%24%7Btenant.name%7D.+For%0Aexample+in+Logback%2C+use+a+SiftingAppender+in+logback.xml%3A%0A%EF%81%9A+%C2%A0+%3Cappender+name%3D%22fileAppender%22+class%3D%22ch.qos.logback.classic.sift.SiftingAppender%22%3E%0A%C2%A0+++%3Cdiscriminator%3E%0A%C2%A0+++++%3Ckey%3Etenant.name%3C%2Fkey%3E%0A%C2%A0+++++%3CdefaultValue%3Eunknown%3C%2FdefaultValue%3E%0A%C2%A0+++%3C%2Fdiscriminator%3E%0A%C2%A0+++%3Csift%3E%0A%C2%A0+++++%3Cappender+name%3D%22fileAppender.%24%7Btenant.name%7D%22+class%3D%0A%22...FileAppender%22%3E%0A%C2%A0+++++++%3Cfile%3Elocal%2Flog%2Foptaplanner-%24%7Btenant.name%7D.log%3C%2Ffile%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2Fappender%3E%0A%C2%A0+++%3C%2Fsift%3E%0A%C2%A0+%3C%2Fappender%3E%0A4.4.5.+Random+Number+Generator%0AMany+heuristics+and+metaheuristics+depend+on+a+pseudorandom+number+generator+for+move%0Aselection%2C+to+resolve+score+ties%2C+probability+based+move+acceptance%2C+%E2%80%A6+During+solving%2C+the+same%0ARandom+instance+is+reused+to+improve+reproducibility%2C+performance+and+uniform+distribution+of%0Arandom+values.%0ATo+change+the+random+seed+of+that+Random+instance%2C+specify+a+randomSeed%3A%0A%3Csolver%3E%0A%C2%A0+%3CrandomSeed%3E0%3C%2FrandomSeed%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ATo+change+the+pseudorandom+number+generator+implementation%2C+specify+a+randomType%3A%0A120%0A%3Csolver%3E%0A%C2%A0+%3CrandomType%3EMERSENNE_TWISTER%3C%2FrandomType%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThe+following+types+are+supported%3A%0A%E2%80%A2+JDK+%28default%29%3A+Standard+implementation+%28java.util.Random%29.%0A%E2%80%A2+MERSENNE_TWISTER%3A+Implementation+by+Commons+Math.%0A%E2%80%A2+WELL512A%2C+WELL1024A%2C+WELL19937A%2C+WELL19937C%2C+WELL44497A+and+WELL44497B%3A+Implementation+by%0ACommons+Math.%0AFor+most+use+cases%2C+the+randomType+has+no+significant+impact+on+the+average+quality+of+the+best%0Asolution+on+multiple+datasets.+If+you+want+to+confirm+this+on+your+use+case%2C+use+the+benchmarker.%0A121%0AChapter+5.+Score+Calculation%0A5.1.+Score+Terminology%0A5.1.1.+What+is+a+Score%3F%0AEvery+Solution+has+a+score.+The+score+is+an+objective+way+to+compare+two+solutions.+The+solution%0Awith+the+higher+score+is+better.+The+Solver+aims+to+find+the+Solution+with+the+highest+Score+of+all%0Apossible+solutions.+The+best+solution+is+the+Solution+with+the+highest+Score+that+Solver+has%0Aencountered+during+solving%2C+which+might+be+the+optimal+solution.%0APlanner+cannot+automatically+know+which+Solution+is+best+for+your+business%2C+so+you+need+to+tell+it%0Ahow+to+calculate+the+score+of+a+given+Solution+according+to+your+business+needs.+If+you+forget+or+are%0Aunable+to+implement+an+important+business+constraint%2C+the+solution+is+probably+useless%3A%0A5.1.2.+Formalize+the+Business+Constraints%0ATo+implement+a+verbal+business+constraint%2C+it+needs+to+be+formalized+as+a+score+constraint.+Luckily%2C%0Adefining+constraints+in+Planner+is+very+flexible+through+the+following+score+techniques%3A%0A%E2%80%A2+Score+signum+%28positive+or+negative%29%3A+maximize+or+minimize+a+constraint+type%0A%E2%80%A2+Score+weight%3A+put+a+cost%2Fprofit+on+a+constraint+type%0A122%0A%E2%80%A2+Score+level+%28hard%2C+soft%2C+%E2%80%A6%29%3A+prioritize+a+group+of+constraint+types%0A%E2%80%A2+Pareto+scoring+%28rarely+used%29%0ATake+the+time+to+acquaint+yourself+with+the+first+three+techniques.+Once+you+understand+them%2C%0Aformalizing+most+business+constraints+becomes+straightforward.%0A5.1.3.+Score+Constraint+Signum+%28Positive+or+Negative%29%0AAll+score+techniques+are+based+on+constraints.+A+constraint+can+be+a+simple+pattern+%28such+as%0AMaximize+the+apple+harvest+in+the+solution%29+or+a+more+complex+pattern.+A+positive+constraint+is+a%0Aconstraint+you+want+to+maximize.+A+negative+constraint+is+a+constraint+you+want+to+minimize.%0AThe+image+above+illustrates+that+the+optimal+solution+always+has+the+highest+score%2C+regardless+if%0Athe+constraints+are+positive+or+negative.%0AMost+planning+problems+have+only+negative+constraints+and+therefore+have+a+negative+score.+In+that%0Acase%2C+the+score+is+the+sum+of+the+weight+of+the+negative+constraints+being+broken%2C+with+a+perfect%0Ascore+of+0.+This+explains+why+the+score+of+a+solution+of+four+queens+is+the+negative+of+the+number+of%0Aqueen+pairs+which+can+attack+each+other.%0ANegative+and+positive+constraints+can+be+combined%2C+even+in+the+same+score+level.%0A123%0ADo+not+presume+that+your+business+knows+all+its+score+constraints+in+advance.%0A%EF%81%9A+Expect+score+constraints+to+be+added+or+changed+after+the+first+releases.%0AWhen+a+constraint+activates+%28because+the+negative+constraint+is+broken+or+the+positive+constraint+is%0Afulfilled%29+on+a+certain+planning+entity+set%2C+it+is+called+a+constraint+match.%0A5.1.4.+Score+Constraint+Weight%0ANot+all+score+constraints+are+equally+important.+If+breaking+one+constraint+is+equally+bad+as%0Abreaking+another+constraint+x+times%2C+then+those+two+constraints+have+a+different+weight+%28but+they%0Aare+in+the+same+score+level%29.+For+example+in+vehicle+routing%2C+you+can+make+one+%22unhappy+driver%22%0Aconstraint+match+count+as+much+as+two+%22fuel+tank+usage%22+constraint+matches%3A%0AScore+weighting+is+easy+in+use+cases+where+you+can+put+a+price+tag+on+everything.+In+that+case%2C+the%0Apositive+constraints+maximize+revenue+and+the+negative+constraints+minimize+expenses%2C+so+together%0Athey+maximize+profit.+Alternatively%2C+score+weighting+is+also+often+used+to+create+social+fairness.+For%0Aexample%2C+a+nurse%2C+who+requests+a+free+day%2C+pays+a+higher+weight+on+New+Years+eve+than+on+a+normal%0Aday.%0AThe+weight+of+a+constraint+match+can+be+dynamically+based+on+the+planning+entities+involved.+For%0Aexample+in+cloud+balance%2C+the+weight+of+the+soft+constraint+match+for+an+active+Computer+is+the+cost%0Aof+that+Computer+%28which+differs+per+computer%29.%0APutting+a+good+weight+on+a+constraint+can+be+a+difficult+analytical+decision%2C+because+it+is+about%0A124%0Amaking+choices+and+tradeoffs+with+other+constraints.+Don%E2%80%99t+spend+too+much+time+on+it+at+the+start+of%0Aan+implementation.+A+non-accurate+weight+is+less+damaging+than+mediocre+algorithms%3A%0AWhen+deciding+the+weights+of+some+constraints+is+debatable%2C+it%E2%80%99s+recommended+to%0Amake+them+configurable+at+runtime%2C+as+demonstrated+in+the+exam+timetabling%0A%EF%81%9A+example+with+the+InstitutionParametrization+class.+This+allow+the+end-user+to%0Arecalibrate+constraint+weights+in+the+user+interface+and+immediately+discover+the%0Aimpact+of+the+new+weights+by+running+the+solver+again.%0AMost+use+cases+use+a+Score+with+int+weights%2C+such+as+HardSoftScore.%0A5.1.5.+Score+Constraint+Level+%28hard%2C+soft%2C+%E2%80%A6%29%0ASometimes+a+score+constraint+outranks+another+score+constraint%2C+no+matter+how+many+times+the%0Aother+is+broken.+In+that+case%2C+those+score+constraints+are+in+different+levels.+For+example%2C+a+nurse%0Acannot+do+two+shifts+at+the+same+time+%28due+to+the+constraints+of+physical+reality%29%2C+this+outranks+all%0Anurse+happiness+constraints.%0AMost+use+cases+have+only+two+score+levels%2C+hard+and+soft.+The+levels+of+two+scores+are+compared%0Alexicographically.+The+first+score+level+gets+compared+first.+If+those+differ%2C+the+remaining+score+levels%0Aare+ignored.+For+example%2C+a+score+that+breaks+0+hard+constraints+and+1000000+soft+constraints+is%0Abetter+than+a+score+that+breaks+1+hard+constraint+and+0+soft+constraints.%0A125%0AIf+there+are+two+%28or+more%29+score+levels%2C+for+example+a+hard+and+soft+level%2C+then+a+score+is+feasible+if%0Ano+hard+constraints+are+broken.%0ABy+default%2C+Planner+will+always+assign+all+planning+variables+a+planning+value.+If%0Athere+is+no+feasible+solution%2C+this+means+the+best+solution+will+be+infeasible.+To%0A%EF%81%9A+instead+leave+some+of+the+planning+entities+unassigned%2C+apply+overconstrained%0Aplanning.%0AFor+each+constraint%2C+you+need+to+pick+a+score+level%2C+a+score+weight+and+a+score+signum.+For+example%3A%0A-1soft+which+has+score+level+of+soft%2C+a+weight+of+1+and+a+negative+signum.+Do+not+use+a+big%0Aconstraint+weight+when+your+business+actually+wants+different+score+levels.+That+hack%2C+known+as%0Ascore+folding%2C+is+broken%3A%0A126%0AYour+business+might+tell+you+that+your+hard+constraints+all+have+the+same+weight%2C%0Abecause+they+cannot+be+broken+%28so+the+weight+does+not+matter%29.+This+is+not+true%0Abecause+if+no+feasible+solution+exists+for+a+specific+dataset%2C+the+least+infeasible%0Asolution+allows+the+business+to+estimate+how+many+business+resources+they+are%0A%EF%81%9A+lacking.+For+example+in+cloud+balancing%2C+how+many+new+computers+to+buy.%0AFurthermore%2C+it+will+likely+create+a+score+trap.+For+example+in+cloud+balance+if+a%0AComputer+has+seven+CPU+too+little+for+its+Processes%2C+then+it+must+be+weighted+seven%0Atimes+as+much+as+if+it+had+only+one+CPU+too+little.%0AThree+or+more+score+levels+are+supported.+For+example%3A+a+company+might+decide+that+profit%0Aoutranks+employee+satisfaction+%28or+vice+versa%29%2C+while+both+are+outranked+by+the+constraints+of%0Aphysical+reality.%0ATo+model+fairness+or+load+balancing%2C+there+is+no+need+to+use+lots+of+score+levels%0A%EF%81%9A+%28even+though+Planner+can+handle+many+score+levels%29.%0AMost+use+cases+use+a+Score+with+two+weights%2C+such+as+HardSoftScore.%0A5.1.6.+Pareto+Scoring+%28AKA+Multi-objective+Optimization+Scoring%29%0AFar+less+common+is+the+use+case+of+pareto+optimization%2C+which+is+also+known+under+the+more%0Aconfusing+term+multi-objective+optimization.+In+pareto+scoring%2C+score+constraints+are+in+the+same%0A127%0Ascore+level%2C+yet+they+are+not+weighted+against+each+other.+When+two+scores+are+compared%2C+each+of%0Athe+score+constraints+are+compared+individually+and+the+score+with+the+most+dominating+score%0Aconstraints+wins.+Pareto+scoring+can+even+be+combined+with+score+levels+and+score+constraint%0Aweighting.%0AConsider+this+example+with+positive+constraints%2C+where+we+want+to+get+the+most+apples+and+oranges.%0ASince+it+is+impossible+to+compare+apples+and+oranges%2C+we+can+not+weight+them+against+each+other.%0AYet%2C+despite+that+we+can+not+compare+them%2C+we+can+state+that+two+apples+are+better+then+one+apple.%0ASimilarly%2C+we+can+state+that+two+apples+and+one+orange+are+better+than+just+one+orange.+So+despite%0Aour+inability+to+compare+some+Scores+conclusively+%28at+which+point+we+declare+them+equal%29%2C+we+can%0Afind+a+set+of+optimal+scores.+Those+are+called+pareto+optimal.%0AScores+are+considered+equal+far+more+often.+It+is+left+up+to+a+human+to+choose+the+better+out+of+a+set%0Aof+best+solutions+%28with+equal+scores%29+found+by+Planner.+In+the+example+above%2C+the+user+must+choose%0Abetween+solution+A+%28three+apples+and+one+orange%29+and+solution+B+%28one+apple+and+six+oranges%29.+It+is%0Aguaranteed+that+Planner+has+not+found+another+solution+which+has+more+apples+or+more+oranges+or%0Aeven+a+better+combination+of+both+%28such+as+two+apples+and+three+oranges%29.%0ATo+implement+pareto+scoring+in+Planner%2C+implement+a+custom+ScoreDefinition+and+Score+%28and%0Areplace+the+BestSolutionRecaller%29.+Future+versions+will+provide+out-of-the-box+support.%0A128%0AA+pareto+Score%27s+compareTo+method+is+not+transitive+because+it+does+a+pareto%0Acomparison.+For+example%3A+having+two+apples+is+greater+than+one+apple.+One+apple%0Ais+equal+to+One+orange.+Yet%2C+two+apples+are+not+greater+than+one+orange+%28but%0A%EF%81%9A+actually+equal%29.+Pareto+comparison+violates+the+contract+of+the+interface%0Ajava.lang.Comparable%27s+compareTo+method%2C+but+Planners+systems+are+pareto%0Acomparison+safe%2C+unless+explicitly+stated+otherwise+in+this+documentation.%0A5.1.7.+Combining+Score+Techniques%0AAll+the+score+techniques+mentioned+above%2C+can+be+combined+seamlessly%3A%0A5.1.8.+Score+interface%0AA+score+is+represented+by+the+Score+interface%2C+which+naturally+extends+Comparable%3A%0Apublic+interface+Score%3C...%3E+extends+Comparable%3C...%3E+%7B%0A%C2%A0+++...%0A%7D%0AThe+Score+implementation+to+use+depends+on+your+use+case.+Your+score+might+not+efficiently+fit+in+a%0Asingle+long+value.+Planner+has+several+built-in+Score+implementations%2C+but+you+can+implement+a%0Acustom+Score+too.+Most+use+cases+tend+to+use+the+built-in+HardSoftScore.%0A129%0AAll+Score+implementations+also+have+an+initScore+%28which+is+an+int%29.+It+is+mostly+intended+for%0Ainternal+use+in+Planner%3A+it+is+the+negative+number+of+uninitialized+planning+variables.+From+a+user%E2%80%99s%0Aperspective+this+is+0%2C+unless+a+Construction+Heuristic+is+terminated+before+it+could+initialize+all%0Aplanning+variables+%28in+which+case+Score.isSolutionInitialized%28%29+returns+false%29.%0AThe+Score+implementation+%28for+example+HardSoftScore%29+must+be+the+same+throughout+a+Solver%0Aruntime.+The+Score+implementation+is+configured+in+the+solution+domain+class%3A%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%7D%0A5.1.9.+Avoid+Floating+Point+Numbers+in+Score+Calculation%0AAvoid+the+use+of+float+or+double+in+score+calculation.+Use+BigDecimal+or+scaled+long+instead.%0AFloating+point+numbers+%28float+and+double%29+cannot+represent+a+decimal+number+correctly.+For%0Aexample%3A+a+double+cannot+hold+the+value+0.05+correctly.+Instead%2C+it+holds+the+nearest+representable%0A130%0Avalue.+Arithmetic+%28including+addition+and+subtraction%29+with+floating+point+numbers%2C+especially+for%0Aplanning+problems%2C+leads+to+incorrect+decisions%3A%0AAdditionally%2C+floating+point+number+addition+is+not+associative%3A%0ASystem.out.println%28+%28%280.01+%2B+0.02%29+%2B+0.03%29+%3D%3D+%280.01+%2B+%280.02+%2B+0.03%29%29+%29%3B+%2F%2F+returns%0Afalse%0AThis+leads+to+score+corruption.%0ADecimal+numbers+%28BigDecimal%29+have+none+of+these+problems.%0ABigDecimal+arithmetic+is+considerably+slower+than+int%2C+long+or+double+arithmetic.%0AIn+experiments+we+have+seen+the+score+calculation+take+five+times+longer.%0A%EF%81%9A+Therefore%2C+in+many+cases%2C+it+can+be+worthwhile+to+multiply+all+numbers+for+a+single%0Ascore+weight+by+a+plural+of+ten%2C+so+the+score+weight+fits+in+a+scaled+int+or+long.+For%0Aexample%2C+if+we+multiply+all+weights+by+1000%2C+a+fuelCost+of+0.07+becomes+a%0AfuelCostMillis+of+70+and+no+longer+uses+a+decimal+score+weight.%0A131%0A5.2.+Choose+a+Score+Type%0ADepending+on+the+number+of+score+levels+and+type+of+score+weights+you+need%2C+choose+a+Score+type.%0AMost+use+cases+use+a+HardSoftScore.%0ATo+properly+write+a+Score+to+a+database+%28with+JPA%2FHibernate%29+or+to+XML%2FJSON+%28with%0A%EF%81%9A+XStream%2FJAXB%2FJackson%29%2C+see+the+integration+chapter.%0A5.2.1.+SimpleScore%0AA+SimpleScore+has+a+single+int+value%2C+for+example+-123.+It+has+a+single+score+level.%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+SimpleScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+SimpleLongScore+uses+a+long+value+instead+of+an+int+value.%0A%E2%80%A2+SimpleDoubleScore+uses+a+double+value+instead+of+an+int+value.+Not+recommended+to+use.%0A%E2%80%A2+SimpleBigDecimalScore+uses+a+BigDecimal+value+instead+of+an+int+value.%0A5.2.2.+HardSoftScore+%28Recommended%29%0AA+HardSoftScore+has+a+hard+int+value+and+a+soft+int+value%2C+for+example+-123hard%2F-456soft.+It+has+two%0Ascore+levels+%28hard+and+soft%29.%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+HardSoftLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+HardSoftDoubleScore+uses+double+values+instead+of+int+values.+Not+recommended+to+use.%0A%E2%80%A2+HardSoftBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.3.+HardMediumSoftScore%0AA+HardMediumSoftScore+which+has+a+hard+int+value%2C+a+medium+int+value+and+a+soft+int+value%2C+for%0Aexample+-123hard%2F-456medium%2F-789soft.+It+has+three+score+levels+%28hard%2C+medium+and+soft%29.+The+hard%0Alevel+determines+if+the+solution+is+feasible%2C+and+the+medium+level+and+soft+level+score+values%0Adetermine+how+well+the+solution+meets+business+goals.+Higher+medium+values+take+precedence+over%0Asoft+values+irrespective+of+the+soft+value.%0A132%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardMediumSoftScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+HardMediumSoftLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+HardMediumSoftBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.4.+BendableScore%0AA+BendableScore+has+a+configurable+number+of+score+levels.+It+has+an+array+of+hard+int+values+and+an%0Aarray+of+soft+int+values%2C+for+example+with+two+hard+levels+and+three+soft+levels%2C+the+score+can+be+%5B-%0A123%2F-456%5Dhard%2F%5B-789%2F-012%2F-345%5Dsoft.+In+that+case%2C+it+has+five+score+levels.+A+solution+is+feasible+if+all%0Ahard+levels+are+at+least+zero.%0AA+BendableScore+with+one+hard+level+and+one+soft+level+is+equivalent+to+a+HardSoftScore%2C+while+a%0ABendableScore+with+one+hard+level+and+two+soft+levels+is+equivalent+to+a+HardMediumSoftScore.%0A%C2%A0+++%40PlanningScore%28bendableHardLevelsSize+%3D+2%2C+bendableSoftLevelsSize+%3D+3%29%0A%C2%A0+++private+BendableScore+score%3B%0AThe+number+of+hard+and+soft+score+levels+need+to+be+set+at+compilation+time.+It+is+not+flexible+to%0Achange+during+solving.%0ADo+not+use+a+BendableScore+with+seven+levels+just+because+you+have+seven%0Aconstraints.+It+is+extremely+rare+to+use+a+different+score+level+for+each+constraint%2C%0Abecause+that+means+one+constraint+match+on+soft+0+outweighs+even+a+million%0A%EF%81%9A+constraint+matches+of+soft+1.%0AUsually%2C+multiple+constraints+share+the+same+level+and+are+weighted+against+each%0Aother.+Use+explaining+the+score+to+get+the+weight+of+individual+constraints+in+the%0Asame+level.%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+BendableLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+BendableBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.5.+Implementing+a+Custom+Score%0AInternally%2C+each+Score+implementation+also+has+a+ScoreDefinition+implementation.+For+example%3A%0ASimpleScore+is+defined+by+SimpleScoreDefinition.+The+ScoreDefinition+interface+defines+the+score%0Arepresentation.%0ATo+implement+a+custom+Score%2C+also+implement+such+a+custom+ScoreDefinition.+Extend%0AAbstractScoreDefinition+%28preferably+by+copy+pasting+HardSoftScoreDefinition%29+and+start+from+there.%0A133%0AThen+hook+your+custom+ScoreDefinition+in+the+domain%3A%0A%C2%A0+++%40PlanningScore%28scoreDefinitionClass+%3D+MyCustomScoreDefinition.class%29%0A%C2%A0+++private+MyCustomScore+score%3B%0ATo+have+it+integrate+seamlessly+with+JPA%2FHibernate%2C+XStream%2C+Jackson%2C+%E2%80%A6%2C+you%E2%80%99ll+need+to+write%0Acustom+glue+code+too.%0A5.3.+Calculate+the+Score%0A5.3.1.+Score+Calculation+Types%0AThere+are+several+ways+to+calculate+the+Score+of+a+Solution%3A%0A%E2%80%A2+Easy+Java+score+calculation%3A+implement+a+single+Java+method%0A%E2%80%A2+Incremental+Java+score+calculation%3A+implement+multiple+Java+methods%0A%E2%80%A2+Drools+score+calculation+%28recommended%29%3A+implement+score+rules%0AEvery+score+calculation+type+can+use+any+Score+definition.+For+example%2C+easy+Java+score+calculation%0Acan+output+a+HardSoftScore.%0AAll+score+calculation+types+are+Object+Oriented+and+can+reuse+existing+Java+code.%0AThe+score+calculation+must+be+read-only.+It+must+not+change+the+planning+entities%0Aor+the+problem+facts+in+any+way.+For+example%2C+it+must+not+call+a+setter+method+on+a%0Aplanning+entity+in+a+Drools+score+rule%E2%80%99s+RHS.+This+does+not+apply+to+logically%0Ainserted+objects%2C+which+can+be+changed+by+the+score+rules+that+logically+inserted%0Athem+in+the+first+place.%0A%EF%81%AA%0APlanner+will+not+recalculate+the+score+of+a+Solution+if+it+can+predict+it+%28unless+an%0AenvironmentMode+assertion+is+enabled%29.+For+example%2C+after+a+winning+step+is+done%2C%0Athere+is+no+need+to+calculate+the+score+because+that+move+was+done+and+undone%0Aearlier.+As+a+result%2C+there+is+no+guarantee+that+such+changes+applied+during+score%0Acalculation+are+actually+done.%0A5.3.2.+Easy+Java+Score+Calculation%0AAn+easy+way+to+implement+your+score+calculation+in+Java.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Plain+old+Java%3A+no+learning+curve%0A%E2%97%A6+Opportunity+to+delegate+score+calculation+to+an+existing+code+base+or+legacy+system%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+Slower%0A%E2%97%A6+Does+not+scale+because+there+is+no+incremental+score+calculation%0A134%0AImplement+the+one+method+of+the+interface+EasyScoreCalculator%3A%0Apublic+interface+EasyScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++Score+calculateScore%28Solution_+solution%29%3B%0A%7D%0AFor+example+in+n+queens%3A%0Apublic+class+NQueensEasyScoreCalculator+implements+EasyScoreCalculator%3CNQueens%3E+%7B%0A%C2%A0+++public+SimpleScore+calculateScore%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+nQueens.getQueenList%28%29%3B%0A%C2%A0+++++++int+score+%3D+0%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+n%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++for+%28int+j+%3D+i+%2B+1%3B+j+%3C+n%3B+j%2B%2B%29+%7B%0A%C2%A0+++++++++++++++Queen+leftQueen+%3D+queenList.get%28i%29%3B%0A%C2%A0+++++++++++++++Queen+rightQueen+%3D+queenList.get%28j%29%3B%0A%C2%A0+++++++++++++++if+%28leftQueen.getRow%28%29+%21%3D+null+%26%26+rightQueen.getRow%28%29+%21%3D+null%29+%7B%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getRowIndex%28%29+%3D%3D+rightQueen.getRowIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getAscendingDiagonalIndex%28%29+%3D%3D+rightQueen%0A.getAscendingDiagonalIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getDescendingDiagonalIndex%28%29+%3D%3D+rightQueen%0A.getDescendingDiagonalIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+SimpleScore.valueOf%28score%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+it+in+the+solver+configuration%3A%0A135%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueensEasySco%0AreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0ATo+configure+values+of+an+EasyScoreCalculator+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+easyScoreCalculatorCustomProperties+element%0Aand+use+custom+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CeasyScoreCalculatorClass%3E...MyEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3CeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%0A%C2%A0+++%3C%2FeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.3.+Incremental+Java+Score+Calculation%0AA+way+to+implement+your+score+calculation+incrementally+in+Java.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Very+fast+and+scalable%0A%E2%96%AA+Currently+the+fastest+if+implemented+correctly%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+Hard+to+write%0A%E2%96%AA+A+scalable+implementation+heavily+uses+maps%2C+indexes%2C+%E2%80%A6+%28things+the+Drools+rule+engine%0Acan+do+for+you%29%0A%E2%96%AA+You+have+to+learn%2C+design%2C+write+and+improve+all+these+performance+optimizations%0Ayourself%0A%E2%97%A6+Hard+to+read%0A%E2%96%AA+Regular+score+constraint+changes+can+lead+to+a+high+maintenance+cost%0AImplement+all+the+methods+of+the+interface+IncrementalScoreCalculator+and+extend+the+class%0AAbstractIncrementalScoreCalculator%3A%0A136%0Apublic+interface+IncrementalScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++void+resetWorkingSolution%28Solution_+workingSolution%29%3B%0A%C2%A0+++void+beforeEntityAdded%28Object+entity%29%3B%0A%C2%A0+++void+afterEntityAdded%28Object+entity%29%3B%0A%C2%A0+++void+beforeVariableChanged%28Object+entity%2C+String+variableName%29%3B%0A%C2%A0+++void+afterVariableChanged%28Object+entity%2C+String+variableName%29%3B%0A%C2%A0+++void+beforeEntityRemoved%28Object+entity%29%3B%0A%C2%A0+++void+afterEntityRemoved%28Object+entity%29%3B%0A%C2%A0+++Score+calculateScore%28%29%3B%0A%7D%0AFor+example+in+n+queens%3A%0Apublic+class+NQueensAdvancedIncrementalScoreCalculator+extends%0A137%0AAbstractIncrementalScoreCalculator%3CNQueens%3E+%7B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+rowIndexMap%3B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+ascendingDiagonalIndexMap%3B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+descendingDiagonalIndexMap%3B%0A%C2%A0+++private+int+score%3B%0A%C2%A0+++public+void+resetWorkingSolution%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++rowIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n%29%3B%0A%C2%A0+++++++ascendingDiagonalIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n+*+2%29%3B%0A%C2%A0+++++++descendingDiagonalIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n+*+2%29%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+n%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++rowIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++if+%28i+%21%3D+0%29+%7B%0A%C2%A0+++++++++++++++ascendingDiagonalIndexMap.put%28n+-+1+%2B+i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++++++descendingDiagonalIndexMap.put%28%28-i%29%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++score+%3D+0%3B%0A%C2%A0+++++++for+%28Queen+queen+%3A+nQueens.getQueenList%28%29%29+%7B%0A%C2%A0+++++++++++insert%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeEntityAdded%28Object+entity%29+%7B%0A%C2%A0+++++++%2F%2F+Do+nothing%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterEntityAdded%28Object+entity%29+%7B%0A%C2%A0+++++++insert%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeVariableChanged%28Object+entity%2C+String+variableName%29+%7B%0A%C2%A0+++++++retract%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterVariableChanged%28Object+entity%2C+String+variableName%29+%7B%0A%C2%A0+++++++insert%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeEntityRemoved%28Object+entity%29+%7B%0A%C2%A0+++++++retract%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterEntityRemoved%28Object+entity%29+%7B%0A%C2%A0+++++++%2F%2F+Do+nothing%0A%C2%A0+++%7D%0A138%0A%C2%A0+++private+void+insert%28Queen+queen%29+%7B%0A%C2%A0+++++++Row+row+%3D+queen.getRow%28%29%3B%0A%C2%A0+++++++if+%28row+%21%3D+null%29+%7B%0A%C2%A0+++++++++++int+rowIndex+%3D+queen.getRowIndex%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+rowIndexList+%3D+rowIndexMap.get%28rowIndex%29%3B%0A%C2%A0+++++++++++score+-%3D+rowIndexList.size%28%29%3B%0A%C2%A0+++++++++++rowIndexList.add%28queen%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+ascendingDiagonalIndexList+%3D+ascendingDiagonalIndexMap.get%0A%28queen.getAscendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++score+-%3D+ascendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexList.add%28queen%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+descendingDiagonalIndexList+%3D+descendingDiagonalIndexMap.get%0A%28queen.getDescendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++score+-%3D+descendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexList.add%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++private+void+retract%28Queen+queen%29+%7B%0A%C2%A0+++++++Row+row+%3D+queen.getRow%28%29%3B%0A%C2%A0+++++++if+%28row+%21%3D+null%29+%7B%0A%C2%A0+++++++++++List%3CQueen%3E+rowIndexList+%3D+rowIndexMap.get%28queen.getRowIndex%28%29%29%3B%0A%C2%A0+++++++++++rowIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+rowIndexList.size%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+ascendingDiagonalIndexList+%3D+ascendingDiagonalIndexMap.get%0A%28queen.getAscendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+ascendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+descendingDiagonalIndexList+%3D+descendingDiagonalIndexMap.get%0A%28queen.getDescendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+descendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++public+SimpleScore+calculateScore%28%29+%7B%0A%C2%A0+++++++return+SimpleScore.valueOf%28score%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+it+in+the+solver+configuration%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CincrementalScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueens%0AAdvancedIncrementalScoreCalculator%3C%2FincrementalScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A139%0AA+piece+of+incremental+score+calculator+code+can+be+difficult+to+write+and+to+review.%0A%EF%81%AA+Assert+its+correctness+by+using+an+EasyScoreCalculator+to+fulfill+the+assertions%0Atriggered+by+the+environmentMode.%0ATo+configure+values+of+an+IncrementalScoreCalculator+dynamically+in+the+solver+configuration+%28so%0Athe+Benchmarker+can+tweak+those+parameters%29%2C+add+the%0AincrementalScoreCalculatorCustomProperties+element+and+use+custom+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CincrementalScoreCalculatorClass%3E%0A...MyIncrementalScoreCalculator%3C%2FincrementalScoreCalculatorClass%3E%0A%C2%A0+++%3CincrementalScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%0A%C2%A0+++%3C%2FincrementalScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.3.1.+ConstraintMatchAwareIncrementalScoreCalculator%0AOptionally%2C+also+implement+the+ConstraintMatchAwareIncrementalScoreCalculator+interface+to%3A%0A%E2%80%A2+Explain+a+score+by+splitting+it+up+per+score+constraint+with%0AScoreDirector.getConstraintMatchTotals%28%29.%0A%E2%80%A2+Visualize+or+sort+planning+entities+by+how+many+constraints+each+one+breaks+with%0AScoreDirector.getIndictmentMap%28%29.%0A%E2%80%A2+Receive+a+detailed+analysis+if+the+IncrementalScoreCalculator+is+corrupted+in+FAST_ASSERT+or%0AFULL_ASSERT+environmentMode%2C%0Apublic+interface+ConstraintMatchAwareIncrementalScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++void+resetWorkingSolution%28Solution_+workingSolution%2C+boolean%0AconstraintMatchEnabled%29%3B%0A%C2%A0+++Collection%3CConstraintMatchTotal%3E+getConstraintMatchTotals%28%29%3B%0A%C2%A0+++Map%3CObject%2C+Indictment%3E+getIndictmentMap%28%29%3B%0A%7D%0AFor+example+in+machine+reassignment%2C+create+one+ConstraintMatchTotal+per+constraint+type+and%0Acall+addConstraintMatch%28%29+for+each+constraint+match%3A%0A140%0Apublic+class+MachineReassignmentIncrementalScoreCalculator%0A%C2%A0+++++++implements+ConstraintMatchAwareIncrementalScoreCalculator%3CMachineReassignment%3E%0A%7B%0A%C2%A0+++...%0A%C2%A0+++%40Override%0A%C2%A0+++public+void+resetWorkingSolution%28MachineReassignment+workingSolution%2C+boolean%0AconstraintMatchEnabled%29+%7B%0A%C2%A0+++++++resetWorkingSolution%28workingSolution%29%3B%0A%C2%A0+++++++%2F%2F+ignore+constraintMatchEnabled%2C+it+is+always+presumed+enabled%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3CConstraintMatchTotal%3E+getConstraintMatchTotals%28%29+%7B%0A%C2%A0+++++++ConstraintMatchTotal+maximumCapacityMatchTotal+%3D+new+ConstraintMatchTotal%28%0A%C2%A0+++++++++++++++CONSTRAINT_PACKAGE%2C+%22maximumCapacity%22%2C+HardSoftLongScore.ZERO%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++++++for+%28MrMachineScorePart+machineScorePart+%3A+machineScorePartMap.values%28%29%29+%7B%0A%C2%A0+++++++++++for+%28MrMachineCapacityScorePart+machineCapacityScorePart+%3A%0AmachineScorePart.machineCapacityScorePartList%29+%7B%0A%C2%A0+++++++++++++++if+%28machineCapacityScorePart.maximumAvailable+%3C+0L%29+%7B%0A%C2%A0+++++++++++++++++++maximumCapacityMatchTotal.addConstraintMatch%28%0A%C2%A0+++++++++++++++++++++++++++Arrays.asList%28machineCapacityScorePart.machineCapacity%29%2C%0A%C2%A0+++++++++++++++++++++++++++HardSoftLongScore.valueOf%28machineCapacityScorePart%0A.maximumAvailable%2C+0%29%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++...%0A%C2%A0+++++++List%3CConstraintMatchTotal%3E+constraintMatchTotalList+%3D+new+ArrayList%3C%3E%284%29%3B%0A%C2%A0+++++++constraintMatchTotalList.add%28maximumCapacityMatchTotal%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++++++return+constraintMatchTotalList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Map%3CObject%2C+Indictment%3E+getIndictmentMap%28%29+%7B%0A%C2%A0+++++++return+null%3B+%2F%2F+Calculate+it+non-incrementally+from+getConstraintMatchTotals%28%29%0A%C2%A0+++%7D%0A%7D%0AThat+getConstraintMatchTotals%28%29+code+often+duplicates+some+of+the+logic+of+the+normal%0AIncrementalScoreCalculator+methods.+Drools+Score+Calculation+doesn%E2%80%99t+have+this+disadvantage%2C%0Abecause+it+is+constraint+match+aware+automatically+when+needed%2C+without+any+extra+domain-%0Aspecific+code.%0A5.3.4.+Drools+Score+Calculation%0A141%0A5.3.4.1.+Overview%0AImplement+your+score+calculation+using+the+Drools+rule+engine.+Every+score+constraint+is+written+as%0Aone+or+more+score+rules.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Incremental+score+calculation+for+free%0A%E2%96%AA+Because+most+DRL+syntax+uses+forward+chaining%2C+it+does+incremental+calculation+without%0Aany+extra+code%0A%E2%97%A6+Score+constraints+are+isolated+as+separate+rules%0A%E2%96%AA+Easy+to+add+or+edit+existing+score+rules%0A%E2%97%A6+Flexibility+to+augment+your+score+constraints+by%0A%E2%96%AA+Defining+them+in+decision+tables%0A%E2%96%AA+Excel+%28XLS%29+spreadsheet%0A%E2%96%AA+KIE+Workbench+WebUI%0A%E2%96%AA+Translate+them+into+natural+language+with+DSL%0A%E2%96%AA+Store+and+release+in+the+KIE+Workbench+repository%0A%E2%97%A6+Performance+optimizations+in+future+versions+for+free%0A%E2%96%AA+In+every+release%2C+the+Drools+rule+engine+tends+to+become+faster%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+DRL+learning+curve%0A%E2%97%A6+Usage+of+DRL%0A%E2%96%AA+Polyglot+fear+can+prohibit+the+use+of+a+new+language+such+as+DRL+in+some+organizations%0A5.3.4.2.+Drools+Score+Rules+Configuration%0AThere+are+several+ways+to+define+where+your+score+rules+live.%0A5.3.4.2.1.+A+scoreDrl+Resource+on+the+Classpath%0AThis+is+the+easy+way.+The+score+rules+live+in+a+DRL+file+which+is+provided+as+a+classpath+resource.+Just%0Aadd+the+score+rules+DRL+file+in+the+solver+configuration+as+a+%3CscoreDrl%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AIn+a+typical+project+%28following+the+Maven+directory+structure%29%2C+that+DRL+file+would+be+located+at%0A%24PROJECT_DIR%2Fsrc%2Fmain%2Fresources%2Forg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%0A%28even+for+a+war+project%29.%0A142%0AThe+%3CscoreDrl%3E+element+expects+a+classpath+resource%2C+as+defined+by%0A%EF%81%9A+ClassLoader.getResource%28String%29%2C+it+does+not+accept+a+File%2C+nor+an+URL%2C+nor+a%0Awebapp+resource.+See+below+to+use+a+File+instead.%0AAdd+multiple+%3CscoreDrl%3E+elements+if+the+score+rules+are+split+across+multiple+DRL+files.%0AOptionally%2C+you+can+also+set+drools+configuration+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CkieBaseConfigurationProperties%3E%0A%C2%A0+++++%3Cdrools.equalityBehavior%3E...%3C%2Fdrools.equalityBehavior%3E%0A%C2%A0+++%3C%2FkieBaseConfigurationProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0ATo+enable+property+reactive+by+default%2C+without+a+%40propertyReactive+on+the+domain+classes%2C+add%0A%3Cdrools.propertySpecific%3EALWAYS%3C%2Fdrools.propertySpecific%3E+in+there.+Otherwise+Planner%0Aautomatically+changes+the+Drools+default+to+ALLOWED+so+property+reactive+is+not+active+by+default.%0A5.3.4.2.2.+A+scoreDrlFile%0ATo+use+File+on+the+local+file+system%2C+instead+of+a+classpath+resource%2C+add+the+score+rules+DRL+file+in%0Athe+solver+configuration+as+a+%3CscoreDrlFile%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrlFile%3E%2Fhome%2Fge0ffrey%2Ftmp%2FnQueensScoreRules.drl%3C%2FscoreDrlFile%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AFor+portability+reasons%2C+a+classpath+resource+is+recommended+over+a+File.+An%0Aapplication+build+on+one+computer%2C+but+used+on+another+computer%2C+might+not+find%0A%EF%81%B1+the+file+on+the+same+location.+Worse%2C+if+they+use+a+different+Operating+System%2C+it+is%0Ahard+to+choose+a+portable+file+path.%0AAdd+multiple+%3CscoreDrlFile%3E+elements+if+the+score+rules+are+split+across+multiple+DRL+files.%0A5.3.4.2.3.+A+ksessionName+in+a+Kjar+from+a+Maven+repository%0AThis+way+allows+you+to+use+score+rules+defined+by+the+Workbench+or+build+a+kjar+and+deploy+it+to+the%0AExecution+Server.+Both+the+score+rules+and+the+solver+configuration+are+resources+in+a+kjar.+Clients%0Acan+obtain+that+kjar+either+from+the+local+classpath%2C+from+a+local+Maven+repository+or+even+from+a%0Aremote+Maven+repository.%0AThe+score+rules+still+live+in+a+DRL+file%2C+but+the+KieContainer+finds+that+DRL+file+through+the+META-%0AINF%2Fkmodule.xml+file%3A%0A143%0A%3Ckmodule+xmlns%3D%22http%3A%2F%2Fwww.drools.org%2Fxsd%2Fkmodule%22%3E%0A%C2%A0+%3Cconfiguration%3E%0A%C2%A0+++%3C%21--+Don%27t+enable+propertyReactive+unless+there+is+a+%40PropertyReactive+annotation%0Aon+the+domain+classes+--%3E%0A%C2%A0+++%3Cproperty+key%3D%22drools.propertySpecific%22+value%3D%22ALLOWED%22%2F%3E%0A%C2%A0+%3C%2Fconfiguration%3E%0A%C2%A0+%3Ckbase+name%3D%22nQueensKbase%22+packages%3D%22org.optaplanner.examples.nqueens.solver%22%3E%0A%C2%A0+++%3Cksession+name%3D%22nQueensKsession%22%2F%3E%0A%C2%A0+%3C%2Fkbase%3E%0A%3C%2Fkmodule%3E%0AThe+kmodule+above+will+pick+up+all+the+DRL+files+in+the+package%0Aorg.optaplanner.examples.nqueens.solver.+A+kbase+can+even+extend+another+kbase.%0AStarting+from+version+7.0%2C+Drools+enables+property+reactive+by+default+for+all%0Aclasses.+This+means+if+you+have+a+non-simple+getter+and+forget+to+apply+%40Modifies%0A%EF%81%9A+correctly%2C+corruption+occurs.+To+avoid+this%2C+simply+set+drools.propertySpecific+to%0AALLOWED+as+shown+above.%0AAdd+the+ksession+name+in+the+solver+configuration+as+a+%3CksessionName%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CksessionName%3EnQueensKsession%3C%2FksessionName%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AIn+this+approach%2C+it%E2%80%99s+required+to+use+a+SolverFactory.createFromKieContainerXmlResource%28%E2%80%A6%29%0Amethod+to+build+the+SolverFactory.+If+no+%3CksessionName%3E+element+is+specified%2C+the+default+ksession+of%0Athe+kmodule.xml+is+used.%0A5.3.4.3.+Implementing+a+Score+Rule%0AHere+is+an+example+of+a+score+constraint+implemented+as+a+score+rule+in+a+DRL+file%3A%0Arule+%22multipleQueensHorizontal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+rowIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+rowIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0AThis+score+rule+will+fire+once+for+every+two+queens+with+the+same+rowIndex.+The+%28id+%3E+%24id%29+condition%0Ais+needed+to+assure+that+for+two+queens+A+and+B%2C+it+can+only+fire+for+%28A%2C+B%29+and+not+for+%28B%2C+A%29%2C+%28A%2C+A%29+or%0A%28B%2C+B%29.+Let+us+take+a+closer+look+at+this+score+rule+on+this+solution+of+four+queens%3A%0A144%0AIn+this+solution+the+multipleQueensHorizontal+score+rule+will+fire+for+six+queen+couples%3A+%28A%2C+B%29%2C+%28A%2C%0AC%29%2C+%28A%2C+D%29%2C+%28B%2C+C%29%2C+%28B%2C+D%29+and+%28C%2C+D%29.+Because+none+of+the+queens+are+on+the+same+vertical+or+diagonal%0Aline%2C+this+solution+will+have+a+score+of+-6.+An+optimal+solution+of+four+queens+has+a+score+of+0.%0ANotice+that+every+score+rule+will+relate+to+at+least+one+planning+entity+class+%28directly%0Aor+indirectly+through+a+logically+inserted+fact%29.%0A%EF%81%9A+This+is+a+normal+case.+It+would+be+a+waste+of+time+to+write+a+score+rule+that+only%0Arelates+to+problem+facts%2C+as+the+consequence+will+never+change+during+planning%2C+no%0Amatter+what+the+possible+solution.%0AThe+kcontext+variable+is+a+magic+variable+in+Drools+Expert.+The+scoreHolder%27s%0A%EF%81%9A+method+uses+it+to+do+incremental+score+calculation+correctly+and+to+create+a%0AConstraintMatch+instance.%0A5.3.4.4.+Weighing+Score+Rules%0AA+ScoreHolder+instance+is+asserted+into+the+KieSession+as+a+global+called+scoreHolder.+The+score+rules%0Aneed+to+%28directly+or+indirectly%29+update+that+instance.%0A145%0Aglobal+SimpleScoreHolder+scoreHolder%3B%0Arule+%22multipleQueensHorizontal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+rowIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+rowIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0A%2F%2F+multipleQueensVertical+is+obsolete+because+it+is+always+0%0Arule+%22multipleQueensAscendingDiagonal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+ascendingDiagonalIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+ascendingDiagonalIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0Arule+%22multipleQueensDescendingDiagonal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+descendingDiagonalIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+descendingDiagonalIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0ATo+learn+more+about+the+Drools+rule+language+%28DRL%29%2C+consult+the+Drools%0A%EF%81%9A+documentation.%0AMost+use+cases+also+weigh+their+constraint+types+or+even+their+matches+differently%2C+by+using+a%0Aspecific+weight+for+each+constraint+match.+For+example+in+course+scheduling%2C+assigning+a+Lecture+to%0Aa+Room+that+is+lacking+two+seats+is+weighted+equally+bad+as+having+one+isolated+Lecture+in+a%0ACurriculum%3A%0A146%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0A%2F%2F+RoomCapacity%3A+For+each+lecture%2C+the+number+of+students+that+attend+the+course+must%0Abe+less+or+equal%0A%2F%2F+than+the+number+of+seats+of+all+the+rooms+that+host+its+lectures.%0Arule+%22roomCapacity%22%0A%C2%A0+++when%0A%C2%A0+++++++%24room+%3A+Room%28%24capacity+%3A+capacity%29%0A%C2%A0+++++++%24lecture+%3A+Lecture%28room+%3D%3D+%24room%2C+studentSize+%3E+%24capacity%2C+%24studentSize+%3A%0AstudentSize%29%0A%C2%A0+++then%0A%C2%A0+++++++%2F%2F+Each+student+above+the+capacity+counts+as+one+point+of+penalty.%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+%28%24capacity+-+%24studentSize%29%29%3B%0Aend%0A%2F%2F+CurriculumCompactness%3A+Lectures+belonging+to+a+curriculum+should+be+adjacent%0A%2F%2F+to+each+other+%28i.e.%2C+in+consecutive+periods%29.%0A%2F%2F+For+a+given+curriculum+we+account+for+a+violation+every+time+there+is+one+lecture%0Anot+adjacent%0A%2F%2F+to+any+other+lecture+within+the+same+day.%0Arule+%22curriculumCompactness%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++%2F%2F+Each+isolated+lecture+in+a+curriculum+counts+as+two+points+of+penalty.%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-2%29%3B%0Aend%0A5.3.5.+InitializingScoreTrend%0AThe+InitializingScoreTrend+specifies+how+the+Score+will+change+as+more+and+more+variables+are%0Ainitialized+%28while+the+already+initialized+variables+do+not+change%29.+Some+optimization+algorithms%0A%28such+Construction+Heuristics+and+Exhaustive+Search%29+run+faster+if+they+have+such+information.%0AFor+the+Score+%28or+each+score+level+separately%29%2C+specify+a+trend%3A%0A%E2%80%A2+ANY+%28default%29%3A+Initializing+an+extra+variable+can+change+the+score+positively+or+negatively.+Gives%0Ano+performance+gain.%0A%E2%80%A2+ONLY_UP+%28rare%29%3A+Initializing+an+extra+variable+can+only+change+the+score+positively.+Implies+that%3A%0A%E2%97%A6+There+are+only+positive+constraints%0A%E2%97%A6+And+initializing+the+next+variable+can+not+unmatch+a+positive+constraint+that+was+matched%0Aby+a+previous+initialized+variable.%0A%E2%80%A2+ONLY_DOWN%3A+Initializing+an+extra+variable+can+only+change+the+score+negatively.+Implies+that%3A%0A%E2%97%A6+There+are+only+negative+constraints%0A%E2%97%A6+And+initializing+the+next+variable+can+not+unmatch+a+negative+constraint+that+was+matched%0Aby+a+previous+initialized+variable.%0A147%0AMost+use+cases+only+have+negative+constraints.+Many+of+those+have+an+InitializingScoreTrend+that%0Aonly+goes+down%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3E...%2FcloudBalancingScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CinitializingScoreTrend%3EONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AAlternatively%2C+you+can+also+specify+the+trend+for+each+score+level+separately%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3E...%2FcloudBalancingScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CinitializingScoreTrend%3EONLY_DOWN%2FONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.6.+Invalid+Score+Detection%0AWhen+you+put+the+environmentModein+FULL_ASSERT+%28or+FAST_ASSERT%29%2C+it+will+detect+score+corruption+in%0Athe+incremental+score+calculation.+However%2C+that+will+not+verify+that+your+score+calculator+actually%0Aimplements+your+score+constraints+as+your+business+desires.+For+example%2C+one+score+rule+might%0Aconsistently+match+the+wrong+pattern.+To+verify+the+score+rules+against+an+independent%0Aimplementation%2C+configure+a+assertionScoreDirectorFactory%3A%0A%C2%A0+%3CenvironmentMode%3EFAST_ASSERT%3C%2FenvironmentMode%3E%0A%C2%A0+...%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CassertionScoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueensEasySco%0AreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%2FassertionScoreDirectorFactory%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AThis+way%2C+the+scoreDrl+will+be+validated+by+the+EasyScoreCalculator.%0AThis+works+well+to+isolate+score+corruption%2C+but+to+verify+that+the+score+rules%0A%EF%81%9A+implement+the+real+business+needs%2C+a+unit+test+with+a+ScoreVerifier+is+usually%0Abetter.%0A5.4.+Score+Calculation+Performance+Tricks%0A5.4.1.+Overview%0AThe+Solver+will+normally+spend+most+of+its+execution+time+running+the+score+calculation+%28which+is%0A148%0Acalled+in+its+deepest+loops%29.+Faster+score+calculation+will+return+the+same+solution+in+less+time+with%0Athe+same+algorithm%2C+which+normally+means+a+better+solution+in+equal+time.%0A5.4.2.+Score+Calculation+Speed%0AAfter+solving+a+problem%2C+the+Solver+will+log+the+score+calculation+speed+per+second.+This+is+a+good%0Ameasurement+of+Score+calculation+performance%2C+despite+that+it+is+affected+by+non+score+calculation%0Aexecution+time.+It+depends+on+the+problem+scale+of+the+problem+dataset.+Normally%2C+even+for+high%0Ascale+problems%2C+it+is+higher+than+1000%2C+except+when+you+are+using+an+EasyScoreCalculator.%0AWhen+improving+your+score+calculation%2C+focus+on+maximizing+the+score+calculation%0Aspeed%2C+instead+of+maximizing+the+best+score.+A+big+improvement+in+score%0Acalculation+can+sometimes+yield+little+or+no+best+score+improvement%2C+for+example%0Awhen+the+algorithm+is+stuck+in+a+local+or+global+optima.+If+you+are+watching+the%0A%EF%81%AA+calculation+speed+instead%2C+score+calculation+improvements+are+far+more+visible.%0AFurthermore%2C+watching+the+calculation+speed%2C+allows+you+to+remove+or+add+score%0Aconstraints%2C+and+still+compare+it+with+the+original+calculation+speed.+Comparing+the%0Abest+score+with+the+original+would+be+wrong%2C+because+it+is+comparing+apples+and%0Aoranges.%0A5.4.3.+Incremental+Score+Calculation+%28with+Deltas%29%0AWhen+a+Solution+changes%2C+incremental+score+calculation+%28AKA+delta+based+score+calculation%29%2C%0Acalculates+the+delta+with+the+previous+state+to+find+the+new+Score%2C+instead+of+recalculating+the+entire%0Ascore+on+every+solution+evaluation.%0AFor+example%2C+when+a+single+queen+A+moves+from+row+1+to+2%2C+it+will+not+bother+to+check+if+queen+B%0Aand+C+can+attack+each+other%2C+since+neither+of+them+changed%3A%0A149%0ASimilarly+in+employee+rostering%3A%0A150%0AThis+is+a+huge+performance+and+scalability+gain.+Drools+score+calculation+gives+you+this+huge%0Ascalability+gain+without+forcing+you+to+write+a+complicated+incremental+score+calculation%0Aalgorithm.+Just+let+the+Drools+rule+engine+do+the+hard+work.%0ANotice+that+the+speedup+is+relative+to+the+size+of+your+planning+problem+%28your+n%29%2C+making%0Aincremental+score+calculation+far+more+scalable.%0A5.4.4.+Avoid+Calling+Remote+Services+During+Score+Calculation%0ADo+not+call+remote+services+in+your+score+calculation+%28except+if+you+are+bridging+EasyScoreCalculator%0Ato+a+legacy+system%29.+The+network+latency+will+kill+your+score+calculation+performance.+Cache+the%0Aresults+of+those+remote+services+if+possible.%0AIf+some+parts+of+a+constraint+can+be+calculated+once%2C+when+the+Solver+starts%2C+and+never+change%0Aduring+solving%2C+then+turn+them+into+cached+problem+facts.%0A5.4.5.+Pointless+Constraints%0AIf+you+know+a+certain+constraint+can+never+be+broken+%28or+it+is+always+broken%29%2C+you+need+not+write+a%0Ascore+constraint+for+it.+For+example+in+n+queens%2C+the+score+calculation+does+not+check+if+multiple%0Aqueens+occupy+the+same+column%2C+because+a+Queen%27s+column+never+changes+and+every+Solution+starts%0Awith+each+Queen+on+a+different+column.%0A151%0ADo+not+go+overboard+with+this.+If+some+datasets+do+not+use+a+specific+constraint+but%0A%EF%81%9A+others+do%2C+just+return+out+of+the+constraint+as+soon+as+you+can.+There+is+no+need+to%0Adynamically+change+your+score+calculation+based+on+the+dataset.%0A5.4.6.+Built-in+Hard+Constraint%0AInstead+of+implementing+a+hard+constraint%2C+it+can+sometimes+be+built+in.+For+example%2C+if+Lecture+A%0Ashould+never+be+assigned+to+Room+X%2C+but+it+uses+ValueRangeProvider+on+Solution%2C+so+the+Solver+will%0Aoften+try+to+assign+it+to+Room+X+too+%28only+to+find+out+that+it+breaks+a+hard+constraint%29.+Use+a%0AValueRangeProvider+on+the+planning+entity+or+filtered+selection+to+define+that+Course+A+should+only%0Abe+assigned+a+Room+different+than+X.%0AThis+can+give+a+good+performance+gain+in+some+use+cases%2C+not+just+because+the+score+calculation+is%0Afaster%2C+but+mainly+because+most+optimization+algorithms+will+spend+less+time+evaluating+infeasible%0Asolutions.+However%2C+usually+this+not+a+good+idea+because+there+is+a+real+risk+of+trading+short+term%0Abenefits+for+long+term+harm%3A%0A%E2%80%A2+Many+optimization+algorithms+rely+on+the+freedom+to+break+hard+constraints+when+changing%0Aplanning+entities%2C+to+get+out+of+local+optima.%0A%E2%80%A2+Both+implementation+approaches+have+limitations+%28feature+compatibility%2C+disabling+automatic%0Aperformance+optimizations%29%2C+as+explained+in+their+documentation.%0A5.4.7.+Other+Score+Calculation+Performance+Tricks%0A%E2%80%A2+Verify+that+your+score+calculation+happens+in+the+correct+Number+type.+If+you+are+making+the+sum%0Aof+int+values%2C+do+not+let+Drools+sum+it+in+a+double+which+takes+longer.%0A%E2%80%A2+For+optimal+performance%2C+always+use+server+mode+%28java+-server%29.+We+have+seen+performance%0Aincreases+of+50%25+by+turning+on+server+mode.%0A%E2%80%A2+For+optimal+performance%2C+use+the+latest+Java+version.+For+example%2C+in+the+past+we+have+seen%0Aperformance+increases+of+30%25+by+switching+from+java+1.5+to+1.6.%0A%E2%80%A2+Always+remember+that+premature+optimization+is+the+root+of+all+evil.+Make+sure+your+design+is%0Aflexible+enough+to+allow+configuration+based+tweaking.%0A5.4.8.+Score+Trap%0AMake+sure+that+none+of+your+score+constraints+cause+a+score+trap.+A+trapped+score+constraint+uses%0Athe+same+weight+for+different+constraint+matches%2C+when+it+could+just+as+easily+use+a+different+weight.%0AIt+effectively+lumps+its+constraint+matches+together%2C+which+creates+a+flatlined+score+function+for+that%0Aconstraint.+This+can+cause+a+solution+state+in+which+several+moves+need+to+be+done+to+resolve+or%0Alower+the+weight+of+that+single+constraint.+Some+examples+of+score+traps%3A%0A%E2%80%A2+You+need+two+doctors+at+each+table%2C+but+you+are+only+moving+one+doctor+at+a+time.+So+the+solver%0Ahas+no+incentive+to+move+a+doctor+to+a+table+with+no+doctors.+Punish+a+table+with+no+doctors%0Amore+than+a+table+with+only+one+doctor+in+that+score+constraint+in+the+score+function.%0A%E2%80%A2+Two+exams+need+to+be+conducted+at+the+same+time%2C+but+you+are+only+moving+one+exam+at+a+time.%0ASo+the+solver+has+to+move+one+of+those+exams+to+another+timeslot+without+moving+the+other+in%0A152%0Athe+same+move.+Add+a+coarse-grained+move+that+moves+both+exams+at+the+same+time.%0AFor+example%2C+consider+this+score+trap.+If+the+blue+item+moves+from+an+overloaded+computer+to+an%0Aempty+computer%2C+the+hard+score+should+improve.+The+trapped+score+implementation+fails+to+do+that%3A%0AThe+Solver+should+eventually+get+out+of+this+trap%2C+but+it+will+take+a+lot+of+effort+%28especially+if+there+are%0Aeven+more+processes+on+the+overloaded+computer%29.+Before+they+do+that%2C+they+might+actually+start%0Amoving+more+processes+into+that+overloaded+computer%2C+as+there+is+no+penalty+for+doing+so.%0AAvoiding+score+traps+does+not+mean+that+your+score+function+should+be+smart%0Aenough+to+avoid+local+optima.+Leave+it+to+the+optimization+algorithms+to+deal+with%0A%EF%81%9A+the+local+optima.%0AAvoiding+score+traps+means+to+avoid%2C+for+each+score+constraint+individually%2C+a%0Aflatlined+score+function.%0AAlways+specify+the+degree+of+infeasibility.+The+business+will+often+say+%22if+the%0Asolution+is+infeasible%2C+it+does+not+matter+how+infeasible+it+is.%22+While+that+is+true+for%0A%EF%81%AA+the+business%2C+it+is+not+true+for+score+calculation+as+it+benefits+from+knowing+how%0Ainfeasible+it+is.+In+practice%2C+soft+constraints+usually+do+this+naturally+and+it+is+just+a%0Amatter+of+doing+it+for+the+hard+constraints+too.%0AThere+are+several+ways+to+deal+with+a+score+trap%3A%0A153%0A%E2%80%A2+Improve+the+score+constraint+to+make+a+distinction+in+the+score+weight.+For+example%2C+penalize%0A-1hard+for+every+missing+CPU%2C+instead+of+just+-1hard+if+any+CPU+is+missing.%0A%E2%80%A2+If+changing+the+score+constraint+is+not+allowed+from+the+business+perspective%2C+add+a+lower+score%0Alevel+with+a+score+constraint+that+makes+such+a+distinction.+For+example%2C+penalize+-1subsoft+for%0Aevery+missing+CPU%2C+on+top+of+-1hard+if+any+CPU+is+missing.+The+business+ignores+the+subsoft+score%0Alevel.%0A%E2%80%A2+Add+coarse-grained+moves+and+union+select+them+with+the+existing+fine-grained+moves.+A%0Acoarse-grained+move+effectively+does+multiple+moves+to+directly+get+out+of+a+score+trap+with+a%0Asingle+move.+For+example%2C+move+multiple+items+from+the+same+container+to+another+container.%0A5.4.9.+stepLimit+Benchmark%0ANot+all+score+constraints+have+the+same+performance+cost.+Sometimes+one+score+constraint+can+kill%0Athe+score+calculation+performance+outright.+Use+the+Benchmarker+to+do+a+one+minute+run+and+check%0Awhat+happens+to+the+score+calculation+speed+if+you+comment+out+all+but+one+of+the+score+constraints.%0A5.4.10.+Fairness+Score+Constraints%0ASome+use+cases+have+a+business+requirement+to+provide+a+fair+schedule+%28usually+as+a+soft+score%0Aconstraint%29%2C+for+example%3A%0A%E2%80%A2+Fairly+distribute+the+workload+amongst+the+employees%2C+to+avoid+envy.%0A%E2%80%A2+Evenly+distribute+the+workload+amongst+assets%2C+to+improve+reliability.%0AImplementing+such+a+constraint+can+seem+difficult+%28especially+because+there+are+different+ways+to%0Aformalize+fairness%29%2C+but+usually+the+squared+workload+implementation+behaves+most+desirable.+For%0Aeach+employee%2Fasset%2C+count+the+workload+w+and+subtract+w%C2%B2+from+the+score.%0A154%0AAs+shown+above%2C+the+squared+workload+implementation+guarantees+that+if+you+select+two+employees%0Afrom+a+given+solution+and+make+their+distribution+between+those+two+employees+fairer%2C+then+the%0Aresulting+new+solution+will+have+a+better+overall+score.+Do+not+just+use+the+difference+from+the%0Aaverage+workload%2C+as+that+can+lead+to+unfairness%2C+as+demonstrated+below.%0A155%0AInstead+of+the+squared+workload%2C+it+is+also+possible+to+use+the+variance+%28squared%0Adifference+to+the+average%29+or+the+standard+deviation+%28square+root+of+the+variance%29.%0A%EF%81%9A+This+has+no+effect+on+the+score+comparison%2C+because+the+average+will+not+change%0Aduring+planning.+It+is+just+more+work+to+implement+%28because+the+average+needs+to%0Abe+known%29+and+trivially+slower+%28because+the+calculation+is+a+bit+longer%29.%0AWhen+the+workload+is+perfectly+balanced%2C+the+user+often+likes+to+see+a+0+score%2C+instead+of+the%0Adistracting+-34soft+in+the+image+above+%28for+the+last+solution+which+is+almost+perfectly+balanced%29.+To%0Anullify+this%2C+either+add+the+average+multiplied+by+the+number+of+entities+to+the+score+or+instead+show%0Athe+variance+or+standard+deviation+in+the+UI.%0A5.5.+Explaining+the+Score%3A+Which+Constraints+Are%0ABroken%3F%0AThe+easiest+way+to+explain+the+score+during+development+is+to+print+the+return+value+of%0AexplainBestScore%28%29%2C+but+only+use+this+method+for+diagnostic+purposes%3A%0ASystem.out.println%28solver.explainBestScore%28%29%29%3B%0AFor+example+in+conference+scheduling%2C+this+prints+that+talk+S51+is+responsible+for+breaking+the+hard%0Aconstraint+Speaker+required+room+tag%3A%0A156%0AExplanation+of+score+%28-1hard%2F-806soft%29%3A%0A%C2%A0+++Constraint+match+totals%3A%0A%C2%A0+++++++-1hard%3A+constraint+%28Speaker+required+room+tag%29+has+1+matches%3A%0A%C2%A0+++++++++++-1hard%3A+justifications+%28%5BS51%5D%29%0A%C2%A0+++++++-340soft%3A+constraint+%28Theme+track+conflict%29+has+32+matches%3A%0A%C2%A0+++++++++++-20soft%3A+justifications+%28%5BS68%2C+S66%2C+ConferenceParametrization-0%5D%29%0A%C2%A0+++++++++++-20soft%3A+justifications+%28%5BS61%2C+S44%2C+ConferenceParametrization-0%5D%29%0A%C2%A0+++++++++++...%0A%C2%A0+++++++...%0A%C2%A0+++Indictments+%28top+5+of+72%29%3A%0A%C2%A0+++++++-1hard%2F-22soft%3A+justification+%28S51%29+has+12+matches%3A%0A%C2%A0+++++++++++-1hard%3A+constraint+%28Speaker+required+room+tag%29%0A%C2%A0+++++++++++-10soft%3A+constraint+%28Theme+track+conflict%29%0A%C2%A0+++++++++++...%0A%C2%A0+++++++...%0ADo+not+attempt+to+parse+this+string+or+use+it+in+your+UI+or+exposed+services.+Instead%0A%EF%81%AA+use+the+ConstraintMatch+API+below+and+do+it+properly.%0A5.5.1.+Using+Score+Calculation+Outside+the+Solver%0AIf+other+parts+of+your+application%2C+for+example+your+webUI%2C+need+to+calculate+the+score+of+a+solution%2C%0Areuse+the+ScoreDirectorFactory+of+the+Solver+to+build+a+separate+ScoreDirector+for+that+webUI%3A%0AScoreDirectorFactory%3CCloudBalance%3E+scoreDirectorFactory+%3D+solver%0A.getScoreDirectorFactory%28%29%3B%0Atry+%28ScoreDirector%3CCloudBalance%3E+guiScoreDirector+%3D+scoreDirectorFactory%0A.buildScoreDirector%28%29%29+%7B%0A%C2%A0+++...%0A%7D%0AThe+try+ARM+will+call+ScoreDirector.close%28%29+when+the+ScoreDirector+becomes%0A%EF%81%9A+useless%2C+to+avoid+a+memory+leak%2C+especially+with+Drools+score+calculation.%0AThen+use+it+when+you+need+to+calculate+the+Score+of+a+Solution%3A%0AguiScoreDirector.setWorkingSolution%28cloudBalance%29%3B%0AScore+score+%3D+guiScoreDirector.calculateScore%28%29%3B%0AFurthermore%2C+the+ScoreDirector+can+explain+the+score+through+constraint+match+totals+and%2For%0Aindictments%3A%0A157%0A5.5.2.+Constraint+Match+Total%3A+Break+down+the+Score+by+Constraint%0ATo+break+down+the+score+per+constraint+%28so+per+score+rule+with+Drools+score+calculation%29%2C+get+the%0AConstraintMatchTotals+from+the+ScoreDirector%3A%0Afor+%28ConstraintMatchTotal+constraintMatchTotal+%3A+guiScoreDirector%0A.getConstraintMatchTotals%28%29%29+%7B%0A%C2%A0+++String+constraintName+%3D+constraintMatchTotal.getConstraintName%28%29%3B%0A%C2%A0+++%2F%2F+The+score+impact+of+that+constraint%0A%C2%A0+++Score+scoreTotal+%3D+constraintMatchTotal.getScoreTotal%28%29%3B%0A%C2%A0+++for+%28ConstraintMatch+constraintMatch+%3A+constraintMatchTotal.getConstraintMatchSet%0A%28%29%29+%7B%0A%C2%A0+++++++List%3CObject%3E+justificationList+%3D+constraintMatch.getJustificationList%28%29%3B%0A%C2%A0+++++++Score+score+%3D+constraintMatch.getScore%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A%7D%0AEach+ConstraintMatchTotal+is+one+constraint+%28so+one+score+rule%29+and+has+a+part+of+the+overall+score.%0AThe+sum+of+ConstraintMatchTotal.getScoreTotal%28%29+equals+the+overall+score.%0A158%0ADrools+score+calculation+supports+constraint+matches+automatically%2C+but%0A%EF%81%9A+incremental+Java+score+calculation+requires+implementing+an+extra+interface.%0A5.5.3.+Indictment+Heat+Map%3A+Visualize+the+Hot+Planning+Entities%0ATo+show+a+heat+map+in+the+UI+that+highlights+the+planning+entities+and+problem+facts+have+an%0Aimpact+on+the+Score%2C+get+the+Indictment+map+from+the+ScoreDirector%3A%0AMap%3CObject%2C+Indictment%3E+indictmentMap+%3D+guiScoreDirector.getIndictmentMap%28%29%3B%0Afor+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++Indictment+indictment+%3D+indictmentMap.get%28process%29%3B%0A%C2%A0+++if+%28indictment+%3D%3D+null%29+%7B%0A%C2%A0+++++++continue%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+The+score+impact+of+that+planning+entity%0A%C2%A0+++Score+scoreTotal+%3D+indictment.getScoreTotal%28%29%3B%0A%C2%A0+++for+%28ConstraintMatch+constraintMatch+%3A+indictment.getConstraintMatchSet%28%29%29+%7B%0A%C2%A0+++++++String+constraintName+%3D+constraintMatch.getConstraintName%28%29%3B%0A%C2%A0+++++++Score+score+%3D+constraintMatch.getScore%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A%7D%0AEach+Indictment+is+the+sum+of+all+constraints+where+that+justification+object+is+involved+with.+The%0Asum+of+Indictment.getScoreTotal%28%29+differs+from+the+overall+score%2C+because+multiple+Indictments+can%0Ashare+the+same+ConstraintMatch.%0ADrools+score+calculation+supports+indictments+and+constraint+matches%0A%EF%81%9A+automatically%2C+but+incremental+Java+score+calculation+requires+implementing+an%0Aextra+interface.%0A5.6.+Testing+score+constraints+with+JUnit%0AIt%E2%80%99s+recommended+to+write+a+unit+test+for+each+score+constraint+individually+to+check+that+it+behaves%0Acorrectly.%0AAdd+a+test+scoped+dependency+to+the+optaplanner-test+jar+to+take+advantage+of+the+JUnit+integration%0Aand+use+the+ScoreVerifier+classes+to+test+score+rules+in+DRL+%28or+a+constraint+match+aware%0Aincremental+score+calculator%29.+For+example%2C+suppose+we+want+to+test+these+score+rules%3A%0A159%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0Arule+%22requiredCpuPowerTotal%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addHardConstraintMatch%28...%29%3B%0Aend%0A...%0Arule+%22computerCost%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28...%29%3B%0Aend%0AFor+each+score+rule%2C+we+have+a+separate+%40Test+that+only+tests+the+effect+of+that+score+rule+on+the%0Ascore%3A%0Apublic+class+CloudBalancingScoreConstraintTest+%7B%0A%C2%A0+++private+HardSoftScoreVerifier%3CCloudBalance%3E+scoreVerifier+%3D+new%0AHardSoftScoreVerifier%3C%3E%28%0A%C2%A0+++++++++++SolverFactory.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%29%3B%0A%C2%A0+++%40Test%0A%C2%A0+++public+void+requiredCpuPowerTotal%28%29+%7B%0A%C2%A0+++++++CloudComputer+c1+%3D+new+CloudComputer%281L%2C+1000%2C+1%2C+1%2C+1%29%3B%0A%C2%A0+++++++CloudComputer+c2+%3D+new+CloudComputer%282L%2C+200%2C+1%2C+1%2C+1%29%3B%0A%C2%A0+++++++CloudProcess+p1+%3D+new+CloudProcess%281L%2C+700%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudProcess+p2+%3D+new+CloudProcess%282L%2C+70%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudBalance+solution+%3D+new+CloudBalance%280L%2C%0A%C2%A0+++++++++++++++Arrays.asList%28c1%2C+c2%29%2C%0A%C2%A0+++++++++++++++Arrays.asList%28p1%2C+p2%29%29%3B%0A%C2%A0+++++++%2F%2F+Uninitialized%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c1%29%3B%0A%C2%A0+++++++p2.setComputer%28c1%29%3B%0A%C2%A0+++++++%2F%2F+Usage+700+%2B+70+is+within+capacity+1000+of+c1%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c2%29%3B%0A%C2%A0+++++++p2.setComputer%28c2%29%3B%0A%C2%A0+++++++%2F%2F+Usage+700+%2B+70+is+above+capacity+200+of+c2%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+-570%2C+solution%29%3B%0A%C2%A0+++%7D%0A160%0A%C2%A0+++...%0A%C2%A0+++%40Test%0A%C2%A0+++public+void+computerCost%28%29+%7B%0A%C2%A0+++++++CloudComputer+c1+%3D+new+CloudComputer%281L%2C+1%2C+1%2C+1%2C+200%29%3B%0A%C2%A0+++++++CloudComputer+c2+%3D+new+CloudComputer%282L%2C+1%2C+1%2C+1%2C+30%29%3B%0A%C2%A0+++++++CloudProcess+p1+%3D+new+CloudProcess%281L%2C+0%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudProcess+p2+%3D+new+CloudProcess%282L%2C+0%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudBalance+solution+%3D+new+CloudBalance%280L%2C%0A%C2%A0+++++++++++++++Arrays.asList%28c1%2C+c2%29%2C%0A%C2%A0+++++++++++++++Arrays.asList%28p1%2C+p2%29%29%3B%0A%C2%A0+++++++%2F%2F+Uninitialized%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c1%29%3B%0A%C2%A0+++++++p2.setComputer%28c1%29%3B%0A%C2%A0+++++++%2F%2F+Pay+200+for+c1%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+-200%2C+solution%29%3B%0A%C2%A0+++++++p2.setComputer%28c2%29%3B%0A%C2%A0+++++++%2F%2F+Pay+200+%2B+30+for+c1+and+c2%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+-230%2C+solution%29%3B%0A%C2%A0+++%7D%0A%7D%0AThere+is+a+ScoreVerifier+implementation+for+each+Score+implementation.+In+the+assertHardWeight%28%29%0Aand+assertSoftWeight%28%29+methods%2C+the+weight+of+the+other+score+rules+is+ignored+%28even+those+of+the%0Asame+score+level%29.%0AA+ScoreVerifier+does+not+work+well+to+isolate+score+corruption%2C+use+an%0A%EF%81%9A+assertionScoreDirectorFactory+instead.%0A161%0AChapter+6.+Shadow+Variable%0A6.1.+Introduction%0AA+shadow+variable+is+a+planning+variable+whose+correct+value+can+be+deduced+from+the+state+of+the%0Agenuine+planning+variables.+Even+though+such+a+variable+violates+the+principle+of+normalization+by%0Adefinition%2C+in+some+use+cases+it+can+be+very+practical+to+use+a+shadow+variable%2C+especially+to+express%0Athe+constraints+more+naturally.+For+example+in+vehicle+routing+with+time+windows%3A+the+arrival+time%0Aat+a+customer+for+a+vehicle+can+be+calculated+based+on+the+previously+visited+customers+of+that%0Avehicle+%28and+the+known+travel+times+between+two+locations%29.%0AWhen+the+customers+for+a+vehicle+change%2C+the+arrival+time+for+each+customer+is+automatically%0Aadjusted.+For+more+information%2C+see+the+vehicle+routing+domain+model.%0AFrom+a+score+calculation+perspective%2C+a+shadow+variable+is+like+any+other+planning+variable.+From%0Aan+optimization+perspective%2C+Planner+effectively+only+optimizes+the+genuine+variables+%28and+mostly%0Aignores+the+shadow+variables%29%3A+it+just+assures+that+when+a+genuine+variable+changes%2C+any+dependent%0Ashadow+variables+are+changed+accordingly.%0A162%0AAny+class+that+has+at+least+one+shadow+variable%2C+is+a+planning+entity+class%0A%28even+if+it+has+no+genuine+planning+variables%29.+That+class+must+be+defined+in%0Athe+solver+configuration+%28unless+classes+are+automatically+scanned%29+and+have+a%0A%EF%81%AA+%40PlanningEntity+annotation.%0AA+genuine+planning+entity+class+has+at+least+one+genuine+planning+variable%2C+but+can%0Ahave+shadow+variables+too.+A+shadow+planning+entity+class+has+no+genuine%0Aplanning+variables+and+at+least+one+shadow+planning+variable.%0AThere+are+several+built-in+shadow+variables%3A%0A6.2.+Bi-directional+Variable+%28Inverse+Relation+Shadow%0AVariable%29%0ATwo+variables+are+bi-directional+if+their+instances+always+point+to+each+other+%28unless+one+side+points%0Ato+null+and+the+other+side+does+not+exist%29.+So+if+A+references+B%2C+then+B+references+A.%0AFor+a+non-chained+planning+variable%2C+the+bi-directional+relationship+must+be+a+many+to+one%0Arelationship.+To+map+a+bi-directional+relationship+between+two+planning+variables%2C+annotate+the%0Amaster+side+%28which+is+the+genuine+side%29+as+a+normal+planning+variable%3A%0A163%0A%40PlanningEntity%0Apublic+class+CloudProcess+%7B%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setComputer%28CloudComputer+computer%29+%7B...%7D%0A%7D%0AAnd+then+annotate+the+other+side+%28which+is+the+shadow+side%29+with+a+%40InverseRelationShadowVariable%0Aannotation+on+a+Collection+%28usually+a+Set+or+List%29+property%3A%0A%40PlanningEntity%0Apublic+class+CloudComputer+%7B%0A%C2%A0+++%40InverseRelationShadowVariable%28sourceVariableName+%3D+%22computer%22%29%0A%C2%A0+++public+List%3CCloudProcess%3E+getProcessList%28%29+%7B%0A%C2%A0+++++++return+processList%3B%0A%C2%A0+++%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.+The+sourceVariableName+property+is+the+name+of+the+genuine%0Aplanning+variable+on+the+return+type+of+the+getter+%28so+the+name+of+the+genuine+planning+variable+on%0Athe+other+side%29.%0AThe+shadow+property%2C+which+is+a+Collection%2C+can+never+be+null.+If+no+genuine%0Avariable+is+referencing+that+shadow+entity%2C+then+it+is+an+empty+Collection.%0A%EF%81%9A+Furthermore+it+must+be+a+mutable+Collection+because+once+the+Solver+starts%0Ainitializing+or+changing+genuine+planning+variables%2C+it+will+add+and+remove+to+the%0ACollections+of+those+shadow+variables+accordingly.%0AFor+a+chained+planning+variable%2C+the+bi-directional+relationship+is+always+a+one+to+one+relationship.%0AIn+that+case%2C+the+genuine+side+looks+like+this%3A%0A164%0A%40PlanningEntity%0Apublic+class+Customer+...+%7B%0A%C2%A0+++%40PlanningVariable%28graphType+%3D+PlanningVariableGraphType.CHAINED%2C+...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setPreviousStandstill%28Standstill+previousStandstill%29+%7B...%7D%0A%7D%0AAnd+the+shadow+side+looks+like+this%3A%0A%40PlanningEntity%0Apublic+class+Standstill+%7B%0A%C2%A0+++%40InverseRelationShadowVariable%28sourceVariableName+%3D+%22previousStandstill%22%29%0A%C2%A0+++public+Customer+getNextCustomer%28%29+%7B%0A%C2%A0++++++++return+nextCustomer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setNextCustomer%28Customer+nextCustomer%29+%7B...%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.%0AThe+input+planning+problem+of+a+Solver+must+not+violate+bi-directional%0A%EF%81%B1+relationships.+If+A+points+to+B%2C+then+B+must+point+to+A.+Planner+will+not+violate+that%0Aprinciple+during+planning%2C+but+the+input+must+not+violate+it+either.%0A6.3.+Anchor+Shadow+Variable%0AAn+anchor+shadow+variable+is+the+anchor+of+a+chained+variable.%0AAnnotate+the+anchor+property+as+a+%40AnchorShadowVariable+annotation%3A%0A%40PlanningEntity%0Apublic+class+Customer+%7B%0A%C2%A0+++%40AnchorShadowVariable%28sourceVariableName+%3D+%22previousStandstill%22%29%0A%C2%A0+++public+Vehicle+getVehicle%28%29+%7B...%7D%0A%C2%A0+++public+void+setVehicle%28Vehicle+vehicle%29+%7B...%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.+The+sourceVariableName+property+is+the+name+of+the+chained%0A165%0Avariable+on+the+same+entity+class.%0A6.4.+Custom+VariableListener%0ATo+update+a+shadow+variable%2C+Planner+uses+a+VariableListener.+To+define+a+custom+shadow+variable%2C%0Awrite+a+custom+VariableListener%3A+implement+the+interface+and+annotate+it+on+the+shadow+variable%0Athat+needs+to+change.%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerClass+%3D+VehicleUpdatingVariableListener%0A.class%2C%0A%C2%A0+++++++++++sources+%3D+%7B%40PlanningVariableReference%28variableName+%3D+%22previousStandstill%22%0A%29%7D%29%0A%C2%A0+++public+Vehicle+getVehicle%28%29+%7B%0A%C2%A0+++++++return+vehicle%3B%0A%C2%A0+++%7D%0ARegister+this+class+as+a+planning+entity.+The+variableName+is+the+%28genuine+or+shadow%29+variable+that%0Atriggers+changes+to+this+shadow+variable.%0AIf+the+class+of+the+trigger+variable+is+different+than+the+shadow+variable%2C+also%0Aspecify+the+entityClass+on+%40PlanningVariableReference.+In+that+case%2C+make+sure+that%0A%EF%81%9A+entityClass+is+also+properly+configured+as+a+planning+entity+class+in+the+solver%0Aconfig%2C+or+the+VariableListener+will+simply+never+trigger.%0AFor+example%2C+the+VehicleUpdatingVariableListener+assures+that+every+Customer+in+a+chain+has+the%0Asame+Vehicle%2C+namely+the+chain%E2%80%99s+anchor.%0A166%0Apublic+class+VehicleUpdatingVariableListener+implements+VariableListener%3CCustomer%3E+%7B%0A%C2%A0+++public+void+afterEntityAdded%28ScoreDirector+scoreDirector%2C+Customer+customer%29+%7B%0A%C2%A0+++++++updateVehicle%28scoreDirector%2C+customer%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterVariableChanged%28ScoreDirector+scoreDirector%2C+Customer+customer%29+%7B%0A%C2%A0+++++++updateVehicle%28scoreDirector%2C+customer%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%C2%A0+++protected+void+updateVehicle%28ScoreDirector+scoreDirector%2C+Customer+sourceCustomer%29%0A%7B%0A%C2%A0+++++++Standstill+previousStandstill+%3D+sourceCustomer.getPreviousStandstill%28%29%3B%0A%C2%A0+++++++Vehicle+vehicle+%3D+previousStandstill+%3D%3D+null+%3F+null+%3A+previousStandstill%0A.getVehicle%28%29%3B%0A%C2%A0+++++++Customer+shadowCustomer+%3D+sourceCustomer%3B%0A%C2%A0+++++++while+%28shadowCustomer+%21%3D+null+%26%26+shadowCustomer.getVehicle%28%29+%21%3D+vehicle%29+%7B%0A%C2%A0+++++++++++scoreDirector.beforeVariableChanged%28shadowCustomer%2C+%22vehicle%22%29%3B%0A%C2%A0+++++++++++shadowCustomer.setVehicle%28vehicle%29%3B%0A%C2%A0+++++++++++scoreDirector.afterVariableChanged%28shadowCustomer%2C+%22vehicle%22%29%3B%0A%C2%A0+++++++++++shadowCustomer+%3D+shadowCustomer.getNextCustomer%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AA+VariableListener+can+only+change+shadow+variables.+It+must+never+change+a%0A%EF%81%B1+genuine+planning+variable+or+a+problem+fact.%0A%EF%81%B1+Any+change+of+a+shadow+variable+must+be+told+to+the+ScoreDirector.%0AIf+one+VariableListener+changes+two+shadow+variables+%28because+having+two+separate%0AVariableListeners+would+be+inefficient%29%2C+then+annotate+only+the+first+shadow+variable+with+the%0AvariableListenerClass+and+let+the+other+shadow+variable%28s%29+reference+the+first+shadow+variable%3A%0A167%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerClass+%3D%0ATransportTimeAndCapacityUpdatingVariableListener.class%2C%0A%C2%A0+++++++++++sources+%3D+%7B%40PlanningVariableReference%28variableName+%3D+%22previousStandstill%22%0A%29%7D%29%0A%C2%A0+++public+Integer+getTransportTime%28%29+%7B%0A%C2%A0+++++++return+transportTime%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerRef+%3D+%40PlanningVariableReference%0A%28variableName+%3D+%22transportTime%22%29%29%0A%C2%A0+++public+Integer+getCapacity%28%29+%7B%0A%C2%A0+++++++return+capacity%3B%0A%C2%A0+++%7D%0A6.5.+VariableListener+triggering+order%0AAll+shadow+variables+are+triggered+by+a+VariableListener%2C+regardless+if+it%E2%80%99s+a+built-in+or+a+custom%0Ashadow+variable.+The+genuine+and+shadow+variables+form+a+graph%2C+that+determines+the+order+in%0Awhich+the+afterEntityAdded%28%29%2C+afterVariableChanged%28%29+and+afterEntityRemoved%28%29+methods+are+called%3A%0A168%0AIn+the+example+above%2C+D+could+have+also+been+ordered+after+E+%28or+F%29+because+there%0A%EF%81%9A+is+no+direct+or+indirect+dependency+between+D+and+E+%28or+F%29.%0APlanner+guarantees+that%3A%0A%E2%80%A2+The+first+VariableListener%27s+after*%28%29+methods+trigger+after+the+last+genuine+variable+has%0Achanged.+Therefore+the+genuine+variables+%28A+and+B+in+the+example+above%29+are+guaranteed+to+be%0Ain+a+consistent+state+across+all+its+instances+%28with+values+A1%2C+A2+and+B1+in+the+example+above%29%0Abecause+the+entire+Move+has+been+applied.%0A%E2%80%A2+The+second+VariableListener%27s+after*%28%29+methods+trigger+after+the+last+first+shadow+variable+has%0Achanged.+Therefore+the+first+shadow+variable+%28C+in+the+example+above%29+are+guaranteed+to+be+in%0Aconsistent+state+across+all+its+instances+%28with+values+C1+and+C2+in+the+example+above%29.+And+of%0Acourse+the+genuine+variables+too.%0A%E2%80%A2+And+so+forth.%0APlanner+does+not+guarantee+the+order+in+which+the+after*%28%29+methods+are+called+for+the%0AsameVariableListener+with+different+parameters+%28such+as+A1+and+A2+in+the+example+above%29%2C%0Aalthough+they+are+likely+to+be+in+the+order+in+which+they+were+affected.%0ABy+default%2C+Planner+does+not+guarantee+that+the+events+are+unique.+For+example%2C+if+a+shadow%0Avariable+on+an+entity+is+changed+twice+in+the+same+move+%28for+example+by+two+different+genuine%0Avariables%29%2C+then+that+will+cause+the+same+event+twice+on+the+VariableListeners+that+are+listening+to%0Athat+original+shadow+variable.+To+avoid+dealing+with+that+complexity%2C+overwrite+the+method%0A169%0ArequiresUniqueEntityEvents%28%29+to+receive+unique+events+at+the+cost+of+a+small+performance+penalty%3A%0Apublic+class+StartTimeUpdatingVariableListener+implements+VariableListener%3CTask%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+requiresUniqueEntityEvents%28%29+%7B%0A%C2%A0+++++++return+true%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A170%0AChapter+7.+Optimization+Algorithms%0A7.1.+Search+Space+Size+in+the+Real+World%0AThe+number+of+possible+solutions+for+a+planning+problem+can+be+mind+blowing.+For+example%3A%0A%E2%80%A2+Four+queens+has+256+possible+solutions+%284%5E4%29+and+two+optimal+solutions.%0A%E2%80%A2+Five+queens+has+3125+possible+solutions+%285%5E5%29+and+one+optimal+solution.%0A%E2%80%A2+Eight+queens+has+16777216+possible+solutions+%288%5E8%29+and+92+optimal+solutions.%0A%E2%80%A2+64+queens+has+more+than+10%5E115+possible+solutions+%2864%5E64%29.%0A%E2%80%A2+Most+real-life+planning+problems+have+an+incredible+number+of+possible+solutions+and+only+one%0Aor+a+few+optimal+solutions.%0AFor+comparison%3A+the+minimal+number+of+atoms+in+the+known+universe+%2810%5E80%29.+As+a+planning%0Aproblem+gets+bigger%2C+the+search+space+tends+to+blow+up+really+fast.+Adding+only+one+extra+planning%0Aentity+or+planning+value+can+heavily+multiply+the+running+time+of+some+algorithms.%0ACalculating+the+number+of+possible+solutions+depends+on+the+design+of+the+domain+model%3A%0A171%0AThis+search+space+size+calculation+includes+infeasible+solutions+%28if+they+can+be%0Arepresented+by+the+model%29%2C+because%3A%0A%E2%80%A2+The+optimal+solution+might+be+infeasible.%0A%EF%81%9A+%E2%80%A2+There+are+many+types+of+hard+constraints+that+cannot+be+incorporated+in+theformula+practically.+For+example%2C+in+Cloud+Balancing%2C+try+incorporating+the+CPU%0Acapacity+constraint+in+the+formula.%0AEven+in+cases+where+adding+some+of+the+hard+constraints+in+the+formula+is%0Apractical+%28for+example%2C+Course+Scheduling%29%2C+the+resulting+search+space+is+still+huge.%0AAn+algorithm+that+checks+every+possible+solution+%28even+with+pruning%2C+such+as+in+Branch+And+Bound%29%0Acan+easily+run+for+billions+of+years+on+a+single+real-life+planning+problem.+The+aim+is+to+find+the+best%0Asolution+in+the+available+timeframe.+Planning+competitions+%28such+as+the+International+Timetabling%0ACompetition%29+show+that+Local+Search+variations+%28Tabu+Search%2C+Simulated+Annealing%2C+Late%0AAcceptance%2C+%E2%80%A6%29+usually+perform+best+for+real-world+problems+given+real-world+time+limitations.%0A7.2.+Does+Planner+Find+the+Optimal+Solution%3F%0AThe+business+wants+the+optimal+solution%2C+but+they+also+have+other+requirements%3A%0A%E2%80%A2+Scale+out%3A+Large+production+data+sets+must+not+crash+and+have+also+good+results.%0A172%0A%E2%80%A2+Optimize+the+right+problem%3A+The+constraints+must+match+the+actual+business+needs.%0A%E2%80%A2+Available+time%3A+The+solution+must+be+found+in+time%2C+before+it+becomes+useless+to+execute.%0A%E2%80%A2+Reliability%3A+Every+data+set+must+have+at+least+a+decent+result+%28better+than+a+human+planner%29.%0AGiven+these+requirements%2C+and+despite+the+promises+of+some+salesmen%2C+it+is+usually+impossible+for%0Aanyone+or+anything+to+find+the+optimal+solution.+Therefore%2C+Planner+focuses+on+finding+the+best%0Asolution+in+available+time.+In+realistic%2C+independent+competitions%2C+it+often+comes+out+as+the+best%0Areusable+software.%0AThe+nature+of+NP-complete+problems+make+scaling+a+prime+concern.%0AThe+quality+of+a+result+from+a+small+data+set+is+no+indication+of+the+quality+of+a%0A%EF%81%9A+result+from+a+large+data+set.%0AScaling+issues+cannot+be+mitigated+by+hardware+purchases+later+on.+Start+testing+with+a+production%0Asized+data+set+as+soon+as+possible.+Do+not+assess+quality+on+small+data+sets+%28unless+production%0Aencounters+only+such+data+sets%29.+Instead%2C+solve+a+production+sized+data+set+and+compare+the+results%0Aof+longer+executions%2C+different+algorithms+and+-+if+available+-+the+human+planner.%0A7.3.+Architecture+Overview%0APlanner+is+the+first+framework+to+combine+optimization+algorithms+%28metaheuristics%2C+%E2%80%A6%29+with+score%0Acalculation+by+a+rule+engine+%28such+as+Drools+Expert%29.+This+combination+is+very+efficient%2C+because%3A%0A%E2%80%A2+A+rule+engine%2C+such+as+Drools+Expert%2C+is+great+for+calculating+the+score+of+a+solution+of+a%0Aplanning+problem.+It+makes+it+easy+and+scalable+to+add+additional+soft+or+hard+constraints+such%0Aas%2C+%22a+teacher+should+not+teach+more+then+seven+hours+a+day%22.+It+does+delta-based+score%0Acalculation+without+any+extra+code.+However+it+tends+to+be+not+suitable+to+actually+find+new%0Asolutions.%0A%E2%80%A2+An+optimization+algorithm+is+great+at+finding+new+improving+solutions+for+a+planning%0Aproblem%2C+without+necessarily+brute-forcing+every+possibility.+However%2C+it+needs+to+know+the%0Ascore+of+a+solution+and+offers+no+support+in+calculating+that+score+efficiently.%0A173%0A7.4.+Optimization+Algorithms+Overview%0APlanner+supports+three+families+of+optimization+algorithms%3A+Exhaustive+Search%2C+Construction%0AHeuristics+and+Metaheuristics.+In+practice%2C+Metaheuristics+%28in+combination+with+Construction%0AHeuristics+to+initialize%29+are+the+recommended+choice%3A%0A174%0AEach+of+these+algorithm+families+have+multiple+optimization+algorithms%3A%0ATable+4.+Optimization+Algorithms+Overview%0AAlgorithm+Scalable%3F+Optimal%3F+Easy+to+use%3F+Tweakable%3F+Requires+CH%3F%0AExhaustive+Search+%28ES%29%0A%C2%A0%C2%A0Brute+Force+0%2F5+5%2F5+5%2F5+0%2F5+No%0A%C2%A0%C2%A0Branch+And+0%2F5+5%2F5+4%2F5+2%2F5+No%0ABound%0AConstruction+heuristics+%28CH%29%0A%C2%A0%C2%A0First+Fit+5%2F5+1%2F5+5%2F5+1%2F5+No%0A%C2%A0%C2%A0First+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Weakest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0A%C2%A0%C2%A0Weakest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Strongest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0A%C2%A0%C2%A0Strongest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Cheapest+3%2F5+2%2F5+5%2F5+2%2F5+No%0AInsertion%0A175%0AAlgorithm+Scalable%3F+Optimal%3F+Easy+to+use%3F+Tweakable%3F+Requires+CH%3F%0A%C2%A0%C2%A0Regret+3%2F5+2%2F5+5%2F5+2%2F5+No%0AInsertion%0AMetaheuristics+%28MH%29%0A%C2%A0%C2%A0Local+Search+%28LS%29%0A%C2%A0%C2%A0%C2%A0%C2%A0Hill+Climbing+5%2F5+2%2F5+4%2F5+3%2F5+Yes%0A%C2%A0%C2%A0%C2%A0%C2%A0Tabu+Search+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0A%C2%A0%C2%A0%C2%A0%C2%A0Simulated+5%2F5+4%2F5+2%2F5+5%2F5+Yes%0AAnnealing%0A%C2%A0%C2%A0%C2%A0%C2%A0Late+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0AAcceptance%0A%C2%A0%C2%A0%C2%A0%C2%A0Step+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0ACounting+Hill%0AClimbing%0A%C2%A0%C2%A0%C2%A0%C2%A0Variable+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0ANeighborhood%0ADescent%0A%C2%A0%C2%A0Evolutionary+Algorithms+%28EA%29%0A%C2%A0%C2%A0%C2%A0%C2%A0Evolutionary+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0AStrategies%0A%C2%A0%C2%A0%C2%A0%C2%A0Genetic+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0AAlgorithms%0ATo+learn+more+about+metaheuristics%2C+see+Essentials+of+Metaheuristics+or+Clever+Algorithms.%0A7.5.+Which+Optimization+Algorithms+Should+I+Use%3F%0AThe+best+optimization+algorithms+configuration+to+use+depends+heavily+on+your+use+case.+However%2C%0Athis+basic+procedure+provides+a+good+starting+configuration+that+will+produce+better+than+average%0Aresults.%0A1.+Start+with+a+quick+configuration+that+involves+little+or+no+configuration+and+optimization+code%3A%0ASee+First+Fit.%0A2.+Next%2C+implement+planning+entity+difficulty+comparison+and+turn+it+into+First+Fit+Decreasing.%0A3.+Next%2C+add+Late+Acceptance+behind+it%3A%0Aa.+First+Fit+Decreasing.%0Ab.+Late+Acceptance.%0AAt+this+point%2C+the+return+on+invested+time+lowers+and+the+result+is+likely+to+be+sufficient.%0AHowever%2C+this+can+be+improved+at+a+lower+return+on+invested+time.+Use+the+Benchmarker+and+try+a%0Acouple+of+different+Tabu+Search%2C+Simulated+Annealing+and+Late+Acceptance+configurations%2C+for%0Aexample%3A%0A176%0A1.+First+Fit+Decreasing%3A+Tabu+Search.%0AUse+the+Benchmarker+to+improve+the+values+for+the+size+parameters.%0AOther+experiments+can+also+be+run.+For+example%2C+the+following+multiple+algorithms+can+be%0Acombined+together%3A%0A1.+First+Fit+Decreasing%0A2.+Late+Acceptance+%28relatively+long+time%29%0A3.+Tabu+Search+%28relatively+short+time%29%0A7.6.+Power+tweaking+or+default+parameter+values%0AMany+optimization+algorithms+have+parameters+that+affect+results+and+scalability.+Planner+applies%0Aconfiguration+by+exception%2C+so+all+optimization+algorithms+have+default+parameter+values.+This+is%0Avery+similar+to+the+Garbage+Collection+parameters+in+a+JVM%3A+most+users+have+no+need+to+tweak%0Athem%2C+but+power+users+often+do.%0AThe+default+parameter+values+are+sufficient+for+many+cases+%28and+especially+for+prototypes%29%2C+but+if%0Adevelopment+time+allows%2C+it+may+be+beneficial+to+power+tweak+them+with+the+benchmarker+for%0Abetter+results+and+scalability+on+a+specific+use+case.+The+documentation+for+each+optimization%0Aalgorithm+also+declares+the+advanced+configuration+for+power+tweaking.%0AThe+default+value+of+parameters+will+change+between+minor+versions%2C+to+improve%0A%EF%81%B1+them+for+most+users.+The+advanced+configuration+can+be+used+to+prevent%0Aunwanted+changes%2C+however%2C+this+is+not+recommended.%0A7.7.+Solver+Phase%0AA+Solver+can+use+multiple+optimization+algorithms+in+sequence.+Each+optimization+algorithm+is%0Arepresented+by+one+solver+Phase.+There+is+never+more+than+one+Phase+solving+at+the+same+time.%0ASome+Phase+implementations+can+combine+techniques+from+multiple+optimization%0A%EF%81%9A+algorithms%2C+but+it+is+still+just+one+Phase.+For+example%3A+a+Local+Search+Phase+can+do%0ASimulated+Annealing+with+entity+Tabu.%0AHere+is+a+configuration+that+runs+three+phases+in+sequence%3A%0A177%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...+%3C%21--+First+phase%3A+First+Fit+Decreasing+--%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...+%3C%21--+Second+phase%3A+Late+Acceptance+--%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...+%3C%21--+Third+phase%3A+Tabu+Search+--%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0AThe+solver+phases+are+run+in+the+order+defined+by+solver+configuration.%0A%E2%80%A2+When+the+first+Phase+terminates%2C+the+second+Phase+starts%2C+and+so+on.%0A%E2%80%A2+When+the+last+Phase+terminates%2C+the+Solver+terminates.%0AUsually%2C+a+Solver+will+first+run+a+construction+heuristic+and+then+run+one+or+multiple+metaheuristics%3A%0AIf+no+phases+are+configured%2C+Planner+will+default+to+a+Construction+Heuristic+phase+followed+by+a%0ALocal+Search+phase.%0A178%0ASome+phases+%28especially+construction+heuristics%29+will+terminate+automatically.+Other+phases%0A%28especially+metaheuristics%29+will+only+terminate+if+the+Phase+is+configured+to+terminate%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3Ctermination%3E%3C%21--+Solver+termination+--%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E90%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%3C%21--+Phase+termination+--%3E%0A%C2%A0+++++%3CsecondsSpentLimit%3E60%3C%2FsecondsSpentLimit%3E%3C%21--+Give+the+next+phase+a+chance+to%0Arun+too%2C+before+the+Solver+terminates+--%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0AIf+the+Solver+terminates+%28before+the+last+Phase+terminates+itself%29%2C+the+current+phase+is+terminated+and%0Aall+subsequent+phases+will+not+run.%0A7.8.+Scope+Overview%0AA+solver+will+iteratively+run+phases.+Each+phase+will+usually+iteratively+run+steps.+Each+step%2C+in+turn%2C%0Ausually+iteratively+runs+moves.+These+form+four+nested+scopes%3A%0A1.+Solver%0A2.+Phase%0A3.+Step%0A4.+Move%0A179%0AConfigure+logging+to+display+the+log+messages+of+each+scope.%0A7.9.+Termination%0ANot+all+phases+terminate+automatically+and+may+take+a+significant+amount+of+time.+A+Solver+can+be%0Aterminated+synchronously+by+up-front+configuration%2C+or+asynchronously+from+another+thread.%0AMetaheuristic+phases+in+particular+need+to+be+instructed+to+stop+solving.+This+can+be+because+of+a%0Anumber+of+reasons%2C+for+example%2C+if+the+time+is+up%2C+or+the+perfect+score+has+been+reached+just+before%0Aits+solution+is+used.+Finding+the+optimal+solution+cannot+be+relied+on+%28unless+you+know+the+optimal%0Ascore%29%2C+because+a+metaheuristic+algorithm+is+generally+unaware+of+the+optimal+solution.%0AThis+is+not+an+issue+for+real-life+problems%2C+as+finding+the+optimal+solution+may+take+more+time+than%0Ais+available.+Finding+the+best+solution+in+the+available+time+is+the+most+important+outcome.%0AIf+no+termination+is+configured+%28and+a+metaheuristic+algorithm+is+used%29%2C+the+Solver%0A%EF%81%AA+will+run+forever%2C+until+terminateEarly%28%29+is+called+from+another+thread.+This+is%0Aespecially+common+during+real-time+planning.%0AFor+synchronous+termination%2C+configure+a+Termination+on+a+Solver+or+a+Phase+when+it+needs+to+stop.%0AThe+built-in+implementations+of+these+should+be+sufficient%2C+but+custom+terminations+are+supported%0Atoo.+Every+Termination+can+calculate+a+time+gradient+%28needed+for+some+optimization+algorithms%29%2C%0Awhich+is+a+ratio+between+the+time+already+spent+solving+and+the+estimated+entire+solving+time+of+the%0A180%0ASolver+or+Phase.%0A7.9.1.+TimeMillisSpentTermination%0ATerminates+when+an+amount+of+time+has+been+used.%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CmillisecondsSpentLimit%3E500%3C%2FmillisecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E10%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CminutesSpentLimit%3E5%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3ChoursSpentLimit%3E1%3C%2FhoursSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CdaysSpentLimit%3E2%3C%2FdaysSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AMultiple+time+types+can+be+used+together%2C+for+example+to+configure+150+minutes%2C+either+configure+it%0Adirectly%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CminutesSpentLimit%3E150%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AOr+use+a+combination+that+sums+up+to+150+minutes%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3ChoursSpentLimit%3E2%3C%2FhoursSpentLimit%3E%0A%C2%A0+++%3CminutesSpentLimit%3E30%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A181%0AThis+Termination+will+most+likely+sacrifice+perfect+reproducibility+%28even+with%0AenvironmentMode+REPRODUCIBLE%29+because+the+available+CPU+time+differs+frequently%0Abetween+runs%3A%0A%EF%81%9A+%E2%80%A2+The+available+CPU+time+influences+the+number+of+steps+that+can+be+taken%2Cwhich+might+be+a+few+more+or+less.%0A%E2%80%A2+The+Termination+might+produce+slightly+different+time+gradient+values%2C+which%0Awill+send+time+gradient-based+algorithms+%28such+as+Simulated+Annealing%29+on+a%0Aradically+different+path.%0A7.9.2.+UnimprovedTimeMillisSpentTermination%0ATerminates+when+the+best+score+has+not+improved+in+a+specified+amount+of+time.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedMillisecondsSpentLimit%3E500%3C%2FunimprovedMillisecondsSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedSecondsSpentLimit%3E10%3C%2FunimprovedSecondsSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedMinutesSpentLimit%3E5%3C%2FunimprovedMinutesSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedHoursSpentLimit%3E1%3C%2FunimprovedHoursSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedDaysSpentLimit%3E1%3C%2FunimprovedDaysSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A182%0AThis+termination+should+not+be+applied+to+Construction+Heuristics+as+they+only+update+the+best%0Asolution+at+the+end.+Configuring+it+on+a+specific+Phase+%28such+as+%3ClocalSearch%3E%29%2C+instead+of+on+the%0ASolver+itself+may+be+a+better+option.%0AThis+Termination+will+most+likely+sacrifice+perfect+reproducibility+%28even+with%0AenvironmentMode+REPRODUCIBLE%29+as+the+available+CPU+time+differs+frequently+between%0Aruns%3A%0A%EF%81%9A+%E2%80%A2+The+available+CPU+time+influences+the+number+of+steps+that+can+be+taken%2Cwhich+might+be+a+few+more+or+less.%0A%E2%80%A2+The+Termination+might+produce+slightly+different+time+gradient+values%2C+which%0Awill+send+time+gradient+based+algorithms+%28such+as+Simulated+Annealing%29+on+a%0Aradically+different+path.%0A7.9.3.+BestScoreTermination%0ABestScoreTermination+terminates+when+a+certain+score+has+been+reached.+Use+this+Termination+where%0Athe+perfect+score+is+known%2C+for+example+for+four+queens+%28which+uses+a+SimpleScore%29%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E0%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AA+planning+problem+with+a+HardSoftScore+may+look+like+this%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E0hard%2F-5000soft%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AA+planning+problem+with+a+BendableScore+with+three+hard+levels+and+one+soft+level+may+look+like%0Athis%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E%5B0%2F0%2F0%5Dhard%2F%5B-5000%5Dsoft%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AIn+this+instance%2C+Termination+once+a+feasible+solution+has+been+reached+is+not+practical+because+it%0Arequires+a+bestScoreLimit+such+as+0hard%2F-2147483648soft.+Use+the+next+termination+instead.%0A7.9.4.+BestScoreFeasibleTermination%0ATerminates+as+soon+as+a+feasible+solution+has+been+discovered.+Requires+that+Score+implements%0AFeasibilityScore.%0A183%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreFeasible%3Etrue%3C%2FbestScoreFeasible%3E%0A%C2%A0+%3C%2Ftermination%3E%0AThis+Termination+is+usually+combined+with+other+terminations.%0A7.9.5.+StepCountTermination%0ATerminates+when+a+number+of+steps+has+been+reached.+This+is+useful+for+hardware+performance%0Aindependent+runs.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CstepCountLimit%3E100%3C%2FstepCountLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AThis+Termination+can+only+be+used+for+a+Phase+%28such+as+%3ClocalSearch%3E%29%2C+not+for+the+Solver+itself.%0A7.9.6.+UnimprovedStepCountTermination%0ATerminates+when+the+best+score+has+not+improved+in+a+number+of+steps.+This+is+useful+for+hardware%0Aperformance+independent+runs.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedStepCountLimit%3E100%3C%2FunimprovedStepCountLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AIf+the+score+has+not+improved+recently%2C+it+is+unlikely+to+improve+in+a+reasonable+timeframe.+It+has%0Abeen+observed+that+once+a+new+best+solution+is+found+%28even+after+a+long+time+without+improvement%0Aon+the+best+solution%29%2C+the+next+few+steps+tend+to+improve+the+best+solution.%0AThis+Termination+can+only+be+used+for+a+Phase+%28such+as+%3ClocalSearch%3E%29%2C+not+for+the+Solver+itself.%0A7.9.7.+ScoreCalculationCountTermination%0AScoreCalculationCountTermination+terminates+when+a+number+of+score+calculations+have+been%0Areached.+This+is+often+the+sum+of+the+number+of+moves+and+the+number+of+steps.+This+is+useful+for%0Abenchmarking.%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CscoreCalculationCountLimit%3E100000%3C%2FscoreCalculationCountLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A184%0ASwitching+EnvironmentMode+can+heavily+impact+when+this+termination+ends.%0A7.9.8.+Combining+Multiple+Terminations%0ATerminations+can+be+combined%2C+for+example%3A+terminate+after+100+steps+or+if+a+score+of+0+has+been%0Areached%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CterminationCompositionStyle%3EOR%3C%2FterminationCompositionStyle%3E%0A%C2%A0+++%3CstepCountLimit%3E100%3C%2FstepCountLimit%3E%0A%C2%A0+++%3CbestScoreLimit%3E0%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AAlternatively+you+can+use+AND%2C+for+example%3A+terminate+after+reaching+a+feasible+score+of+at+least+-100%0Aand+no+improvements+in+5+steps%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CterminationCompositionStyle%3EAND%3C%2FterminationCompositionStyle%3E%0A%C2%A0+++%3CunimprovedStepCountLimit%3E5%3C%2FunimprovedStepCountLimit%3E%0A%C2%A0+++%3CbestScoreLimit%3E-100%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AThis+example+ensures+it+does+not+just+terminate+after+finding+a+feasible+solution%2C+but+also+completes%0Aany+obvious+improvements+on+that+solution+before+terminating.%0A7.9.9.+Asynchronous+Termination+from+Another+Thread%0AAsychronous+termination+from+another+thread+occurs+when+a+Solver+needs+to+be+terminated+early%0Afrom+another+thread%2C+for+example%2C+due+to+a+user+action+or+a+server+restart.+This+cannot+be%0Aconfigured+by+a+Termination+as+it+is+impossible+to+predict+when+and+if+it+will+occur.+Therefore+the%0ASolver+interface+has+the+following+thread-safe+methods%3A%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++boolean+terminateEarly%28%29%3B%0A%C2%A0+++boolean+isTerminateEarly%28%29%3B%0A%7D%0AWhen+calling+the+terminateEarly%28%29+method+from+another+thread%2C+the+Solver+will+terminate+at+its%0Aearliest+convenience+and+the+solve%28Solution%29+method+will+return+%28in+the+original+Solver+thread%29.%0A185%0AInterrupting+the+Solver+thread+%28which+is+the+thread+that+called%0ASolver.solve%28Solution%29%29+has+the+same+affect+as+calling+terminateEarly%28%29+except+that%0A%EF%81%9A+it+leaves+that+thread+in+the+interrupted+state.+This+guarantees+a+graceful+shutdown%0Awhen+an+ExecutorService+%28such+as+a+thread+pool%29+is+shutdown+because+that+only%0Ainterrupts+all+active+threads+in+the+pool.%0A7.10.+SolverEventListener%0AEach+time+a+new+best+solution+is+found%2C+a+new+BestSolutionChangedEvent+is+fired+in+the+Solver+thread.%0ATo+listen+to+such+events%2C+add+a+SolverEventListener+to+the+Solver%3A%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++void+addEventListener%28SolverEventListener%3CS%3E+eventListener%29%3B%0A%C2%A0+++void+removeEventListener%28SolverEventListener%3CS%3E+eventListener%29%3B%0A%7D%0AThe+BestSolutionChangedEvent%27s+newBestSolution+may+not+be+initialized+or+feasible.+Use+the%0AisFeasible%28%29+method+on+BestSolutionChangedEvent%27s+new+best+Score+to+detect+such+cases%3A%0A%C2%A0+++solver.addEventListener%28new+SolverEventListener%3CCloudBalance%3E%28%29+%7B%0A%C2%A0+++++++public+void+bestSolutionChanged%28BestSolutionChangedEvent%3CCloudBalance%3E+event%29%0A%7B%0A%C2%A0+++++++++++%2F%2F+Ignore+infeasible+%28including+uninitialized%29+solutions%0A%C2%A0+++++++++++if+%28event.getNewBestSolution%28%29.getScore%28%29.isFeasible%28%29%29+%7B%0A%C2%A0+++++++++++++++...%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%29%3B%0AUse+Score.isSolutionInitialized%28%29+instead+of+Score.isFeasible%28%29+to+only+ignore+uninitialized%0Asolutions%2C+but+also+accept+infeasible+solutions.%0AThe+bestSolutionChanged%28%29+method+is+called+in+the+solver%E2%80%99s+thread%2C+as+part+of%0A%EF%81%B1+Solver.solve%28%29.+So+it+should+return+quickly+to+avoid+slowing+down+the+solving.%0A7.11.+Custom+Solver+Phase%0ARun+a+custom+optimization+algorithm+between+phases+or+before+the+first+phase+to+initialize+the%0ASolution%2C+or+to+get+a+better+score+quickly.+You+will+still+want+to+reuse+the+score+calculation.+For%0Aexample%2C+to+implement+a+custom+Construction+Heuristic+without+implementing+an+entire+Phase.%0A186%0AMost+of+the+time%2C+a+custom+solver+phase+is+not+worth+the+development+time%0Ainvestment.+The+supported+Constructions+Heuristics+are+configurable+%28use+the%0A%EF%81%9A+Benchmarker+to+tweak+them%29%2C+Termination+aware+and+support+partially+initialized%0Asolutions+too.%0AThe+CustomPhaseCommand+interface+appears+as+follows%3A%0Apublic+interface+CustomPhaseCommand%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++void+changeWorkingSolution%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%7D%0AFor+example%2C+extend+AbstractCustomPhaseCommand+and+implement+the+changeWorkingSolution%28%29%0Amethod%3A%0Apublic+class+ToOriginalMachineSolutionInitializer+extends+AbstractCustomPhaseCommand%0A%3CMachineReassignment%3E+%7B%0A%C2%A0+++public+void+changeWorkingSolution%28ScoreDirector%3CMachineReassignment%3E%0AscoreDirector%29+%7B%0A%C2%A0+++++++MachineReassignment+machineReassignment+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++for+%28MrProcessAssignment+processAssignment+%3A+machineReassignment%0A.getProcessAssignmentList%28%29%29+%7B%0A%C2%A0+++++++++++scoreDirector.beforeVariableChanged%28processAssignment%2C+%22machine%22%29%3B%0A%C2%A0+++++++++++processAssignment.setMachine%28processAssignment.getOriginalMachine%28%29%29%3B%0A%C2%A0+++++++++++scoreDirector.afterVariableChanged%28processAssignment%2C+%22machine%22%29%3B%0A%C2%A0+++++++++++scoreDirector.triggerVariableListeners%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AAny+change+on+the+planning+entities+in+a+CustomPhaseCommand+must+be+notified+to+the%0A%EF%81%B1+ScoreDirector.%0ADo+not+change+any+of+the+problem+facts+in+a+CustomPhaseCommand.+That+will+corrupt%0Athe+Solver+because+any+previous+score+or+solution+was+for+a+different+problem.+To%0A%EF%81%9A+do+that%2C+read+about+repeated+planning+and+do+it+with+a+ProblemFactChange%0Ainstead.%0AConfigure+the+CustomPhaseCommand+in+the+solver+configuration%3A%0A187%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0%0A%3CcustomPhaseCommandClass%3Eorg.optaplanner.examples.machinereassignment.solver.solution.%0Ainitializer.ToOriginalMachineSolutionInitializer%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0A%C2%A0+...+%3C%21--+Other+phases+--%3E%0A%3C%2Fsolver%3E%0AConfigure+multiple+customPhaseCommandClass+instances+to+run+them+in+sequence.%0AIf+the+changes+of+a+CustomPhaseCommand+do+not+result+in+a+better+score%2C+the+best%0Asolution+will+not+be+changed+%28so+effectively+nothing+will+have+changed+for+the+next%0APhase+or+CustomPhaseCommand%29.+To+force+such+changes+anyway%2C+use%0AforceUpdateBestSolution%3A%0A%EF%81%AA%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0+++%3CcustomPhaseCommandClass%3E...MyCustomPhase%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+++%3CforceUpdateBestSolution%3Etrue%3C%2FforceUpdateBestSolution%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0AIf+the+Solver+or+a+Phase+wants+to+terminate+while+a+CustomPhaseCommand+is+still%0Arunning%2C+it+will+wait+to+terminate+until+the+CustomPhaseCommand+is+complete.+This%0A%EF%81%9A+may+take+a+significant+amount+of+time.+The+built-in+solver+phases+do+not+have+this%0Aissue.%0ATo+configure+values+of+a+CustomPhaseCommand+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+customProperties+element+and+use+custom%0Aproperties%3A%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0+++%3CcustomPhaseCommandClass%3E...MyCustomPhase%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+++%3CcustomProperties%3E%0A%C2%A0+++++%3CmySelectionSize%3E5%3C%2FmySelectionSize%3E%0A%C2%A0+++%3C%2FcustomProperties%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0A7.12.+No+Change+Solver+Phase%0AIn+rare+cases%2C+it%E2%80%99s+useful+not+to+run+any+solver+phases.+But+by+default%2C+configuring+no+phase+will%0Atrigger+running+the+default+phases.+To+avoid+those%2C+configure+a+NoChangePhase%3A%0A188%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CnoChangePhase%2F%3E%0A%3C%2Fsolver%3E%0A7.13.+Multithreaded+Solving%0AThere+are+several+ways+of+doing+multithreaded+solving%3A%0A%E2%80%A2+Multitenancy%3A+solve+different+datasets+in+parallel%0A%E2%97%A6+The+SolverManager+will+make+it+even+easier+to+set+this+up%2C+in+a+future+version.%0A%E2%80%A2+Multi+bet+solving%3A+solve+1+dataset+with+multiple%2C+isolated+solvers+and+take+the+best+result.%0A%E2%97%A6+Not+recommended%3A+This+is+a+marginal+gain+for+a+high+cost+of+hardware+resources.%0A%E2%97%A6+Use+the+Benchmarker+during+development+to+determine+the+most+appropriate+algorithm%2C%0Aalthough+that%E2%80%99s+only+on+average.%0A%E2%97%A6+Use+multithreaded+incremental+solving+instead.%0A%E2%80%A2+Partitioned+Search%3A+Split+1+dataset+in+multiple+parts+and+solve+them+independently.%0A%E2%97%A6+Configure+a+Partitioned+Search.%0A%E2%80%A2+Multithreaded+incremental+solving%3A+solve+1+dataset+with+multiple+threads+without+sacrificing%0Aincremental+score+calculation.%0A%E2%97%A6+Donate+a+portion+of+your+CPU+cores+to+Planner+to+scale+up+the+score+calculation+speed+and%0Aget+the+same+results+in+fraction+of+the+time.%0A%E2%97%A6+Configure+multithreaded+incremental+solving.%0A189%0AA+logging+level+of+debug+or+trace+might+cause+congestion+multithreaded+solving+and%0A%EF%81%9A+slow+down+the+score+calculation+speed.%0A7.13.1.+Custom+Thread+Factory+%28WildFly%2C+Android%2C+GAE%2C+%E2%80%A6%29%0AThe+threadFactoryClass+allows+to+plug+in+a+custom+ThreadFactory+for+environments+where+arbitrary%0Athread+creation+should+be+avoided%2C+such+as+most+application+servers+%28including+WildFly%29%2C+Android%2C%0Aor+Google+App+Engine.%0AConfigure+the+ThreadFactory+on+the+solver+to+create+the+move+threads+and+the+Partition+Search%0Athreads+with+it%3A%0A%3Csolver%3E%0A%C2%A0+%3CthreadFactoryClass%3E...MyAppServerThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0A7.13.2.+Multithreaded+Incremental+Solving%0AEnable+multithreaded+incremental+solving+by+configuring+a+moveThreadCount%3A%0A190%0A%3Csolver%3E%0A%C2%A0+%3CmoveThreadCount%3EAUTO%3C%2FmoveThreadCount%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThat+one+extra+line+heavily+improves+the+score+calculation+speed%2C+presuming+that+your+machine+has%0Aenough+free+CPU+cores.%0AAdvanced+configuration%3A%0A%3Csolver%3E%0A%C2%A0+%3CmoveThreadCount%3E4%3C%2FmoveThreadCount%3E%0A%C2%A0+%3CmoveThreadBufferSize%3E10%3C%2FmoveThreadBufferSize%3E%0A%C2%A0+%3CthreadFactoryClass%3E...MyAppServerThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AA+moveThreadCount+of+4+saturates+almost+5+CPU+cores%3A+the+4+move+threads+fill+up+4+CPU+cores%0Acompletely+and+the+solver+thread+uses+most+of+another+CPU+core.%0AThe+following+moveThreadCounts+are+supported%3A%0A%E2%80%A2+NONE+%28default%29%3A+Don%E2%80%99t+run+any+move+threads.+Use+the+single+threaded+code.%0A%E2%80%A2+AUTO%3A+Let+Planner+decide+how+many+move+threads+to+run+in+parallel.+On+machines+or+containers%0Awith+little+or+no+CPUs%2C+this+falls+back+to+the+single+threaded+code.%0A%E2%80%A2+Static+number%3A+The+number+of+move+threads+to+run+in+parallel.%0A%3CmoveThreadCount%3E4%3C%2FmoveThreadCount%3E%0AThis+can+be+1+to+enforce+running+the+multithreaded+code+with+only+1+move+thread+%28which+is+less%0Aefficient+than+NONE%29.%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+move+threads+to+run+in+parallel.+It+can+use+the%0Avariable+availableProcessorCount.+For+example%3A%0A%3CmoveThreadCount%3E%28availableProcessorCount+%2F+2%29+%2B+1%3C%2FmoveThreadCount%3E%0AIt+is+counter-effective+to+set+a+moveThreadCount+that+is+higher+than+the+number+of+available+CPU+cores%2C%0Aas+that+will+slow+down+the+score+calculation+speed.+One+good+reason+to+do+it+anyway%2C+is+to+reproduce%0Aa+bug+of+a+high-end+production+machine.%0A191%0AMultithreaded+solving+is+still+reproducible%2C+as+long+as+the+resolved+moveThreadCount%0Ais+stable.+A+run+of+the+same+solver+configuration+on+2+machines+with+a+different%0A%EF%81%9A+number+of+CPUs%2C+is+still+reproducible%2C+unless+the+moveThreadCount+is+set+to+AUTO+or+a%0Afunction+of+availableProcessorCount.%0AThe+moveThreadBufferSize+power+tweaks+the+number+of+moves+that+are+selected+but+won%E2%80%99t+be%0Aforaged.+Setting+it+too+low+reduces+performance%2C+but+setting+it+too+high+too.+Unless+you%E2%80%99re+deeply%0Afamiliar+with+the+inner+workings+of+multithreaded+solving%2C+don%E2%80%99t+configure+this+parameter.%0ATo+run+in+an+environment+that+doesn%E2%80%99t+like+arbitrary+thread+creation%2C+use+threadFactoryClass+to+plug%0Ain+a+custom+thread+factory.%0A192%0AChapter+8.+Move+and+Neighborhood%0ASelection%0A8.1.+Move+and+Neighborhood+Introduction%0A8.1.1.+What+is+a+Move%3F%0AA+Move+is+a+change+%28or+set+of+changes%29+from+a+solution+A+to+a+solution+B.+For+example%2C+the+move+below%0Achanges+queen+C+from+row+0+to+row+2%3A%0AThe+new+solution+is+called+a+neighbor+of+the+original+solution%2C+because+it+can+be+reached+in+a+single%0AMove.+Although+a+single+move+can+change+multiple+queens%2C+the+neighbors+of+a+solution+should+always%0Abe+a+very+small+subset+of+all+possible+solutions.+For+example%2C+on+that+original+solution%2C+these+are+all%0Apossible+changeMove%27s%3A%0AIf+we+ignore+the+four+changeMove%27s+that+have+no+impact+and+are+therefore+not+doable%2C+we+can+see+that%0Anumber+of+moves+is+n+*+%28n+-+1%29+%3D+12.+This+is+far+less+than+the+number+of+possible+solutions%2C+which%0Ais+n+%5E+n+%3D+256.+As+the+problem+scales+out%2C+the+number+of+possible+moves+increases+far+less+than+the%0Anumber+of+possible+solutions.%0AYet%2C+in+four+changeMove%27s+or+less+we+can+reach+any+solution.+For+example+we+can+reach+a+very%0Adifferent+solution+in+three+changeMove%27s%3A%0A193%0AThere+are+many+other+types+of+moves+besides+changeMove%27s.+Many+move+types+are%0Aincluded+out-of-the-box%2C+but+you+can+also+implement+custom+moves.%0A%EF%81%9A%0AA+Move+can+affect+multiple+entities+or+even+create%2Fdelete+entities.+But+it+must+not%0Achange+the+problem+facts.%0AAll+optimization+algorithms+use+Move%27s+to+transition+from+one+solution+to+a+neighbor+solution.%0ATherefore%2C+all+the+optimization+algorithms+are+confronted+with+Move+selection%3A+the+craft+of+creating%0Aand+iterating+moves+efficiently+and+the+art+of+finding+the+most+promising+subset+of+random+moves%0Ato+evaluate+first.%0A8.1.2.+What+is+a+MoveSelector%3F%0AA+MoveSelector%27s+main+function+is+to+create+Iterator%3CMove%3E+when+needed.+An+optimization+algorithm%0Awill+iterate+through+a+subset+of+those+moves.%0AHere%E2%80%99s+an+example+how+to+configure+a+changeMoveSelector+for+the+optimization+algorithm+Local%0ASearch%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0AOut+of+the+box%2C+this+works+and+all+properties+of+the+changeMoveSelector+are+defaulted+sensibly%0A%28unless+that+fails+fast+due+to+ambiguity%29.+On+the+other+hand%2C+the+configuration+can+be+customized%0Asignificantly+for+specific+use+cases.+For+example%3A+you+might+want+to+configure+a+filter+to+discard%0Apointless+moves.%0A8.1.3.+Subselecting+of+Entities%2C+Values+and+Other+Moves%0ATo+create+a+Move%2C+a+MoveSelector+needs+to+select+one+or+more+planning+entities+and%2For+planning%0Avalues+to+move.+Just+like+MoveSelectors%2C+EntitySelectors+and+ValueSelectors+need+to+support+a%0Asimilar+feature+set+%28such+as+scalable+just-in-time+selection%29.+Therefore%2C+they+all+implement+a+common%0Ainterface+Selector+and+they+are+configured+similarly.%0AA+MoveSelector+is+often+composed+out+of+EntitySelectors%2C+ValueSelectors+or+even+other%0AMoveSelectors%2C+which+can+be+configured+individually+if+desired%3A%0A194%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0ATogether%2C+this+structure+forms+a+Selector+tree%3A%0AThe+root+of+this+tree+is+a+MoveSelector+which+is+injected+into+the+optimization+algorithm%0Aimplementation+to+be+%28partially%29+iterated+in+every+step.%0A8.2.+Generic+MoveSelectors%0A195%0A8.2.1.+changeMoveSelector%0AFor+one+planning+variable%2C+the+ChangeMove+selects+one+planning+entity+and+one+planning+value+and%0Aassigns+the+entity%E2%80%99s+variable+to+that+value.%0ASimplest+configuration%3A%0A%C2%A0+++%3CchangeMoveSelector%2F%3E%0AIf+there+are+multiple+entity+classes+or+multiple+planning+variables+for+one+entity+class%2C+a+simple%0Aconfiguration+will+automatically+unfold+into+a+union+of+ChangeMove+selectors+for+every+planning%0Avariable.%0AAdvanced+configuration%3A%0A196%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AA+ChangeMove+is+the+finest+grained+move.%0AAlmost+every+moveSelector+configuration+injected+into+a+metaheuristic+algorithm%0Ashould+include+a+changeMoveSelector+or+a+custom+implementation.+This%0A%EF%81%AA+guarantees+that+every+possible+Solution+can+be+reached+through+applying+a%0Anumber+of+moves+in+sequence+%28not+taking+score+traps+into+account%29.+Of+course%2C%0Anormally+it+is+unioned+with+other%2C+more+coarse+grained+move+selectors.%0A8.2.2.+swapMoveSelector%0AThe+SwapMove+selects+two+different+planning+entities+and+swaps+the+planning+values+of+all+their%0Aplanning+variables.%0A197%0AAlthough+a+SwapMove+on+a+single+variable+is+essentially+just+two+ChangeMoves%2C+it%E2%80%99s+often+the+winning%0Astep+where+the+first+of+the+two+ChangeMoves+would+not+be+the+winning+step+because+it+leaves+the%0Asolution+in+a+state+with+broken+hard+constraints.+For+example%3A+swapping+the+room+of+two+lectures%0Adoesn%E2%80%99t+bring+the+solution+in+a+intermediate+state+where+both+lectures+are+in+the+same+room+which%0Abreaks+a+hard+constraint.%0ASimplest+configuration%3A%0A%C2%A0+++%3CswapMoveSelector%2F%3E%0AIf+there+are+multiple+entity+classes%2C+a+simple+configuration+will+automatically+unfold+into+a+union+of%0ASwapMove+selectors+for+every+entity+class.%0AAdvanced+configuration%3A%0A198%0A%C2%A0+++%3CswapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CsecondaryEntitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FsecondaryEntitySelector%3E%0A%C2%A0+++++%3CvariableNameInclude%3Eroom%3C%2FvariableNameInclude%3E%0A%C2%A0+++++%3CvariableNameInclude%3E...%3C%2FvariableNameInclude%3E%0A%C2%A0+++%3C%2FswapMoveSelector%3E%0AThe+secondaryEntitySelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0AentitySelector+are+swapped.%0AIf+one+or+more+variableNameInclude+properties+are+specified%2C+not+all+planning+variables+will+be%0Aswapped%2C+but+only+those+specified.+For+example+for+course+scheduling%2C+specifying+only%0AvariableNameInclude+room+will+make+it+only+swap+room%2C+not+period.%0A8.2.3.+pillarChangeMoveSelector%0AA+pillar+is+a+set+of+planning+entities+which+have+the+same+planning+value%28s%29+for+their+planning%0Avariable%28s%29.+The+PillarChangeMove+selects+one+entity+pillar+%28or+subset+of+those%29+and+changes+the+value%0Aof+one+variable+%28which+is+the+same+for+all+entities%29+to+another+value.%0A199%0AIn+the+example+above%2C+queen+A+and+C+have+the+same+value+%28row+0%29+and+are+moved+to+row+2.+Also+the%0Ayellow+and+blue+process+have+the+same+value+%28computer+Y%29+and+are+moved+to+computer+X.%0ASimplest+configuration%3A%0A%C2%A0+++%3CpillarChangeMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A200%0A%C2%A0+++%3CpillarChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CpillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CsubPillarEnabled%3Etrue%3C%2FsubPillarEnabled%3E%0A%C2%A0+++++++%3CminimumSubPillarSize%3E1%3C%2FminimumSubPillarSize%3E%0A%C2%A0+++++++%3CmaximumSubPillarSize%3E1000%3C%2FmaximumSubPillarSize%3E%0A%C2%A0+++++%3C%2FpillarSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FpillarChangeMoveSelector%3E%0AA+sub+pillar+is+a+subset+of+entities+that+share+the+same+value%28s%29+for+their+variable%28s%29.+For+example+if%0Aqueen+A%2C+B%2C+C+and+D+are+all+located+on+row+0%2C+they+are+a+pillar+and+%5BA%2C+D%5D+is+one+of+the+many+sub%0Apillars.+If+subPillarEnabled+%28defaults+to+true%29+is+false%2C+no+sub+pillars+are+selected.+If+sub+pillars+are%0Aenabled%2C+the+pillar+itself+is+also+included+and+the+properties+minimumSubPillarSize+%28defaults+to+1%29+and%0AmaximumSubPillarSize+%28defaults+to+infinity%29+limit+the+size+of+the+selected+%28sub%29+pillar.%0AThe+number+of+sub+pillars+of+a+pillar+is+exponential+to+the+size+of+the+pillar.+For%0A%EF%81%9A+example+a+pillar+of+size+32+has+%282%5E32+-+1%29+subpillars.+Therefore+a+pillarSelector%0Aonly+supports+JIT+random+selection+%28which+is+the+default%29.%0AThe+other+properties+are+explained+in+changeMoveSelector.%0A8.2.4.+pillarSwapMoveSelector%0AA+pillar+is+a+set+of+planning+entities+which+have+the+same+planning+value%28s%29+for+their+planning%0Avariable%28s%29.+The+PillarSwapMove+selects+two+different+entity+pillars+and+swaps+the+values+of+all+their%0Avariables+for+all+their+entities.%0A201%0ASimplest+configuration%3A%0A%C2%A0+++%3CpillarSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A202%0A%C2%A0+++%3CpillarSwapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CpillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CsubPillarEnabled%3Etrue%3C%2FsubPillarEnabled%3E%0A%C2%A0+++++++%3CminimumSubPillarSize%3E1%3C%2FminimumSubPillarSize%3E%0A%C2%A0+++++++%3CmaximumSubPillarSize%3E1000%3C%2FmaximumSubPillarSize%3E%0A%C2%A0+++++%3C%2FpillarSelector%3E%0A%C2%A0+++++%3CsecondaryPillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FsecondaryPillarSelector%3E%0A%C2%A0+++++%3CvariableNameInclude%3Eroom%3C%2FvariableNameInclude%3E%0A%C2%A0+++++%3CvariableNameInclude%3E...%3C%2FvariableNameInclude%3E%0A%C2%A0+++%3C%2FpillarSwapMoveSelector%3E%0AThe+secondaryPillarSelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0ApillarSelector+are+swapped.%0AThe+other+properties+are+explained+in+swapMoveSelector+and+pillarChangeMoveSelector.%0A8.2.5.+tailChainSwapMoveSelector+or+2-opt+%28chained+variables+only%29%0AA+tailChain+is+a+set+of+planning+entities+with+a+chained+planning+variable+which+form+a+last+part+of+a%0Achain.+The+tailChainSwapMove+selects+a+tail+chain+and+swaps+it+with+the+tail+chain+of+another%0Aplanning+value+%28in+a+different+or+the+same+anchor+chain%29.+If+the+targeted+planning+value%2C+doesn%E2%80%99t%0Ahave+a+tail+chain%2C+it+swaps+with+nothing+%28resulting+in+a+change+like+move%29.+If+it+occurs+within+the%0Asame+anchor+chain%2C+a+partial+chain+reverse+occurs.+In+academic+papers%2C+this+is+often+called+a+2-opt%0Amove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CtailChainSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A203%0A%C2%A0+++%3CsubChainChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FsubChainChangeMoveSelector%3E%0AThe+entitySelector+selects+the+start+of+the+tail+chain+that+is+being+moved.+The+valueSelector+selects%0Ato+where+that+tail+chain+is+moved.+If+it+has+a+tail+chain+itself%2C+that+is+moved+to+the+location+of+the%0Aoriginal+tail+chain.+It+uses+a+valueSelector+instead+of+a+secondaryEntitySelector+to+be+able+to+include%0Aall+possible+2opt+moves+%28such+as+moving+to+the+end+of+a+tail%29+and+to+work+correctly+with+nearby%0Aselection+%28because+of+asymmetric+distances+and+also+swapped+entity+distance+gives+an+incorrect%0Aselection+probability%29.%0AAlthough+subChainChangeMoveSelector+and+subChainSwapMoveSelector+include+almost%0A%EF%81%9A+every+possible+tailChainSwapMove%2C+experiments+have+shown+that+focusing+on%0AtailChainSwapMoves+increases+efficiency.%0A8.2.6.+subChainChangeMoveSelector+%28chained+variables+only%29%0AA+subChain+is+a+set+of+planning+entities+with+a+chained+planning+variable+which+form+part+of+a%0Achain.+The+subChainChangeMoveSelector+selects+a+subChain+and+moves+it+to+another+place+%28in+a%0Adifferent+or+the+same+anchor+chain%29.%0ASimplest+configuration%3A%0A%C2%A0+++%3CsubChainChangeMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A204%0A%C2%A0+++%3CsubChainChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++%3CsubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsubChainSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3CselectReversingMoveToo%3Etrue%3C%2FselectReversingMoveToo%3E%0A%C2%A0+++%3C%2FsubChainChangeMoveSelector%3E%0AThe+subChainSelector+selects+a+number+of+entities%2C+no+less+than+minimumSubChainSize+%28defaults+to+1%29%0Aand+no+more+than+maximumSubChainSize+%28defaults+to+infinity%29.%0AIf+minimumSubChainSize+is+1+%28which+is+the+default%29%2C+this+selector+might+select+the+same%0Amove+as+a+ChangeMoveSelector%2C+at+a+far+lower+selection+probability+%28because+each%0Amove+type+has+the+same+selection+chance+by+default+%28not+every+move+instance%29+and%0Athere+are+far+more+SubChainChangeMove+instances+than+ChangeMove+instances%29.%0A%EF%81%9A+However%2C+don%E2%80%99t+just+remove+the+ChangeMoveSelector%2C+because+experiments+show%0Athat+it%E2%80%99s+good+to+focus+on+ChangeMoves.%0AFurthermore%2C+in+a+SubChainSwapMoveSelector%2C+setting+minimumSubChainSize+prevents%0Aswapping+a+subchain+of+size+1+with+a+subchain+of+at+least+size+2.%0AThe+selectReversingMoveToo+property+%28defaults+to+true%29+enables+selecting+the+reverse+of+every%0Asubchain+too.%0A8.2.7.+subChainSwapMoveSelector+%28chained+variables+only%29%0AThe+subChainSwapMoveSelector+selects+two+different+subChains+and+moves+them+to+another+place+in+a%0Adifferent+or+the+same+anchor+chain.%0ASimplest+configuration%3A%0A%C2%A0+++%3CsubChainSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A205%0A%C2%A0+++%3CsubChainSwapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++%3CsubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsubChainSelector%3E%0A%C2%A0+++++%3CsecondarySubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsecondarySubChainSelector%3E%0A%C2%A0+++++%3CselectReversingMoveToo%3Etrue%3C%2FselectReversingMoveToo%3E%0A%C2%A0+++%3C%2FsubChainSwapMoveSelector%3E%0AThe+secondarySubChainSelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0AsubChainSelector+are+swapped.%0AThe+other+properties+are+explained+in+subChainChangeMoveSelector.%0A8.3.+Combining+Multiple+MoveSelectors%0A8.3.1.+unionMoveSelector%0AA+unionMoveSelector+selects+a+Move+by+selecting+one+of+its+MoveSelector+children+to+supply+the+next%0AMove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AAdvanced+configuration%3A%0A206%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CselectorProbabilityWeightFactoryClass%3E%0A...ProbabilityWeightFactory%3C%2FselectorProbabilityWeightFactoryClass%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2F...MoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AThe+selectorProbabilityWeightFactory+determines+in+selectionOrder+RANDOM+how+often+a%0AMoveSelector+child+is+selected+to+supply+the+next+Move.+By+default%2C+each+MoveSelector+child+has+the%0Asame+chance+of+being+selected.%0A207%0AChange+the+fixedProbabilityWeight+of+such+a+child+to+select+it+more+often.+For+example%2C+the%0AunionMoveSelector+can+return+a+SwapMove+twice+as+often+as+a+ChangeMove%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E1.0%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E2.0%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AThe+number+of+possible+ChangeMoves+is+very+different+from+the+number+of+possible+SwapMoves+and%0Afurthermore+it%E2%80%99s+problem+dependent.+To+give+each+individual+Move+the+same+selection+chance+%28as%0Aopposed+to+each+MoveSelector%29%2C+use+the+FairSelectorProbabilityWeightFactory%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0%0A%3CselectorProbabilityWeightFactoryClass%3Eorg.optaplanner.core.impl.heuristic.selector.co%0Ammon.decorator.FairSelectorProbabilityWeightFactory%3C%2FselectorProbabilityWeightFactoryC%0Alass%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.3.2.+cartesianProductMoveSelector%0AA+cartesianProductMoveSelector+selects+a+new+CompositeMove.+It+builds+that+CompositeMove+by+selecting%0Aone+Move+per+MoveSelector+child+and+adding+it+to+the+CompositeMove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0AAdvanced+configuration%3A%0A208%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CignoreEmptyChildIterators%3Etrue%3C%2FignoreEmptyChildIterators%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2F...MoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0AThe+ignoreEmptyChildIterators+property+%28true+by+default%29+will+ignore+every+empty+childMoveSelector%0Ato+avoid+returning+no+moves.+For+example%3A+a+cartesian+product+of+changeMoveSelector+A+and+B%2C+for%0Awhich+B+is+empty+%28because+all+it%E2%80%99s+entities+are+immovable%29+returns+no+move+if%0AignoreEmptyChildIterators+is+false+and+the+moves+of+A+if+ignoreEmptyChildIterators+is+true.%0ATo+enforce+that+two+child+selectors+use+the+same+entity+or+value+efficiently%2C+use+mimic+selection%2C+not%0Amove+filtering.%0A8.4.+EntitySelector%0ASimplest+configuration%3A%0A%C2%A0+++++%3CentitySelector%2F%3E%0AAdvanced+configuration%3A%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++++%3CentityClass%3E%0Aorg.optaplanner.examples.curriculumcourse.domain.Lecture%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0AThe+entityClass+property+is+only+required+if+it+cannot+be+deduced+automatically+because+there+are%0Amultiple+entity+classes.%0A8.5.+ValueSelector%0ASimplest+configuration%3A%0A209%0A%C2%A0+++++%3CvalueSelector%2F%3E%0AAdvanced+configuration%3A%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0AThe+variableName+property+is+only+required+if+it+cannot+be+deduced+automatically+because+there+are%0Amultiple+variables+%28for+the+related+entity+class%29.%0AIn+exotic+Construction+Heuristic+configurations%2C+the+entityClass+from+the+EntitySelector+sometimes%0Aneeds+to+be+downcasted%2C+which+can+be+done+with+the+property+downcastEntityClass%3A%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22period%22%3E%0A%C2%A0+++++++%3CdowncastEntityClass%3E...LeadingExam%3C%2FdowncastEntityClass%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0AIf+a+selected+entity+cannot+be+downcasted%2C+the+ValueSelector+is+empty+for+that+entity.%0A8.6.+General+Selector+Features%0A8.6.1.+CacheType%3A+Create+Moves+Ahead+of+Time+or+Just+In+Time%0AA+Selector%27s+cacheType+determines+when+a+selection+%28such+as+a+Move%2C+an+entity%2C+a+value%2C+%E2%80%A6%29+is+created%0Aand+how+long+it+lives.%0AAlmost+every+Selector+supports+setting+a+cacheType%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AThe+following+cacheTypes+are+supported%3A%0A%E2%80%A2+JUST_IN_TIME+%28default%29%3A+Not+cached.+Construct+each+selection+%28Move%2C+%E2%80%A6%29+just+before+it%E2%80%99s+used.+This%0Ascales+up+well+in+memory+footprint.%0A%E2%80%A2+STEP%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+step+and+cache+them+in+a+list%0Afor+the+remainder+of+the+step.+This+scales+up+badly+in+memory+footprint.%0A%E2%80%A2+PHASE%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+solver+phase+and+cache+them%0Ain+a+list+for+the+remainder+of+the+phase.+Some+selections+cannot+be+phase+cached+because+the+list%0Achanges+every+step.+This+scales+up+badly+in+memory+footprint%2C+but+has+a+slight+performance%0Again.%0A210%0A%E2%80%A2+SOLVER%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+Solver+and+cache+them+in+a%0Alist+for+the+remainder+of+the+Solver.+Some+selections+cannot+be+solver+cached+because+the+list%0Achanges+every+step.+This+scales+up+badly+in+memory+footprint%2C+but+has+a+slight+performance%0Again.%0AA+cacheType+can+be+set+on+composite+selectors+too%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0ANested+selectors+of+a+cached+selector+cannot+be+configured+to+be+cached+themselves%2C+unless+it%E2%80%99s+a%0Ahigher+cacheType.+For+example%3A+a+STEP+cached+unionMoveSelector+can+hold+a+PHASE+cached%0AchangeMoveSelector%2C+but+not+a+STEP+cached+changeMoveSelector.%0A8.6.2.+SelectionOrder%3A+Original%2C+Sorted%2C+Random%2C+Shuffled+or+Probabilistic%0AA+Selector%27s+selectionOrder+determines+the+order+in+which+the+selections+%28such+as+Moves%2C+entities%2C%0Avalues%2C+%E2%80%A6%29+are+iterated.+An+optimization+algorithm+will+usually+only+iterate+through+a+subset+of+its%0AMoveSelector%27s+selections%2C+starting+from+the+start%2C+so+the+selectionOrder+is+critical+to+decide+which%0AMoves+are+actually+evaluated.%0AAlmost+every+Selector+supports+setting+a+selectionOrder%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AThe+following+selectionOrders+are+supported%3A%0A%E2%80%A2+ORIGINAL%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+default+order.+Each+selection+will+be%0Aselected+only+once.%0A%E2%97%A6+For+example%3A+A0%2C+A1%2C+A2%2C+A3%2C+%E2%80%A6%2C+B0%2C+B1%2C+B2%2C+B3%2C+%E2%80%A6%2C+C0%2C+C1%2C+C2%2C+C3%2C+%E2%80%A6%0A%E2%80%A2+SORTED%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+sorted+order.+Each+selection+will+be%0Aselected+only+once.+Requires+cacheType+%3E%3D+STEP.+Mostly+used+on+an+entitySelector+or%0AvalueSelector+for+construction+heuristics.+See+sorted+selection.%0A%E2%97%A6+For+example%3A+A0%2C+B0%2C+C0%2C+%E2%80%A6%2C+A2%2C+B2%2C+C2%2C+%E2%80%A6%2C+A1%2C+B1%2C+C1%2C+%E2%80%A6%0A%E2%80%A2+RANDOM+%28default%29%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+non-shuffled+random%0Aorder.+A+selection+might+be+selected+multiple+times.+This+scales+up+well+in+performance+because%0Ait+does+not+require+caching.%0A211%0A%E2%97%A6+For+example%3A+C2%2C+A3%2C+B1%2C+C2%2C+A0%2C+C0%2C+%E2%80%A6%0A%E2%80%A2+SHUFFLED%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+shuffled+random+order.+Each%0Aselection+will+be+selected+only+once.+Requires+cacheType+%3E%3D+STEP.+This+scales+up+badly+in%0Aperformance%2C+not+just+because+it+requires+caching%2C+but+also+because+a+random+number+is%0Agenerated+for+each+element%2C+even+if+it%E2%80%99s+not+selected+%28which+is+the+grand+majority+when+scaling%0Aup%29.%0A%E2%97%A6+For+example%3A+C2%2C+A3%2C+B1%2C+A0%2C+C0%2C+%E2%80%A6%0A%E2%80%A2+PROBABILISTIC%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+random+order%2C+based+on+the%0Aselection+probability+of+each+element.+A+selection+with+a+higher+probability+has+a+higher+chance%0Ato+be+selected+than+elements+with+a+lower+probability.+A+selection+might+be+selected+multiple%0Atimes.+Requires+cacheType+%3E%3D+STEP.+Mostly+used+on+an+entitySelector+or+valueSelector.+See%0Aprobabilistic+selection.%0A%E2%97%A6+For+example%3A+B1%2C+B1%2C+A1%2C+B2%2C+B1%2C+C2%2C+B1%2C+B1%2C+%E2%80%A6%0AA+selectionOrder+can+be+set+on+composite+selectors+too.%0AWhen+a+Selector+is+cached%2C+all+of+its+nested+Selectors+will+naturally+default+to%0A%EF%81%9A+selectionOrder+ORIGINAL.+Avoid+overwriting+the+selectionOrder+of+those+nested%0ASelectors.%0A8.6.3.+Recommended+Combinations+of+CacheType+and+SelectionOrder%0A8.6.3.1.+Just+in+Time+Random+Selection+%28default%29%0AThis+combination+is+great+for+big+use+cases+%2810+000+entities+or+more%29%2C+as+it+scales+up+well+in+memory%0Afootprint+and+performance.+Other+combinations+are+often+not+even+viable+on+such+sizes.+It+works%0Afor+smaller+use+cases+too%2C+so+it%E2%80%99s+a+good+way+to+start+out.+It%E2%80%99s+the+default%2C+so+this+explicit+configuration%0Aof+cacheType+and+selectionOrder+is+actually+obsolete%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EJUST_IN_TIME%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AHere%E2%80%99s+how+it+works.+When+Iterator%3CMove%3E.next%28%29+is+called%2C+a+child+MoveSelector+is+randomly%0Aselected+%281%29%2C+which+creates+a+random+Move+%282%2C+3%2C+4%29+and+is+then+returned+%285%29%3A%0A212%0ANotice+that+it+never+creates+a+list+of+Moves+and+it+generates+random+numbers+only+for+Moves+that+are%0Aactually+selected.%0A8.6.3.2.+Cached+Shuffled+Selection%0AThis+combination+often+wins+for+small+and+medium+use+cases+%285000+entities+or+less%29.+Beyond+that%0Asize%2C+it+scales+up+badly+in+memory+footprint+and+performance.%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESHUFFLED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AHere%E2%80%99s+how+it+works%3A+At+the+start+of+the+phase+%28or+step+depending+on+the+cacheType%29%2C+all+moves+are%0Acreated+%281%29+and+cached+%282%29.+When+MoveSelector.iterator%28%29+is+called%2C+the+moves+are+shuffled+%283%29.%0AWhen+Iterator%3CMove%3E.next%28%29+is+called%2C+the+next+element+in+the+shuffled+list+is+returned+%284%29%3A%0A213%0ANotice+that+each+Move+will+only+be+selected+once%2C+even+though+they+are+selected+in+random+order.%0AUse+cacheType+PHASE+if+none+of+the+%28possibly+nested%29+Selectors+require+STEP.+Otherwise%2C+do%0Asomething+like+this%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3ESTEP%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESHUFFLED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3CpillarSwapMoveSelector%2F%3E%3C%21--+Does+not+support+cacheType+PHASE+--%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.6.3.3.+Cached+Random+Selection%0AThis+combination+is+often+a+worthy+competitor+for+medium+use+cases%2C+especially+with+fast+stepping%0Aoptimization+algorithms+%28such+as+Simulated+Annealing%29.+Unlike+cached+shuffled+selection%2C+it+doesn%E2%80%99t%0Awaste+time+shuffling+the+moves+list+at+the+beginning+of+every+step.%0A214%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.6.4.+Filtered+Selection%0AThere+can+be+certain+moves+that+you+don%E2%80%99t+want+to+select%2C+because%3A%0A%E2%80%A2+The+move+is+pointless+and+would+only+waste+CPU+time.+For+example%2C+swapping+two+lectures+of%0Athe+same+course+will+result+in+the+same+score+and+the+same+schedule+because+all+lectures+of+one%0Acourse+are+interchangeable+%28same+teacher%2C+same+students%2C+same+topic%29.%0A%E2%80%A2+Doing+the+move+would+break+a+built-in+hard+constraint%2C+so+the+solution+would+be+infeasible+but%0Athe+score+function+doesn%E2%80%99t+check+built-in+hard+constraints+%28for+performance+gain%29.+For+example%2C%0Adon%E2%80%99t+change+a+gym+lecture+to+a+room+which+is+not+a+gym+room.%0AAny+built-in+hard+constraint+must+probably+be+filtered+on+every+move+type+of%0Aevery+solver+phase.+For+example+if+it+filters+the+change+move+of+Local+Search%2C+it%0Amust+also+filter+the+swap+move+that+swaps+the+room+of+a+gym+lecture+with%0A%EF%81%9A+another+lecture+for+which+the+other+lecture%E2%80%99s+original+room+isn%E2%80%99t+a+gym+room.%0AFurthermore%2C+it+must+also+filter+the+change+moves+of+the+Construction%0AHeuristics+%28which+requires+an+advanced+configuration%29.%0AIf+a+move+is+unaccepted+by+the+filter%2C+it%E2%80%99s+not+executed+and+the+score+isn%E2%80%99t+calculated.%0A215%0AFiltering+uses+the+interface+SelectionFilter%3A%0Apublic+interface+SelectionFilter%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++boolean+accept%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+T+selection%29%3B%0A%7D%0AImplement+the+accept+method+to+return+false+on+a+discarded+selection+%28see+below%29.+Filtered%0Aselection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+works+with+any+cacheType+and+selectionOrder.%0AApply+the+filter+on+the+lowest+level+possible.+In+most+cases%2C+you%E2%80%99ll+need+to+know%0A%EF%81%9A+both+the+entity+and+the+value+involved+so+you%E2%80%99ll+have+to+apply+it+on+the+move%0Aselector.%0A8.6.4.1.+Filtered+Move+Selection%0AUnaccepted+moves+will+not+be+selected+and+will+therefore+never+have+their+doMove%28%29+method+called%3A%0A216%0Apublic+class+DifferentCourseSwapMoveFilter+implements+SelectionFilter%3CSwapMove%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector+scoreDirector%2C+SwapMove+move%29+%7B%0A%C2%A0+++++++Lecture+leftLecture+%3D+%28Lecture%29+move.getLeftEntity%28%29%3B%0A%C2%A0+++++++Lecture+rightLecture+%3D+%28Lecture%29+move.getRightEntity%28%29%3B%0A%C2%A0+++++++return+%21leftLecture.getCourse%28%29.equals%28rightLecture.getCourse%28%29%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+moveSelector+%28potentially+both+in+the+Local+Search+and%0Athe+Construction+Heuristics+if+it+filters+ChangeMoves%29%3A%0A%C2%A0+++%3CswapMoveSelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.DifferentCourseSwap%0AMoveFilter%3C%2FfilterClass%3E%0A%C2%A0+++%3C%2FswapMoveSelector%3E%0AYou+can+configure+multiple+filterClass+elements+on+a+single+move+selector.%0A8.6.4.2.+Filtered+Entity+Selection%0AUnaccepted+entities+will+not+be+selected+and+will+therefore+never+be+used+to+create+a+move.%0Apublic+class+LongLectureSelectionFilter+implements+SelectionFilter%3CLecture%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CCourseSchedule%3E+scoreDirector%2C+Lecture%0Alecture%29+%7B%0A%C2%A0+++++++return+lecture.isLong%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+entitySelector+%28potentially+both+in+the+Local+Search%0Aand+the+Construction+Heuristics%29%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.LongLectureSelectio%0AnFilter%3C%2FfilterClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A217%0AIf+that+filter+should+apply+on+all+entities%2C+configure+it+as+a+global+movableEntitySelectionFilter%0Ainstead.%0AYou+can+configure+multiple+filterClass+elements+on+a+single+entity+selector.%0A8.6.4.3.+Filtered+Value+Selection%0AUnaccepted+values+will+not+be+selected+and+will+therefore+never+be+used+to+create+a+move.%0Apublic+class+LongPeriodSelectionFilter+implements+SelectionFilter%3CPeriod%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CCourseSchedule%3E+scoreDirector%2C+Period+period%29%0A%7B%0A%C2%A0+++++++return+period%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+valueSelector+%28potentially+both+in+the+Local+Search+and%0Athe+Construction+Heuristics%29%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.LongPeriodSelection%0AFilter%3C%2FfilterClass%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AYou+can+configure+multiple+filterClass+elements+on+a+single+value+selector.%0A8.6.5.+Sorted+Selection%0ASorted+selection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+does+not+work+with+cacheType+JUST_IN_TIME+and+it+only+works%0Awith+selectionOrder+SORTED.%0AIt%E2%80%99s+mostly+used+in+construction+heuristics.%0AIf+the+chosen+construction+heuristic+implies+sorting%2C+for+example%0AFIRST_FIT_DECREASING+implies+that+the+EntitySelector+is+sorted%2C+there+is+no+need+to%0A%EF%81%9A+explicitly+configure+a+Selector+with+sorting.+If+you+do+explicitly+configure+the%0ASelector%2C+it+overwrites+the+default+settings+of+that+construction+heuristic.%0A8.6.5.1.+Sorted+Selection+by+SorterManner%0ASome+Selector+types+implement+a+SorterManner+out+of+the+box%3A%0A218%0A%E2%80%A2+EntitySelector+supports%3A%0A%E2%97%A6+DECREASING_DIFFICULTY%3A+Sorts+the+planning+entities+according+to+decreasing+planning+entity%0Adifficulty.+Requires+that+planning+entity+difficulty+is+annotated+on+the+domain+model.%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A%E2%80%A2+ValueSelector+supports%3A%0A%E2%97%A6+INCREASING_STRENGTH%3A+Sorts+the+planning+values+according+to+increasing+planning+value%0Astrength.+Requires+that+planning+value+strength+is+annotated+on+the+domain+model.%0A%C2%A0+++%3CvalueSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++%3C%2FvalueSelector%3E%0A8.6.5.2.+Sorted+Selection+by+Comparator%0AAn+easy+way+to+sort+a+Selector+is+with+a+plain+old+Comparator%3A%0Apublic+class+CloudProcessDifficultyComparator+implements+Comparator%3CCloudProcess%3E+%7B%0A%C2%A0+++public+int+compare%28CloudProcess+a%2C+CloudProcess+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getRequiredMultiplicand%28%29%2C+b.getRequiredMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AYou%E2%80%99ll+also+need+to+configure+it+%28unless+it%E2%80%99s+annotated+on+the+domain+model+and+automatically%0Aapplied+by+the+optimization+algorithm%29%3A%0A219%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterComparatorClass%3E%0A...CloudProcessDifficultyComparator%3C%2FsorterComparatorClass%3E%0A%C2%A0+++++%3CsorterOrder%3EDESCENDING%3C%2FsorterOrder%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A8.6.5.3.+Sorted+Selection+by+SelectionSorterWeightFactory%0AIf+you+need+the+entire+Solution+to+sort+a+Selector%2C+use+a+SelectionSorterWeightFactory+instead%3A%0Apublic+interface+SelectionSorterWeightFactory%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++Comparable+createSorterWeight%28Solution_+solution%2C+T+selection%29%3B%0A%7D%0A220%0Apublic+class+QueenDifficultyWeightFactory+implements+SelectionSorterWeightFactory%0A%3CNQueens%2C+Queen%3E+%7B%0A%C2%A0+++public+QueenDifficultyWeight+createSorterWeight%28NQueens+nQueens%2C+Queen+queen%29+%7B%0A%C2%A0+++++++int+distanceFromMiddle+%3D+calculateDistanceFromMiddle%28nQueens.getN%28%29%2C+queen%0A.getColumnIndex%28%29%29%3B%0A%C2%A0+++++++return+new+QueenDifficultyWeight%28queen%2C+distanceFromMiddle%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%C2%A0+++public+static+class+QueenDifficultyWeight+implements+Comparable%0A%3CQueenDifficultyWeight%3E+%7B%0A%C2%A0+++++++private+final+Queen+queen%3B%0A%C2%A0+++++++private+final+int+distanceFromMiddle%3B%0A%C2%A0+++++++public+QueenDifficultyWeight%28Queen+queen%2C+int+distanceFromMiddle%29+%7B%0A%C2%A0+++++++++++this.queen+%3D+queen%3B%0A%C2%A0+++++++++++this.distanceFromMiddle+%3D+distanceFromMiddle%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++public+int+compareTo%28QueenDifficultyWeight+other%29+%7B%0A%C2%A0+++++++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++++++%2F%2F+The+more+difficult+queens+have+a+lower+distance+to+the+middle%0A%C2%A0+++++++++++++++++++.append%28other.distanceFromMiddle%2C+distanceFromMiddle%29+%2F%2F%0ADecreasing%0A%C2%A0+++++++++++++++++++%2F%2F+Tie+breaker%0A%C2%A0+++++++++++++++++++.append%28queen.getColumnIndex%28%29%2C+other.queen.getColumnIndex%28%29%29%0A%C2%A0+++++++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AYou%E2%80%99ll+also+need+to+configure+it+%28unless+it%E2%80%99s+annotated+on+the+domain+model+and+automatically%0Aapplied+by+the+optimization+algorithm%29%3A%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterWeightFactoryClass%3E%0A...QueenDifficultyWeightFactory%3C%2FsorterWeightFactoryClass%3E%0A%C2%A0+++++%3CsorterOrder%3EDESCENDING%3C%2FsorterOrder%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A221%0A8.6.5.4.+Sorted+Selection+by+SelectionSorter%0AAlternatively%2C+you+can+also+use+the+interface+SelectionSorter+directly%3A%0Apublic+interface+SelectionSorter%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++void+sort%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+List%3CT%3E+selectionList%29%3B%0A%7D%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterClass%3E...MyEntitySorter%3C%2FsorterClass%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A8.6.6.+Probabilistic+Selection%0AProbabilistic+selection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+does+not+work+with+cacheType+JUST_IN_TIME+and+it+only+works%0Awith+selectionOrder+PROBABILISTIC.%0A222%0AEach+selection+has+a+probabilityWeight%2C+which+determines+the+chance+that+selection+will+be+selected%3A%0Apublic+interface+SelectionProbabilityWeightFactory%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++double+createProbabilityWeight%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+T%0Aselection%29%3B%0A%7D%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3EPROBABILISTIC%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CprobabilityWeightFactoryClass%3E%0A...MyEntityProbabilityWeightFactoryClass%3C%2FprobabilityWeightFactoryClass%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0AFor+example%2C+if+there+are+three+entities%3A+process+A+%28probabilityWeight+2.0%29%2C+process+B%0A%28probabilityWeight+0.5%29+and+process+C+%28probabilityWeight+0.5%29%2C+then+process+A+will+be+selected+four%0Atimes+more+than+B+and+C.%0A8.6.7.+Limited+Selection%0ASelecting+all+possible+moves+sometimes+does+not+scale+well+enough%2C+especially+for+construction%0Aheuristics+%28which+don%E2%80%99t+support+acceptedCountLimit%29.%0ATo+limit+the+number+of+selected+selection+per+step%2C+apply+a+selectedCountLimit+on+the+selector%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CselectedCountLimit%3E100%3C%2FselectedCountLimit%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0ATo+scale+Local+Search%2C+setting+acceptedCountLimit+is+usually+better+than+using%0A%EF%81%9A+selectedCountLimit.%0A8.6.8.+Mimic+Selection+%28Record%2FReplay%29%0ADuring+mimic+selection%2C+one+normal+selector+records+its+selection+and+one+or+multiple+other+special%0Aselectors+replay+that+selection.+The+recording+selector+acts+as+a+normal+selector+and+supports+all%0Aother+configuration+properties.+A+replaying+selector+mimics+the+recording+selection+and+supports+no%0Aother+configuration+properties.%0AThe+recording+selector+needs+an+id.+A+replaying+selector+must+reference+a+recorder%E2%80%99s+id+with+a%0AmimicSelectorRef%3A%0A223%0A%C2%A0+++++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++++%3CentitySelector+id%3D%22entitySelector%22%2F%3E%0A%C2%A0+++++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++++%3CentitySelector+mimicSelectorRef%3D%22entitySelector%22%2F%3E%0A%C2%A0+++++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3C%2FcartesianProductMoveSelector%3E%0AMimic+selection+is+useful+to+create+a+composite+move+from+two+moves+that+affect+the+same+entity.%0A8.6.9.+Nearby+Selection%0AIn+some+use+cases+%28such+as+TSP+and+VRP%2C+but+also+in+non-chained+variable+cases%29%2C+changing+entities%0Ato+nearby+values+or+swapping+nearby+entities+can+heavily+increase+scalability+and+improve%0Asolution+quality.%0ANearby+selection+increases+the+probability+of+selecting+an+entity+or+value+which+is+nearby+to+the+first%0Aentity+being+moved+in+that+move.%0A224%0AThe+distance+between+two+entities+or+values+is+domain+specific.+Therefore%2C+implement+the%0ANearbyDistanceMeter+interface%3A%0Apublic+interface+NearbyDistanceMeter%3CO%2C+D%3E+%7B%0A%C2%A0+++double+getNearbyDistance%28O+origin%2C+D+destination%29%3B%0A%7D%0AIt+returns+a+double+which+represents+the+distance%3A%0Apublic+class+CustomerNearbyDistanceMeter+implements+NearbyDistanceMeter%3CCustomer%2C%0AStandstill%3E+%7B%0A%C2%A0+++public+double+getNearbyDistance%28Customer+origin%2C+Standstill+destination%29+%7B%0A%C2%A0+++++++return+origin.getDistanceTo%28destination%29%3B%0A%C2%A0+++%7D%0A%7D%0ATo+configure+nearby+selection%2C+add+a+nearbySelection+element+in+the+entitySelector+or+valueSelector%0Aand+use+mimic+selection+to+specify+which+entity+should+be+near+by+the+selection.%0A225%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector1%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector1%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector2%22%2F%3E%0A%C2%A0+++++++%3CsecondaryEntitySelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector2%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FsecondaryEntitySelector%3E%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3CtailChainSwapMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector3%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector3%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FtailChainSwapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AA+distributionSizeMaximum+parameter+should+not+be+1+because+if+the+nearest+is+already+the+planning%0Avalue+of+the+current+entity%2C+then+the+only+move+that+is+selectable+is+not+doable.%0ATo+allow+every+element+to+be+selected%2C+regardless+of+the+number+of+entities%2C+only+set+the+distribution%0Atype+%28so+without+a+distributionSizeMaximum+parameter%29%3A%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CnearbySelectionDistributionType%3E%0APARABOLIC_DISTRIBUTION%3C%2FnearbySelectionDistributionType%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0AThe+following+NearbySelectionDistributionTypes+are+supported%3A%0A226%0A%E2%80%A2+BLOCK_DISTRIBUTION%3A+Only+the+n+nearest+are+selected%2C+with+an+equal+probability.+For+example%2C%0Aselect+the+20+nearest%3A%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CblockDistributionSizeMaximum%3E20%3C%2FblockDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+LINEAR_DISTRIBUTION%3A+Nearest+elements+are+selected+with+a+higher+probability.+The+probability%0Adecreases+linearly.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3ClinearDistributionSizeMaximum%3E40%3C%2FlinearDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+PARABOLIC_DISTRIBUTION+%28recommended%29%3A+Nearest+elements+are+selected+with+a+higher%0Aprobability.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CparabolicDistributionSizeMaximum%3E80%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+BETA_DISTRIBUTION%3A+Selection+according+to+a+beta+distribution.+Slows+down+the+solver%0Asignificantly.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CbetaDistributionAlpha%3E1%3C%2FbetaDistributionAlpha%3E%0A%C2%A0+++%3CbetaDistributionBeta%3E5%3C%2FbetaDistributionBeta%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0AAs+always%2C+use+the+Benchmarker+to+tweak+values+if+desired.%0A8.7.+Custom+Moves%0A8.7.1.+Which+Move+Types+Might+be+Missing+in+my+Implementation%3F%0ATo+determine+which+move+types+might+be+missing+in+your+implementation%2C+run+a+Benchmarker+for%0Aa+short+amount+of+time+and+configure+it+to+write+the+best+solutions+to+disk.+Take+a+look+at+such+a+best%0Asolution%3A+it+will+likely+be+a+local+optima.+Try+to+figure+out+if+there%E2%80%99s+a+move+that+could+get+out+of+that%0Alocal+optima+faster.%0AIf+you+find+one%2C+implement+that+coarse-grained+move%2C+mix+it+with+the+existing+moves+and%0Abenchmark+it+against+the+previous+configurations+to+see+if+you+want+to+keep+it.%0A227%0A8.7.2.+Custom+Moves+Introduction%0AInstead+of+using+the+generic+Moves+%28such+as+ChangeMove%29+you+can+also+implement+your+own+Move.%0AGeneric+and+custom+MoveSelectors+can+be+combined+as+desired.%0AA+custom+Move+can+be+tailored+to+work+to+the+advantage+of+your+constraints.+For+example+in%0Aexamination+scheduling%2C+changing+the+period+of+an+exam+A+would+also+change+the+period+of+all+the%0Aother+exams+that+need+to+coincide+with+exam+A.%0AA+custom+Move+is+also+slightly+faster+than+a+generic+Move.+However%2C+it%E2%80%99s+far+more+work+to+implement%0Aand+much+harder+to+avoid+bugs.+After+implementing+a+custom+Move%2C+turn+on+environmentMode%0AFULL_ASSERT+to+check+for+score+corruptions.%0A8.7.3.+The+Interface+Move%0AAll+moves+implement+the+Move+interface%3A%0Apublic+interface+Move%3CSolution_%3E+%7B%0A%C2%A0+++boolean+isMoveDoable%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Move%3CSolution_%3E+doMove%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++...%0A%7D%0ATo+implement+a+custom+move%2C+it%E2%80%99s+recommended+to+extend+AbstractMove+instead+implementing+Move%0Adirectly.+Planner+calls+AbstractMove.doMove%28ScoreDirector%29%2C+which+calls%0AdoMoveOnGenuineVariables%28ScoreDirector%29.+For+example+in+cloud+balancing%2C+this+move+changes+one%0Aprocess+to+another+computer%3A%0A228%0Apublic+class+CloudComputerChangeMove+extends+AbstractMove%3CCloudBalance%3E+%7B%0A%C2%A0+++private+CloudProcess+cloudProcess%3B%0A%C2%A0+++private+CloudComputer+toCloudComputer%3B%0A%C2%A0+++public+CloudComputerChangeMove%28CloudProcess+cloudProcess%2C+CloudComputer%0AtoCloudComputer%29+%7B%0A%C2%A0+++++++this.cloudProcess+%3D+cloudProcess%3B%0A%C2%A0+++++++this.toCloudComputer+%3D+toCloudComputer%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++protected+void+doMoveOnGenuineVariables%28ScoreDirector%3CCloudBalance%3E+scoreDirector%29%0A%7B%0A%C2%A0+++++++scoreDirector.beforeVariableChanged%28cloudProcess%2C+%22computer%22%29%3B%0A%C2%A0+++++++cloudProcess.setComputer%28toCloudComputer%29%3B%0A%C2%A0+++++++scoreDirector.afterVariableChanged%28cloudProcess%2C+%22computer%22%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+...%0A%7D%0AThe+implementation+must+notify+the+ScoreDirector+of+any+changes+it+makes+to+planning+entity%E2%80%99s%0Avariables%3A+Call+the+scoreDirector.beforeVariableChanged%28Object%2C+String%29+and%0AscoreDirector.afterVariableChanged%28Object%2C+String%29+methods+directly+before+and+after+modifying%0Aan+entity%E2%80%99s+planning+variable.%0AThe+example+move+above+is+a+fine-grained+move+because+it+changes+only+one+planning+variable.+On%0Athe+other+hand%2C+a+coarse-grained+move+changes+multiple+entities+or+multiple+planning+variables+in+a%0Asingle+move%2C+usually+to+avoid+breaking+hard+constraints+by+making+multiple+related+changes+at%0Aonce.+For+example%2C+a+swap+move+is+really+just+two+change+moves%2C+but+it+keeps+those+two+changes%0Atogether.%0AA+Move+can+only+change%2Fadd%2Fremove+planning+entities%2C+it+must+not+change+any+of%0A%EF%81%B1+the+problem+facts+as+that+will+cause+score+corruption.+Use+real-time+planning+to%0Achange+problem+facts+while+solving.%0APlanner+automatically+filters+out+non+doable+moves+by+calling+the+isMoveDoable%28ScoreDirector%29%0Amethod+on+each+selected+move.+A+non+doable+move+is%3A%0A%E2%80%A2+A+move+that+changes+nothing+on+the+current+solution.+For+example%2C+moving+process+P1+on%0Acomputer+X+to+computer+X+is+not+doable%2C+because+it+is+already+there.%0A%E2%80%A2+A+move+that+is+impossible+to+do+on+the+current+solution.+For+example%2C+moving+process+P1+to%0Acomputer+Q+%28when+Q+isn%E2%80%99t+in+the+list+of+computers%29+is+not+doable+because+it+would+assign+a%0Aplanning+value+that%E2%80%99s+not+inside+the+planning+variable%E2%80%99s+value+range.%0AIn+the+cloud+balancing+example%2C+a+move+which+assigns+a+process+to+the+computer+it%E2%80%99s+already%0A229%0Aassigned+to+is+not+doable%3A%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+isMoveDoable%28ScoreDirector%3CCloudBalance%3E+scoreDirector%29+%7B%0A%C2%A0+++++++return+%21Objects.equals%28cloudProcess.getComputer%28%29%2C+toCloudComputer%29%3B%0A%C2%A0+++%7D%0AWe+don%E2%80%99t+need+to+check+if+toCloudComputer+is+in+the+value+range%2C+because+we+only+generate+moves+for%0Awhich+that+is+the+case.+A+move+that+is+currently+not+doable+can+become+doable+when+the+working%0ASolution+changes+in+a+later+step%2C+otherwise+we+probably+shouldn%E2%80%99t+have+created+it+in+the+first+place.%0AEach+move+has+an+undo+move%3A+a+move+%28normally+of+the+same+type%29+which+does+the+exact+opposite.+In%0Athe+cloud+balancing+example+the+undo+move+of+P1+%7BX+%E2%86%92+Y%7D+is+the+move+P1+%7BY+%E2%86%92+X%7D.+The+undo+move%0Aof+a+move+is+created+when+the+Move+is+being+done+on+the+current+solution%2C+before+the+genuine%0Avariables+change%3A%0A%C2%A0+++%40Override%0A%C2%A0+++public+CloudComputerChangeMove+createUndoMove%28ScoreDirector%3CCloudBalance%3E%0AscoreDirector%29+%7B%0A%C2%A0+++++++return+new+CloudComputerChangeMove%28cloudProcess%2C+cloudProcess.getComputer%28%29%29%3B%0A%C2%A0+++%7D%0ANotice+that+if+P1+would+have+already+been+moved+to+Y%2C+the+undo+move+would+create+the+move+P1+%7BY%0A%E2%86%92+Y%7D%2C+instead+of+the+move+P1+%7BY+%E2%86%92+X%7D.%0AA+solver+phase+might+do+and+undo+the+same+Move+more+than+once.+In+fact%2C+many+solver+phases+will%0Aiteratively+do+and+undo+a+number+of+moves+to+evaluate+them%2C+before+selecting+one+of+those+and%0Adoing+that+move+again+%28without+undoing+it+the+last+time%29.%0AA+Move+must+also+implement+the+getPlanningEntities%28%29+and+getPlanningValues%28%29+methods.+Those+are%0Aused+by+entity+tabu+and+value+tabu+respectively.+They+are+called+after+the+Move+has+already+been%0Adone.%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningEntities%28%29+%7B%0A%C2%A0+++++++return+Collections.singletonList%28cloudProcess%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningValues%28%29+%7B%0A%C2%A0+++++++return+Collections.singletonList%28toCloudComputer%29%3B%0A%C2%A0+++%7D%0AIf+the+Move+changes+multiple+planning+entities%2C+such+as+in+a+swap+move%2C+return+all+of+them+in%0AgetPlanningEntities%28%29+and+return+all+their+values+%28to+which+they+are+changing%29+in%0AgetPlanningValues%28%29.%0A230%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningEntities%28%29+%7B%0A%C2%A0+++++++return+Arrays.asList%28leftCloudProcess%2C+rightCloudProcess%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningValues%28%29+%7B%0A%C2%A0+++++++return+Arrays.asList%28leftCloudProcess.getComputer%28%29%2C+rightCloudProcess%0A.getComputer%28%29%29%3B%0A%C2%A0+++%7D%0AA+Move+must+implement+the+equals%28%29+and+hashCode%28%29+methods+for+move+tabu.+Two+moves+which%0Amake+the+same+change+on+a+solution%2C+should+be+equal+ideally.%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+equals%28Object+o%29+%7B%0A%C2%A0+++++++if+%28this+%3D%3D+o%29+%7B%0A%C2%A0+++++++++++return+true%3B%0A%C2%A0+++++++%7D+else+if+%28o+instanceof+CloudComputerChangeMove%29+%7B%0A%C2%A0+++++++++++CloudComputerChangeMove+other+%3D+%28CloudComputerChangeMove%29+o%3B%0A%C2%A0+++++++++++return+new+EqualsBuilder%28%29%0A%C2%A0+++++++++++++++++++.append%28cloudProcess%2C+other.cloudProcess%29%0A%C2%A0+++++++++++++++++++.append%28toCloudComputer%2C+other.toCloudComputer%29%0A%C2%A0+++++++++++++++++++.isEquals%28%29%3B%0A%C2%A0+++++++%7D+else+%7B%0A%C2%A0+++++++++++return+false%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+int+hashCode%28%29+%7B%0A%C2%A0+++++++return+new+HashCodeBuilder%28%29%0A%C2%A0+++++++++++++++.append%28cloudProcess%29%0A%C2%A0+++++++++++++++.append%28toCloudComputer%29%0A%C2%A0+++++++++++++++.toHashCode%28%29%3B%0A%C2%A0+++%7D%0ANotice+that+it+checks+if+the+other+move+is+an+instance+of+the+same+move+type.+This+instanceof+check%0Ais+important+because+a+move+will+be+compared+to+a+move+with+another+move+type+if+you+have%0Amultiple+move+selectors.%0AImplement+the+toString%28%29+method+to+keep+Planner%E2%80%99s+logs+readable%3A%0A%C2%A0+++public+String+toString%28%29+%7B%0A%C2%A0+++++++return+cloudProcess+%2B+%22+%7B%22+%2B+cloudProcess.getComputer%28%29+%2B+%22+-%3E+%22+%2B%0AtoCloudComputer+%2B+%22%7D%22%3B%0A%C2%A0+++%7D%0A231%0ANow%2C+let%E2%80%99s+generate+instances+of+this+custom+Move+class.%0ACustom+MoveListFactory+and+MoveIteratorFactory+implementations+must+ensure%0A%EF%81%B1+that+they+do+not+move+immovable+entities.%0A8.7.4.+MoveListFactory%3A+the+Easy+Way+to+Generate+Custom+Moves%0AThe+easiest+way+to+generate+custom+moves+is+by+implementing+the+interface+MoveListFactory%3A%0Apublic+interface+MoveListFactory%3CSolution_%3E+%7B%0A%C2%A0+++List%3CMove%3E+createMoveList%28Solution_+solution%29%3B%0A%7D%0AFor+example%3A%0Apublic+class+CloudComputerChangeMoveFactory+implements+MoveListFactory%3CCloudBalance%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+List%3CCloudComputerChangeMove%3E+createMoveList%28CloudBalance+cloudBalance%29+%7B%0A%C2%A0+++++++List%3CCloudComputerChangeMove%3E+moveList+%3D+new+ArrayList%3C%3E%28%29%3B%0A%C2%A0+++++++List%3CCloudComputer%3E+cloudComputerList+%3D+cloudBalance.getComputerList%28%29%3B%0A%C2%A0+++++++for+%28CloudProcess+cloudProcess+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++for+%28CloudComputer+cloudComputer+%3A+cloudComputerList%29+%7B%0A%C2%A0+++++++++++++++moveList.add%28new+CloudComputerChangeMove%28cloudProcess%2C+cloudComputer%29%0A%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+moveList%3B%0A%C2%A0+++%7D%0A%7D%0ASimple+configuration+%28which+can+be+nested+in+a+unionMoveSelector+just+like+any+other+MoveSelector%29%3A%0A%C2%A0+++%3CmoveListFactory%3E%0A%C2%A0%0A%3CmoveListFactoryClass%3Eorg.optaplanner.examples.cloudbalancing.optional.move.CloudCompu%0AterChangeMoveFactory%3C%2FmoveListFactoryClass%3E%0A%C2%A0+++%3C%2FmoveListFactory%3E%0AAdvanced+configuration%3A%0A232%0A%C2%A0+++%3CmoveListFactory%3E%0A%C2%A0+++++...+%3C%21--+Normal+moveSelector+properties+--%3E%0A%C2%A0%0A%3CmoveListFactoryClass%3Eorg.optaplanner.examples.cloudbalancing.optional.move.CloudCompu%0AterChangeMoveFactory%3C%2FmoveListFactoryClass%3E%0A%C2%A0+++%3C%2FmoveListFactory%3E%0ABecause+the+MoveListFactory+generates+all+moves+at+once+in+a+List%3CMove%3E%2C+it+does+not+support%0AcacheType+JUST_IN_TIME.+Therefore%2C+moveListFactory+uses+cacheType+STEP+by+default+and+it+scales%0Abadly.%0A8.7.5.+MoveIteratorFactory%3A+Generate+Custom+Moves+Just+in+Time%0AUse+this+advanced+form+to+generate+custom+moves+Just+In+Time+by+implementing+the%0AMoveIteratorFactory+interface%3A%0Apublic+interface+MoveIteratorFactory%3CSolution_%3E+%7B%0A%C2%A0+++long+getSize%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Iterator%3CMove%3E+createOriginalMoveIterator%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Iterator%3CMove%3E+createRandomMoveIterator%28ScoreDirector%3CSolution_%3E+scoreDirector%2C%0ARandom+workingRandom%29%3B%0A%7D%0AThe+getSize%28%29+method+must+return+an+estimation+of+the+size.+It+doesn%E2%80%99t+need+to+be+correct%2C+but+it%E2%80%99s%0Abetter+too+big+than+too+small.+The+createOriginalMoveIterator+method+is+called+if+the+selectionOrder%0Ais+ORIGINAL+or+if+it+is+cached.+The+createRandomMoveIterator+method+is+called+for+selectionOrder%0ARANDOM+combined+with+cacheType+JUST_IN_TIME.%0ADon%E2%80%99t+create+a+collection+%28array%2C+list%2C+set+or+map%29+of+Moves+when+creating+the%0A%EF%81%AA+Iterator%3CMove%3E%3A+the+whole+purpose+of+MoveIteratorFactory+over+MoveListFactory+is%0Ato+create+a+Move+just+in+time+in+a+custom+Iterator.next%28%29.%0ASimple+configuration+%28which+can+be+nested+in+a+unionMoveSelector+just+like+any+other+MoveSelector%29%3A%0A%C2%A0+++%3CmoveIteratorFactory%3E%0A%C2%A0+++++%3CmoveIteratorFactoryClass%3E...%3C%2FmoveIteratorFactoryClass%3E%0A%C2%A0+++%3C%2FmoveIteratorFactory%3E%0AAdvanced+configuration%3A%0A233%0A%C2%A0+++%3CmoveIteratorFactory%3E%0A%C2%A0+++++...+%3C%21--+Normal+moveSelector+properties+--%3E%0A%C2%A0+++++%3CmoveIteratorFactoryClass%3E...%3C%2FmoveIteratorFactoryClass%3E%0A%C2%A0+++%3C%2FmoveIteratorFactory%3E%0A234%0AChapter+9.+Exhaustive+Search%0A9.1.+Overview%0AExhaustive+Search+will+always+find+the+global+optimum+and+recognize+it+too.+That+being+said%2C+it%0Adoesn%E2%80%99t+scale+%28not+even+beyond+toy+data+sets%29+and+is+therefore+mostly+useless.%0A9.2.+Brute+Force%0A9.2.1.+Algorithm+Description%0AThe+Brute+Force+algorithm+creates+and+evaluates+every+possible+solution.%0ANotice+that+it+creates+a+search+tree+that+explodes+exponentially+as+the+problem+size+increases%2C+so+it%0Ahits+a+scalability+wall.%0ABrute+Force+is+mostly+unusable+for+a+real-world+problem+due+to+time%0A%EF%81%AA+limitations%2C+as+shown+in+scalability+of+Exhaustive+Search.%0A235%0A9.2.2.+Configuration%0ASimplest+configuration+of+Brute+Force%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRUTE_FORCE%3C%2FexhaustiveSearchType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%3C%2Fsolver%3E%0A9.3.+Branch+And+Bound%0A9.3.1.+Algorithm+Description%0ABranch+And+Bound+also+explores+nodes+in+an+exponential+search+tree%2C+but+it+investigates+more%0Apromising+nodes+first+and+prunes+away+worthless+nodes.%0AFor+each+node%2C+Branch+And+Bound+calculates+the+optimistic+bound%3A+the+best+possible+score+to+which%0Athat+node+can+lead+to.+If+the+optimistic+bound+of+a+node+is+lower+or+equal+to+the+global+pessimistic%0Abound%2C+then+it+prunes+away+that+node+%28including+the+entire+branch+of+all+its+subnodes%29.%0AAcademic+papers+use+the+term+lower+bound+instead+of+optimistic+bound+%28and+the%0Aterm+upper+bound+instead+of+pessimistic+bound%29%2C+because+they+minimize+the+score.%0A%EF%81%9A+Planner+maximizes+the+score+%28because+it+supports+combining+negative+and+positive%0Aconstraints%29.+Therefore%2C+for+clarity%2C+it+uses+different+terms%2C+as+it+would+be+confusing%0Ato+use+the+term+lower+bound+for+a+bound+which+is+always+higher.%0AFor+example%3A+at+index+14%2C+it+sets+the+global+pessimistic+bound+to+-2.+Because+all+solutions+reachable%0Afrom+the+node+visited+at+index+11+will+have+a+score+lower+or+equal+to+-2+%28the+node%E2%80%99s+optimistic%0Abound%29%2C+they+can+be+pruned+away.%0A236%0ANotice+that+Branch+And+Bound+%28much+like+Brute+Force%29+creates+a+search+tree+that+explodes%0Aexponentially+as+the+problem+size+increases.+So+it+hits+the+same+scalability+wall%2C+only+a+little+bit+later.%0ABranch+And+Bound+is+mostly+unusable+for+a+real-world+problem+due+to+time%0A%EF%81%AA+limitations%2C+as+shown+in+scalability+of+Exhaustive+Search.%0A9.3.2.+Configuration%0ASimplest+configuration+of+Branch+And+Bound%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%3C%2Fsolver%3E%0AFor+the+pruning+to+work+with+the+default+ScoreBounder%2C+the+InitializingScoreTrend%0A%EF%81%AA+should+be+set.+Especially+an+InitializingScoreTrend+of+ONLY_DOWN+%28or+at+least+has%0AONLY_DOWN+in+the+leading+score+levels%29+prunes+a+lot.%0AAdvanced+configuration%3A%0A237%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EDEPTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0AThe+nodeExplorationType+options+are%3A%0A%E2%80%A2+DEPTH_FIRST+%28default%29%3A+Explore+deeper+nodes+first+%28and+then+a+better+score+and+then+a+better%0Aoptimistic+bound%29.+Deeper+nodes+%28especially+leaf+nodes%29+often+improve+the+pessimistic+bound.+A%0Abetter+pessimistic+bound+allows+pruning+more+nodes+to+reduce+the+search+space.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EDEPTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+BREADTH_FIRST+%28not+recommended%29%3A+Explore+nodes+layer+by+layer+%28and+then+a+better+score+and%0Athen+a+better+optimistic+bound%29.+Scales+terribly+in+memory+%28and+usually+in+performance+too%29.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EBREADTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+SCORE_FIRST%3A+Explore+nodes+with+a+better+score+first+%28and+then+a+better+optimistic+bound+and%0Athen+deeper+nodes+first%29.+Might+scale+as+terribly+as+BREADTH_FIRST+in+some+cases.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3ESCORE_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+OPTIMISTIC_BOUND_FIRST%3A+Explore+nodes+with+a+better+optimistic+bound+first+%28and+then+a+better%0Ascore+and+then+deeper+nodes+first%29.+Might+scale+as+terribly+as+BREADTH_FIRST+in+some+cases.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EOPTIMISTIC_BOUND_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0AThe+entitySorterManner+options+are%3A%0A238%0A%E2%80%A2+DECREASING_DIFFICULTY%3A+Initialize+the+more+difficult+planning+entities+first.+This+usually+increases%0Apruning+%28and+therefore+improves+scalability%29.+Requires+the+model+to+support+planning+entity%0Adifficulty+comparison.%0A%E2%80%A2+DECREASING_DIFFICULTY_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+entity+difficulty%0Acomparison%2C+behave+like+DECREASING_DIFFICULTY%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Initialize+the+planning+entities+in+original+order.%0AThe+valueSorterManner+options+are%3A%0A%E2%80%A2+INCREASING_STRENGTH%3A+Evaluate+the+planning+values+in+increasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+INCREASING_STRENGTH_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+value+strength%0Acomparison%2C+behave+like+INCREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+DECREASING_STRENGTH%3A+Evaluate+the+planning+values+in+decreasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+DECREASING_STRENGTH_IF_AVAILABLE%3A+If+the+model+supports+planning+value+strength+comparison%2C%0Abehave+like+DECREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Try+the+planning+values+in+original+order.%0A9.4.+Scalability+of+Exhaustive+Search%0AExhaustive+Search+variants+suffer+from+two+big+scalability+issues%3A%0A%E2%80%A2+They+scale+terribly+memory+wise.%0A%E2%80%A2+They+scale+horribly+performance+wise.%0AAs+shown+in+these+time+spent+graphs+from+the+Benchmarker%2C+Brute+Force+and+Branch+And+Bound%0Aboth+hit+a+performance+scalability+wall.+For+example%2C+on+N+queens+it+hits+wall+at+a+few+dozen%0Aqueens%3A%0A239%0AIn+most+use+cases%2C+such+as+Cloud+Balancing%2C+the+wall+appears+out+of+thin+air%3A%0A240%0AExhaustive+Search+hits+this+wall+on+small+datasets+already%2C+so+in+production+these%0Aoptimizations+algorithms+are+mostly+useless.+Use+Construction+Heuristics+with+Local+Search%0Ainstead%3A+those+can+handle+thousands+of+queens%2Fcomputers+easily.%0AThrowing+hardware+at+these+scalability+issues+has+no+noticeable+impact.+Newer%0A%EF%81%9A+and+more+hardware+are+just+a+drop+in+the+ocean.+Moore%E2%80%99s+law+cannot+win+against%0Athe+onslaught+of+a+few+more+planning+entities+in+the+dataset.%0A241%0AChapter+10.+Construction+Heuristics%0A10.1.+Overview%0AA+construction+heuristic+builds+a+pretty+good+initial+solution+in+a+finite+length+of+time.+Its+solution%0Aisn%E2%80%99t+always+feasible%2C+but+it+finds+it+fast+so+metaheuristics+can+finish+the+job.%0AConstruction+heuristics+terminate+automatically%2C+so+there%E2%80%99s+usually+no+need+to+configure+a%0ATermination+on+the+construction+heuristic+phase+specifically.%0A10.2.+First+Fit%0A10.2.1.+Algorithm+Description%0AThe+First+Fit+algorithm+cycles+through+all+the+planning+entities+%28in+default+order%29%2C+initializing+one%0Aplanning+entity+at+a+time.+It+assigns+the+planning+entity+to+the+best+available+planning+value%2C+taking%0Athe+already+initialized+planning+entities+into+account.+It+terminates+when+all+planning+entities+have%0Abeen+initialized.+It+never+changes+a+planning+entity+after+it+has+been+assigned.%0ANotice+that+it+starts+with+putting+Queen+A+into+row+0+%28and+never+moving+it+later%29%2C+which+makes+it%0Aimpossible+to+reach+the+optimal+solution.+Suffixing+this+construction+heuristic+with+metaheuristics%0Acan+remedy+that.%0A242%0A10.2.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.3.+First+Fit+Decreasing%0A10.3.1.+Algorithm+Description%0ALike+First+Fit%2C+but+assigns+the+more+difficult+planning+entities+first%2C+because+they+are+less+likely+to+fit%0Ain+the+leftovers.+So+it+sorts+the+planning+entities+on+decreasing+difficulty.%0A243%0ARequires+the+model+to+support+planning+entity+difficulty+comparison.%0AOne+would+expect+that+this+algorithm+has+better+results+than+First+Fit.+That%E2%80%99s%0A%EF%81%9A+usually+the+case%2C+but+not+always.%0A10.3.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A244%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.4.+Weakest+Fit%0A10.4.1.+Algorithm+Description%0ALike+First+Fit%2C+but+uses+the+weaker+planning+values+first%2C+because+the+strong+planning+values+are%0Amore+likely+to+be+able+to+accommodate+later+planning+entities.+So+it+sorts+the+planning+values+on%0Aincreasing+strength.%0ARequires+the+model+to+support+planning+value+strength+comparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit.+That%E2%80%99s+often%0A%EF%81%9A+not+the+case.%0A10.4.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.5.+Weakest+Fit+Decreasing%0A10.5.1.+Algorithm+Description%0ACombines+First+Fit+Decreasing+and+Weakest+Fit.+So+it+sorts+the+planning+entities+on+decreasing%0Adifficulty+and+the+planning+values+on+increasing+strength.%0ARequires+the+model+to+support+planning+entity+difficulty+comparison+and+planning+value+strength%0Acomparison.%0A245%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+Decreasing.%0A%EF%81%9A+That%E2%80%99s+often+not+the+case.+However%2C+it+is+usually+better+than+Weakest+Fit.%0A10.5.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.6.+Strongest+Fit%0A10.6.1.+Algorithm+Description%0ALike+First+Fit%2C+but+uses+the+strong+planning+values+first%2C+because+the+strong+planning+values+are+more%0Alikely+to+have+a+lower+soft+cost+to+use.+So+it+sorts+the+planning+values+on+decreasing+strength.%0ARequires+the+model+to+support+planning+value+strength+comparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+or+Weakest+Fit.%0A%EF%81%9A+That%E2%80%99s+often+not+the+case.%0A10.6.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A246%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.7.+Strongest+Fit+Decreasing%0A10.7.1.+Algorithm+Description%0ACombines+First+Fit+Decreasing+and+Strongest+Fit.+So+it+sorts+the+planning+entities+on+decreasing%0Adifficulty+and+the+planning+values+on+decreasing+strength.%0ARequires+the+model+to+support+planning+entity+difficulty+comparison+and+planning+value+strength%0Acomparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+Decreasing+or%0A%EF%81%9A+Weakest+Fit+Decreasing.+That%E2%80%99s+often+not+the+case.+However%2C+it+is+usually+better+than%0AStrongest+Fit.%0A10.7.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A247%0A10.8.+Allocate+Entity+From+Queue%0A10.8.1.+Algorithm+Description%0AAllocate+Entity+From+Queue+is+a+versatile%2C+generic+form+of+First+Fit%2C+First+Fit+Decreasing%2C+Weakest+Fit%2C%0AWeakest+Fit+Decreasing%2C+Strongest+Fit+and+Strongest+Fit+Decreasing.+It+works+like+this%3A%0A1.+Put+all+entities+in+a+queue.%0A2.+Assign+the+first+entity+%28from+that+queue%29+to+the+best+value.%0A3.+Repeat+until+all+entities+are+assigned.%0A10.8.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_ENTITY_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_ENTITY_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+entitySorterManner+options+are%3A%0A%E2%80%A2+DECREASING_DIFFICULTY%3A+Initialize+the+more+difficult+planning+entities+first.+This+usually+increases%0Apruning+%28and+therefore+improves+scalability%29.+Requires+the+model+to+support+planning+entity%0Adifficulty+comparison.%0A%E2%80%A2+DECREASING_DIFFICULTY_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+entity+difficulty%0Acomparison%2C+behave+like+DECREASING_DIFFICULTY%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Initialize+the+planning+entities+in+original+order.%0AThe+valueSorterManner+options+are%3A%0A%E2%80%A2+INCREASING_STRENGTH%3A+Evaluate+the+planning+values+in+increasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+INCREASING_STRENGTH_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+value+strength%0Acomparison%2C+behave+like+INCREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+DECREASING_STRENGTH%3A+Evaluate+the+planning+values+in+decreasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A248%0A%E2%80%A2+DECREASING_STRENGTH_IF_AVAILABLE%3A+If+the+model+supports+planning+value+strength+comparison%2C%0Abehave+like+DECREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Try+the+planning+values+in+original+order.%0AAdvanced+configuration+with+Weakest+Fit+Decreasing+for+a+single+entity+class+with+one+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0APer+step%2C+the+QueuedEntityPlacer+selects+one+uninitialized+entity+from+the+EntitySelector+and+applies%0Athe+winning+Move+%28out+of+all+the+moves+for+that+entity+generated+by+the+MoveSelector%29.+The+mimic%0Aselection+ensures+that+the+winning+Move+changes+only+the+selected+entity.%0ATo+customize+the+entity+or+value+sorting%2C+see+sorted+selection.+For+scaling+out%2C+see+scaling%0Aconstruction+heuristics.%0AIf+there+are+multiple+planning+variables%2C+there%E2%80%99s+one+ChangeMoveSelector+per+planning+variable%2C%0Awhich+are+either+in+a+cartesian+product+or+in+sequential+steps%2C+similar+to+the+less+verbose%0Aconfiguration.%0A10.8.3.+Multiple+Entity+Classes%0AThe+easiest+way+to+deal+with+multiple+entity+classes+is+to+run+a+separate+Construction+Heuristic+for%0Aeach+entity+class%3A%0A249%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CentityClass%3E...DogEntity%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CentityClass%3E...CatEntity%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.8.4.+Pick+Early+Type%0AThere+are+several+pick+early+types+for+Construction+Heuristics%3A%0A%E2%80%A2+NEVER%3A+Evaluate+all+the+selected+moves+to+initialize+the+variable%28s%29.+This+is+the+default+if+the%0AInitializingScoreTrend+is+not+ONLY_DOWN.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3ENEVER%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%E2%80%A2+FIRST_NON_DETERIORATING_SCORE%3A+Initialize+the+variable%28s%29+with+the+first+move+that+doesn%E2%80%99t%0Adeteriorate+the+score%2C+ignore+the+remaining+selected+moves.+This+is+the+default+if+the%0AInitializingScoreTrend+is+ONLY_DOWN.%0A250%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_NON_DETERIORATING_SCORE%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AIf+there+are+only+negative+constraints%2C+but+the+InitializingScoreTrend+is+strictly%0Anot+ONLY_DOWN%2C+it+can+sometimes+make+sense+to+apply%0A%EF%81%9A+FIRST_NON_DETERIORATING_SCORE.+Use+the+Benchmarker+to+decide+if+the%0Ascore+quality+loss+is+worth+the+time+gain.%0A%E2%80%A2+FIRST_FEASIBLE_SCORE%3A+Initialize+the+variable%28s%29+with+the+first+move+that+has+a+feasible+score.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_FEASIBLE_SCORE%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AIf+the+InitializingScoreTrend+is+ONLY_DOWN%2C+use+FIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%0Ainstead%2C+because+that%E2%80%99s+faster+without+any+disadvantages.%0A%E2%80%A2+FIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%3A+Initialize+the+variable%28s%29+with+the+first+move%0Athat+doesn%E2%80%99t+deteriorate+the+feasibility+of+the+score+any+further.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.9.+Allocate+To+Value+From+Queue%0A10.9.1.+Algorithm+Description%0AAllocate+To+Value+From+Queue+works+like+this%3A%0A1.+Put+all+values+in+a+round-robin+queue.%0A2.+Assign+the+best+entity+to+the+first+value+%28from+that+queue%29.%0A3.+Repeat+until+all+entities+are+assigned.%0A251%0A10.9.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3E%0AALLOCATE_TO_VALUE_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3E%0AALLOCATE_TO_VALUE_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration+for+a+single+entity+class+with+a+single+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedValuePlacer%3E%0A%C2%A0+++++%3CvalueSelector+id%3D%22placerValueSelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector+mimicSelectorRef%3D%22placerValueSelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedValuePlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.%0A10.10.+Cheapest+Insertion%0A10.10.1.+Algorithm+Description%0AThe+Cheapest+Insertion+algorithm+cycles+through+all+the+planning+values+for+all+the+planning%0Aentities%2C+initializing+one+planning+entity+at+a+time.+It+assigns+a+planning+entity+to+the+best+available%0A252%0Aplanning+value+%28out+of+all+the+planning+entities+and+values%29%2C+taking+the+already+initialized+planning%0Aentities+into+account.+It+terminates+when+all+planning+entities+have+been+initialized.+It+never%0Achanges+a+planning+entity+after+it+has+been+assigned.%0A%EF%81%9A+Cheapest+Insertion+scales+considerably+worse+than+First+Fit%2C+etc.%0A10.10.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ECHEAPEST_INSERTION%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A253%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ECHEAPEST_INSERTION%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0Afrom+pool.%0A10.11.+Regret+Insertion%0A10.11.1.+Algorithm+Description%0AThe+Regret+Insertion+algorithm+behaves+like+the+Cheapest+Insertion+algorithm.+It+also+cycles+through%0Aall+the+planning+values+for+all+the+planning+entities%2C+initializing+one+planning+entity+at+a+time.+But%0Ainstead+of+picking+the+entity-value+combination+with+the+best+score%2C+it+picks+the+entity+which+has+the%0Alargest+score+loss+between+its+best+and+second+best+value+assignment.+It+then+assigns+that+entity+to+its%0Abest+value%2C+to+avoid+regretting+not+having+done+that.%0A10.11.2.+Configuration%0AThis+algorithm+has+not+been+implemented+yet.%0A10.12.+Allocate+From+Pool%0A10.12.1.+Algorithm+Description%0AAllocate+From+Pool+is+a+versatile%2C+generic+form+of+Cheapest+Insertion+and+Regret+Insertion.+It+works%0Alike+this%3A%0A1.+Put+all+entity-value+combinations+in+a+pool.%0A2.+Assign+the+best+entity+to+best+value.%0A3.+Repeat+until+all+entities+are+assigned.%0A10.12.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_FROM_POOL%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A254%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_FROM_POOL%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+entitySorterManner+and+valueSorterManner+options+are+described+in+Allocate+Entity+From+Queue.%0AAdvanced+configuration+with+Cheapest+Insertion+for+a+single+entity+class+with+a+single+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CpooledEntityPlacer%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FpooledEntityPlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0APer+step%2C+the+PooledEntityPlacer+applies+the+winning+Move+%28out+of+all+the+moves+for+that+entity%0Agenerated+by+the+MoveSelector%29.%0ATo+customize+the+entity+or+value+sorting%2C+see+sorted+selection.+Other+Selector+customization+%28such+as%0Afiltering+and+limiting%29+is+supported+too.%0AFor+scaling+out%2C+see+scaling+construction+heuristics.%0A10.13.+Scaling+Construction+Heuristics%0AIf+the+Construction+Heuristic+takes+a+long+time+to+solve+and+create+an+initial+solution%2C+there+is+too%0Alittle+time+left+for+Local+Search+to+reach+a+near+optimal+solution.%0AIdeally%2C+a+Construction+Heuristic+should+take+less+than+20+seconds+from+scratch+and+less+than+50%0Amilliseconds+in+real-time+planning%2C+so+there+is+plenty+of+time+left+for+Local+Search.+If+the%0ABenchmarker+proves+that+this+is+not+the+case%2C+there%E2%80%99s+a+number+of+improvements+that+can+be+done%3A%0A10.13.1.+InitializingScoreTrend+shortcuts%0AIf+the+InitializingScoreTrend+is+ONLY_DOWN%2C+a+Construction+Heuristic+algorithm+%28such+as+First+Fit%29+is%0Afaster%3A+for+an+entity%2C+it+picks+the+first+move+for+which+the+score+does+not+deteriorate+the+last+step%0A255%0Ascore%2C+ignoring+all+subsequent+moves+in+that+step.%0AIt+can+take+that+shortcut+without+reducing+solution+quality%2C+because+a+down+trend+guarantees+that%0Ainitializing+any+additional+planning+variable+can+only+make+the+score+the+same+or+worse.+So+if+a%0Amove+has+the+same+score+as+before+the+planning+variable+was+initialized%2C+then+no+other+move+can%0Ahave+a+better+score.%0A10.13.2.+Scaling+Multiple+Planning+Variables+in+Construction+Heuristics%0AThere+are+two+ways+to+deal+with+multiple+planning+variables%2C+depending+on+how+their+ChangeMoves%0Aare+combined%3A%0A%E2%80%A2+Cartesian+product+%28default%29%3A+All+variables+of+the+selected+entity+are+assigned+together.+This%0Ausually+results+in+a+better+solution+quality%2C+but+it+scales+poorly+because+it+tries+every%0Acombination+of+variables.+For+example%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%E2%80%A2+Sequential%3A+One+variable+is+assigned+at+a+time.+Scales+better%2C+at+the+cost+of+solution+quality.+The%0Aorder+of+the+planning+variables+matters.+For+example%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+second+way+scales+better%2C+so+it+can+be+worth+to+switch+to+it.+For+example%2C+in+a+course+scheduling%0Aexample+with+200+rooms+and+40+periods%2C+a+cartesian+product+selects+8%C2%A0000+moves+per+entity+%281+step%0Aper+entity%29.+On+the+other+hand%2C+a+sequential+approach+only+selects+240+moves+per+entity+%282+steps+per%0Aentity%29%2C+ending+the+Construction+Heuristic+3+times+faster.+Especially+for+three+or+more+planning%0Avariables%2C+the+scaling+difference+is+huge.+For+example%2C+with+three+variables+of+1%C2%A0000+values+each%2C+a%0Acartesian+product+selects+1%C2%A0000%C2%A0000%C2%A0000+moves+per+entity+%281+step+per+entity%29.+A+sequential+approach%0A256%0Aonly+selects+3%C2%A0000+moves+per+entity+%283+steps+per+entity%29%2C+ending+the+Construction+Heuristic+300%C2%A0000%0Atimes+faster.%0AThe+order+of+the+variables+is+important%2C+especially+in+the+sequential+technique.+In%0Athe+sequential+example+above%2C+it%E2%80%99s+better+to+select+the+period+first+and+the+room%0Asecond+%28instead+of+the+other+way+around%29%2C+because+there+are+more+hard+constraints%0A%EF%81%AA+that+do+not+involve+the+room%2C+such+as+no+teacher+should+teach+two+lectures+at+the%0Asame+time.%0ALet+the+Benchmarker+guide+you.%0AWith+three+or+more+variables%2C+it%E2%80%99s+possible+to+combine+the+cartesian+product+and+sequential%0Atechniques%3A%0A257%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22teacher%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.13.3.+Other+Scaling+Techniques+in+Construction+Heuristics%0APartitioned+Search+reduces+the+number+of+moves+per+step.+On+top+of+that%2C+it+runs+the+Construction%0AHeuristic+on+the+partitions+in+parallel.+It+is+supported+to+only+partition+the+Construction+Heuristic%0Aphase.%0AOther+Selector+customizations+can+also+reduce+the+number+of+moves+generated+by+step%3A%0A%E2%80%A2+Filtered+selection%0A%E2%80%A2+Limited+selection%0A258%0AChapter+11.+Local+Search%0A11.1.+Overview%0ALocal+Search+starts+from+an+initial+solution+and+evolves+that+single+solution+into+a+mostly+better+and%0Abetter+solution.+It+uses+a+single+search+path+of+solutions%2C+not+a+search+tree.+At+each+solution+in+this%0Apath+it+evaluates+a+number+of+moves+on+the+solution+and+applies+the+most+suitable+move+to+take+the%0Astep+to+the+next+solution.+It+does+that+for+a+high+number+of+iterations+until+it%E2%80%99s+terminated+%28usually%0Abecause+its+time+has+run+out%29.%0ALocal+Search+acts+a+lot+like+a+human+planner%3A+it+uses+a+single+search+path+and+moves+facts+around+to%0Afind+a+good+feasible+solution.+Therefore+it%E2%80%99s+pretty+natural+to+implement.%0ALocal+Search+needs+to+start+from+an+initialized+solution%2C+therefore+it%E2%80%99s+usually+required+to%0Aconfigure+a+Construction+Heuristic+phase+before+it.%0A11.2.+Local+Search+Concepts%0A11.2.1.+Step+by+Step%0AA+step+is+the+winning+Move.+Local+Search+tries+a+number+of+moves+on+the+current+solution+and+picks%0Athe+best+accepted+move+as+the+step%3A%0AFigure+6.+Decide+the+next+step+at+step+0+%28four+queens+example%29%0ABecause+the+move+B0+to+B3+has+the+highest+score+%28-3%29%2C+it+is+picked+as+the+next+step.+If+multiple+moves%0Ahave+the+same+highest+score%2C+one+is+picked+randomly%2C+in+this+case+B0+to+B3.+Note+that+C0+to+C3+%28not%0Ashown%29+could+also+have+been+picked+because+it+also+has+the+score+-3.%0AThe+step+is+applied+on+the+solution.+From+that+new+solution%2C+Local+Search+tries+every+move+again%2C+to%0Adecide+the+next+step+after+that.+It+continually+does+this+in+a+loop%2C+and+we+get+something+like+this%3A%0A259%0AFigure+7.+All+steps+%28four+queens+example%29%0ANotice+that+Local+Search+doesn%E2%80%99t+use+a+search+tree%2C+but+a+search+path.+The+search+path+is+highlighted%0Aby+the+green+arrows.+At+each+step+it+tries+all+selected+moves%2C+but+unless+it%E2%80%99s+the+step%2C+it+doesn%E2%80%99t%0Ainvestigate+that+solution+further.+This+is+one+of+the+reasons+why+Local+Search+is+very+scalable.%0AAs+shown+above%2C+Local+Search+solves+the+four+queens+problem+by+starting+with+the+starting+solution%0Aand+make+the+following+steps+sequentially%3A%0A1.+B0+to+B3%0A2.+D0+to+B2%0A3.+A0+to+B1%0A260%0ATurn+on+debug+logging+for+the+category+org.optaplanner+to+show+those+steps+in+the+log%3A%0AINFO++Solving+started%3A+time+spent+%280%29%2C+best+score+%28-6%29%2C+environment+mode%0A%28REPRODUCIBLE%29%2C+random+%28JDK+with+seed+0%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%2820%29%2C+score+%28-3%29%2C+new+best+score+%28-3%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-0+-%3E+Row-3%7D%29.%0ADEBUG+++++LS+step+%281%29%2C+time+spent+%2831%29%2C+score+%28-1%29%2C+new+best+score+%28-1%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-3+%7BRow-0+-%3E+Row-2%7D%29.%0ADEBUG+++++LS+step+%282%29%2C+time+spent+%2840%29%2C+score+%280%29%2C+new+best+score+%280%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-0+%7BRow-0+-%3E+Row-1%7D%29.%0AINFO++Local+Search+phase+%280%29+ended%3A+time+spent+%2841%29%2C+best+score+%280%29%2C+score+calculation%0Aspeed+%285000%2Fsec%29%2C+step+total+%283%29.%0AINFO++Solving+ended%3A+time+spent+%2841%29%2C+best+score+%280%29%2C+score+calculation+speed%0A%285000%2Fsec%29%2C+phase+total+%281%29%2C+environment+mode+%28REPRODUCIBLE%29.%0ANotice+that+a+log+message+includes+the+toString%28%29+method+of+the+Move+implementation+which+returns%0Afor+example+%22Queen-1+%7BRow-0+%E2%86%92+Row-3%7D%22.%0AA+naive+Local+Search+configuration+solves+the+four+queens+problem+in+three+steps%2C+by+evaluating%0Aonly+37+possible+solutions+%28three+steps+with+12+moves+each+%2B+one+starting+solution%29%2C+which+is+only%0Afraction+of+all+256+possible+solutions.+It+solves+16+queens+in+31+steps%2C+by+evaluating+only+7441+out+of%0A18446744073709551616+possible+solutions.+By+using+a+Construction+Heuristics+phase+first%2C+it%E2%80%99s+even+a%0Alot+more+efficient.%0A11.2.2.+Decide+the+Next+Step%0ALocal+Search+decides+the+next+step+with+the+aid+of+three+configurable+components%3A%0A%E2%80%A2+A+MoveSelector+which+selects+the+possible+moves+of+the+current+solution.+See+the+chapter+move%0Aand+neighborhood+selection.%0A%E2%80%A2+An+Acceptor+which+filters+out+unacceptable+moves.%0A%E2%80%A2+A+Forager+which+gathers+accepted+moves+and+picks+the+next+step+from+them.%0AThe+solver+phase+configuration+looks+like+this%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A261%0AIn+the+example+below%2C+the+MoveSelector+generated+the+moves+shown+with+the+blue+lines%2C+the+Acceptor%0Aaccepted+all+of+them+and+the+Forager+picked+the+move+B0+to+B3.%0ATurn+on+trace+logging+to+show+the+decision+making+in+the+log%3A%0AINFO++Solver+started%3A+time+spent+%280%29%2C+score+%28-6%29%2C+new+best+score+%28-6%29%2C+random+%28JDK%0Awith+seed+0%29.%0ATRACE+++++++++Move+index+%280%29+not+doable%2C+ignoring+move+%28Queen-0+%7BRow-0+-%3E+Row-0%7D%29.%0ATRACE+++++++++Move+index+%281%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-1%7D%29.%0ATRACE+++++++++Move+index+%282%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-2%7D%29.%0ATRACE+++++++++Move+index+%283%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%286%29%2C+score+%28-3%29%2C+accepted+%28true%29%2C+move+%28Queen-1+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%289%29%2C+score+%28-3%29%2C+accepted+%28true%29%2C+move+%28Queen-2+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%2812%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-3+%7BRow-0+-%3E%0ARow-3%7D%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%286%29%2C+score+%28-3%29%2C+new+best+score+%28-3%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-0+-%3E+Row-3%7D%29.%0A...%0ABecause+the+last+solution+can+degrade+%28for+example+in+Tabu+Search%29%2C+the+Solver+remembers+the+best%0Asolution+it+has+encountered+through+the+entire+search+path.+Each+time+the+current+solution+is+better%0Athan+the+last+best+solution%2C+the+current+solution+is+cloned+and+referenced+as+the+new+best+solution.%0A262%0A11.2.3.+Acceptor%0AAn+Acceptor+is+used+%28together+with+a+Forager%29+to+active+Tabu+Search%2C+Simulated+Annealing%2C+Late%0AAcceptance%2C+%E2%80%A6+For+each+move+it+checks+whether+it+is+accepted+or+not.%0ABy+changing+a+few+lines+of+configuration%2C+you+can+easily+switch+from+Tabu+Search+to+Simulated%0AAnnealing+or+Late+Acceptance+and+back.%0AYou+can+implement+your+own+Acceptor%2C+but+the+built-in+acceptors+should+suffice+for+most+needs.+You%0Acan+also+combine+multiple+acceptors.%0A11.2.4.+Forager%0AA+Forager+gathers+all+accepted+moves+and+picks+the+move+which+is+the+next+step.+Normally+it+picks%0Athe+accepted+move+with+the+highest+score.+If+several+accepted+moves+have+the+highest+score%2C+one+is%0Apicked+randomly+to+break+the+tie.+Breaking+ties+randomly+leads+to+better+results.%0A263%0AIt+is+possible+to+disable+breaking+ties+randomly+by+explicitly+setting%0AbreakTieRandomly+to+false%2C+but+that%E2%80%99s+almost+never+a+good+idea%3A%0A%EF%81%9A+%E2%80%A2+If+an+earlier+move+is+better+than+a+later+move+with+the+same+score%2C+the+scorecalculator+should+add+an+extra+softer+score+level+to+score+the+first+move+as%0Aslightly+better.+Don%E2%80%99t+rely+on+move+selection+order+to+enforce+that.%0A%E2%80%A2+Random+tie+breaking+does+not+affect+reproducibility.%0A11.2.4.1.+Accepted+Count+Limit%0AWhen+there+are+many+possible+moves%2C+it+becomes+inefficient+to+evaluate+all+of+them+at+every+step.%0ATo+evaluate+only+a+random+subset+of+all+the+moves%2C+use%3A%0A%E2%80%A2+An+acceptedCountLimit+integer%2C+which+specifies+how+many+accepted+moves+should+be+evaluated%0Aduring+each+step.+By+default%2C+all+accepted+moves+are+evaluated+at+every+step.%0A%C2%A0+%3Cforager%3E%0A%C2%A0+++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+%3C%2Fforager%3E%0AUnlike+the+n+queens+problem%2C+real+world+problems+require+the+use+of+acceptedCountLimit.+Start+from%0Aan+acceptedCountLimit+that+takes+a+step+in+less+than+two+seconds.+Turn+on+INFO+logging+to+see+the%0Astep+times.+Use+the+Benchmarker+to+tweak+the+value.%0AWith+a+low+acceptedCountLimit+%28so+a+fast+stepping+algorithm%29%2C+it+is+recommended+to%0Aavoid+using+selectionOrder+SHUFFLED+because+the+shuffling+generates+a+random%0A%EF%81%AA+number+for+every+element+in+the+selector%2C+taking+up+a+lot+of+time%2C+but+only+a+few%0Aelements+are+actually+selected.%0A11.2.4.2.+Pick+Early+Type%0AA+forager+can+pick+a+move+early+during+a+step%2C+ignoring+subsequent+selected+moves.+There+are+three%0Apick+early+types+for+Local+Search%3A%0A%E2%80%A2+NEVER%3A+A+move+is+never+picked+early%3A+all+accepted+moves+are+evaluated+that+the+selection+allows.%0AThis+is+the+default.%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3ENEVER%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%E2%80%A2+FIRST_BEST_SCORE_IMPROVING%3A+Pick+the+first+accepted+move+that+improves+the+best+score.+If+none%0Aimprove+the+best+score%2C+it+behaves+exactly+like+the+pickEarlyType+NEVER.%0A264%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_BEST_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%E2%80%A2+FIRST_LAST_STEP_SCORE_IMPROVING%3A+Pick+the+first+accepted+move+that+improves+the+last+step+score.%0AIf+none+improve+the+last+step+score%2C+it+behaves+exactly+like+the+pickEarlyType+NEVER.%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_LAST_STEP_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A11.3.+Hill+Climbing+%28Simple+Local+Search%29%0A11.3.1.+Algorithm+Description%0AHill+Climbing+tries+all+selected+moves+and+then+takes+the+best+move%2C+which+is+the+move+which+leads%0Ato+the+solution+with+the+highest+score.+That+best+move+is+called+the+step+move.+From+that+new%0Asolution%2C+it+again+tries+all+selected+moves+and+takes+the+best+move+and+continues+like+that+iteratively.%0AIf+multiple+selected+moves+tie+for+the+best+move%2C+one+of+them+is+randomly+chosen+as+the+best+move.%0ANotice+that+once+a+queen+has+moved%2C+it+can+be+moved+again+later.+This+is+a+good+thing%2C+because+in+an%0A265%0ANP-complete+problem+it%E2%80%99s+impossible+to+predict+what+will+be+the+optimal+final+value+for+a+planning%0Avariable.%0A11.3.2.+Stuck+in+Local+Optima%0AHill+Climbing+always+takes+improving+moves.+This+may+seem+like+a+good+thing%2C+but+it%E2%80%99s+not%3A+Hill%0AClimbing+can+easily+get+stuck+in+a+local+optimum.+This+happens+when+it+reaches+a+solution+for%0Awhich+all+the+moves+deteriorate+the+score.+Even+if+it+picks+one+of+those+moves%2C+the+next+step+might%0Ago+back+to+the+original+solution+and+which+case+chasing+its+own+tail%3A%0AImprovements+upon+Hill+Climbing+%28such+as+Tabu+Search%2C+Simulated+Annealing+and+Late+Acceptance%29%0Aaddress+the+problem+of+being+stuck+in+local+optima.+Therefore%2C+it%E2%80%99s+recommend+to+never+use+Hill%0AClimbing%2C+unless+you%E2%80%99re+absolutely+sure+there+are+no+local+optima+in+your+planning+problem.%0A11.3.3.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3EHILL_CLIMBING%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AAdvanced+configuration%3A%0A266%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CacceptorType%3EHILL_CLIMBING%3C%2FacceptorType%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.4.+Tabu+Search%0A11.4.1.+Algorithm+Description%0ATabu+Search+works+like+Hill+Climbing%2C+but+it+maintains+a+tabu+list+to+avoid+getting+stuck+in+local%0Aoptima.+The+tabu+list+holds+recently+used+objects+that+are+taboo+to+use+for+now.+Moves+that+involve%0Aan+object+in+the+tabu+list%2C+are+not+accepted.+The+tabu+list+objects+can+be+anything+related+to+the+move%2C%0Asuch+as+the+planning+entity%2C+planning+value%2C+move%2C+solution%2C+%E2%80%A6+Here%E2%80%99s+an+example+with+entity+tabu%0Afor+four+queens%2C+so+the+queens+are+put+in+the+tabu+list%3A%0A%EF%81%9A+It%E2%80%99s+called+Tabu+Search%2C+not+Taboo+Search.+There+is+no+spelling+error.%0A267%0AScientific+paper%3A+Tabu+Search+-+Part+1+and+Part+2+by+Fred+Glover+%281989+-+1990%29%0A11.4.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3ETABU_SEARCH%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AWhen+Tabu+Search+takes+steps+it+creates+one+or+more+tabu%E2%80%99s.+For+a+number+of+steps%2C+it+does+not%0Aaccept+a+move+if+that+move+breaks+tabu.+That+number+of+steps+is+the+tabu+size.+Advanced%0Aconfiguration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AA+Tabu+Search+acceptor+should+be+combined+with+a+high+acceptedCountLimit%2C+such%0A%EF%81%AA+as+1000.%0APlanner+implements+several+tabu+types%3A%0A%E2%80%A2+Planning+entity+tabu+%28recommended%29+makes+the+planning+entities+of+recent+steps+tabu.+For%0Aexample%2C+for+N+queens+it+makes+the+recently+moved+queens+tabu.+It%E2%80%99s+recommended+to+start+with%0Athis+tabu+type.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0ATo+avoid+hard+coding+the+tabu+size%2C+configure+a+tabu+ratio%2C+relative+to+the+number+of+entities%2C+for%0Aexample+2%25%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuRatio%3E0.02%3C%2FentityTabuRatio%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Planning+value+tabu+makes+the+planning+values+of+recent+steps+tabu.+For+example%2C+for+N+queens%0A268%0Ait+makes+the+recently+moved+to+rows+tabu.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CvalueTabuSize%3E7%3C%2FvalueTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0ATo+avoid+hard+coding+the+tabu+size%2C+configure+a+tabu+ratio%2C+relative+to+the+number+of+values%2C+for%0Aexample+2%25%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CvalueTabuRatio%3E0.02%3C%2FvalueTabuRatio%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Move+tabu+makes+recent+steps+tabu.+It+does+not+accept+a+move+equal+to+one+of+those+steps.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CmoveTabuSize%3E7%3C%2FmoveTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Undo+move+tabu+makes+the+undo+move+of+recent+steps+tabu.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CundoMoveTabuSize%3E7%3C%2FundoMoveTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Solution+tabu+makes+recently+visited+solutions+tabu.+It+does+not+accept+a+move+that+leads+to+one%0Aof+those+solutions.+It+requires+that+the+Solution+implements+equals%28%29+and+hashCode%28%29+properly.+If%0Ayou+can+spare+the+memory%2C+don%E2%80%99t+be+cheap+on+the+tabu+size.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsolutionTabuSize%3E1000%3C%2FsolutionTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0AFor+non-trivial+cases%2C+solution+tabu+is+usually+useless+because+the+search+space+size+makes+it%0Astatistically+highly+unlikely+to+reach+the+same+solution+twice.+Therefore+its+use+is+not%0Arecommended%2C+except+for+small+datasets.%0ASometimes+it%E2%80%99s+useful+to+combine+tabu+types%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++++%3CvalueTabuSize%3E3%3C%2FvalueTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A269%0AIf+the+tabu+size+is+too+small%2C+the+solver+can+still+get+stuck+in+a+local+optimum.+On+the+other+hand%2C+if%0Athe+tabu+size+is+too+large%2C+the+solver+can+be+inefficient+by+bouncing+of+the+walls.+Use+the%0ABenchmarker+to+fine+tweak+your+configuration.%0A11.5.+Simulated+Annealing%0A11.5.1.+Algorithm+Description%0ASimulated+Annealing+evaluates+only+a+few+moves+per+step%2C+so+it+steps+quickly.+In+the+classic%0Aimplementation%2C+the+first+accepted+move+is+the+winning+step.+A+move+is+accepted+if+it+doesn%E2%80%99t%0Adecrease+the+score+or+-+in+case+it+does+decrease+the+score+-+it+passes+a+random+check.+The+chance+that%0Aa+decreasing+move+passes+the+random+check+decreases+relative+to+the+size+of+the+score+decrement%0Aand+the+time+the+phase+has+been+running+%28which+is+represented+as+the+temperature%29.%0ASimulated+Annealing+does+not+always+pick+the+move+with+the+highest+score%2C+neither+does+it+evaluate%0Amany+moves+per+step.+At+least+at+first.+Instead%2C+it+gives+non+improving+moves+also+a+chance+to+be%0Apicked%2C+depending+on+its+score+and+the+time+gradient+of+the+Termination.+In+the+end%2C+it+gradually%0Aturns+into+Hill+Climbing%2C+only+accepting+improving+moves.%0A11.5.2.+Configuration%0AStart+with+a+simulatedAnnealingStartingTemperature+set+to+the+maximum+score+delta+a+single+move%0Acan+cause.+Use+the+Benchmarker+to+tweak+the+value.+Advanced+configuration%3A%0A270%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsimulatedAnnealingStartingTemperature%3E%0A2hard%2F100soft%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ASimulated+Annealing+should+use+a+low+acceptedCountLimit.+The+classic+algorithm+uses+an%0AacceptedCountLimit+of+1%2C+but+often+4+performs+better.%0ASimulated+Annealing+can+be+combined+with+a+tabu+acceptor+at+the+same+time.+That+gives+Simulated%0AAnnealing+salted+with+a+bit+of+Tabu.+Use+a+lower+tabu+size+than+in+a+pure+Tabu+Search+configuration.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsimulatedAnnealingStartingTemperature%3E%0A2hard%2F100soft%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++++%3CentityTabuSize%3E5%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.6.+Late+Acceptance%0A11.6.1.+Algorithm+Description%0ALate+Acceptance+%28also+known+as+Late+Acceptance+Hill+Climbing%29+also+evaluates+only+a+few+moves+per%0Astep.+A+move+is+accepted+if+it+does+not+decrease+the+score%2C+or+if+it+leads+to+a+score+that+is+at+least+the%0Alate+score+%28which+is+the+winning+score+of+a+fixed+number+of+steps+ago%29.%0A271%0AScientific+paper%3A+The+Late+Acceptance+Hill-Climbing+Heuristic+by+Edmund+K.+Burke%2C+Yuri+Bykov%0A%282012%29%0A11.6.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3ELATE_ACCEPTANCE%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ALate+Acceptance+accepts+any+move+that+has+a+score+which+is+higher+than+the+best+score+of+a+number%0Aof+steps+ago.+That+number+of+steps+is+the+lateAcceptanceSize.+Advanced+configuration%3A%0A272%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3ClateAcceptanceSize%3E400%3C%2FlateAcceptanceSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ALate+Acceptance+should+use+a+low+acceptedCountLimit.%0ALate+Acceptance+can+be+combined+with+a+tabu+acceptor+at+the+same+time.+That+gives+Late%0AAcceptance+salted+with+a+bit+of+Tabu.+Use+a+lower+tabu+size+than+in+a+pure+Tabu+Search%0Aconfiguration.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3ClateAcceptanceSize%3E400%3C%2FlateAcceptanceSize%3E%0A%C2%A0+++++%3CentityTabuSize%3E5%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.7.+Step+Counting+Hill+Climbing%0A11.7.1.+Algorithm+Description%0AStep+Counting+Hill+Climbing+also+evaluates+only+a+few+moves+per+step.+For+a+number+of+steps%2C+it%0Akeeps+the+step+score+as+a+threshold.+A+move+is+accepted+if+it+does+not+decrease+the+score%2C+or+if+it+leads%0Ato+a+score+that+is+at+least+the+threshold+score.%0AScientific+paper%3A+An+initial+study+of+a+novel+Step+Counting+Hill+Climbing+heuristic+applied+to%0Atimetabling+problems+by+Yuri+Bykov%2C+Sanja+Petrovic+%282013%29%0A11.7.2.+Configuration%0AStep+Counting+Hill+Climbing+accepts+any+move+that+has+a+score+which+is+higher+than+a+threshold%0Ascore.+Every+number+of+steps+%28specified+by+stepCountingHillClimbingSize%29%2C+the+threshold+score+is+set%0Ato+the+step+score.%0A273%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CstepCountingHillClimbingSize%3E400%3C%2FstepCountingHillClimbingSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AStep+Counting+Hill+Climbing+should+use+a+low+acceptedCountLimit.%0AStep+Counting+Hill+Climbing+can+be+combined+with+a+tabu+acceptor+at+the+same+time%2C+similar+as%0Ashown+in+the+Late+Acceptance+section.%0A11.8.+Strategic+Oscillation%0A11.8.1.+Algorithm+Description%0AStrategic+Oscillation+is+an+add-on%2C+which+works+especially+well+with+Tabu+Search.+Instead+of+picking%0Athe+accepted+move+with+the+highest+score%2C+it+employs+a+different+mechanism%3A+If+there%E2%80%99s+an%0Aimproving+move%2C+it+picks+it.+If+there%E2%80%99s+no+improving+move+however%2C+it+prefers+moves+which+improve%0Aa+softer+score+level%2C+over+moves+which+break+a+harder+score+level+less.%0A11.8.2.+Configuration%0AConfigure+a+finalistPodiumType%2C+for+example+in+a+Tabu+Search+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+++++%3CfinalistPodiumType%3ESTRATEGIC_OSCILLATION%3C%2FfinalistPodiumType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AThe+following+finalistPodiumTypes+are+supported%3A%0A%E2%80%A2+HIGHEST_SCORE+%28default%29%3A+Pick+the+accepted+move+with+the+highest+score.%0A%E2%80%A2+STRATEGIC_OSCILLATION%3A+Alias+for+the+default+strategic+oscillation+variant.%0A%E2%80%A2+STRATEGIC_OSCILLATION_BY_LEVEL%3A+If+there+is+an+accepted+improving+move%2C+pick+it.+If+no+such+move%0Aexists%2C+prefer+an+accepted+move+which+improves+a+softer+score+level+over+one+that+doesn%E2%80%99t+%28even%0Aif+it+has+a+better+harder+score+level%29.+A+move+is+improving+if+it%E2%80%99s+better+than+the+last+completed%0A274%0Astep+score.%0A%E2%80%A2+STRATEGIC_OSCILLATION_BY_LEVEL_ON_BEST_SCORE%3A+Like+STRATEGIC_OSCILLATION_BY_LEVEL%2C+but+define%0Aimproving+as+better+than+the+best+score+%28instead+of+the+last+completed+step+score%29.%0A11.9.+Variable+Neighborhood+Descent%0A11.9.1.+Algorithm+Description%0AVariable+Neighborhood+Descent+iteratively+tries+multiple+move+selectors+in+original+order+%28depleting%0Aeach+selector+entirely+before+trying+the+next+one%29%2C+picking+the+first+improving+move+%28which+also%0Aresets+the+iterator+back+to+the+first+move+selector%29.%0ADespite+that+VND+has+a+name+that+ends+with+descent+%28from+the+research+papers%29%2C%0A%EF%81%9A+the+implementation+will+ascend+to+a+higher+score+%28which+is+a+better+score%29.%0A11.9.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3EVARIABLE_NEIGHBORHOOD_DESCENT%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CselectionOrder%3EORIGINAL%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CacceptorType%3EHILL_CLIMBING%3C%2FacceptorType%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_LAST_STEP_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AVariable+Neighborhood+Descent+doesn%E2%80%99t+scale+well%2C+but+it+is+useful+in+some+use+cases+with+a+very%0Aerratic+score+landscape.%0A275%0A11.10.+Using+a+Custom+Termination%2C+MoveSelector%2C%0AEntitySelector%2C+ValueSelector+or+Acceptor%0APlug+in+a+custom+Termination%2C+MoveSelector%2C+EntitySelector%2C+ValueSelector+or+Acceptor+by+extending%0Athe+abstract+class+and+also+the+related+%5C*Config+class.%0AExtending+Config+classes+is+not+covered+by+the+backwards+compatbility+gaurantee.%0A%EF%81%AA+Whenever+possible%2C+it%E2%80%99s+better+to+just+use+custom+properties+instead.%0AFor+example%2C+to+use+a+custom+Termination%2C+extend+the+AbstractTermination+class%2C+extend+the%0ATerminationConfig+class+and+configure+it+in+the+solver+configuration.%0A%3Csolver%3E%0A%C2%A0+%3Ctermination+class%3D%22...MyTerminationConfig%22%3E%0A%C2%A0+++%3CmyProperty%3EmyValue%3C%2FmyProperty%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%3C%2Fsolver%3E%0AIt%E2%80%99s+not+possible+to+inject+a+Termination%2C+%E2%80%A6+instance+directly+%28to+avoid+extending+a%0AConfig+class+too%29+because%3A%0A%E2%80%A2+A+SolverFactory+can+build+multiple+Solver+instances%2C+which+each+require+a%0Adistinct+Termination%2C+%E2%80%A6+instance.%0A%EF%81%9A+%E2%80%A2+A+solver+configuration+needs+to+be+serializable+from+and+to+XML.+This+makes%0Abenchmarking+with+PlannerBenchmark+particularly+easy+because+you+can%0Aconfigure+different+Solver+variants+in+XML.%0A%E2%80%A2+A+Config+class+is+often+easier+and+clearer+to+configure.+For+example%3A%0ATerminationConfig+translates+minutesSpentLimit+and+secondsSpentLimit+into%0AtimeMillisSpentLimit.%0AIf+you+write+a+custom+implementation+of+any+of+those+classes%2C+let+us+know+why+on+our+forum.+If+it%E2%80%99s%0Anot+domain+specific%2C+you+might+want+to+consider+contributing+it+back+as+a+pull+request+on+github%3A%0Awe%E2%80%99ll+optimize+it+and+take+it+along+in+future+refactorings.%0A276%0AChapter+12.+Evolutionary+Algorithms%0A12.1.+Overview%0AEvolutionary+Algorithms+work+on+a+population+of+solutions+and+evolve+that+population.%0A12.2.+Evolutionary+Strategies%0AThis+algorithm+has+not+been+implemented+yet.%0A12.3.+Genetic+Algorithms%0AThis+algorithm+has+not+been+implemented+yet.%0AA+good+Genetic+Algorithms+prototype+in+Planner+was+written+some+time+ago%2C+but+it%0Awasn%E2%80%99t+practical+to+merge+and+support+it+at+the+time.+The+results+of+Genetic%0AAlgorithms+were+consistently+and+seriously+inferior+to+all+the+Local+Search+variants%0A%EF%81%9A+%28except+Hill+Climbing%29+on+all+use+cases+tried.+Nevertheless%2C+a+future+version+of%0APlanner+will+add+support+for+Genetic+Algorithms%2C+so+you+can+easily+benchmark%0AGenetic+Algorithms+on+your+use+case+too.%0A277%0AChapter+13.+Hyperheuristics%0A13.1.+Overview%0AA+hyperheuristic+automates+the+decision+which+heuristic%28s%29+to+use+on+a+specific+data+set.%0AA+future+version+of+Planner+will+have+native+support+for+hyperheuristics.+Meanwhile%2C+it%E2%80%99s+possible+to%0Aimplement+it+yourself%3A+Based+on+the+size+or+difficulty+of+a+data+set+%28which+is+a+criterion%29%2C+use+a%0Adifferent+Solver+configuration+%28or+adjust+the+default+configuration+using+the+Solver+configuration%0AAPI%29.+The+Benchmarker+can+help+to+identify+such+criteria.%0A278%0AChapter+14.+Partitioned+Search%0A14.1.+Algorithm+Description%0AIt+is+often+more+efficient+to+partition+large+data+sets+%28usually+above+5000+planning+entities%29+into%0Asmaller+pieces+and+solve+them+separately.+Partition+Search+is+multithreaded%2C+so+it+provides+a%0Aperformance+boost+on+multi-core+machines+due+to+higher+CPU+utilization.+Additionally%2C+even+when%0Aonly+using+one+CPU%2C+it+finds+an+initial+solution+faster%2C+because+the+search+space+sum+of+a+partitioned%0AConstruction+Heuristic+is+far+less+than+its+non-partitioned+variant.%0AHowever%2C+partitioning+does+lead+to+suboptimal+results%2C+even+if+the+pieces+are+solved+optimally%2C+as%0Ashown+below%3A%0AIt+effectively+trades+a+short+term+gain+in+solution+quality+for+long+term+loss.+One+way+to+compensate%0Afor+this+loss%2C+is+to+run+a+non-partitioned+Local+Search+after+the+Partitioned+Search+phase.%0ANot+all+use+cases+can+be+partitioned.+Partitioning+only+works+for+use+cases+where%0A%EF%81%9A+the+planning+entities+and+value+ranges+can+be+split+into+n+partitions%2C+without+any+of%0Athe+constraints+crossing+boundaries+between+partitions.%0A279%0A14.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AThere+are+several+ways+to+partition+a+solution.%0AAdvanced+configuration%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++...%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CrunnablePartThreadLimit%3E4%3C%2FrunnablePartThreadLimit%3E%0A%C2%A0+++%3CconstructionHeuristic%3E...%3C%2FconstructionHeuristic%3E%0A%C2%A0+++%3ClocalSearch%3E...%3C%2FlocalSearch%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AThe+runnablePartThreadLimit+allows+limiting+CPU+usage+to+avoid+hanging+your+machine%2C+see+below.%0ATo+run+in+an+environment+that+doesn%E2%80%99t+like+arbitrary+thread+creation%2C+plug+in+a+custom+thread%0Afactory.%0AA+logging+level+of+debug+or+trace+causes+congestion+in+multithreaded+Partitioned%0A%EF%81%AA+Search+and+slows+down+the+score+calculation+speed.%0AJust+like+a+%3Csolver%3E+element%2C+the+%3CpartitionedSearch%3E+element+can+contain+one+or+more+phases.+Each%0Aof+those+phases+will+be+run+on+each+partition.%0AA+common+configuration+is+to+first+run+a+Partitioned+Search+phase+%28which+includes+a+Construction%0AHeuristic+and+a+Local+Search%29+followed+by+a+non-partitioned+Local+Search+phase%3A%0A280%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++%3CsolutionPartitionerClass%3E...CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CconstructionHeuristic%2F%3E%0A%C2%A0+++%3ClocalSearch%3E%0A%C2%A0+++++%3Ctermination%3E%0A%C2%A0+++++++%3CsecondsSpentLimit%3E60%3C%2FsecondsSpentLimit%3E%0A%C2%A0+++++%3C%2Ftermination%3E%0A%C2%A0+++%3C%2FlocalSearch%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0A%C2%A0+%3ClocalSearch%2F%3E%0A14.3.+Partitioning+a+Solution%0A14.3.1.+Custom+SolutionPartitioner%0ATo+use+a+custom+SolutionPartitioner%2C+configure+one+on+the+Partitioned+Search+phase%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AImplement+the+SolutionPartitioner+interface%3A%0Apublic+interface+SolutionPartitioner%3CSolution_%3E+%7B%0A%C2%A0+++List%3CSolution_%3E+splitWorkingSolution%28ScoreDirector%3CSolution_%3E+scoreDirector%2C%0AInteger+runnablePartThreadLimit%29%3B%0A%7D%0AThe+size%28%29+of+the+returned+List+is+the+partCount+%28the+number+of+partitions%29.+This+can+be+decided%0Adynamically%2C+for+example%2C+based+on+the+size+of+the+non-partitioned+solution.+The+partCount+is%0Aunrelated+to+the+runnablePartThreadLimit.%0AFor+example%3A%0Apublic+class+CloudBalancePartitioner+implements+SolutionPartitioner%3CCloudBalance%3E+%7B%0A%C2%A0+++private+int+partCount+%3D+4%3B%0A%C2%A0+++private+int+minimumProcessListSize+%3D+75%3B%0A%C2%A0+++%40Override%0A%C2%A0+++public+List%3CCloudBalance%3E+splitWorkingSolution%28ScoreDirector%3CCloudBalance%3E%0A281%0AscoreDirector%2C+Integer+runnablePartThreadLimit%29+%7B%0A%C2%A0+++++++CloudBalance+originalSolution+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++List%3CCloudComputer%3E+originalComputerList+%3D+originalSolution.getComputerList%28%29%3B%0A%C2%A0+++++++List%3CCloudProcess%3E+originalProcessList+%3D+originalSolution.getProcessList%28%29%3B%0A%C2%A0+++++++int+partCount+%3D+this.partCount%3B%0A%C2%A0+++++++if+%28originalProcessList.size%28%29+%2F+partCount+%3C+minimumProcessListSize%29+%7B%0A%C2%A0+++++++++++partCount+%3D+originalProcessList.size%28%29+%2F+minimumProcessListSize%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++List%3CCloudBalance%3E+partList+%3D+new+ArrayList%3C%3E%28partCount%29%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+partCount%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++CloudBalance+partSolution+%3D+new+CloudBalance%28originalSolution.getId%28%29%2C%0A%C2%A0+++++++++++++++++++new+ArrayList%3C%3E%28originalComputerList.size%28%29+%2F+partCount+%2B+1%29%2C%0A%C2%A0+++++++++++++++++++new+ArrayList%3C%3E%28originalProcessList.size%28%29+%2F+partCount+%2B+1%29%29%3B%0A%C2%A0+++++++++++partList.add%28partSolution%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++int+partIndex+%3D+0%3B%0A%C2%A0+++++++Map%3CLong%2C+Pair%3CInteger%2C+CloudComputer%3E%3E+idToPartIndexAndComputerMap+%3D+new%0AHashMap%3C%3E%28originalComputerList.size%28%29%29%3B%0A%C2%A0+++++++for+%28CloudComputer+originalComputer+%3A+originalComputerList%29+%7B%0A%C2%A0+++++++++++CloudBalance+part+%3D+partList.get%28partIndex%29%3B%0A%C2%A0+++++++++++CloudComputer+computer+%3D+new+CloudComputer%28%0A%C2%A0+++++++++++++++++++originalComputer.getId%28%29%2C%0A%C2%A0+++++++++++++++++++originalComputer.getCpuPower%28%29%2C+originalComputer.getMemory%28%29%2C%0A%C2%A0+++++++++++++++++++originalComputer.getNetworkBandwidth%28%29%2C+originalComputer.getCost%28%0A%29%29%3B%0A%C2%A0+++++++++++part.getComputerList%28%29.add%28computer%29%3B%0A%C2%A0+++++++++++idToPartIndexAndComputerMap.put%28computer.getId%28%29%2C+Pair.of%28partIndex%2C%0Acomputer%29%29%3B%0A%C2%A0+++++++++++partIndex+%3D+%28partIndex+%2B+1%29+%25+partList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++partIndex+%3D+0%3B%0A%C2%A0+++++++for+%28CloudProcess+originalProcess+%3A+originalProcessList%29+%7B%0A%C2%A0+++++++++++CloudBalance+part+%3D+partList.get%28partIndex%29%3B%0A%C2%A0+++++++++++CloudProcess+process+%3D+new+CloudProcess%28%0A%C2%A0+++++++++++++++++++originalProcess.getId%28%29%2C%0A%C2%A0+++++++++++++++++++originalProcess.getRequiredCpuPower%28%29%2C+originalProcess%0A.getRequiredMemory%28%29%2C%0A%C2%A0+++++++++++++++++++originalProcess.getRequiredNetworkBandwidth%28%29%29%3B%0A%C2%A0+++++++++++part.getProcessList%28%29.add%28process%29%3B%0A%C2%A0+++++++++++if+%28originalProcess.getComputer%28%29+%21%3D+null%29+%7B%0A%C2%A0+++++++++++++++Pair%3CInteger%2C+CloudComputer%3E+partIndexAndComputer+%3D%0AidToPartIndexAndComputerMap.get%28%0A%C2%A0+++++++++++++++++++++++originalProcess.getComputer%28%29.getId%28%29%29%3B%0A%C2%A0+++++++++++++++if+%28partIndexAndComputer+%3D%3D+null%29+%7B%0A%C2%A0+++++++++++++++++++throw+new+IllegalStateException%28%22The+initialized+process+%28%22+%2B%0AoriginalProcess%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+has+a+computer+%28%22+%2B+originalProcess.getComputer%28%29%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+which+doesn%27t+exist+in+the+originalSolution+%28%22+%2B%0AoriginalSolution+%2B+%22%29.%22%29%3B%0A282%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++++++if+%28partIndex+%21%3D+partIndexAndComputer.getLeft%28%29.intValue%28%29%29+%7B%0A%C2%A0+++++++++++++++++++throw+new+IllegalStateException%28%22The+initialized+process+%28%22+%2B%0AoriginalProcess%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+with+partIndex+%28%22+%2B+partIndex%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+has+a+computer+%28%22+%2B+originalProcess.getComputer%28%29%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+which+belongs+to+another+partIndex+%28%22+%2B%0ApartIndexAndComputer.getLeft%28%29+%2B+%22%29.%22%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++++++process.setComputer%28partIndexAndComputer.getRight%28%29%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++partIndex+%3D+%28partIndex+%2B+1%29+%25+partList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+partList%3B%0A%C2%A0+++%7D%0A%7D%0ATo+configure+values+of+a+SolutionPartitioner+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+solutionPartitionerCustomProperties+element%0Aand+use+custom+properties%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++%3CsolutionPartitionerClass%3E...CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CsolutionPartitionerCustomProperties%3E%0A%C2%A0+++++%3CmyPartCount%3E8%3C%2FmyPartCount%3E%0A%C2%A0+++++%3CmyMinimumProcessListSize%3E100%3C%2FmyMinimumProcessListSize%3E%0A%C2%A0+++%3C%2FsolutionPartitionerCustomProperties%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0A14.4.+Runnable+Part+Thread+Limit%0AWhen+running+a+multithreaded+solver%2C+such+as+Partitioned+Search%2C+CPU+power+can+quickly+become%0Aa+scarce+resource%2C+which+can+cause+other+processes+or+threads+to+hang+or+freeze.+However%2C+Planner%0Ahas+a+system+to+prevent+CPU+starving+of+other+processes+%28such+as+an+SSH+connection+in+production%0Aor+your+IDE+in+development%29+or+other+threads+%28such+as+the+servlet+threads+that+handle+REST%0Arequests%29.%0AAs+explained+in+sizing+hardware+and+software%2C+each+solver+%28including+each+child+solver%29+does+no+IO%0Aduring+solve%28%29+and+therefore+saturates+one+CPU+core+completely.+In+Partitioned+Search%2C+every%0Apartition+always+has+its+own+thread%2C+called+a+part+thread.+It+is+impossible+for+two+partitions+to+share%0Aa+thread%2C+because+of+asynchronous+termination%3A+the+second+thread+would+never+run.+Every+part%0Athread+will+try+to+consume+one+CPU+core+entirely%2C+so+if+there+are+more+partitions+than+CPU+cores%2C%0Athis+will+probably+hang+the+system.+Thread.setPriority%28%29+is+often+too+weak+to+solve+this+hogging%0Aproblem%2C+so+another+approach+is+used.%0AThe+runnablePartThreadLimit+parameter+specifies+how+many+part+threads+are+runnable+at+the+same%0Atime.+The+other+part+threads+will+temporarily+block+and+therefore+will+not+consume+any+CPU+power.%0A283%0AThis+parameter+basically+specifies+how+many+CPU+cores+are+donated+to+Planner.+All+part%0Athreads+share+the+CPU+cores+in+a+round-robin+manner+to+consume+%28more+or+less%29+the+same+number%0Aof+CPU+cycles%3A%0AThe+following+runnablePartThreadLimit+options+are+supported%3A%0A%E2%80%A2+UNLIMITED%3A+Allow+Planner+to+occupy+all+CPU+cores%2C+do+not+avoid+hogging.+Useful+if+a+no+hogging%0ACPU+policy+is+configured+on+the+OS+level.%0A%E2%80%A2+AUTO+%28default%29%3A+Let+Planner+decide+how+many+CPU+cores+to+occupy.+This+formula+is+based+on%0Aexperience.+It+does+not+hog+all+CPU+cores+on+a+multi-core+machine.%0A%E2%80%A2+Static+number%3A+The+number+of+CPU+cores+to+consume.+For+example%3A%0A%3CrunnablePartThreadLimit%3E2%3C%2FrunnablePartThreadLimit%3E%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+CPU+cores+to+occupy.+It+can+use+the+variable%0AavailableProcessorCount.+For+example%3A%0A%3CrunnablePartThreadLimit%3EavailableProcessorCount+-+2%3C%2FrunnablePartThreadLimit%3E%0A284%0AIf+the+runnablePartThreadLimit+is+equal+to+or+higher+than+the+number+of+available%0A%EF%81%B1+processors%2C+the+host+is+likely+to+hang+or+freeze%2C+unless+there+is+an+OS+specific+policy%0Ain+place+to+avoid+Planner+from+hogging+all+the+CPU+processors.%0A285%0AChapter+15.+Benchmarking+and+Tweaking%0A15.1.+Find+the+Best+Solver+Configuration%0APlanner+supports+several+optimization+algorithms%2C+so+you%E2%80%99re+probably+wondering+which+is+the+best%0Aone%3F+Although+some+optimization+algorithms+generally+perform+better+than+others%2C+it+really%0Adepends+on+your+problem+domain.+Most+solver+phases+have+parameters+which+can+be+tweaked.%0AThose+parameters+can+influence+the+results+a+lot%2C+even+though+most+solver+phases+work+pretty+well%0Aout-of-the-box.%0ALuckily%2C+Planner+includes+a+benchmarker%2C+which+allows+you+to+play+out+different+solver+phases+with%0Adifferent+settings+against+each+other+in+development%2C+so+you+can+use+the+best+configuration+for+your%0Aplanning+problem+in+production.%0A15.2.+Benchmark+Configuration%0A15.2.1.+Add+a+Dependency+on+optaplanner-benchmark%0AThe+benchmarker+is+in+a+separate+artifact+called+optaplanner-benchmark.%0AIf+you+use+Maven%2C+add+a+dependency+in+your+pom.xml+file%3A%0A286%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eoptaplanner-benchmark%3C%2FartifactId%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AThis+is+similar+for+Gradle%2C+Ivy+and+Buildr.+The+version+must+be+exactly+the+same+as+the+optaplanner-%0Acore+version+used+%28which+is+automatically+the+case+if+you+import+optaplanner-bom%29.%0AIf+you+use+ANT%2C+you%E2%80%99ve+probably+already+copied+the+required+jars+from+the+download+zip%E2%80%99s+binaries%0Adirectory.%0A15.2.2.+Run+a+Simple+Benchmark%0ATo+quickly+setup+a+benchmark%2C+create+a+PlannerBenchmarkFactory+from+your+SolverFactory%2C+load+a%0Afew+datasets+and+benchmark+them.+For+example%2C+with+3+datasets%3A%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28...%29%3B%0A%C2%A0+++++++PlannerBenchmarkFactory+benchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromSolverFactory%28solverFactory%29%3B%0A%C2%A0+++++++CloudBalance+dataset1+%3D+...%3B%0A%C2%A0+++++++CloudBalance+dataset2+%3D+...%3B%0A%C2%A0+++++++CloudBalance+dataset3+%3D+...%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+benchmarkFactory.buildPlannerBenchmark%0A%28dataset1%2C+dataset2%2C+dataset3%29%3B%0A%C2%A0+++++++plannerBenchmark.benchmarkAndShowReportInBrowser%28%29%3B%0AThis+generates+a+benchmark+report+in+local%2FbenchmarkReport+and+shows+it+in+your+browser+when+it%E2%80%99s%0Afinished.+The+SolverFactory%E2%80%99s+solver+configuration+needs+a+termination+to+limit+how+long+each%0Adataset+runs.+To+configure+a+different+benchmark+directory%2C+pass+a+%60File+parameter+to%0AcreateFromSolverFactory%28%29.%0AThe+generated+benchmark+report+already+contains+interesting+information%2C+but+it+doesn%E2%80%99t+allow%0Acomparing+solver+configurations+to+find+the+best+algorithm.+To+do+that%2C+set+up+a+benchmark%0Aconfiguration%3A%0A15.2.3.+Configure+and+Run+an+Advanced+Benchmark%0ABuild+a+PlannerBenchmark+instance+with+a+PlannerBenchmarkFactory.+Configure+it+with+a+benchmark%0Aconfiguration+XML+file%2C+provided+as+a+classpath+resource%3A%0A287%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fbenchmark%2FnqueensBenchmarkConfig.xml%22%29%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+plannerBenchmarkFactory%0A.buildPlannerBenchmark%28%29%3B%0A%C2%A0+++++++plannerBenchmark.benchmark%28%29%3B%0AA+benchmark+configuration+file+looks+like+this%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fcloudbalancing%2Funsolved%2F100computers-%0A300processes.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fcloudbalancing%2Funsolved%2F200computers-%0A600processes.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Common+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ETabu+Search%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Tabu+Search+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ESimulated+Annealing%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Simulated+Annealing+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ELate+Acceptance%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Late+Acceptance+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2FplannerBenchmark%3E%0AThis+PlannerBenchmark+will+try+three+configurations+%28Tabu+Search%2C+Simulated+Annealing+and+Late%0A288%0AAcceptance%29+on+two+data+sets+%28100computers-300processes+and+200computers-600processes%29%2C+so+it+will%0Arun+six+solvers.%0AEvery+%3CsolverBenchmark%3E+element+contains+a+solver+configuration+and+one+or+more%0A%3CinputSolutionFile%3E+elements.+It+will+run+the+solver+configuration+on+each+of+those+unsolved%0Asolution+files.+The+element+name+is+optional%2C+because+it+is+generated+if+absent.+The+inputSolutionFile%0Ais+read+by+a+SolutionFileIO+%28relative+to+the+working+directory%29.%0AUse+a+forward+slash+%28%2F%29+as+the+file+separator+%28for+example+in+the+element%0A%3CinputSolutionFile%3E%29.+That+will+work+on+any+platform+%28including+Windows%29.%0A%EF%81%9A%0ADo+not+use+backslash+%28%5C%29+as+the+file+separator%3A+that+breaks+portability+because+it%0Adoes+not+work+on+Linux+and+Mac.%0AThe+benchmark+report+will+be+written+in+the+directory+specified+by+the+%3CbenchmarkDirectory%3E%0Aelement+%28relative+to+the+working+directory%29.%0AIt%E2%80%99s+recommended+that+the+benchmarkDirectory+is+a+directory+ignored+for+source%0Acontrol+and+not+cleaned+by+your+build+system.+This+way+the+generated+files+are+not%0A%EF%81%9A+bloating+your+source+control+and+they+aren%E2%80%99t+lost+when+doing+a+build.+For+example%0Ain+git%2C+it+should+be+added+to+.gitignore.+Usually+that+directory+is+called+local.%0AIf+an+Exception+or+Error+occurs+in+a+single+benchmark%2C+the+entire+Benchmarker+will+not+fail-fast%0A%28unlike+everything+else+in+Planner%29.+Instead%2C+the+Benchmarker+will+continue+to+run+all+other%0Abenchmarks%2C+write+the+benchmark+report+and+then+fail+%28if+there+is+at+least+one+failing+single%0Abenchmark%29.+The+failing+benchmarks+will+be+clearly+marked+as+such+in+the+benchmark+report.%0A15.2.3.1.+Inherited+solver+benchmark%0ATo+lower+verbosity%2C+the+common+parts+of+multiple+%3CsolverBenchmark%3E+elements+are+extracted+to+the%0A%3CinheritedSolverBenchmark%3E+element.+Every+property+can+still+be+overwritten+per+%3CsolverBenchmark%3E%0Aelement.+Note+that+inherited+solver+phases+such+as+%3CconstructionHeuristic%3E+or+%3ClocalSearch%3E+are+not%0Aoverwritten+but+instead+are+added+to+the+tail+of+the+solver+phases+list.%0A15.2.4.+SolutionFileIO%3A+Input+And+Output+Of+Solution+Files%0A15.2.4.1.+SolutionFileIO+Interface%0AThe+benchmarker+needs+to+be+able+to+read+the+input+files+to+load+a+Solution.+Also%2C+it+optionally%0Awrites+the+best+Solution+of+each+benchmark+to+an+output+file.+It+does+that+through+the+SolutionFileIO%0Ainterface+which+has+a+read+and+write+method%3A%0A289%0Apublic+interface+SolutionFileIO%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++Solution_+read%28File+inputSolutionFile%29%3B%0A%C2%A0+++void+write%28Solution_+solution%2C+File+outputSolutionFile%29%3B%0A%7D%0AThe+SolutionFileIO+interface+is+in+the+optaplanner-persistence-common+jar+%28which+is+a+dependency+of%0Athe+optaplanner-benchmark+jar%29.+There+are+several+ways+to+serialize+a+solution%3A%0A15.2.4.2.+XStreamSolutionFileIO%3A+Serialize+To+And+From+An+XML+Format%0ATo+use+the+XStreamSolutionFileIO+instance+to+read+and+write+solutions%2C+configure+your+Solution+class%0Aas+an+xStreamAnnotatedClass%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++%3CxStreamAnnotatedClass%3E%0Aorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FxStreamAnnotatedClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F32queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AThose+input+files+need+to+have+been+written+with+a+XStreamSolutionFileIO+instance%2C+not+just+any%0AXStream+instance%2C+because+the+XStreamSolutionFileIO+uses+a+customized+XStream+instance.%0AThe+inputSolutionFile+needs+to+come+from+a+trusted+source%3A+if+it+contains+malicious%0Adata%2C+it+can+be+exploited.+The+XStreamSolutionFileIO+disables+the+XStream+security%0Aframework%2C+so+it+just+works+out+of+the+box.%0A%EF%81%AA%0AIf+you+expose+benchmarking+in+production%2C+use%0AXStreamSolutionFileIO.getXStream%28%29+to+enable+the+security+framework+and%0Aexplicitly+whitelist+all+marshalled+classes.%0AAdd+XStream+annotations+%28such+as+%40XStreamAlias%29+on+your+domain+classes+to+use+a+less+verbose+XML%0Aformat.+Regardless%2C+XML+is+still+a+very+verbose+format.+Reading+or+writing+large+datasets+in+this%0Aformat+can+cause+an+OutOfMemoryError%2C+StackOverflowError+or+large+performance+degradation.%0A15.2.4.3.+Custom+SolutionFileIO%3A+Serialize+To+And+From+A+Custom+Format%0AImplement+your+own+SolutionFileIO+implementation+and+configure+it+with+the+solutionFileIOClass%0Aelement+to+write+to+a+custom+format+%28such+as+a+txt+or+a+binary+format%29%3A%0A290%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0%0A%3CsolutionFileIOClass%3Eorg.optaplanner.examples.machinereassignment.persistence.MachineR%0AeassignmentFileIO%3C%2FsolutionFileIOClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3E%0Adata%2Fmachinereassignment%2Fimport%2Fmodel_a1_1.txt%3C%2FinputSolutionFile%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AIt%E2%80%99s+recommended+that+output+files+can+be+read+as+input+files%2C+which+implies+that%0AgetInputFileExtension%28%29+and+getOutputFileExtension%28%29+return+the+same+value.%0A%EF%81%B1+A+SolutionFileIO+implementation+must+be+thread-safe.%0A15.2.4.4.+Reading+An+Input+Solution+From+A+Database+%28Or+Other+Storage%29%0AThere+are+two+options+if+your+dataset+is+in+a+relational+database+or+another+type+of+repository%3A%0A%E2%80%A2+Extract+the+datasets+from+the+database+and+serialize+them+to+a+local+file+%28for+example+as+XML%0Awith+XStreamSolutionFileIO+if+XML+isn%E2%80%99t+too+verbose%29.+Then+use+those+files+in+%3CinputSolutionFile%3E%0Aelements.%0A%E2%97%A6+The+benchmarks+are+now+more+reliable+because+they+run+offline.%0A%E2%97%A6+Each+dataset+is+only+loaded+just+in+time.%0A%E2%80%A2+Load+all+the+datasets+in+advance+and+pass+them+to+the+buildPlannerBenchmark%28%29+method%3A%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+benchmarkFactory.buildPlannerBenchmark%0A%28dataset1%2C+dataset2%2C+dataset3%29%3B%0A15.2.5.+Warming+Up+The+HotSpot+Compiler%0AWithout+a+warm+up%2C+the+results+of+the+first+%28or+first+few%29+benchmarks+are+not+reliable%2C+because+they%0Awill+lose+CPU+time+on+HotSpot+JIT+compilation+%28and+possibly+DRL+compilation+too%29.%0ATo+avoid+that+distortion%2C+the+benchmarker+runs+some+of+the+benchmarks+for+30+seconds%2C+before%0Arunning+the+real+benchmarks.+That+default+warm+up+of+30+seconds+usually+suffices.+Change+it%2C+for%0Aexample+to+give+it+60+seconds%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CwarmUpSecondsSpentLimit%3E60%3C%2FwarmUpSecondsSpentLimit%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0ATurn+off+the+warm+up+phase+altogether+by+setting+it+to+zero%3A%0A291%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CwarmUpSecondsSpentLimit%3E0%3C%2FwarmUpSecondsSpentLimit%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+warm+up+time+budget+does+not+include+the+time+it+takes+to+load+the+datasets.%0A%EF%81%9A+With+large+datasets%2C+this+can+cause+the+warm+up+to+run+considerably+longer+than%0Aspecified+in+the+configuration.%0A15.2.6.+Benchmark+Blueprint%3A+A+Predefined+Configuration%0ATo+quickly+configure+and+run+a+benchmark+for+typical+solver+configs%2C+use+a%0AsolverBenchmarkBluePrint+instead+of+solverBenchmarks%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++%3CxStreamAnnotatedClass%3E%0Aorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FxStreamAnnotatedClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F32queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F64queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+++++%3CscoreDirectorFactory%3E%0A%C2%A0+++++++%3CscoreDrl%3E%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++++++%3CinitializingScoreTrend%3EONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+++++%3C%2FscoreDirectorFactory%3E%0A%C2%A0+++++%3Ctermination%3E%0A%C2%A0+++++++%3CminutesSpentLimit%3E1%3C%2FminutesSpentLimit%3E%0A%C2%A0+++++%3C%2Ftermination%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmarkBluePrint%3E%0A%C2%A0%0A%3CsolverBenchmarkBluePrintType%3EEVERY_CONSTRUCTION_HEURISTIC_TYPE_WITH_EVERY_LOCAL_SEARC%0AH_TYPE%3C%2FsolverBenchmarkBluePrintType%3E%0A%C2%A0+%3C%2FsolverBenchmarkBluePrint%3E%0A%3C%2FplannerBenchmark%3E%0AThe+following+SolverBenchmarkBluePrintTypes+are+supported%3A%0A292%0A%E2%80%A2+EVERY_CONSTRUCTION_HEURISTIC_TYPE%3A+Run+every+Construction+Heuristic+type+%28First+Fit%2C+First+Fit%0ADecreasing%2C+Cheapest+Insertion%2C+%E2%80%A6%29.%0A%E2%80%A2+EVERY_LOCAL_SEARCH_TYPE%3A+Run+every+Local+Search+type+%28Tabu+Search%2C+Late+Acceptance%2C+%E2%80%A6%29+with%0Athe+default+Construction+Heuristic.%0A%E2%80%A2+EVERY_CONSTRUCTION_HEURISTIC_TYPE_WITH_EVERY_LOCAL_SEARCH_TYPE%3A+Run+every+Construction%0AHeuristic+type+with+every+Local+Search+type.%0A15.2.7.+Write+The+Output+Solution+Of+Benchmark+Runs%0AThe+best+solution+of+each+benchmark+run+can+be+written+in+the+benchmarkDirectory.+By+default%2C+this%0Ais+disabled%2C+because+the+files+are+rarely+used+and+considered+bloat.+Also%2C+on+large+datasets%2C+writing%0Athe+best+solution+of+each+single+benchmark+can+take+quite+some+time+and+memory+%28causing+an%0AOutOfMemoryError%29%2C+especially+in+a+verbose+format+like+XStream+XML.%0ATo+write+those+solutions+in+the+benchmarkDirectory%2C+enable+writeOutputSolutionEnabled%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CwriteOutputSolutionEnabled%3Etrue%3C%2FwriteOutputSolutionEnabled%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A15.2.8.+Benchmark+Logging%0ABenchmark+logging+is+configured+like+solver+logging.%0ATo+separate+the+log+messages+of+each+single+benchmark+run+into+a+separate+file%2C+use+the+MDC+with%0Akey+singleBenchmark.name+in+a+sifting+appender.+For+example+with+Logback+in+logback.xml%3A%0A%C2%A0+%3Cappender+name%3D%22fileAppender%22+class%3D%22ch.qos.logback.classic.sift.SiftingAppender%22%3E%0A%C2%A0+++%3Cdiscriminator%3E%0A%C2%A0+++++%3Ckey%3EsingleBenchmark.name%3C%2Fkey%3E%0A%C2%A0+++++%3CdefaultValue%3Eapp%3C%2FdefaultValue%3E%0A%C2%A0+++%3C%2Fdiscriminator%3E%0A%C2%A0+++%3Csift%3E%0A%C2%A0+++++%3Cappender+name%3D%22fileAppender.%24%7BsingleBenchmark.name%7D%22+class%3D%22...FileAppender%22%3E%0A%C2%A0+++++++%3Cfile%3Elocal%2Flog%2FoptaplannerBenchmark-%24%7BsingleBenchmark.name%7D.log%3C%2Ffile%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2Fappender%3E%0A%C2%A0+++%3C%2Fsift%3E%0A%C2%A0+%3C%2Fappender%3E%0A15.3.+Benchmark+Report%0A293%0A15.3.1.+HTML+Report%0AAfter+running+a+benchmark%2C+an+HTML+report+will+be+written+in+the+benchmarkDirectory+with+the%0Aindex.html+filename.+Open+it+in+your+browser.+It+has+a+nice+overview+of+your+benchmark+including%3A%0A%E2%80%A2+Summary+statistics%3A+graphs+and+tables%0A%E2%80%A2+Problem+statistics+per+inputSolutionFile%3A+graphs+and+CSV%0A%E2%80%A2+Each+solver+configuration+%28ranked%29%3A+Handy+to+copy+and+paste%0A%E2%80%A2+Benchmark+information%3A+settings%2C+hardware%2C+%E2%80%A6%0A%EF%81%9A+Graphs+are+generated+by+the+excellent+JFreeChart+library.%0AThe+HTML+report+will+use+your+default+locale+to+format+numbers.+If+you+share+the+benchmark%0Areport+with+people+from+another+country%2C+consider+overwriting+the+locale+accordingly%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3Clocale%3Een_US%3C%2Flocale%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0A15.3.2.+Ranking+The+Solvers%0AThe+benchmark+report+automatically+ranks+the+solvers.+The+Solver+with+rank+0+is+called+the+favorite%0ASolver%3A+it+performs+best+overall%2C+but+it+might+not+be+the+best+on+every+problem.+It%E2%80%99s+recommended+to%0Ause+that+favorite+Solver+in+production.%0AHowever%2C+there+are+different+ways+of+ranking+the+solvers.+Configure+it+like+this%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingType%3ETOTAL_SCORE%3C%2FsolverRankingType%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+following+solverRankingTypes+are+supported%3A%0A%E2%80%A2+TOTAL_SCORE+%28default%29%3A+Maximize+the+overall+score%2C+so+minimize+the+overall+cost+if+all+solutions%0Awould+be+executed.%0A%E2%80%A2+WORST_SCORE%3A+Minimize+the+worst+case+scenario.%0A%E2%80%A2+TOTAL_RANKING%3A+Maximize+the+overall+ranking.+Use+this+if+your+datasets+differ+greatly+in+size+or%0Adifficulty%2C+producing+a+difference+in+Score+magnitude.%0A294%0ASolvers+with+at+least+one+failed+single+benchmark+do+not+get+a+ranking.+Solvers+with+not+fully%0Ainitialized+solutions+are+ranked+worse.%0ATo+use+a+custom+ranking%2C+implement+a+Comparator%3A%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingComparatorClass%3E%0A...TotalScoreSolverRankingComparator%3C%2FsolverRankingComparatorClass%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0AOr+by+implementing+a+weight+factory%3A%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingWeightFactoryClass%3E%0A...TotalRankSolverRankingWeightFactory%3C%2FsolverRankingWeightFactoryClass%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A15.4.+Summary+Statistics%0A15.4.1.+Best+Score+Summary+%28Graph+And+Table%29%0AShows+the+best+score+per+inputSolutionFile+for+each+solver+configuration.%0AUseful+for+visualizing+the+best+solver+configuration.%0A295%0AFigure+8.+Best+Score+Summary+Statistic%0A15.4.2.+Best+Score+Scalability+Summary+%28Graph%29%0AShows+the+best+score+per+problem+scale+for+each+solver+configuration.%0AUseful+for+visualizing+the+scalability+of+each+solver+configuration.%0AThe+problem+scale+will+report+0+if+any+%40ValueRangeProvider+method+signature%0A%EF%81%9A+returns+ValueRange+%28instead+of+CountableValueRange+or+Collection%29.%0A15.4.3.+Best+Score+Distribution+Summary+%28Graph%29%0AShows+the+best+score+distribution+per+inputSolutionFile+for+each+solver+configuration.%0AUseful+for+visualizing+the+reliability+of+each+solver+configuration.%0A296%0AFigure+9.+Best+Score+Distribution+Summary+Statistic%0AEnable+statistical+benchmarking+to+use+this+summary.%0A15.4.4.+Winning+Score+Difference+Summary+%28Graph+And+Table%29%0AShows+the+winning+score+difference+per+inputSolutionFile+for+each+solver+configuration.+The%0Awinning+score+difference+is+the+score+difference+with+the+score+of+the+winning+solver+configuration%0Afor+that+particular+inputSolutionFile.%0AUseful+for+zooming+in+on+the+results+of+the+best+score+summary.%0A15.4.5.+Worst+Score+Difference+Percentage+%28ROI%29+Summary+%28Graph+and%0ATable%29%0AShows+the+return+on+investment+%28ROI%29+per+inputSolutionFile+for+each+solver+configuration+if+you%E2%80%99d%0Aupgrade+from+the+worst+solver+configuration+for+that+particular+inputSolutionFile.%0AUseful+for+visualizing+the+return+on+investment+%28ROI%29+to+decision+makers.%0A15.4.6.+Score+Calculation+Speed+Summary+%28Graph+and+Table%29%0AShows+the+score+calculation+speed%3A+a+count+per+second+per+problem+scale+for+each+solver%0Aconfiguration.%0A297%0AUseful+for+comparing+different+score+calculators+and%2For+score+rule+implementations+%28presuming%0Athat+the+solver+configurations+do+not+differ+otherwise%29.+Also+useful+to+measure+the+scalability+cost+of%0Aan+extra+constraint.%0A15.4.7.+Time+Spent+Summary+%28Graph+And+Table%29%0AShows+the+time+spent+per+inputSolutionFile+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+visualizing+the+performance+of+construction+heuristics+%28presuming+that+no+other+solver%0Aphases+are+configured%29.%0A15.4.8.+Time+Spent+Scalability+Summary+%28Graph%29%0AShows+the+time+spent+per+problem+scale+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+extrapolating+the+scalability+of+construction+heuristics+%28presuming+that+no+other+solver%0Aphases+are+configured%29.%0A15.4.9.+Best+Score+Per+Time+Spent+Summary+%28Graph%29%0AShows+the+best+score+per+time+spent+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+visualizing+trade-off+between+the+best+score+versus+the+time+spent+for+construction%0Aheuristics+%28presuming+that+no+other+solver+phases+are+configured%29.%0A15.5.+Statistic+Per+Dataset+%28Graph+And+CSV%29%0A15.5.1.+Enable+A+Problem+Statistic%0AThe+benchmarker+supports+outputting+problem+statistics+as+graphs+and+CSV+%28comma+separated%0Avalues%29+files+to+the+benchmarkDirectory.+To+configure+one+or+more%2C+add+a+problemStatisticType+line%0Afor+each+one%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%2Fsolved%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++++%3CproblemStatisticType%3ESCORE_CALCULATION_SPEED%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0A298%0AThese+problem+statistics+can+slow+down+the+solvers+noticeably%2C+which+affects+the%0Abenchmark+results.+That%E2%80%99s+why+they+are+optional+and+only+BEST_SCORE+is+enabled+by%0Adefault.+To+disable+that+one+too%2C+use+problemStatisticEnabled%3A%0A%EF%81%9A+%C2%A0+++%3CproblemBenchmarks%3E%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticEnabled%3Efalse%3C%2FproblemStatisticEnabled%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AThe+summary+statistics+do+not+slow+down+the+solver+and+are+always+generated.%0AThe+following+types+are+supported%3A%0A15.5.2.+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29%0AShows+how+the+best+score+evolves+over+time.+It+is+run+by+default.+To+run+it+when+other+statistics+are%0Aconfigured%2C+also+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A299%0AFigure+10.+Best+Score+Over+Time+Statistic%0AA+time+gradient+based+algorithm+%28such+as+Simulated+Annealing%29+will+have+a%0Adifferent+statistic+if+it%E2%80%99s+run+with+a+different+time+limit+configuration.+That%E2%80%99s%0A%EF%81%9A+because+this+Simulated+Annealing+implementation+automatically+determines+its%0Avelocity+based+on+the+amount+of+time+that+can+be+spent.+On+the+other+hand%2C+for+the%0ATabu+Search+and+Late+Acceptance%2C+what+you+see+is+what+you%E2%80%99d+get.%0AThe+best+score+over+time+statistic+is+very+useful+to+detect+abnormalities%2C+such+as+a+potential%0Ascore+trap+which+gets+the+solver+temporarily+stuck+in+a+local+optima.%0A300%0A15.5.3.+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29%0ATo+see+how+the+step+score+evolves+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3ESTEP_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A301%0AFigure+11.+Step+Score+Over+Time+Statistic%0ACompare+the+step+score+statistic+with+the+best+score+statistic+%28especially+on+parts+for+which+the+best%0Ascore+flatlines%29.+If+it+hits+a+local+optima%2C+the+solver+should+take+deteriorating+steps+to+escape+it.+But+it%0Ashouldn%E2%80%99t+deteriorate+too+much+either.%0AThe+step+score+statistic+has+been+seen+to+slow+down+the+solver+noticeably+due+to+GC%0A%EF%81%B1+stress%2C+especially+for+fast+stepping+algorithms+%28such+as+Simulated+Annealing+and%0ALate+Acceptance%29.%0A15.5.4.+Score+Calculation+Speed+Statistic+%28Graph+And+CSV%29%0ATo+see+how+fast+the+scores+are+calculated%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3ESCORE_CALCULATION_SPEED%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A302%0AFigure+12.+Score+Calculation+Speed+Statistic%0AThe+initial+high+calculation+speed+is+typical+during+solution+initialization%3A+it%E2%80%99s+far%0Aeasier+to+calculate+the+score+of+a+solution+if+only+a+handful+planning+entities+have%0A%EF%81%9A+been+initialized%2C+than+when+all+the+planning+entities+are+initialized.%0AAfter+those+few+seconds+of+initialization%2C+the+calculation+speed+is+relatively+stable%2C%0Aapart+from+an+occasional+stop-the-world+garbage+collector+disruption.%0A15.5.5.+Best+Solution+Mutation+Over+Time+Statistic+%28Graph+And+CSV%29%0ATo+see+how+much+each+new+best+solution+differs+from+the+previous+best+solution%2C+by+counting+the%0Anumber+of+planning+variables+which+have+a+different+value+%28not+including+the+variables+that+have%0Achanged+multiple+times+but+still+end+up+with+the+same+value%29%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SOLUTION_MUTATION%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A303%0AFigure+13.+Best+Solution+Mutation+Over+Time+Statistic%0AUse+Tabu+Search+-+an+algorithm+that+behaves+like+a+human+-+to+get+an+estimation+on+how+difficult+it%0Awould+be+for+a+human+to+improve+the+previous+best+solution+to+that+new+best+solution.%0A15.5.6.+Move+Count+Per+Step+Statistic+%28Graph+And+CSV%29%0ATo+see+how+the+selected+and+accepted+move+count+per+step+evolves+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EMOVE_COUNT_PER_STEP%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A304%0AFigure+14.+Move+Count+Per+Step+Statistic%0AThis+statistic+has+been+seen+to+slow+down+the+solver+noticeably+due+to+GC+stress%2C%0A%EF%81%B1+especially+for+fast+stepping+algorithms+%28such+as+Simulated+Annealing+and+Late%0AAcceptance%29.%0A15.5.7.+Memory+Use+Statistic+%28Graph+And+CSV%29%0ATo+see+how+much+memory+is+used%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EMEMORY_USE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A305%0AFigure+15.+Memory+Use+Statistic%0A%EF%81%B1+The+memory+use+statistic+has+been+seen+to+affect+the+solver+noticeably.%0A15.6.+Statistic+Per+Single+Benchmark+%28Graph+And+CSV%29%0A15.6.1.+Enable+A+Single+Statistic%0AA+single+statistic+is+static+for+one+dataset+for+one+solver+configuration.+Unlike+a+problem+statistic%2C+it%0Adoes+not+aggregate+over+solver+configurations.%0AThe+benchmarker+supports+outputting+single+statistics+as+graphs+and+CSV+%28comma+separated+values%29%0Afiles+to+the+benchmarkDirectory.+To+configure+one%2C+add+a+singleStatisticType+line%3A%0A306%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%2Fsolved%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3E...%3C%2FproblemStatisticType%3E%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_BEST_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AMultiple+singleStatisticType+elements+are+allowed.%0AThese+statistic+per+single+benchmark+can+slow+down+the+solver+noticeably%2C+which%0A%EF%81%9A+affects+the+benchmark+results.+That%E2%80%99s+why+they+are+optional+and+not+enabled+by%0Adefault.%0AThe+following+types+are+supported%3A%0A15.6.2.+Constraint+Match+Total+Best+Score+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+constraints+are+matched+in+the+best+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3ECONSTRAINT_MATCH_TOTAL_BEST_SCORE%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A307%0AFigure+16.+Constraint+Match+Total+Best+Score+Diff+Over+Time+Statistic%0ARequires+the+score+calculation+to+support+constraint+matches.+Drools+score+calculation+supports%0Aconstraint+matches+automatically%2C+but+incremental+Java+score+calculation+requires+more+work.%0A%EF%81%B1+The+constraint+match+total+statistics+affect+the+solver+noticeably.%0A15.6.3.+Constraint+Match+Total+Step+Score+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+constraints+are+matched+in+the+step+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3ECONSTRAINT_MATCH_TOTAL_STEP_SCORE%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A308%0AFigure+17.+Constraint+Match+Total+Step+Score+Diff+Over+Time+Statistic%0AAlso+requires+the+score+calculation+to+support+constraint+matches.%0A%EF%81%B1+The+constraint+match+total+statistics+affect+the+solver+noticeably.%0A15.6.4.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+move+types+improve+the+best+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_BEST_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A309%0AFigure+18.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic%0A15.6.5.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+how+much+each+winning+step+affects+the+step+score+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_STEP_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A310%0AFigure+19.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic%0A15.7.+Advanced+Benchmarking%0A15.7.1.+Benchmarking+Performance+Tricks%0A15.7.1.1.+Parallel+Benchmarking+On+Multiple+Threads%0AIf+you+have+multiple+processors+available+on+your+computer%2C+you+can+run+multiple+benchmarks+in%0Aparallel+on+multiple+threads+to+get+your+benchmarks+results+faster%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CparallelBenchmarkCount%3EAUTO%3C%2FparallelBenchmarkCount%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0ARunning+too+many+benchmarks+in+parallel+will+affect+the+results+of+benchmarks%0A%EF%81%B1+negatively.+Leave+some+processors+unused+for+garbage+collection+and+other%0Aprocesses.%0AThe+following+parallelBenchmarkCounts+are+supported%3A%0A311%0A%E2%80%A2+1+%28default%29%3A+Run+all+benchmarks+sequentially.%0A%E2%80%A2+AUTO%3A+Let+Planner+decide+how+many+benchmarks+to+run+in+parallel.+This+formula+is+based+on%0Aexperience.+It%E2%80%99s+recommended+to+prefer+this+over+the+other+parallel+enabling+options.%0A%E2%80%A2+Static+number%3A+The+number+of+benchmarks+to+run+in+parallel.%0A%3CparallelBenchmarkCount%3E2%3C%2FparallelBenchmarkCount%3E%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+benchmarks+to+run+in+parallel.+It+can+use+the%0Avariable+availableProcessorCount.+For+example%3A%0A%3CparallelBenchmarkCount%3E%28availableProcessorCount+%2F+2%29+%2B+1%3C%2FparallelBenchmarkCount%3E%0AThe+parallelBenchmarkCount+is+always+limited+to+the+number+of+available%0A%EF%81%9A+processors.+If+it%E2%80%99s+higher%2C+it+will+be+automatically+decreased.%0AIf+you+have+a+computer+with+slow+or+unreliable+cooling%2C+increasing+the%0AparallelBenchmarkCount+above+one+%28even+on+AUTO%29+may+overheat+your+CPU.%0A%EF%81%9A+The+sensors+command+can+help+you+detect+if+this+is+the+case.+It+is+available+in+the%0Apackage+lm_sensors+or+lm-sensors+in+most+Linux+distributions.+There+are+several%0Afreeware+tools+available+for+Windows+too.%0AThe+benchmarker+uses+a+thread+pool+internally%2C+but+you+can+optionally+plug+in+a+custom%0AThreadFactory%2C+for+example+when+running+benchmarks+on+an+application+server+or+a+cloud%0Aplatform%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CthreadFactoryClass%3E...MyCustomThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AIn+the+future%2C+we+will+also+support+multi-JVM+benchmarking.+This+feature+is%0A%EF%81%9A+independent+of+multithreaded+solving+or+multi-JVM+solving.%0A15.7.2.+Statistical+Benchmarking%0ATo+minimize+the+influence+of+your+environment+and+the+Random+Number+Generator+on+the%0Abenchmark+results%2C+configure+the+number+of+times+each+single+benchmark+run+is+repeated.+The%0Aresults+of+those+runs+are+statistically+aggregated.+Each+individual+result+is+also+visible+in+the+report%2C%0Aas+well+as+plotted+in+the+best+score+distribution+summary.%0AJust+add+a+%3CsubSingleCount%3E+element+to+an+%3CinheritedSolverBenchmark%3E+element+or+in+a%0A%3CsolverBenchmark%3E+element%3A%0A312%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+++%3CsubSingleCount%3E10%3C%2FsubSingleCount%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+subSingleCount+defaults+to+1+%28so+no+statistical+benchmarking%29.%0AIf+subSingleCount+is+higher+than+1%2C+the+benchmarker+will+automatically+use+a%0A%EF%81%9A+differentRandom+seed+for+every+sub+single+run%2C+without+losing+reproducibility+%28for%0Aeach+sub+single+index%29+in+EnvironmentModeREPRODUCIBLE+and+lower.%0A15.7.3.+Template+Based+Benchmarking+And+Matrix+Benchmarking%0AMatrix+benchmarking+is+benchmarking+a+combination+of+value+sets.+For+example%3A+benchmark+four%0AentityTabuSize+values+%285%2C+7%2C+11+and+13%29+combined+with+three+acceptedCountLimit+values+%28500%2C+1000+and%0A2000%29%2C+resulting+in+12+solver+configurations.%0ATo+reduce+the+verbosity+of+such+a+benchmark+configuration%2C+you+can+use+a+Freemarker+template+for%0Athe+benchmark+configuration+instead%3A%0A313%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%3C%23list+%5B5%2C+7%2C+11%2C+13%5D+as+entityTabuSize%3E%0A%3C%23list+%5B500%2C+1000%2C+2000%5D+as+acceptedCountLimit%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ETabu+Search+entityTabuSize+%24%7BentityTabuSize%7D+acceptedCountLimit%0A%24%7BacceptedCountLimit%7D%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3ClocalSearch%3E%0A%C2%A0+++++++%3CunionMoveSelector%3E%0A%C2%A0+++++++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++++%3C%2FunionMoveSelector%3E%0A%C2%A0+++++++%3Cacceptor%3E%0A%C2%A0+++++++++%3CentityTabuSize%3E%24%7BentityTabuSize%7D%3C%2FentityTabuSize%3E%0A%C2%A0+++++++%3C%2Facceptor%3E%0A%C2%A0+++++++%3Cforager%3E%0A%C2%A0+++++++++%3CacceptedCountLimit%3E%24%7BacceptedCountLimit%7D%3C%2FacceptedCountLimit%3E%0A%C2%A0+++++++%3C%2Fforager%3E%0A%C2%A0+++++%3C%2FlocalSearch%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2F%23list%3E%0A%3C%2F%23list%3E%0A%3C%2FplannerBenchmark%3E%0ATo+configure+Matrix+Benchmarking+for+Simulated+Annealing+%28or+any+other+configuration+that%0Ainvolves+a+Score+template+variable%29%2C+use+the+replace%28%29+method+in+the+solver+benchmark+name%0Aelement%3A%0A314%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%3C%23list+%5B%221hard%2F10soft%22%2C+%221hard%2F20soft%22%2C+%221hard%2F50soft%22%2C+%221hard%2F70soft%22%5D+as%0AstartingTemperature%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ESimulated+Annealing+startingTemperature+%24%7BstartingTemperature%3Freplace%28%22%2F%22%2C%0A%22_%22%29%7D%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3ClocalSearch%3E%0A%C2%A0+++++++%3Cacceptor%3E%0A%C2%A0+++++++++%3CsimulatedAnnealingStartingTemperature%3E%0A%24%7BstartingTemperature%7D%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++++++%3C%2Facceptor%3E%0A%C2%A0+++++%3C%2FlocalSearch%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2F%23list%3E%0A%3C%2FplannerBenchmark%3E%0AA+solver+benchmark+name+doesn%E2%80%99t+allow+some+characters+%28such+a+%2F%29+because+the%0A%EF%81%9A+name+is+also+used+a+file+name.%0AAnd+build+it+with+the+class+PlannerBenchmarkFactory%3A%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromFreemarkerXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Foptional%2Fbenchmark%2FcloudBalancingBenchmarkCon%0AfigTemplate.xml.ftl%22%29%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+plannerBenchmarkFactory%0A.buildPlannerBenchmark%28%29%3B%0A15.7.4.+Benchmark+Report+Aggregation%0AThe+BenchmarkAggregator+takes+one+or+more+existing+benchmarks+and+merges+them+into+new%0Abenchmark+report%2C+without+actually+running+the+benchmarks+again.%0A315%0AThis+is+useful+to%3A%0A%E2%80%A2+Report+on+the+impact+of+code+changes%3A+Run+the+same+benchmark+configuration+before+and%0Aafter+the+code+changes%2C+then+aggregate+a+report.%0A%E2%80%A2+Report+on+the+impact+of+dependency+upgrades%3A+Run+the+same+benchmark+configuration%0Abefore+and+after+upgrading+the+dependency%2C+then+aggregate+a+report.%0A%E2%80%A2+Condense+a+too+verbose+report%3A+Select+only+the+interesting+solver+benchmarks+from+the%0Aexisting+report.+This+especially+useful+on+template+reports+to+make+the+graphs+readable.%0A%E2%80%A2+Partially+rerun+a+benchmark%3A+Rerun+part+of+an+existing+report+%28for+example+only+the+failed+or%0Ainvalid+solvers%29%2C+then+recreate+the+original+intended+report+with+the+new+values.%0ATo+use+it%2C+provide+a+PlannerBenchmarkFactory+to+the+BenchmarkAggregatorFrame+to+display+the+GUI%3A%0A%C2%A0+++public+static+void+main%28String%5B%5D+args%29+%7B%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fbenchmark%2FnqueensBenchmarkConfig.xml%22%29%3B%0A%C2%A0+++++++BenchmarkAggregatorFrame.createAndDisplay%28plannerBenchmarkFactory%29%3B%0A%C2%A0+++%7D%0A316%0ADespite+that+it+uses+a+benchmark+configuration+as+input%2C+it+ignores+all+elements+of%0A%EF%81%B1+that+configuration%2C+except+for+the+elements+%3CbenchmarkDirectory%3E+and%0A%3CbenchmarkReport%3E.%0AIn+the+GUI%2C+select+the+interesting+benchmarks+and+click+the+button+to+generate+the+report.%0AAll+the+input+reports+which+are+being+merged+should+have+been+generated+with+the%0Asame+Planner+version+%28excluding+hotfix+differences%29+as+the+BenchmarkAggregator.%0A%EF%81%9A+Using+reports+from+different+Planner+major+or+minor+versions+are+not+guaranteed%0Ato+succeed+and+deliver+correct+information%2C+because+the+benchmark+report+data%0Astructure+often+changes.%0A317%0AChapter+16.+Repeated+Planning%0A16.1.+Introduction+to+Repeated+Planning%0AThe+problem+facts+used+to+create+a+solution+may+change+before+or+during+the+execution+of+that%0Asolution.+Delaying+planning+in+order+to+lower+the+risk+of+problem+facts+changing+is+not+ideal%2C+as+an%0Aincomplete+plan+is+preferable+to+no+plan.%0AThe+following+examples+demonstrate+situations+where+planning+solutions+need+to+be+altered+due+to%0Aunpredictable+changes%3A%0A%E2%80%A2+Unforeseen+fact+changes%0A%E2%97%A6+An+employee+assigned+to+a+shift+calls+in+sick.%0A%E2%97%A6+An+airplane+scheduled+to+take+off+has+a+technical+delay.%0A%E2%97%A6+One+of+the+machines+or+vehicles+break+down.%0AUnforeseen+fact+changes+benefit+from+using+backup+planning.%0A%E2%80%A2+Cannot+assign+all+entities+immediately%0ALeave+some+unassigned.+For+example%3A%0A%E2%97%A6+There+are+10+shifts+at+the+same+time+to+assign+but+only+nine+employees+to+handle+shifts.%0AFor+this+type+of+planning%2C+use+overconstrained+planning.%0A%E2%80%A2+Unknown+long+term+future+facts%0AFor+example%3A%0A%E2%97%A6+Hospital+admissions+for+the+next+two+weeks+are+reliable%2C+but+those+for+week+three+and+four%0Aare+less+reliable%2C+and+for+week+five+and+beyond+are+not+worth+planning+yet.%0AThis+problem+benefits+from+continuous+planning.%0A%E2%80%A2+Constantly+changing+problem+facts%0AUse+real-time+planning.%0AMore+CPU+time+results+in+a+better+planning+solution.%0APlanner+allows+you+to+start+planning+earlier%2C+despite+unforeseen+changes%2C+as+the+optimization%0Aalgorithms+support+planning+a+solution+that+has+already+been+partially+planned.+This+is+known+as%0Arepeated+planning.%0A16.2.+Backup+Planning%0ABackup+planning+adds+extra+score+constraints+to+create+space+in+the+planning+for+when+things+go%0A318%0Awrong.+That+creates+a+backup+plan+within+the+plan+itself.%0AAn+example+of+backup+planning+is+as+follows%3A%0A1.+Create+an+extra+score+constraint.+For+example%3A%0A%E2%97%A6+Assign+an+employee+as+the+spare+employee+%28one+for+every+10+shifts+at+the+same+time%29.%0A%E2%97%A6+Keep+one+hospital+bed+open+in+each+department.%0A2.+Change+the+planning+problem+when+an+unforeseen+event+occurs.%0AFor+example%2C+if+an+employee+calls+in+sick%3A%0A%E2%97%A6+Delete+the+sick+employee+and+leave+their+shifts+unassigned.%0A%E2%97%A6+Restart+the+planning%2C+starting+from+that+solution%2C+which+now+has+a+different+score.%0AThe+construction+heuristics+fills+in+the+newly+created+gaps+%28probably+with+the+spare+employee%29+and%0Athe+metaheuristics+will+improve+it+even+further.%0A16.3.+Overconstrained+Planning%0AWhen+there+is+no+feasible+solution+to+assign+all+planning+entities%2C+it+is+preferable+to+assign+as+many%0Aentities+as+possible+without+breaking+hard+constraints.+This+is+called+overconstrained+planning.%0ABy+default%2C+Planner+assigns+all+planning+entities%2C+overloads+the+planning+values%2C+and+therefore%0Abreaks+hard+constraints.+There+are+two+ways+to+avoid+this%3A%0A%E2%80%A2+Use+nullable+planning+variables%2C+so+that+some+entities+are+unassigned.%0A%E2%80%A2+Add+virtual+values+to+catch+the+unassigned+entities.%0A16.3.1.+Overconstrained+Planning+with+Nullable+Variables%0AIf+we+handle+overconstrained+planning+with+nullable+variables%2C+the+overload+entities+will+be+left%0Aunassigned%3A%0A319%0ATo+implement+this%3A%0A1.+Add+an+additional+score+level+%28usually+a+medium+level+between+the+hard+and+soft+level%29+by%0Aswitching+Score+type.%0A2.+Make+the+planning+variable+nullable.%0A3.+Add+a+score+constraint+on+the+new+level+%28usually+a+medium+constraint%29+to+penalize+the+number%0Aof+unassigned+entities+%28or+a+weighted+sum+of+them%29.%0A16.3.2.+Overconstrained+Planning+with+Virtual+Values%0AIn+overconstrained+planning+it+is+often+useful+to+know+which+resources+are+lacking.+In%0Aoverconstrained+planning+with+virtual+values%2C+the+solution+indicates+which+resources+to+buy.%0ATo+implement+this%3A%0A1.+Add+an+additional+score+level+%28usually+a+medium+level+between+the+hard+and+soft+level%29+by%0Aswitching+Score+type.%0A2.+Add+a+number+of+virtual+values.+It+can+be+difficult+to+determine+a+good+formula+to+calculate+that%0Anumber%3A%0A%E2%97%A6+Do+not+add+too+many%2C+as+that+will+decrease+solver+efficiency.%0A%E2%97%A6+Importantly%2C+do+not+add+too+few+as+that+will+lead+to+an+infeasible+solution.%0A3.+Add+a+score+constraint+on+the+new+level+%28usually+a+medium+constraint%29+to+penalize+the+number%0A320%0Aof+virtual+assigned+entities+%28or+a+weighted+sum+of+them%29.%0A4.+Optionally%2C+change+all+soft+constraints+to+ignore+virtual+assigned+entities.%0A16.4.+Continuous+Planning+%28Windowed+Planning%29%0AContinuous+planning+is+the+technique+of+planning+one+or+more+upcoming+planning+periods+at+the%0Asame+time+and+repeating+that+process+monthly%2C+weekly%2C+daily%2C+hourly%2C+or+even+more+frequently.%0AHowever%2C+as+time+is+infinite%2C+planning+all+future+time+periods+is+impossible.%0AIn+the+employee+rostering+example+above%2C+we+re-plan+every+four+days.+Each+time%2C+we+actually+plan+a%0Awindow+of+12+days%2C+but+we+only+publish+the+first+four+days%2C+which+is+stable+enough+to+share+with+the%0Aemployees%2C+so+they+can+plan+their+social+life+accordingly.%0A321%0AIn+the+hospital+bed+planning+example+above%2C+notice+the+difference+between+the+original+planning+of%0ANovember+1st+and+the+new+planning+of+November+5th%3A+some+problem+facts+%28F%2C+H%2C+I%2C+J%2C+K%29+changed+in%0Athe+meantime%2C+which+results+in+unrelated+planning+entities+%28G%29+changing+too.%0AThe+planning+window+can+be+split+up+in+several+stages%3A%0A%E2%80%A2+History%0AImmutable+past+time+periods.+It+contains+only+immovable+entities.%0A%E2%97%A6+Recent+historic+entities+can+also+affect+score+constraints+that+apply+to+movable+entities.+For%0Aexample%2C+in+nurse+rostering%2C+a+nurse+that+has+worked+the+last+three+historic+weekends+in+a%0Arow+should+not+be+assigned+to+three+more+weekends+in+a+row%2C+because+she+requires+a+one%0Afree+weekend+per+month.%0A%E2%97%A6+Do+not+load+all+historic+entities+in+memory%3A+even+though+immovable+entities+do+not+affect%0Asolving+performance%2C+they+can+cause+out+of+memory+problems+when+the+data+grows+to+years.%0AOnly+load+those+that+might+still+affect+the+current+constraints+with+a+good+safety+margin.%0A%E2%80%A2+Published%0AUpcoming+time+periods+that+have+been+published.+They+contain+only+Immovable+and%2For+semi-%0Aimmovable+planning+entities.%0A%E2%97%A6+The+published+schedule+has+been+shared+with+the+business.+For+example%2C+in+nurse+rostering%2C%0Athe+nurses+will+use+this+schedule+to+plan+their+personal+lives%2C+so+they+require+a+publish+notice%0A322%0Aof+for+example+3+weeks+in+advance.+Normal+planning+will+not+change+that+part+of+schedule.%0AChanging+that+schedule+later+is+disruptive%2C+but+were+exceptions+force+us+to+do+them+anyway%0A%28for+example+someone+calls+in+sick%29%2C+do+change+this+part+of+the+planning+while+minimizing%0Adisruption+with+non-disruptive+replanning.%0A%E2%80%A2+Draft%0AUpcoming+time+periods+after+the+published+time+periods+that+can+change+freely.+They+contain%0Amovable+planning+entities%2C+except+for+any+that+are+immovable+for+other+reasons+%28such+as+being%0Apinned+by+a+user%29.%0A%E2%97%A6+The+first+part+of+the+draft%2C+called+the+final+draft%2C+will+be+published%2C+so+these+planning+entities%0Acan+change+one+last+time.+The+publishing+frequency%2C+for+example+once+per+week%2C+determines%0Athe+number+of+time+periods+that+change+from+draft+to+published.%0A%E2%97%A6+The+latter+time+periods+of+the+draft+are+likely+change+again+in+later+planning+efforts%2C%0Aespecially+if+some+of+the+problem+facts+change+by+then+%28for+example+nurse+Ann+doesn%E2%80%99t+want%0Ato+work+on+one+of+those+days%29.%0ADespite+that+these+latter+planning+entities+might+still+change+a+lot%2C+we+can%E2%80%99t+leave+them+out%0Afor+later%2C+because+we+would+risk+painting+ourselves+in+a+corner.+For+example%2C+in+employee%0Arostering+we+could+have+all+our+rare+skilled+employees+working+the+last+5+days+of+the+week%0Athat+gets+published%2C+which+won%E2%80%99t+reduce+the+score+of+that+week%2C+but+will+make+it+impossible%0Afor+us+to+deliver+a+feasible+schedule+the+next+week.+So+the+draft+length+needs+to+be+longer%0Athan+the+part+that+will+be+published+first.%0A%E2%97%A6+That+draft+part+is+usually+not+shared+with+the+business+yet%2C+because+it+is+too+volatile+and+it%0Awould+only+raise+false+expectations.+However%2C+it+is+stored+in+the+database+and+used+as+a%0Astarting+point+for+the+next+solver.%0A%E2%80%A2+Unplanned+%28out+of+scope%29%0APlanning+entities+that+are+not+in+the+current+planning+window.%0A%E2%97%A6+If+the+planning+window+is+too+small+to+plan+all+entities%2C+you%E2%80%99re+dealing+with+overconstrained%0Aplanning.%0A%E2%97%A6+If+time+is+a+planning+variable%2C+the+size+of+the+planning+window+is+determined+dynamically%2C+in%0Awhich+case+the+unplanned+stage+is+not+applicable.%0A323%0A16.4.1.+Immovable+Planning+Entities%0AAn+immovable+planning+entity+doesn%E2%80%99t+change+during+solving.+This+is+commonly+used+by+users+to%0Apin+down+one+or+more+specific+assignments+and+force+Planner+to+schedule+around+those+fixed%0Aassignments.%0A16.4.1.1.+Pin+Down+Planning+Entities+with+%40PlanningPin%0ATo+make+some+planning+entities+immovable%2C+add+an+%40PlanningPin+annotation+on+a+boolean+getter+or%0Afield+of+the+planning+entity+class.+That+boolean+is+true+if+the+entity+is+immovable+%28pinned+down+to+its%0Acurrent+planning+values%29+and+false+otherwise.%0A1.+Add+the+%40PlanningPin+annotation+on+a+boolean%3A%0A324%0A%40PlanningEntity%0Apublic+class+Lecture+%7B%0A%C2%A0+++private+boolean+pinned%3B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningPin%0A%C2%A0+++public+boolean+isPinned%28%29+%7B%0A%C2%A0+++++++return+pinned%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0AIn+the+example+above%2C+if+pinned+is+true%2C+the+lecture+will+not+be+assigned+to+another+period+or+room%0A%28even+if+the+current+period+and+rooms+fields+are+null%29.%0A16.4.1.2.+Configure+a+Movable+EntitySelectionFilter%0AAlternatively%2C+to+make+some+planning+entities+immovable%2C+add+an+entity+SelectionFilter+that%0Areturns+true+if+an+entity+is+movable%2C+and+false+if+it+is+immovable.+This+is+more+flexible+and+more%0Averbose+than+the+%40PlanningPin+approach.%0AFor+example+on+the+nurse+rostering+example%3A%0A1.+Add+the+SelectionFilter%3A%0Apublic+class+MovableShiftAssignmentSelectionFilter+implements+SelectionFilter%0A%3CNurseRoster%2C+ShiftAssignment%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CNurseRoster%3E+scoreDirector%2C+ShiftAssignment%0AshiftAssignment%29+%7B%0A%C2%A0+++++++NurseRoster+nurseRoster+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++ShiftDate+shiftDate+%3D+shiftAssignment.getShift%28%29.getShiftDate%28%29%3B%0A%C2%A0+++++++return+nurseRoster.getNurseRosterInfo%28%29.isInPlanningWindow%28shiftDate%29%3B%0A%C2%A0+++%7D%0A%7D%0A2.+Configure+the+SelectionFilter%3A%0A%40PlanningEntity%28movableEntitySelectionFilter+%3D%0AMovableShiftAssignmentSelectionFilter.class%29%0Apublic+class+ShiftAssignment+%7B%0A%C2%A0+++...%0A%7D%0A325%0A16.4.2.+Nonvolatile+Replanning+to+Minimize+Disruption+%28Semi-movable%0APlanning+Entities%29%0AReplanning+an+existing+plan+can+be+very+disruptive.+If+the+plan+affects+humans+%28such+as+employees%2C%0Adrivers%2C+%E2%80%A6%29%2C+very+disruptive+changes+are+often+undesirable.+In+such+cases%2C+nonvolatile+replanning%0Ahelps+by+restricting+planning+freedom%3A+the+gain+of+changing+a+plan+must+be+higher+than+the%0Adisruption+it+causes.+This+is+usually+implemented+by+taxing+all+planning+entities+that+change.%0AIn+the+machine+reassignment+example%2C+the+entity+has+both+the+planning+variable+machine+and+its%0Aoriginal+value+originalMachine%3A%0A326%0A%40PlanningEntity%28...%29%0Apublic+class+ProcessAssignment+%7B%0A%C2%A0+++private+MrProcess+process%3B%0A%C2%A0+++private+Machine+originalMachine%3B%0A%C2%A0+++private+Machine+machine%3B%0A%C2%A0+++public+Machine+getOriginalMachine%28%29+%7B...%7D%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Machine+getMachine%28%29+%7B...%7D%0A%C2%A0+++public+boolean+isMoved%28%29+%7B%0A%C2%A0+++++++return+originalMachine+%21%3D+null+%26%26+originalMachine+%21%3D+machine%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0ADuring+planning%2C+the+planning+variable+machine+changes.+By+comparing+it+with+the+originalMachine%2C%0Aa+change+in+plan+can+be+penalized%3A%0Arule+%22processMoved%22%0A%C2%A0+++when%0A%C2%A0+++++++ProcessAssignment%28moved+%3D%3D+true%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-1000%29%3B%0Aend%0AThe+soft+penalty+of+-1000+means+that+a+better+solution+is+only+accepted+if+it+improves+the+soft+score%0Afor+at+least+1000+points+per+variable+changed+%28or+if+it+improves+the+hard+score%29.%0A16.5.+Real-time+Planning%0ATo+do+real-time+planning%2C+combine+the+following+planning+techniques%3A%0A%E2%80%A2+Backup+planning+-+adding+extra+score+constraints+to+allow+for+unforeseen+changes.%0A%E2%80%A2+Continuous+planning+-+planning+for+one+or+more+future+planning+periods.%0A%E2%80%A2+Short+planning+windows.%0AThis+lowers+the+burden+of+real-time+planning.%0AAs+time+passes%2C+the+problem+itself+changes.+Consider+the+vehicle+routing+use+case%3A%0A327%0AIn+the+example+above%2C+three+customers+are+added+at+different+times+%2807%3A56%2C+08%3A02+and+08%3A45%29%2C+after%0Athe+original+customer+set+finished+solving+at+07%3A55%2C+and+in+some+cases%2C+after+the+vehicles+already+left.%0APlanner+can+handle+such+scenarios+with+ProblemFactChange+%28in+combination+with+immovable%0Aplanning+entities%29.%0A16.5.1.+ProblemFactChange%0AWhile+the+Solver+is+solving%2C+one+of+the+problem+facts+may+be+changed+by+an+outside+event.+For%0Aexample%2C+an+airplane+is+delayed+and+needs+the+runway+at+a+later+time.%0ADo+not+change+the+problem+fact+instances+used+by+the+Solver+while+it+is+solving%0A%EF%81%AA+%28from+another+thread+or+even+in+the+same+thread%29%2C+as+that+will+corrupt+it.%0AAdd+a+ProblemFactChange+to+the+Solver%2C+which+it+executes+in+the+solver+thread+as+soon+as+possible.+For%0Aexample%3A%0A328%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++boolean+addProblemFactChange%28ProblemFactChange%3CSolution_%3E+problemFactChange%29%3B%0A%C2%A0+++boolean+isEveryProblemFactChangeProcessed%28%29%3B%0A%C2%A0+++...%0A%7D%0Apublic+interface+ProblemFactChange%3CSolution_%3E+%7B%0A%C2%A0+++void+doChange%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%7D%0AThe+ScoreDirector+must+be+updated+with+any+change+on+the+problem+facts+of%0A%EF%81%B1+planning+entities+in+a+ProblemFactChange.%0ATo+write+a+ProblemFactChange+correctly%2C+it+is+important+to+understand+the+behavior+of+a+planning%0Aclone.%0AA+planning+clone+of+a+solution+must+fulfill+these+requirements%3A%0A%E2%80%A2+The+clone+must+represent+the+same+planning+problem.+Usually+it+reuses+the+same+instances+of%0Athe+problem+facts+and+problem+fact+collections+as+the+original.%0A%E2%80%A2+The+clone+must+use+different%2C+cloned+instances+of+the+entities+and+entity+collections.+Changes+to%0Aan+original+Solution+entity%E2%80%99s+variables+must+not+affect+its+clone.%0A16.5.1.1.+Cloud+Balancing+ProblemFactChange+Example%0AConsider+the+following+example+of+a+ProblemFactChange+implementation+in+the+cloud+balancing+use%0Acase%3A%0A329%0A%C2%A0+++public+void+deleteComputer%28final+CloudComputer+computer%29+%7B%0A%C2%A0+++++++solver.addProblemFactChange%28scoreDirector+-%3E+%7B%0A%C2%A0+++++++++++CloudBalance+cloudBalance+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++++++CloudComputer+workingComputer+%3D+scoreDirector.lookUpWorkingObject%28%0Acomputer%29%3B%0A%C2%A0+++++++++++%2F%2F+First+remove+the+problem+fact+from+all+planning+entities+that+use+it%0A%C2%A0+++++++++++for+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++++++if+%28process.getComputer%28%29+%3D%3D+workingComputer%29+%7B%0A%C2%A0+++++++++++++++++++scoreDirector.beforeVariableChanged%28process%2C+%22computer%22%29%3B%0A%C2%A0+++++++++++++++++++process.setComputer%28null%29%3B%0A%C2%A0+++++++++++++++++++scoreDirector.afterVariableChanged%28process%2C+%22computer%22%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+A+SolutionCloner+does+not+clone+problem+fact+lists+%28such+as%0AcomputerList%29%0A%C2%A0+++++++++++%2F%2F+Shallow+clone+the+computerList+so+only+workingSolution+is+affected%2C+not%0AbestSolution+or+guiSolution%0A%C2%A0+++++++++++ArrayList%3CCloudComputer%3E+computerList+%3D+new+ArrayList%3C%3E%28cloudBalance%0A.getComputerList%28%29%29%3B%0A%C2%A0+++++++++++cloudBalance.setComputerList%28computerList%29%3B%0A%C2%A0+++++++++++%2F%2F+Remove+the+problem+fact+itself%0A%C2%A0+++++++++++scoreDirector.beforeProblemFactRemoved%28workingComputer%29%3B%0A%C2%A0+++++++++++computerList.remove%28workingComputer%29%3B%0A%C2%A0+++++++++++scoreDirector.afterProblemFactRemoved%28workingComputer%29%3B%0A%C2%A0+++++++++++scoreDirector.triggerVariableListeners%28%29%3B%0A%C2%A0+++++++%7D%29%3B%0A%C2%A0+++%7D%0A1.+Any+change+in+a+ProblemFactChange+must+be+done+on+the+Solution+instance+of%0AscoreDirector.getWorkingSolution%28%29.%0A2.+The+workingSolution+is+a+planning+clone+of+the+BestSolutionChangedEvent%27s+bestSolution.%0A%E2%97%A6+The+workingSolution+in+the+Solver+is+never+the+same+instance+as+the+Solution+in+the+rest+of%0Ayour+application%3A+it+is+a+planning+clone.%0A%E2%97%A6+A+planning+clone+also+clones+the+planning+entities+and+planning+entity+collections.%0ASo+any+change+on+the+planning+entities+must+happen+on+the+instances+held+by%0AscoreDirector.getWorkingSolution%28%29.%0A3.+Use+the+method+ScoreDirector.lookUpWorkingObject%28%29+to+translate+and+retrieve+the+working%0Asolution%E2%80%99s+instance+of+an+object.%0A4.+A+planning+clone+does+not+clone+the+problem+facts%2C+nor+the+problem+fact+collections.+Therefore%0Athe+workingSolution+and+the+bestSolution+share+the+same+problem+fact+instances+and+the+same%0Aproblem+fact+list+instances.%0AAny+problem+fact+or+problem+fact+list+changed+by+a+ProblemFactChange+must+be+problem+cloned%0Afirst+%28which+can+imply+rerouting+references+in+other+problem+facts+and+planning+entities%29.%0AOtherwise%2C+if+the+workingSolution+and+bestSolution+are+used+in+different+threads+%28for+example+a%0A330%0Asolver+thread+and+a+GUI+event+thread%29%2C+a+race+condition+can+occur.%0A16.5.1.2.+Cloning+Solutions+to+Avoid+Race+Conditions+in+Real-time+Planning%0AMany+types+of+changes+can+leave+a+planning+entity+uninitialized%2C+resulting+in+a+partially+initialized%0Asolution.+This+is+acceptable%2C+provided+the+first+solver+phase+can+handle+it.%0AAll+construction+heuristics+solver+phases+can+handle+a+partially+initialized+solution%2C+so+it+is%0Arecommended+to+configure+such+a+solver+phase+as+the+first+phase.%0AThe+process+occurs+as+follows%3A%0A1.+The+Solver+stops.%0A2.+Runs+the+ProblemFactChange.%0A3.+restarts.%0AThis+is+a+warm+start+because+its+initial+solution+is+the+adjusted+best+solution+of+the+previous+run.%0A4.+Each+solver+phase+runs+again.%0AThis+implies+the+construction+heuristic+runs+again%2C+but+because+little+or+no+planning+variables%0Aare+uninitialized+%28unless+you+have+a+nullable+planning+variable%29%2C+it+finishes+much+quicker+than%0Ain+a+cold+start.%0A331%0A5.+Each+configured+Termination+resets+%28both+in+solver+and+phase+configuration%29%2C+but+a+previous+call%0Ato+terminateEarly%28%29+is+not+undone.%0ATermination+is+not+usually+configured+%28except+in+daemon+mode%29%3B+instead%2C%0ASolver.terminateEarly%28%29+is+called+when+the+results+are+needed.+Alternatively%2C+configure+a%0ATermination+and+use+the+daemon+mode+in+combination+with+BestSolutionChangedEvent+as%0Adescribed+in+the+following+section.%0A16.5.2.+Daemon%3A+solve%28%29+Does+Not+Return%0AIn+real-time+planning%2C+it+is+often+useful+to+have+a+solver+thread+wait+when+it+runs+out+of+work%2C+and%0Aimmediately+resume+solving+a+problem+once+new+problem+fact+changes+are+added.+Putting+the%0ASolver+in+daemon+mode+has+the+following+effects%3A%0A%E2%80%A2+If+the+Solver%27s+Termination+terminates%2C+it+does+not+return+from+solve%28%29%2C+but+blocks+its+thread%0Ainstead+%28which+frees+up+CPU+power%29.%0A%E2%97%A6+Except+for+terminateEarly%28%29%2C+which+does+make+it+return+from+solve%28%29%2C+freeing+up+system%0Aresources+and+allowing+an+application+to+shutdown+gracefully.%0A%E2%97%A6+If+a+Solver+starts+with+an+empty+planning+entity+collection%2C+it+waits+in+the+blocked+state%0Aimmediately.%0A%E2%80%A2+If+a+ProblemFactChange+is+added%2C+it+goes+into+the+running+state%2C+applies+the+ProblemFactChange+and%0Aruns+the+Solver+again.%0ATo+use+the+Solver+in+daemon+mode%3A%0A1.+Enable+daemon+mode+on+the+Solver%3A%0A%3Csolver%3E%0A%C2%A0+%3Cdaemon%3Etrue%3C%2Fdaemon%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ADo+not+forget+to+call+Solver.terminateEarly%28%29+when+your+application+needs+to%0A%EF%81%B1+shutdown+to+avoid+killing+the+solver+thread+unnaturally.%0A2.+Subscribe+to+the+BestSolutionChangedEvent+to+process+new+best+solutions+found+by+the+solver%0Athread.%0AA+BestSolutionChangedEvent+does+not+guarantee+that+every+ProblemFactChange+has+been+processed%0Aalready%2C+nor+that+the+solution+is+initialized+and+feasible.%0A3.+To+ignore+BestSolutionChangedEvents+with+such+invalid+solutions%2C+do+the+following%3A%0A332%0A%C2%A0+++public+void+bestSolutionChanged%28BestSolutionChangedEvent%3CCloudBalance%3E+event%29+%7B%0A%C2%A0+++++++if+%28event.isEveryProblemFactChangeProcessed%28%29%0A%C2%A0+++++++++++++++%2F%2F+Ignore+infeasible+%28including+uninitialized%29+solutions%0A%C2%A0+++++++++++++++%26%26+event.getNewBestSolution%28%29.getScore%28%29.isFeasible%28%29%29+%7B%0A%C2%A0+++++++++++...%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A4.+Use+Score.isSolutionInitialized%28%29+instead+of+Score.isFeasible%28%29+to+only+ignore+uninitialized%0Asolutions%2C+but+do+accept+infeasible+solutions+too.%0A333%0AChapter+17.+Integration%0A17.1.+Overview%0APlanner%E2%80%99s+input+and+output+data+%28the+planning+problem+and+the+best+solution%29+are+plain+old%0AJavaBeans+%28POJO%E2%80%99s%29%2C+so+integration+with+other+Java+technologies+is+straightforward.+For+example%3A%0A%E2%80%A2+To+read+a+planning+problem+from+the+database+%28and+store+the+best+solution+in+it%29%2C+annotate+the%0Adomain+POJO%E2%80%99s+with+JPA+annotations.%0A%E2%80%A2+To+read+a+planning+problem+from+an+XML+file+%28and+store+the+best+solution+in+it%29%2C+annotate+the%0Adomain+POJO%E2%80%99s+with+XStream+or+JAXB+annotations.%0A%E2%80%A2+To+expose+the+Solver+as+a+REST+Service+that+reads+the+planning+problem+and+responds+with+the%0Abest+solution%2C+annotate+the+domain+POJO%E2%80%99s+with+XStream%2C+JAXB+or+Jackson+annotations+and+hook%0Athe+Solver+in+Camel+or+RESTEasy.%0A17.2.+Persistent+Storage%0A17.2.1.+Database%3A+JPA+and+Hibernate%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+JPA+annotations+to+store+them+in+a%0Adatabase+by+calling+EntityManager.persist%28%29.%0A334%0ADo+not+confuse+JPA%E2%80%99s+%40Entity+annotation+with+Planner%E2%80%99s+%40PlanningEntity%0Aannotation.+They+can+appear+both+on+the+same+class%3A%0A%EF%81%9A+%40PlanningEntity+%2F%2F+OptaPlanner+annotation%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Talk+%7B...%7D%0AAdd+a+dependency+to+the+optaplanner-persistence-jpa+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.1.1.+JPA+and+Hibernate%3A+Persisting+a+Score%0AWhen+a+Score+is+persisted+into+a+relational+database%2C+JPA+and+Hibernate+will+default+to+Java%0Aserializing+it+to+a+BLOB+column.+This+has+several+disadvantages%3A%0A%E2%80%A2+The+Java+serialization+format+of+Score+classes+is+currently+not+backwards+compatible.+Upgrading%0Ato+a+newer+Planner+version+can+break+reading+an+existing+database.%0A%E2%80%A2+The+score+is+not+easily+readable+for+a+query+executed+in+the+database+console.+This+is+annoying%0Aduring+development.%0A%E2%80%A2+The+score+cannot+be+used+in+a+SQL+or+JPA-QL+query+to+efficiently+filter+the+results%3A+for+example+to%0Aquery+all+infeasible+schedules.%0ATo+avoid+these+issues%2C+configure+it+to+instead+use+INTEGER+%28or+other%29+columns%2C+by+using+the%0Aappropriate+*ScoreHibernateType+for+your+Score+type%2C+for+example+for+a+HardSoftScore%3A%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+HardSoftScore.class%2C+typeClass+%3D+HardSoftScoreHibernateType%0A.class%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%40Column%28name+%3D+%22initScore%22%29%2C+%40Column%28name+%3D+%22hardScore%22%29%2C%0A%40Column%28name+%3D+%22softScore%22%29%7D%29%0A%C2%A0+++protected+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AConfigure+the+same+number+of+%40Column+annotations+as+the+number+of+score+levels%0A%EF%81%9A+in+the+score+plus+one+%28for+the+initScore%29%2C+otherwise+Hibernate+will+fail+fast+because%0Aa+property+mapping+has+the+wrong+number+of+columns.%0AIn+this+case%2C+the+DDL+will+look+like+this%3A%0A335%0ACREATE+TABLE+CloudBalance%28%0A%C2%A0+++...%0A%C2%A0+++initScore+INTEGER%2C%0A%C2%A0+++hardScore+INTEGER%2C%0A%C2%A0+++softScore+INTEGER%0A%29%3B%0AWhen+using+a+BigDecimal+based+Score%2C+specify+the+precision+and+scale+of+the+columns+to+avoid+silent%0Arounding%3A%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+HardSoftBigDecimalScore.class%2C+typeClass+%3D%0AHardSoftBigDecimalScoreHibernateType.class%29%0Apublic+class+CloudBalance%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%0A%C2%A0+++++++++++%40Column%28name+%3D+%22initScore%22%29%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hardScore%22%2C+precision+%3D+10%2C+scale+%3D+5%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22softScore%22%2C+precision+%3D+10%2C+scale+%3D+5%29%7D%29%0A%C2%A0+++protected+HardSoftBigDecimalScore+score%3B%0A%C2%A0+++...%0A%7D%0AIn+this+case%2C+the+DDL+will+look+like+this%3A%0ACREATE+TABLE+CloudBalance%28%0A%C2%A0+++...%0A%C2%A0+++initScore+INTEGER%2C%0A%C2%A0+++hardScore+DECIMAL%2810%2C+5%29%2C%0A%C2%A0+++softScore+DECIMAL%2810%2C+5%29%0A%29%3B%0AWhen+using+any+type+of+bendable+Score%2C+specify+the+hard+and+soft+level+sizes+as+parameters%3A%0A336%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+BendableScore.class%2C+typeClass+%3D+BendableScoreHibernateType%0A.class%2C+parameters+%3D+%7B%0A%C2%A0+++++++%40Parameter%28name+%3D+%22hardLevelsSize%22%2C+value+%3D+%223%22%29%2C%0A%C2%A0+++++++%40Parameter%28name+%3D+%22softLevelsSize%22%2C+value+%3D+%222%22%29%7D%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%0A%C2%A0+++++++++++%40Column%28name+%3D+%22initScore%22%29%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard0Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard1Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard2Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22soft0Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22soft1Score%22%29%7D%29%0A%C2%A0+++protected+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AAll+this+support+is+Hibernate+specific+because+currently+JPA+2.1%E2%80%99s+converters+do+not+support%0Aconverting+to+multiple+columns.%0A17.2.1.2.+JPA+and+Hibernate%3A+Planning+Cloning%0AIn+JPA+and+Hibernate%2C+there+is+usually+a+%40ManyToOne+relationship+from+most+problem+fact+classes+to%0Athe+planning+solution+class.+Therefore%2C+the+problem+fact+classes+reference+the+planning+solution%0Aclass%2C+which+implies+that+when+the+solution+is+planning+cloned%2C+they+need+to+be+cloned+too.+Use+an%0A%40DeepPlanningClone+on+each+such+problem+fact+class+to+enforce+that%3A%0A%40PlanningSolution+%2F%2F+OptaPlanner+annotation%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Conference+%7B%0A%C2%A0+++%40OneToMany%28mappedBy%3D%22conference%22%29%0A%C2%A0+++private+List%3CRoom%3E+roomList%3B%0A%C2%A0+++...%0A%7D%0A337%0A%40DeepPlanningClone+%2F%2F+OptaPlanner+annotation%3A+Force+the+default+planning+cloner+to%0Aplanning+clone+this+class+too%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Room+%7B%0A%C2%A0+++%40ManyToOne%0A%C2%A0+++private+Conference+conference%3B+%2F%2F+Because+of+this+reference%2C+this+problem+fact%0Aneeds+to+be+planning+cloned+too%0A%7D%0ANeglecting+to+do+this+can+lead+to+persisting+duplicate+solutions%2C+JPA+exceptions+or+other+side+effects.%0A17.2.2.+XML+or+JSON%3A+XStream%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+XStream+annotations+to+serialize%0Athem+to%2Ffrom+XML+or+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-xstream+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.2.1.+XStream%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to+XML+or+JSON+by+the+default+XStream+configuration%2C+it%E2%80%99s+verbose+and%0Augly.+To+fix+that%2C+configure+the+appropriate+ScoreXStreamConverter%3A%0A%40PlanningSolution%0A%40XStreamAlias%28%22CloudBalance%22%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XStreamConverter%28HardSoftScoreXStreamConverter.class%29%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+pretty+XML%3A%0A%3CCloudBalance%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E0hard%2F-200soft%3C%2Fscore%3E%0A%3C%2FCloudBalance%3E%0AThe+same+applies+for+a+bendable+score%3A%0A338%0A%40PlanningSolution%0A%40XStreamAlias%28%22Schedule%22%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XStreamConverter%28BendableScoreXStreamConverter.class%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate%3A%0A%3CSchedule%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%3C%2Fscore%3E%0A%3C%2FSchedule%3E%0AWhen+reading+a+bendable+score+from+an+XML+element%2C+the+implied+hardLevelsSize+and%0AsoftLevelsSize+must+always+be+in+sync+with+those+in+the+solver.%0A17.2.3.+XML+or+JSON%3A+JAXB%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+JAXB+annotations+to+serialize+them%0Ato%2Ffrom+XML+or+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-jaxb+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.3.1.+JAXB%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to+XML+or+JSON+by+the+default+JAXB+configuration%2C+it%E2%80%99s+corrupted.+To+fix%0Athat%2C+configure+the+appropriate+ScoreJaxbXmlAdapter%3A%0A%40PlanningSolution%0A%40XmlRootElement+%40XmlAccessorType%28XmlAccessType.FIELD%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XmlJavaTypeAdapter%28HardSoftScoreJaxbXmlAdapter.class%29%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+pretty+XML%3A%0A339%0A%3CcloudBalance%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E0hard%2F-200soft%3C%2Fscore%3E%0A%3C%2FcloudBalance%3E%0AThe+same+applies+for+a+bendable+score%3A%0A%40PlanningSolution%0A%40XmlRootElement+%40XmlAccessorType%28XmlAccessType.FIELD%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XmlJavaTypeAdapter%28BendableScoreJaxbXmlAdapter.class%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+with+a+hardLevelsSize+of+2+and+a+softLevelsSize+of+3%2C+that+will+generate%3A%0A%3Cschedule%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%3C%2Fscore%3E%0A%3C%2Fschedule%3E%0AThe+hardLevelsSize+and+softLevelsSize+implied%2C+when+reading+a+bendable+score+from+an+XML%0Aelement%2C+must+always+be+in+sync+with+those+in+the+solver.%0A17.2.4.+JSON%3A+Jackson%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+Jackson+annotations+to+serialize%0Athem+to%2Ffrom+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-jackson+jar+and+register%0AOptaPlannerJacksonModule%3A%0AObjectMapper+objectMapper+%3D+new+ObjectMapper%28%29%3B%0AobjectMapper.registerModule%28OptaPlannerJacksonModule.createModule%28%29%29%3B%0A17.2.4.1.+Jackson%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to%2Ffrom+JSON+by+the+default+Jackson+configuration%2C+it+fails.+The%0AOptaPlannerJacksonModule+fixes+that%2C+by+using+HardSoftScoreJacksonJsonSerializer%2C%0AHardSoftScoreJacksonJsonDeserializer%60%2C+etc.%0A340%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+this+JSON%3A%0A%7B%0A%C2%A0++%22score%22%3A%220hard%2F-200soft%22%0A%C2%A0++...%0A%7D%0AWhen+reading+a+BendableScore%2C+the+hardLevelsSize+and+softLevelsSize+implied+in%0Athe+JSON+element%2C+must+always+be+in+sync+with+those+defined+in+the+%40PlanningScore%0Aannotation+in+the+solution+class.+For+example%3A%0A%7B%0A%C2%A0++%22score%22%3A%22%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%22%0A%C2%A0++...%0A%7D%0AThis+JSON+implies+the+hardLevelsSize+is+2+and+thet+softLevelsSize+is+3%2C+which+must%0A%EF%81%9A+be+in+sync+with+the+%40PlanningScore+annotation%3A%0A%40PlanningSolution%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%28bendableHardLevelsSize+%3D+2%2C+bendableSoftLevelsSize+%3D%0A3%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AWhen+a+field+is+the+Score+supertype+%28instead+of+a+specific+type+such+as+HardSoftScore%29%2C+it+uses%0APolymorphicScoreJacksonJsonSerializer+and+PolymorphicScoreJacksonJsonDeserializer+to+record+the%0Ascore+type+in+JSON+too%2C+otherwise+it+would+be+impossible+to+deserialize+it%3A%0A341%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+Score+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+this+JSON%3A%0A%7B%0A%C2%A0++%22score%22%3A%7B%22HardSoftScore%22%3A%220hard%2F-200soft%22%7D%0A%C2%A0++...%0A%7D%0A17.3.+SOA+and+ESB%0A17.3.1.+Camel+and+Karaf%0ACamel+is+an+enterprise+integration+framework+which+includes+support+for+Planner+%28starting+from%0ACamel+2.13%29.+It+can+expose+a+use+case+as+a+REST+service%2C+a+SOAP+service%2C+a+JMS+service%2C+%E2%80%A6%0ARead+the+documentation+for+the+camel-optaplanner+component.+That+component+works+in+Karaf%0Atoo.%0A17.4.+Other+Environments%0A17.4.1.+JBoss+Modules%2C+WildFly+and+JBoss+EAP%0ABecause+of+JBoss+Modules%27+ClassLoader+magic%2C+provide+the+ClassLoader+of+your+classes+during+the%0ASolverFactory+creation%2C+so+it+can+find+the+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s%0Aand+domain+classes%29+in+your+jars.%0AIt%E2%80%99s+also+recommended+to+plug+in+WildFly%E2%80%99s+thread+factory%2C+especially+with+multithreaded+solving.%0A17.4.1.1.+Logging+on+WildFly+and+JBoss+EAP%0ATo+get+decent+logging+of+the+solver%28s%29%2C+create+a+file+src%2Fmain%2Fresources%2Fjboss-log4j.xml+%28so+it+ends+up%0Ain+the+war+as+WEB-INF%2Fclasses%2Fjboss-log4j.xml%29+with+this+content%3A%0A342%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Clog4j%3Aconfiguration+xmlns%3Alog4j%3D%22http%3A%2F%2Fjakarta.apache.org%2Flog4j%2F%22+debug%3D%22false%22%3E%0A%C2%A0+%3Cappender+name%3D%22consoleAppender%22+class%3D%22org.apache.log4j.ConsoleAppender%22%3E%0A%C2%A0+++%3Clayout+class%3D%22org.apache.log4j.PatternLayout%22%3E%0A%C2%A0+++++%3Cparam+name%3D%22ConversionPattern%22+value%3D%22%25d%7BHH%3Amm%3Ass.SSS%7D+%25-5p+%5B%25t%5D+%25m%25n%22%2F%3E%0A%C2%A0+++%3C%2Flayout%3E%0A%C2%A0+%3C%2Fappender%3E%0A%C2%A0+%3Clogger+name%3D%22org.optaplanner%22%3E%0A%C2%A0+++%3Clevel+value%3D%22debug%22%2F%3E%0A%C2%A0+%3C%2Flogger%3E%0A%C2%A0+%3Croot%3E%0A%C2%A0+++%3Clevel+value%3D%22warn%22+%2F%3E%0A%C2%A0+++%3Cappender-ref+ref%3D%22consoleAppender%22%2F%3E%0A%C2%A0+%3C%2Froot%3E%0A%3C%2Flog4j%3Aconfiguration%3E%0A17.4.1.2.+Skinny+war+on+WildFly+and+JBoss+EAP%0ATo+deploy+an+Planner+web+application+on+WildFly%2C+simply+include+the+optaplanner+dependency+jars%0Ain+the+war+file%E2%80%99s+WEB-INF%2Flib+directory+%28just+like+any+other+dependency%29+as+shown+in+the+optaplanner-%0Awebexamples-*.war.+However%2C+in+this+approach+the+war+file+can+easily+grow+to+several+MB+in+size%2C%0Awhich+is+fine+for+a+one-time+deployment%2C+but+too+heavyweight+for+frequent+redeployments%0A%28especially+over+a+slow+network+connection%29.%0AThe+remedy+is+to+use+deliver+the+optaplanner+jars+in+a+JBoss+module+to+WildFly+and+create+a+skinny%0Awar.+Let%E2%80%99s+create+an+module+called+org.optaplanner%3A%0A1.+Navigate+to+the+directory+%24%7BWILDFLY_HOME%7D%2Fmodules%2Fsystem%2Flayers%2Fbase%2F.+This+directory+contains%0Athe+JBoss+modules+of+WildFly.+Create+directory+structure+org%2Foptaplanner%2Fmain+for+our+new%0Amodule.%0Aa.+Copy+optaplanner-core-%24%7Bversion%7D.jar+and+all+its+direct+and+transitive+dependency+jars+into%0Athat+new+directory.+Use+%22mvn+dependency%3Atree%22+on+each+optaplanner+artifact+to+discover+all%0Adependencies.%0Ab.+Create+the+file+module.xml+in+that+new+directory.+Give+it+this+content%3A%0A343%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Cmodule+xmlns%3D%22urn%3Ajboss%3Amodule%3A1.3%22+name%3D%22org.optaplanner%22%3E%0A%C2%A0+%3Cresources%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22kie-api-%24%7Bversion%7D.jar%22%2F%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22optaplanner-core-%24%7Bversion%7D.jar%22%2F%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22.%22%2F%3E%0A%C2%A0+%3C%2Fresources%3E%0A%C2%A0+%3Cdependencies%3E%0A%C2%A0+++%3Cmodule+name%3D%22javaee.api%22%2F%3E%0A%C2%A0+%3C%2Fdependencies%3E%0A%3C%2Fmodule%3E%0A2.+Navigate+to+the+deployed+war+file.%0Aa.+Remove+optaplanner-core-%24%7Bversion%7D.jar+and+all+its+direct+and+transitive+dependency+jars%0Afrom+the+WEB-INF%2Flib+directory+in+the+war+file.%0Ab.+Create+the+file+jboss-deployment-structure.xml+in+the+WEB-INF%2Flib+directory.+Give+it+this%0Acontent%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22+%3F%3E%0A%3Cjboss-deployment-structure%3E%0A%C2%A0++%3Cdeployment%3E%0A%C2%A0+++++%3Cdependencies%3E%0A%C2%A0++++++++%3Cmodule+name%3D%22org.optaplanner%22+export%3D%22true%22%2F%3E%0A%C2%A0+++++%3C%2Fdependencies%3E%0A%C2%A0++%3C%2Fdeployment%3E%0A%3C%2Fjboss-deployment-structure%3E%0A17.4.2.+Spring+Boot%0ANormally+Planner+just+works+on+Spring+Boot%2C+simply+add+the+optaplanner-core+dependency.+If+it+has%0Atrouble+finding+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s+and+domain+classes%29%2C%0Aprovide+the+ClassLoader+of+your+classes+during+the+SolverFactory+creation.%0A17.4.3.+Java+Platform+Module+System+%28Jigsaw%29%0AWhen+using+Planner+from+code+on+the+modulepath+%28Java+9+and+higher%29%2C+open+your+packages+that%0Acontain+your+domain+objects%2C+DRL+files+and+solver+configuration+in+your+module-info.java+file%3A%0A344%0Amodule+org.optaplanner.cloudbalancing+%7B%0A%C2%A0+++requires+org.optaplanner.core%3B%0A%C2%A0+++...%0A%C2%A0+++opens+org.optaplanner.examples.cloudbalancing.domain%3B+%2F%2F+Domain+classes%0A%C2%A0+++opens+org.optaplanner.examples.cloudbalancing.solver%3B+%2F%2F+DRL+file+and+solver%0Aconfiguration%0A%C2%A0+++...%0A%7D%0AOtherwise+Planner+can%E2%80%99t+reach+those+classes+or+files%2C+even+if+they+are+exported.%0A17.4.4.+OSGi%0AThe+optaplanner-core+jar+includes+OSGi+metadata+in+its+MANIFEST.MF+file+to+function+properly+in+an%0AOSGi+environment+too.+Furthermore%2C+the+maven+artifact+kie-karaf-features+contains+a+features.xml%0Afile+that+supports+the+OSGi-feature+optaplanner-engine.%0ABecause+of+the+OSGi%E2%80%99s+ClassLoader+magic%2C+provide+the+ClassLoader+of+your+classes+during+the%0ASolverFactory+creation%2C+so+it+can+find+the+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s%0Aand+domain+classes%29+in+your+jars.%0APlanner+does+not+require+OSGi.+It+works+perfectly+fine+in+a+normal+Java%0A%EF%81%9A+environment+too.%0A17.4.5.+Android%0AAndroid+is+not+a+complete+JVM+%28because+some+JDK+libraries+are+missing%29%2C+but+Planner+works+on%0AAndroid+with+easy+Java+or+incremental+Java+score+calculation.+The+Drools+rule+engine+does+not+work%0Aon+Android+yet%2C+so+Drools+score+calculation+doesn%E2%80%99t+work+on+Android+and+its+dependencies+need+to%0Abe+excluded.%0AWorkaround+to+use+Planner+on+Android%3A%0A1.+Add+a+dependency+to+the+build.gradle+file+in+your+Android+project+to+exclude+org.drools+and%0Axmlpull+dependencies%3A%0Adependencies+%7B%0A%C2%A0+++...%0A%C2%A0+++compile%28%27org.optaplanner%3Aoptaplanner-core%3A...%27%29+%7B%0A%C2%A0+++++++exclude+group%3A+%27xmlpull%27%0A%C2%A0+++++++exclude+group%3A+%27org.drools%27%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A345%0A17.5.+Integration+with+Human+Planners+%28Politics%29%0AA+good+Planner+implementation+beats+any+good+human+planner+for+non-trivial+datasets.+Many%0Ahuman+planners+fail+to+accept+this%2C+often+because+they+feel+threatened+by+an+automated+system.%0ABut+despite+that%2C+both+can+benefit+if+the+human+planner+becomes+the+supervisor+of+Planner%3A%0A%E2%80%A2+The+human+planner+defines%2C+validates+and+tweaks+the+score+function.%0A%E2%97%A6+Some+examples+expose+a+Parametrization+object%2C+which+defines+the+weight+for+each+score%0Aconstraint.+The+human+planner+can+then+tweak+those+weights+at+runtime.%0A%E2%97%A6+When+the+business+changes%2C+the+score+function+often+needs+to+change+too.+The+human%0Aplanner+can+notify+the+developers+to+add%2C+change+or+remove+score+constraints.%0A%E2%80%A2+The+human+planner+is+always+in+control+of+Planner.%0A%E2%97%A6+As+shown+in+the+course+scheduling+example%2C+the+human+planner+can+pin+down+one+or+more%0Aplanning+variables+to+a+specific+planning+value.+Because+they+are+immovable%2C+Planner+does%0Anot+change+them%3A+it+optimizes+the+planning+around+the+enforcements+made+by+the+human.+If%0Athe+human+planner+pins+down+all+planning+variables%2C+he%2Fshe+sidelines+Planner+completely.%0A%E2%97%A6+In+a+prototype+implementation%2C+the+human+planner+occasionally+uses+pinning+to+intervene%2C%0Abut+as+the+implementation+matures%2C+this+should+become+obsolete.+The+feature+should+be+kept%0Aavailable+as+a+reassurance+for+the+humans%2C+and+in+the+event+that+the+business+changes%0Adramatically+before+the+score+constraints+are+adjusted+accordingly.%0AFor+this+reason%2C+it+is+recommended+the+human+planner+is+actively+involved+in+your+project.%0A346%0A347%0A17.6.+Sizing+Hardware+and+Software%0ABefore+sizing+a+Planner+service%2C+first+understand+the+typical+behaviour+of+a+Solver.solve%28%29+call%3A%0AUnderstand+these+guidelines+to+decide+the+hardware+for+a+Planner+service%3A%0A%E2%80%A2+RAM+memory%3A+Provision+plenty%2C+but+no+need+to+provide+more.%0A%E2%97%A6+The+problem+dataset%2C+loaded+before+Planner+is+called%2C+often+consumes+the+most+memory.+It%0Adepends+on+the+problem+scale.%0A%E2%96%AA+For+example%2C+in+the+Machine+Reassignment+example+some+datasets+use+over+1GB+in%0Amemory.+But+in+most+examples%2C+they+use+just+a+few+MB.%0A%E2%96%AA+If+this+is+a+problem%2C+review+the+domain+class+structure%3A+remove+classes+or+fields+that%0APlanner+doesn%E2%80%99t+need+during+solving.%0A%E2%96%AA+Planner+usually+has+up+to+three+solution+instances%3A+the+internal+working+solution%2C+the%0Abest+solution+and+the+old+best+solution+%28when+it%E2%80%99s+being+replaced%29.+However%2C+these+are+all%0Aa+planning+clone+of+each+other%2C+so+many+problem+fact+instances+are+shared+between%0Athose+solution+instances.%0A%E2%97%A6+During+solving%2C+the+memory+is+very+volatile%2C+because+solving+creates+many+short-lived%0Aobjects.+The+Garbage+Collector+deletes+these+in+bulk+and+therefore+needs+some+heap+space+as%0Aa+buffer.%0A%E2%97%A6+The+maximum+size+of+the+JVM+heap+space+can+be+in+three+states%3A%0A348%0A%E2%96%AA+Insufficient%3A+An+OutOfMemoryException+is+thrown+%28often+because+the+Garbage+Collector+is%0Ausing+more+than+98%25+of+the+CPU+time%29.%0A%E2%96%AA+Narrow%3A+The+heap+buffer+for+those+short-lived+instances+is+too+small%2C+therefore+the%0AGarbage+Collector+needs+to+run+more+than+it+would+like+to%2C+which+causes+a+performance%0Aloss.%0A%E2%96%AA+Profiling+shows+that+in+the+heap+chart%2C+the+used+heap+space+frequently+touches+the%0Amax+heap+space+during+solving.+It+also+shows+that+the+Garbage+Collector+has+a%0Asignificant+CPU+usage+impact.%0A%E2%96%AA+Adding+more+heap+space+increases+the+score+calculation+speed.%0A%E2%96%AA+Plenty%3A+There+is+enough+heap+space.+The+Garbage+Collector+is+active%2C+but+its+CPU+usage+is%0Alow.%0A%E2%96%AA+Adding+more+heap+space+does+not+increase+performance.%0A%E2%96%AA+Usually%2C+this+is+around+300+to+500MB+above+the+dataset+size%2C+regardless+of+the+problem%0Ascale+%28except+with+nearby+selection+and+caching+move+selector%2C+neither+are+used+by%0Adefault%29.%0A%E2%80%A2+CPU+power%3A+More+is+better.%0A%E2%97%A6+Improving+CPU+speed+directly+increases+the+score+calculation+speed.%0A%E2%96%AA+If+the+CPU+power+is+twice+as+fast%2C+it+takes+half+the+time+to+find+the+same+result.+However%2C%0Athis+does+not+guarantee+that+it+finds+a+better+result+in+the+same+time%2C+nor+that+it+finds+a%0Asimilar+result+for+a+problem+twice+as+a+big+in+the+same+time.%0A%E2%96%AA+Increasing+CPU+power+usually+does+not+resolve+scaling+issues%2C+because+planning%0Aproblems+scale+exponentially.+Power+tweaking+the+solver+configuration+has+far+better%0Aresults+for+scaling+issues+than+throwing+hardware+at+it.%0A%E2%97%A6+During+the+solve%28%29+method%2C+the+CPU+power+will+max+out+until+it+returns+%28except+in+daemon%0Amode+or+if+your+SolverEventListener+writes+the+best+solution+to+disk+or+the+network%29.%0A%E2%80%A2+Number+of+CPU+cores%3A+one+CPU+core+per+active+Solver%2C+plus+at+least+one+one+for+the+operating%0Asystem.%0A%E2%97%A6+So+in+a+multitenant+application%2C+which+has+one+Solver+per+tenant%2C+this+means+one+CPU+core%0Aper+tenant%2C+unless+the+number+of+solver+threads+is+limited%2C+as+that+limits+the+number+of%0Atenants+being+solved+in+parallel.%0A%E2%97%A6+With+Partitioned+Search%2C+presume+one+CPU+core+per+partition+%28per+active+tenant%29%2C+unless+the%0Anumber+of+partition+threads+is+limited.%0A%E2%96%AA+To+reduce+the+number+of+used+cores%2C+it+can+be+better+to+reduce+the+partition+threads+%28so%0Asolve+some+partitions+sequentially%29+than+to+reduce+the+number+of+partitions.%0A%E2%97%A6+In+use+cases+with+many+tenants+%28such+as+scheduling+Software+as+a+Service%29+or+many%0Apartitions%2C+it+might+not+be+affordable+to+provision+that+many+CPUs.%0A%E2%96%AA+Reduce+the+number+of+active+Solvers+at+a+time.+For+example%3A+give+each+tenant+only+one%0Aminute+of+machine+time+and+use+a+ExecutorService+with+a+fixed+thread+pool+to+queue%0Arequests.%0A%E2%96%AA+Distribute+the+Solver+runs+across+the+day+%28or+night%29.+This+is+especially+an+opportunity+in%0ASaaS+that%E2%80%99s+used+across+the+globe%2C+due+to+timezones%3A+UK+and+India+can+use+the+same+CPU%0A349%0Acore+when+scheduling+at+night.%0A%E2%97%A6+The+SolverManager+will+take+care+of+the+orchestration%2C+especially+in+those+underfunded%0Aenvironments+in+which+solvers+%28and+partitions%29+are+forced+to+share+CPU+cores+or+wait+in+line.%0A%E2%80%A2+I%2FO+%28network%2C+disk%2C+%E2%80%A6%29%3A+Not+used+during+solving.%0A%E2%97%A6+Planner+is+not+a+web+server%3A+a+solver+thread+does+not+block+%28unlike+a+servlet+thread%29%2C+each%0Aone+fully+drains+a+CPU.%0A%E2%96%AA+A+web+server+can+handle+24+active+servlets+threads+with+eight+cores+without%0Aperformance+loss%2C+because+most+servlets+threads+are+blocking+on+I%2FO.%0A%E2%96%AA+However%2C+24+active+solver+threads+with+eight+cores+will+cause+each+solver%E2%80%99s+score%0Acalculation+speed+to+be+three+times+slower%2C+causing+a+big+performance+loss.%0A%E2%97%A6+Note+that+calling+any+I%2FO+during+solving%2C+for+example+a+remote+service+in+your+score%0Acalculation%2C+causes+a+huge+performance+loss+because+it%E2%80%99s+called+thousands+of+times+per%0Asecond%2C+so+it+should+complete+in+microseconds.+So+no+good+implementation+does+that.%0AKeep+these+guidelines+in+mind+when+selecting+and+configuring+the+software.+See+our+blog+archive%0Afor+the+details+of+our+experiments%2C+which+use+our+diverse+set+of+examples.+Your+mileage+may+vary.%0A%E2%80%A2+Operating+System%0A%E2%97%A6+No+experimentally+proven+advice+yet+%28but+prefer+Linux+anyway%29.%0A%E2%80%A2+JDK%0A%E2%97%A6+Version%3A+Java+7+can+be+between+10%25+and+25%25+faster+than+Java+6.+But+Java+8+however+is%0Ausually+not+significantly+faster+than+Java+7.%0A%E2%97%A6+Garbage+Collector%3A+ParallelGC+%28the+default+in+Java+8%29+can+be+potentially+between+5%25+and+35%25%0Afaster+than+G1GC+%28the+default+in+Java+9%29.+Unlike+web+servers%2C+Planner+needs+a+GC+focused+on%0Athroughput%2C+not+latency.+Use+-XX%3A%2BUseParallelGC+to+turn+on+ParallelGC.%0A%E2%80%A2+Logging+can+have+a+severe+impact+on+performance.%0A%E2%97%A6+Debug+logging+org.drools+can+reduce+performance+by+a+factor+of+7.%0A%E2%97%A6+Debug+logging+org.optaplanner+can+be+between+0%25+and+15%25+slower+than+info+logging.+Trace%0Alogging+can+be+between+5%25+and+70%25+slower+than+info+logging.%0A%E2%97%A6+Synchronous+logging+to+a+file+has+an+additional+significant+impact+for+debug+and+trace%0Alogging+%28but+not+for+info+logging%29.%0A%E2%80%A2+Avoid+a+cloud+environment+in+which+you+share+your+CPU+core%28s%29+with+other+virtual+machines+or%0Acontainers.+Performance+%28and+therefore+solution+quality%29+can+be+unreliable+when+the+available%0ACPU+power+varies+greatly.%0AKeep+in+mind+that+the+perfect+hardware%2Fsoftware+environment+will+probably+not+solve+scaling%0Aissues+%28even+Moore%E2%80%99s+law+is+too+slow%29.+There+is+no+need+to+follow+these+guidelines+to+the+letter.%0A350%0AChapter+18.+Design+Patterns%0A18.1.+Design+Patterns+Introduction%0AThese+design+patterns+list+and+solve+common+design+challenges.%0A18.2.+Domain+Modeling+Guide%0AA+good+model+can+greatly+improve+the+success+of+your+planning+implementation.+These+guidelines%0Ahelp+to+design+a+good+model%3A%0A1.+Draw+a+class+diagram+of+your+domain+model.+Normalize+it+get+rid+of+duplicate+data.%0A%E2%97%A6+Write+down+some+sample+instances+for+each+class.%0A%E2%96%AA+For+example+in+employee+rostering%2C+the+samples+for+the+Employee+class+are+Ann%2C+Bert+and%0ACarl.%0A2.+Determine+which+relationships+%28or+fields%29+change+during+planning.+Color+them+orange.+Often%0Athere+is+only+one+such+relationship+%28or+field%29.+One+side+of+these+relationships+will+become+a%0Aplanning+variable+later+on.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+Shift+to+Employee+relationship+changes+during%0Aplanning%2C+so+it+is+orange.+Other+relationships%2C+such+as+from+Employee+to+Skill%2C+are+immutable%0Aduring+planning+because+Planner+can%E2%80%99t+decide+to+give+an+employee+an+extra+skill.%0A3.+If+there+are+multiple+relationships+%28or+fields%29%3A+check+for+shadow+variables.+A+shadow+variable%0Adoes+change+during+planning%2C+but+its+value+can+be+calculated+based+on+one+or+more+genuine%0Aplanning+variables%2C+without+dispute.+Color+those+shadow+relationships+%28or+fields%29+purple.%0A%E2%97%A6+Only+one+side+of+a+bi-directional+relationship+can+be+a+genuine+planning+variable%2C+the+other%0Aside+will+become+an+inverse+relation+shadow+variable+later+on.+Keep+those+relationships+in%0Aorange.%0A4.+Check+for+chained+planning+variables.+In+a+chained+variable+design%2C+the+focus+lies+on+deciding%0Athe+order+of+a+set+planning+entity+instances%2C+instead+of+assigning+them+to+a+date%2Ftime+%28although%0Athere+can+be+an+assigned+date%2Ftime+as+a+shadow+variable%29.+A+typical+use+case+is+vehicle+routing.%0A5.+If+there+is+an+orange+many+to+many+relationship%2C+replace+that+many+to+many+relationship+with%0Aa+one+to+many+and+a+many+to+one+relationship+to+a+new+intermediate+class.%0A%E2%97%A6+Planner+currently+doesn%E2%80%99t+support+a+%40PlanningVariable+on+a+collection.+Although+a+future%0Aversion+will+support+it+for+flexibility+reasons%2C+it+probably+has+an+inherit+performance+and%0Acomplexity+cost%2C+so+it+might+be+better+to+avoid+it+anyway.%0A%E2%97%A6+For+example+in+employee+rostering+the+ShiftAssignment+class+is+the+many+to+many%0Arelationship+between+the+Shift+and+Employee.+It%E2%80%99s+effectively+every+spot+that+needs+to+be+filled%0Awith+an+employee.%0A351%0A6.+In+a+many+to+one+relationship%2C+usually+the+many+side+is+the+planning+entity+class+with+the%0Aplanning+variable.+Annotate+it+with+a+%40PlanningEntity+annotation.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+has+an+%40PlanningEntity%0Aannotation.%0A%E2%97%A6+If+it%E2%80%99s+a+bi-directional+relationship%2C+both+sides+are+a+planning+entity+class%2C+but+usually+the%0Amany+side+has+the+planning+variable+and+the+one+side+the+shadow+variable.%0A7.+The+planning+entity+class+should+have+at+least+one+problem+property.+So+a+planning+entity%0Aclass+cannot+consist+out+of+only+planning+variables+%28or+even+an+id+and+only+planning+variables%29.%0ARemove+a+surplus+%40PlanningVariable+so+it+becomes+a+problem+property.+This+heavily+decreases%0Athe+search+space+size+and+heavily+increases+solving+efficiency.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+should+not+annotate+both+the%0Ashift+and+employee+relationship+with+%40PlanningVariable.%0A%E2%97%A6+When+all+planning+variables+are+null+%28which+occurs+when+the+planning+solution+is+still%0Auninitialized%29%2C+a+planning+entity+instance+should+still+be+describable+to+the+business+people.%0A%E2%96%AA+So+a+surrogate+ID+does+not+suffice+as+the+required+minimum+of+one+problem+property.%0A%E2%97%A6+This+way%2C+there+is+no+need+to+add+a+hard+constraint+to+assure+that+two+planning+entities+are%0Adifferent%3A+they+are+already+different+due+to+their+problem+properties.%0A%E2%97%A6+In+some+cases%2C+multiple+planning+entity+instances+have+the+same+set+of+problem+properties.%0AIn+such+cases%2C+it+can+be+useful+to+create+an+extra+problem+property+to+distinguish+them.%0A%E2%96%AA+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+has+besides+the+problem%0Aproperty+Shift+also+the+problem+property+indexInShift+%28which+is+an+int%29.%0A352%0A8.+Choose+the+model+in+which+the+number+of+planning+entities+is+fixed+during+planning.%0A%E2%97%A6+For+example+in+employee+rostering%2C+it%E2%80%99s+impossible+to+know+in+advance+how+many+shifts%0Aeach+employee+will+have+before+Planner+solves+it+%28and+it+can+even+differ+per+best+solution%0Afound%29.+On+the+other+hand%2C+the+number+of+employees+per+shift+is+known+in+advance%2C+so+it%E2%80%99s%0Abetter+to+make+the+Shift+relationship+a+problem+property+and+the+Employee+relationship+a%0Aplanning+variable.%0AFor+inspiration%2C+take+a+look+at+how+the+examples+modeled+their+domain%3A%0A353%0A%EF%81%9A+Vehicle+routing+is+special%2C+because+it+uses+a+chained+planning+variable.%0A18.3.+Assigning+Time+to+Planning+Entities%0ADealing+with+time+and+dates+in+planning+problems+may+be+problematic+because+it+is+dependent+on%0Athe+needs+of+your+use+case.%0AThere+are+several+representations+of+timestamps%2C+dates%2C+durations+and+periods+in+Java.+Choose+the%0Aright+representation+type+for+your+use+case%3A%0A%E2%80%A2+java.util.Date+%28deprecated%29%3A+a+slow%2C+error-prone+way+to+represent+timestamps.+Do+not+use.%0A%E2%80%A2+java.time.LocalDateTime%2C+LocalDate%2C+DayOfWeek%2C+Duration%2C+Period%2C+%E2%80%A6%3A+an+accurate+way+to+represent%0Aand+calculate+with+timestamps%2C+dates%2C+%E2%80%A6%0A%E2%97%A6+Supports+timezones+and+DST+%28Daylight+Saving+Time%29.%0A%E2%97%A6+Requires+Java+8+or+higher.%0A%E2%80%A2+int+or+long%3A+Caches+a+timestamp+as+a+simplified+number+of+coarse-grained+time+units+%28such+as%0Aminutes%29+from+the+start+of+the+global+planning+time+window+or+the+epoch.%0A%E2%97%A6+For+example%3A+a+LocalDateTime+of+1-JAN+08%3A00%3A00+becomes+an+int+of+400+minutes.+Similarly+1-%0AJAN+09%3A00%3A00+becomes+460+minutes.%0A%E2%97%A6+It+often+represents+an+extra+field+in+a+class%2C+alongside+the+LocalDateTime+field+from+which+it%0A354%0Awas+calculated.+The+LocalDateTime+is+used+for+user+visualization%2C+but+the+int+is+used+in+the%0Ascore+constraints.%0A%E2%97%A6+It+is+faster+in+calculations%2C+which+is+especially+useful+in+the+TimeGrain+pattern.%0A%E2%97%A6+Do+not+use+if+timezones+or+DST+affect+the+score+constraints.%0AThere+are+also+several+designs+for+assigning+a+planning+entity+to+a+starting+time+%28or+date%29%3A%0A%E2%80%A2+The+starting+time+is+fixed+beforehand.+It+is+not+a+planning+variable+%28in+such+solver%29.%0A%E2%97%A6+For+example%2C+in+the+hospital+bed+planning+example%2C+the+arrival+day+of+each+patient+is+fixed%0Abeforehand.%0A%E2%97%A6+This+is+common+in+multi+stage+planning%2C+when+the+starting+time+has+been+decided+already+in%0Aan+earlier+planning+stage.%0A%E2%80%A2+The+starting+time+is+not+fixed%2C+it+is+a+planning+variable+%28genuine+or+shadow%29.%0A%E2%97%A6+If+all+planning+entities+have+the+same+duration%2C+use+the+Timeslot+pattern.%0A%E2%96%AA+For+example+in+course+scheduling%2C+all+lectures+take+one+hour.+Therefore%2C+each+timeslot+is%0Aone+hour.%0A%E2%97%A6+If+the+duration+differs+and+time+is+rounded+to+a+specifc+time+granularity+%28for+example+5%0Aminutes%29+use+the+TimeGrain+pattern.%0A%E2%96%AA+For+example+in+meeting+scheduling%2C+all+meetings+start+at+15+minute+intervals.+All%0Ameetings+take+15%2C+30%2C+45%2C+60%2C+90+or+120+minutes.%0A%E2%97%A6+If+the+duration+differs+and+one+task+starts+immediately+after+the+previous+task+%28assigned+to%0Athe+same+executor%29+finishes%2C+use+the+Chained+Through+Time+pattern.%0A%E2%96%AA+For+example+in+time+windowed+vehicle+routing%2C+each+vehicle+departs+immediately+to+the%0Anext+customer+when+the+delivery+for+the+previous+customer+finishes.%0AChoose+the+right+pattern+depending+on+the+use+case%3A%0A355%0A18.3.1.+Timeslot+Pattern%3A+Assign+to+a+Fixed-Length+Timeslot%0AIf+all+planning+entities+have+the+same+duration+%28or+can+be+inflated+to+the+same+duration%29%2C+the%0ATimeslot+pattern+is+useful.+The+planning+entities+are+assigned+to+a+timeslot+rather+than+time.+For%0Aexample+in+course+timetabling%2C+all+lectures+take+one+hour.%0AThe+timeslots+can+start+at+any+time.+For+example%2C+the+timeslots+start+at+8%3A00%2C+9%3A00%2C+10%3A15+%28after+a+15-%0Aminute+break%29%2C+11%3A15%2C+%E2%80%A6+They+can+even+overlap%2C+but+that+is+unusual.%0AIt+is+also+usable+if+all+planning+entities+can+be+inflated+to+the+same+duration.+For+example+in+exam%0Atimetabling%2C+some+exams+take+90+minutes+and+others+120+minutes%2C+but+all+timeslots+are+120+minutes.%0AWhen+an+exam+of+90+minutes+is+assigned+to+a+timeslot%2C+for+the+remaining+30+minutes%2C+its+seats+are%0Aoccupied+too+and+cannot+be+used+by+another+exam.%0AUsually+there+is+a+second+planning+variable%2C+for+example+the+room.+In+course+timetabling%2C+two%0Alectures+are+in+conflict+if+they+share+the+same+room+at+the+same+timeslot.+However%2C+in+exam%0Atimetabling%2C+that+is+allowed%2C+if+there+is+enough+seating+capacity+in+the+room+%28although+mixed+exam%0Adurations+in+the+same+room+do+inflict+a+soft+score+penalty%29.%0A18.3.2.+TimeGrain+Pattern%3A+Assign+to+a+Starting+TimeGrain%0AAssigning+humans+to+start+a+meeting+at+four+seconds+after+9+o%E2%80%99clock+is+pointless+because+most%0Ahuman+activities+have+a+time+granularity+of+five+minutes+or+15+minutes.+Therefore+it+is+not%0Anecessary+to+allow+a+planning+entity+to+be+assigned+subsecond%2C+second+or+even+one+minute+accuracy.%0A356%0AThe+five+minute+or+15+minutes+accuracy+suffices.+The+TimeGrain+pattern+models+such+time%0Aaccuracy+by+partitioning+time+as+time+grains.+For+example+in+meeting+scheduling%2C+all+meetings%0Astart%2Fend+in+hour%2C+half+hour%2C+or+15-minute+intervals+before+or+after+each+hour%2C+therefore+the+optimal%0Asettings+for+time+grains+is+15+minutes.%0AEach+planning+entity+is+assigned+to+a+start+time+grain.+The+end+time+grain+is+calculated+by+adding+the%0Aduration+in+grains+to+the+starting+time+grain.+Overlap+of+two+entities+is+determined+by+comparing%0Atheir+start+and+end+time+grains.%0AThis+pattern+also+works+well+with+a+coarser+time+granularity+%28such+as+days%2C+half+days%2C+hours%2C+%E2%80%A6%29.%0AWith+a+finer+time+granularity+%28such+as+seconds%2C+milliseconds%2C+%E2%80%A6%29+and+a+long+time+window%2C+the+value%0Arange+%28and+therefore+the+search+space%29+can+become+too+high%2C+which+reduces+efficiency+and%0Ascalability.+However%2C+such+solution+is+not+impossible%2C+as+shown+in+cheap+time+scheduling.%0A18.3.3.+Chained+Through+Time+Pattern%3A+Assign+in+a+Chain+that+Determines%0AStarting+Time%0AIf+a+person+or+a+machine+continuously+works+on+one+task+at+a+time+in+sequence%2C+which+means%0Astarting+a+task+when+the+previous+is+finished+%28or+with+a+deterministic+delay%29%2C+the+Chained+Through%0ATime+pattern+is+useful.+For+example%2C+in+the+vehicle+routing+with+time+windows+example%2C+a+vehicle%0Adrives+from+customer+to+customer+%28thus+it+handles+one+customer+at+a+time%29.%0AIn+this+pattern%2C+the+planning+entities+are+chained.+The+anchor+determines+the+starting+time+of+its%0Afirst+planning+entity.+The+second+entity%E2%80%99s+starting+time+is+calculated+based+on+the+starting+time+and%0Aduration+of+the+first+entity.+For+example%2C+in+task+assignment%2C+Beth+%28the+anchor%29+starts+working+at%0A8%3A00%2C+thus+her+first+task+starts+at+8%3A00.+It+lasts+52+mins%2C+therefore+her+second+task+starts+at+8%3A52.+The%0Astarting+time+of+an+entity+is+usually+a+shadow+variable.%0AAn+anchor+has+only+one+chain.+Although+it+is+possible+to+split+up+the+anchor+into+two+separate%0Aanchors%2C+for+example+split+up+Beth+into+Beth%E2%80%99s+left+hand+and+Beth%E2%80%99s+right+hand+%28because+she+can+do%0Atwo+tasks+at+the+same+time%29%2C+this+model+makes+pooling+resources+difficult.+Consequently%2C+using+this%0Amodel+in+the+exam+scheduling+example+to+allow+two+or+more+exams+to+use+the+same+room+at+the%0Asame+time+is+problematic.%0ABetween+planning+entities%2C+there+are+three+ways+to+create+gaps%3A%0A%E2%80%A2+No+gaps%3A+This+is+common+when+the+anchor+is+a+machine.+For+example%2C+a+build+server+always%0Astarts+the+next+job+when+the+previous+finishes%2C+without+a+break.%0A%E2%80%A2+Only+deterministic+gaps%3A+This+is+common+for+humans.+For+example%2C+any+task+that+crosses+the%0A10%3A00+barrier+gets+an+extra+15+minutes+duration+so+the+human+can+take+a+break.%0A%E2%97%A6+A+deterministic+gap+can+be+subjected+to+complex+business+logic.+For+example+in+vehicle%0Arouting%2C+a+cross-continent+truck+driver+needs+to+rest+15+minutes+after+two+hours+of+driving%0A%28which+may+also+occur+during+loading+or+unloading+time+at+a+customer+location%29+and+also%0Aneeds+to+rest+10+hours+after+14+hours+of+work.%0A%E2%80%A2+Planning+variable+gaps%3A+This+is+uncommon%2C+because+an+extra+planning+variable+%28which+impacts%0Athe+search+space%29+reduces+efficiency+and+scalability.%0A357%0A18.4.+Multi-stage+planning%0AFor+practical+or+organizational+reasons+%28such+as+Conway%E2%80%99s+law%29%2C+complex+planning+problems+are%0Aoften+broken+down+in+multiple+stages.+A+typical+example+is+train+scheduling%2C+where+one+department%0Adecides+where+and+when+a+train+will+arrive+or+depart%2C+and+another+departments+assigns+the%0Aoperators+to+the+actual+train+cars%2Flocomotives.%0AEach+stage+has+its+own+solver+configuration+%28and+therefore+its+own+SolverFactory%29.+Do+not+confuse+it%0Awith+multi-phase+solving+which+uses+a+one-solver+configuration.%0ASimilarly+to+Partitioned+Search%2C+multi-stage+planning+leads+to+suboptimal+results.+Nevertheless%2C+it%0Amay+be+beneficial+in+order+to+simplify+the+maintenance%2C+ownership%2C+and+help+to+start+a+project.%0A358%0AChapter+19.+Development%0A19.1.+Methodology+Overview%0AThe+diagram+below+explains+the+overall+structure+of+the+OptaPlanner+source+code%3A%0AIn+the+diagram+above%2C+it%E2%80%99s+important+to+understand+the+clear+separation+between+the+configuration%0Aand+runtime+classes.%0AThe+development+philosophy+includes%3A%0A%E2%80%A2+Reuse%3A+The+examples+are+reused+as+integration+tests%2C+stress+tests+and+demo%E2%80%99s.+The+documentation%0Aimages+are+reused+as+slides.%0A%E2%80%A2+Consistent+terminology%3A+Each+example+has+a+class+App+%28executable+class%29+and+Panel+%28swing+UI%29.%0A%E2%80%A2+Consistent+structure%3A+Each+example+has+the+same+packages%3A+domain%2C+persistence%2C+app%2C+solver+and%0Aswingui.%0A%E2%80%A2+Real+world+usefulness%3A+Every+feature+is+used+in+an+example.+Most+examples+are+real+world+use%0Acases+with+real+world+constraints%2C+often+with+real+world+data.%0A%E2%80%A2+Automated+testing%3A+There+are+unit+tests%2C+integration+tests%2C+performance+regressions+tests+and%0Astress+tests.+The+test+coverage+is+high.%0A%E2%80%A2+Fail+fast+with+an+understandable+error+message%3A+Invalid+states+are+checked+as+early+as%0A359%0Apossible.%0A19.2.+Development+guidelines%0A1.+Fail+fast.+There+are+several+levels+of+fail+fast%2C+from+better+to+worse%3A%0Aa.+Fail+Fast+at+compile+time.+For+example%3A+Don%E2%80%99t+accept+an+Object+as+parameter+if+it+needs+to+be%0Aa+String+or+an+Integer.%0Ab.+Fail+Fast+at+startup+time.+For+example%3A+if+the+configuration+parameter+needs+to+be+a+positive%0Aint+and+it%E2%80%99s+negative%2C+fail+fast%0Ac.+Fail+Fast+at+runtime.+For+example%3A+if+the+request+needs+to+contain+a+double+between+0.0+and%0A1.0+and+it%E2%80%99s+bigger+than+1.0%2C+fail+fast.%0Ad.+Fail+Fast+at+runtime+in+assertion+mode+if+the+detection+performance+cost+is+high.+For%0Aexample%3A+If%2C+after+every+low+level+iteration%2C+the+variable+A+needs+to+be+equal+to+the+square%0Aroot+of+B%2C+check+it+if+and+only+if+an+assert+flag+is+set+to+true+%28usually+controlled+by+the%0AEnvironmentMode%29.%0A2.+Exception+messages%0Aa.+The+Exception+message+must+include+the+name+and+state+of+each+relevant+variable.+For%0Aexample%3A%0Aif+%28fooSize+%3C+0%29+%7B%0A%C2%A0+++throw+new+IllegalArgumentException%28%22The+fooSize+%28%22+%2B+fooSize+%2B+%22%29+of+bar+%28%22%0A%2B+this+%2B+%22%29+must+be+positive.%22%29%3B%0A%7D%0ANotice+that+the+output+clearly+explains+what%E2%80%99s+wrong%3A%0AException+in+thread+%22main%22+java.lang.IllegalArgumentException%3A+The+fooSize+%28-5%29%0Aof+bar+%28myBar%29+must+be+positive.%0A%C2%A0+++at+...%0Ab.+Whenever+possible%2C+the+Exception+message+must+include+context.%0Ac.+Whenever+the+fix+is+not+obvious%2C+the+Exception+message+should+include+advice.+Advice%0Anormally+starts+with+the+word+maybe+on+a+new+line%3A%0AException+in+thread+%22main%22+java.lang.IllegalStateException%3A+The%0AvalueRangeDescriptor+%28fooRange%29+is+nullable%2C+but+not+countable+%28false%29.%0AMaybe+the+member+%28getFooRange%29+should+return+CountableValueRange.%0A%C2%A0+++at+...%0AThe+word+maybe+is+to+indicate+that+the+advice+is+not+guaranteed+to+be+right+in+all+cases.%0A3.+Generics.+The+Solution+class+is+often+passed+as+a+generic+type+parameter+to+subsystems.+The%0APlanningEntity+class%28es%29+are+rarely+passed+as+a+generic+type+parameter.%0A360%0A
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1876)
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1474)
	at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
	at com.passer.web.servlet.TranslateServlet.service(TranslateServlet.java:63)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:467)
	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:392)
	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:311)
	at com.passer.web.servlet.UploadServlet.service(UploadServlet.java:96)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:624)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1441)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

09-Dec-2019 11:41:22.551 SEVERE [http-nio-8080-exec-1] org.apache.catalina.core.ApplicationDispatcher.invoke Servlet.service() for servlet com.passer.web.servlet.TranslateServlet threw exception
 java.io.IOException: Server returned HTTP response code: 413 for URL: https://translate.google.cn/translate_a/single?client=webapp&sl=auto&tl=zh-CN&hl=zh-CN&dt=at&dt=bd&dt=ex&dt=ld&dt=md&dt=qca&dt=rw&dt=rm&dt=ss&dt=t&source=bh&ssel=0&tsel=0&kc=1&tk=492773.110737&q=OptaPlanner+User+Guide%0AThe+OptaPlanner+Team%0AVersion+7.10.0.Final%0ATable+of+Contents%0A1.+OptaPlanner+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A01%0A1.1.+What+is+OptaPlanner%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A01%0A1.2.+What+is+a+Planning+Problem%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A02%0A1.2.1.+A+Planning+Problem+is+NP-complete+or+NP-hard+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.2.2.+A+Planning+Problem+Has+%28Hard+and+Soft%29+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.2.3.+A+Planning+Problem+Has+a+Huge+Search+Space+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A04%0A1.3.+Requirements.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A05%0A1.4.+Governance+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.1.+Status+of+OptaPlanner+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.2.+Release+Notes+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.3.+Backwards+Compatibility+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A06%0A1.4.4.+Community+and+Support+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A07%0A1.4.5.+Relationship+with+Drools+and+jBPM+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A07%0A1.5.+Download+and+Run+the+Examples.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A08%0A1.5.1.+Get+the+Release+zip+and+Run+the+Examples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A08%0A1.5.2.+Run+the+Webexamples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A010%0A1.5.3.+Run+the+Examples+in+an+IDE+%28IntelliJ%2C+Eclipse%2C+NetBeans%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A011%0A1.5.4.+Use+OptaPlanner+with+Maven%2C+Gradle%2C+Ivy%2C+Buildr+or+ANT+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A012%0A1.5.5.+Build+OptaPlanner+from+Source+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A013%0A2.+Getting+Started%3A+A+Cloud+Balancing+Demonstration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.+Cloud+Balancing+Tutorial+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A015%0A2.1.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A017%0A2.2.+Using+the+Domain+Model.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A017%0A2.2.1.+Domain+Model+Design+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A018%0A2.2.2.+Domain+Model+Implementation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A019%0A2.3.+Run+the+Cloud+Balancing+Hello+World+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A021%0A2.4.+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A023%0A2.5.+Score+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A024%0A2.5.1.+Easy+Java+Score+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A025%0A2.5.2.+Drools+Score+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A027%0A2.6.+Beyond+this+Tutorial.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A029%0A3.+Use+Cases+and+Examples+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A030%0A3.1.+Examples+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A030%0A3.2.+N+Queens.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A034%0A3.2.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A034%0A3.2.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A035%0A3.2.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A035%0A3.3.+Cloud+Balancing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A037%0A3.4.+Traveling+Salesman+%28TSP+-+Traveling+Salesman+Problem%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.4.3.+Problem+Difficulty.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A038%0A3.5.+Dinner+Party+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.5.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.5.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A039%0A3.6.+Tennis+Club+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.6.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A040%0A3.7.+Meeting+Scheduling+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A041%0A3.7.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A041%0A3.7.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.+Course+Timetabling+%28ITC+2007+Track+3+-+Curriculum+Course+Scheduling%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A042%0A3.8.2.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A043%0A3.8.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A043%0A3.9.+Machine+Reassignment+%28Google+ROADEF+2012%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A044%0A3.9.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A044%0A3.9.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A045%0A3.9.3.+Problem+Size.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A046%0A3.9.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A047%0A3.10.+Vehicle+Routing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A048%0A3.10.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A048%0A3.10.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A050%0A3.10.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A050%0A3.10.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A054%0A3.11.+Project+Job+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A059%0A3.11.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A059%0A3.11.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A060%0A3.12.+Hospital+Bed+Planning+%28PAS+-+Patient+Admission+Scheduling%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A061%0A3.12.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A061%0A3.12.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A063%0A3.12.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A063%0A3.13.+Task+assigning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A064%0A3.13.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A064%0A3.13.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.13.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.13.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A065%0A3.14.+Exam+Timetabling+%28ITC+2007+track+1+-+Examination%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A066%0A3.14.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A066%0A3.14.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A068%0A3.14.3.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A068%0A3.15.+Nurse+Rostering+%28INRC+2010%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A069%0A3.15.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A069%0A3.15.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A071%0A3.15.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A071%0A3.15.4.+Domain+Model+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.+Traveling+Tournament+Problem+%28TTP%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A074%0A3.16.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A075%0A3.17.+Cheap+Time+Scheduling.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A076%0A3.17.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A076%0A3.17.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A077%0A3.18.+Investment+Asset+Class+Allocation+%28Portfolio+Optimization%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.18.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.18.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.+Conference+Scheduling+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A080%0A3.19.2.+Value+Proposition+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A082%0A3.19.3.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A082%0A3.20.+Rock+Tour+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A3.20.1.+Problem+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A3.20.2.+Problem+Size+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A083%0A4.+Planner+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.1.+Solver+Configuration+by+XML.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A084%0A4.2.2.+Solver+Configuration+by+Java+API+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A086%0A4.2.3.+Annotations+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A087%0A4.2.4.+Custom+Properties+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.+Model+a+Planning+Problem.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.1.+Is+This+Class+a+Problem+Fact+or+Planning+Entity%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A089%0A4.3.2.+Problem+Fact+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A090%0A4.3.3.+Planning+Entity+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A091%0A4.3.4.+Planning+Variable+%28genuine%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A094%0A4.3.5.+Planning+Value+and+Planning+Value+Range+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A096%0A4.3.6.+Planning+Problem+and+Planning+Solution.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0104%0A4.4.+Use+the+Solver+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.1.+The+Solver+Interface+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.2.+Solving+a+Problem.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0114%0A4.4.3.+Environment+Mode%3A+Are+There+Bugs+in+my+Code%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0115%0A4.4.4.+Logging+Level%3A+What+is+the+Solver+Doing%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0117%0A4.4.5.+Random+Number+Generator+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0120%0A5.+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.+Score+Terminology+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.1.+What+is+a+Score%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.2.+Formalize+the+Business+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0122%0A5.1.3.+Score+Constraint+Signum+%28Positive+or+Negative%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0123%0A5.1.4.+Score+Constraint+Weight+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0124%0A5.1.5.+Score+Constraint+Level+%28hard%2C+soft%2C+%E2%80%A6%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0125%0A5.1.6.+Pareto+Scoring+%28AKA+Multi-objective+Optimization+Scoring%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0127%0A5.1.7.+Combining+Score+Techniques+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0129%0A5.1.8.+Score+interface+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0129%0A5.1.9.+Avoid+Floating+Point+Numbers+in+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0130%0A5.2.+Choose+a+Score+Type+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.1.+SimpleScore+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.2.+HardSoftScore+%28Recommended%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.3.+HardMediumSoftScore+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0132%0A5.2.4.+BendableScore.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0133%0A5.2.5.+Implementing+a+Custom+Score.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0133%0A5.3.+Calculate+the+Score+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.1.+Score+Calculation+Types+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.2.+Easy+Java+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0134%0A5.3.3.+Incremental+Java+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0136%0A5.3.4.+Drools+Score+Calculation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0141%0A5.3.5.+InitializingScoreTrend.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0147%0A5.3.6.+Invalid+Score+Detection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.+Score+Calculation+Performance+Tricks+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.1.+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0148%0A5.4.2.+Score+Calculation+Speed+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0149%0A5.4.3.+Incremental+Score+Calculation+%28with+Deltas%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0149%0A5.4.4.+Avoid+Calling+Remote+Services+During+Score+Calculation.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0151%0A5.4.5.+Pointless+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0151%0A5.4.6.+Built-in+Hard+Constraint+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.7.+Other+Score+Calculation+Performance+Tricks.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.8.+Score+Trap.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0152%0A5.4.9.+stepLimit+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0154%0A5.4.10.+Fairness+Score+Constraints+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0154%0A5.5.+Explaining+the+Score%3A+Which+Constraints+Are+Broken%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0156%0A5.5.1.+Using+Score+Calculation+Outside+the+Solver+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0157%0A5.5.2.+Constraint+Match+Total%3A+Break+down+the+Score+by+Constraint+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0158%0A5.5.3.+Indictment+Heat+Map%3A+Visualize+the+Hot+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0159%0A5.6.+Testing+score+constraints+with+JUnit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0159%0A6.+Shadow+Variable+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0162%0A6.1.+Introduction.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0162%0A6.2.+Bi-directional+Variable+%28Inverse+Relation+Shadow+Variable%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0163%0A6.3.+Anchor+Shadow+Variable+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0165%0A6.4.+Custom+VariableListener+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0166%0A6.5.+VariableListener+triggering+order+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0168%0A7.+Optimization+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0171%0A7.1.+Search+Space+Size+in+the+Real+World+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0171%0A7.2.+Does+Planner+Find+the+Optimal+Solution%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0172%0A7.3.+Architecture+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0173%0A7.4.+Optimization+Algorithms+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0174%0A7.5.+Which+Optimization+Algorithms+Should+I+Use%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0176%0A7.6.+Power+tweaking+or+default+parameter+values.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0177%0A7.7.+Solver+Phase.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0177%0A7.8.+Scope+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0179%0A7.9.+Termination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0180%0A7.9.1.+TimeMillisSpentTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0181%0A7.9.2.+UnimprovedTimeMillisSpentTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0182%0A7.9.3.+BestScoreTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0183%0A7.9.4.+BestScoreFeasibleTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0183%0A7.9.5.+StepCountTermination+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.6.+UnimprovedStepCountTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.7.+ScoreCalculationCountTermination.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0184%0A7.9.8.+Combining+Multiple+Terminations+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0185%0A7.9.9.+Asynchronous+Termination+from+Another+Thread+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0185%0A7.10.+SolverEventListener+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0186%0A7.11.+Custom+Solver+Phase+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0186%0A7.12.+No+Change+Solver+Phase+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0188%0A7.13.+Multithreaded+Solving+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0189%0A7.13.1.+Custom+Thread+Factory+%28WildFly%2C+Android%2C+GAE%2C+%E2%80%A6%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0190%0A7.13.2.+Multithreaded+Incremental+Solving.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0190%0A8.+Move+and+Neighborhood+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.+Move+and+Neighborhood+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.1.+What+is+a+Move%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0193%0A8.1.2.+What+is+a+MoveSelector%3F.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0194%0A8.1.3.+Subselecting+of+Entities%2C+Values+and+Other+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0194%0A8.2.+Generic+MoveSelectors+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0195%0A8.2.1.+changeMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0196%0A8.2.2.+swapMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0197%0A8.2.3.+pillarChangeMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0199%0A8.2.4.+pillarSwapMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0201%0A8.2.5.+tailChainSwapMoveSelector+or+2-opt+%28chained+variables+only%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0203%0A8.2.6.+subChainChangeMoveSelector+%28chained+variables+only%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0204%0A8.2.7.+subChainSwapMoveSelector+%28chained+variables+only%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0205%0A8.3.+Combining+Multiple+MoveSelectors.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0206%0A8.3.1.+unionMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0206%0A8.3.2.+cartesianProductMoveSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0208%0A8.4.+EntitySelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0209%0A8.5.+ValueSelector+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0209%0A8.6.+General+Selector+Features+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0210%0A8.6.1.+CacheType%3A+Create+Moves+Ahead+of+Time+or+Just+In+Time.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0210%0A8.6.2.+SelectionOrder%3A+Original%2C+Sorted%2C+Random%2C+Shuffled+or+Probabilistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0211%0A8.6.3.+Recommended+Combinations+of+CacheType+and+SelectionOrder+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0212%0A8.6.4.+Filtered+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0215%0A8.6.5.+Sorted+Selection.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0218%0A8.6.6.+Probabilistic+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0222%0A8.6.7.+Limited+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0223%0A8.6.8.+Mimic+Selection+%28Record%2FReplay%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0223%0A8.6.9.+Nearby+Selection+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0224%0A8.7.+Custom+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0227%0A8.7.1.+Which+Move+Types+Might+be+Missing+in+my+Implementation%3F+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0227%0A8.7.2.+Custom+Moves+Introduction.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0228%0A8.7.3.+The+Interface+Move+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0228%0A8.7.4.+MoveListFactory%3A+the+Easy+Way+to+Generate+Custom+Moves+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0232%0A8.7.5.+MoveIteratorFactory%3A+Generate+Custom+Moves+Just+in+Time.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0233%0A9.+Exhaustive+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.+Brute+Force.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.1.+Algorithm+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0235%0A9.2.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.+Branch+And+Bound.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.1.+Algorithm+Description+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0236%0A9.3.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0237%0A9.4.+Scalability+of+Exhaustive+Search.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0239%0A10.+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.+First+Fit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0242%0A10.2.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.+First+Fit+Decreasing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0243%0A10.3.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0244%0A10.4.+Weakest+Fit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.4.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.4.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.+Weakest+Fit+Decreasing.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0245%0A10.5.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.+Strongest+Fit.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.6.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0246%0A10.7.+Strongest+Fit+Decreasing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.7.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.7.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0247%0A10.8.+Allocate+Entity+From+Queue.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0248%0A10.8.3.+Multiple+Entity+Classes+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0249%0A10.8.4.+Pick+Early+Type+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0250%0A10.9.+Allocate+To+Value+From+Queue+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0251%0A10.9.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0251%0A10.9.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.+Cheapest+Insertion+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0252%0A10.10.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0253%0A10.11.+Regret+Insertion+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.11.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.11.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.+Allocate+From+Pool.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.12.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0254%0A10.13.+Scaling+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0255%0A10.13.1.+InitializingScoreTrend+shortcuts+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0255%0A10.13.2.+Scaling+Multiple+Planning+Variables+in+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0256%0A10.13.3.+Other+Scaling+Techniques+in+Construction+Heuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0258%0A11.+Local+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.+Local+Search+Concepts.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.1.+Step+by+Step+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0259%0A11.2.2.+Decide+the+Next+Step+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0261%0A11.2.3.+Acceptor+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0263%0A11.2.4.+Forager+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0263%0A11.3.+Hill+Climbing+%28Simple+Local+Search%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0265%0A11.3.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0265%0A11.3.2.+Stuck+in+Local+Optima+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0266%0A11.3.3.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0266%0A11.4.+Tabu+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0267%0A11.4.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0267%0A11.4.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0268%0A11.5.+Simulated+Annealing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.5.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.5.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0270%0A11.6.+Late+Acceptance+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0271%0A11.6.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0271%0A11.6.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0272%0A11.7.+Step+Counting+Hill+Climbing+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.7.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.7.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0273%0A11.8.+Strategic+Oscillation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.8.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.8.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0274%0A11.9.+Variable+Neighborhood+Descent+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.9.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.9.2.+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0275%0A11.10.+Using+a+Custom+Termination%2C+MoveSelector%2C+EntitySelector%2C+ValueSelector+or+Acceptor+.+.+%C2%A0276%0A12.+Evolutionary+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.2.+Evolutionary+Strategies.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A12.3.+Genetic+Algorithms+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0277%0A13.+Hyperheuristics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0278%0A13.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0278%0A14.+Partitioned+Search+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0279%0A14.1.+Algorithm+Description.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0279%0A14.2.+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0280%0A14.3.+Partitioning+a+Solution+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0281%0A14.3.1.+Custom+SolutionPartitioner+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0281%0A14.4.+Runnable+Part+Thread+Limit+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0283%0A15.+Benchmarking+and+Tweaking.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.1.+Find+the+Best+Solver+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.+Benchmark+Configuration+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.1.+Add+a+Dependency+on+optaplanner-benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0286%0A15.2.2.+Run+a+Simple+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0287%0A15.2.3.+Configure+and+Run+an+Advanced+Benchmark+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0287%0A15.2.4.+SolutionFileIO%3A+Input+And+Output+Of+Solution+Files+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0289%0A15.2.5.+Warming+Up+The+HotSpot+Compiler+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0291%0A15.2.6.+Benchmark+Blueprint%3A+A+Predefined+Configuration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0292%0A15.2.7.+Write+The+Output+Solution+Of+Benchmark+Runs.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.2.8.+Benchmark+Logging+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.3.+Benchmark+Report+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0293%0A15.3.1.+HTML+Report+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0294%0A15.3.2.+Ranking+The+Solvers+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0294%0A15.4.+Summary+Statistics+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0295%0A15.4.1.+Best+Score+Summary+%28Graph+And+Table%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0295%0A15.4.2.+Best+Score+Scalability+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0296%0A15.4.3.+Best+Score+Distribution+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0296%0A15.4.4.+Winning+Score+Difference+Summary+%28Graph+And+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.5.+Worst+Score+Difference+Percentage+%28ROI%29+Summary+%28Graph+and+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.6.+Score+Calculation+Speed+Summary+%28Graph+and+Table%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0297%0A15.4.7.+Time+Spent+Summary+%28Graph+And+Table%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.4.8.+Time+Spent+Scalability+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.4.9.+Best+Score+Per+Time+Spent+Summary+%28Graph%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.+Statistic+Per+Dataset+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.1.+Enable+A+Problem+Statistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0298%0A15.5.2.+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0299%0A15.5.3.+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0301%0A15.5.4.+Score+Calculation+Speed+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0302%0A15.5.5.+Best+Solution+Mutation+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0303%0A15.5.6.+Move+Count+Per+Step+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0304%0A15.5.7.+Memory+Use+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0305%0A15.6.+Statistic+Per+Single+Benchmark+%28Graph+And+CSV%29.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0306%0A15.6.1.+Enable+A+Single+Statistic+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0306%0A15.6.2.+Constraint+Match+Total+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0307%0A15.6.3.+Constraint+Match+Total+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0308%0A15.6.4.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0309%0A15.6.5.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic+%28Graph+And+CSV%29+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0310%0A15.7.+Advanced+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0311%0A15.7.1.+Benchmarking+Performance+Tricks+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0311%0A15.7.2.+Statistical+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0312%0A15.7.3.+Template+Based+Benchmarking+And+Matrix+Benchmarking+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0313%0A15.7.4.+Benchmark+Report+Aggregation+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0315%0A16.+Repeated+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.1.+Introduction+to+Repeated+Planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.2.+Backup+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0318%0A16.3.+Overconstrained+Planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0319%0A16.3.1.+Overconstrained+Planning+with+Nullable+Variables+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0319%0A16.3.2.+Overconstrained+Planning+with+Virtual+Values+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0320%0A16.4.+Continuous+Planning+%28Windowed+Planning%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0321%0A16.4.1.+Immovable+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0324%0A16.4.2.+Nonvolatile+Replanning+to+Minimize+Disruption+%28Semi-movable+Planning+Entities%29.+.+.+%C2%A0326%0A16.5.+Real-time+Planning.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0327%0A16.5.1.+ProblemFactChange+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0328%0A16.5.2.+Daemon%3A+solve%28%29+Does+Not+Return+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0332%0A17.+Integration.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.1.+Overview+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.+Persistent+Storage.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.1.+Database%3A+JPA+and+Hibernate.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0334%0A17.2.2.+XML+or+JSON%3A+XStream+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0338%0A17.2.3.+XML+or+JSON%3A+JAXB.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0339%0A17.2.4.+JSON%3A+Jackson.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0340%0A17.3.+SOA+and+ESB+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.3.1.+Camel+and+Karaf+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.+Other+Environments+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.1.+JBoss+Modules%2C+WildFly+and+JBoss+EAP+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0342%0A17.4.2.+Spring+Boot.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0344%0A17.4.3.+Java+Platform+Module+System+%28Jigsaw%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0344%0A17.4.4.+OSGi+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0345%0A17.4.5.+Android+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0345%0A17.5.+Integration+with+Human+Planners+%28Politics%29+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0346%0A17.6.+Sizing+Hardware+and+Software.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0348%0A18.+Design+Patterns.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.1.+Design+Patterns+Introduction+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.2.+Domain+Modeling+Guide.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0351%0A18.3.+Assigning+Time+to+Planning+Entities+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0354%0A18.3.1.+Timeslot+Pattern%3A+Assign+to+a+Fixed-Length+Timeslot.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0356%0A18.3.2.+TimeGrain+Pattern%3A+Assign+to+a+Starting+TimeGrain+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0356%0A18.3.3.+Chained+Through+Time+Pattern%3A+Assign+in+a+Chain+that+Determines+Starting+Time.+.+.+.+%C2%A0357%0A18.4.+Multi-stage+planning+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0358%0A19.+Development+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0359%0A19.1.+Methodology+Overview.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0359%0A19.2.+Development+guidelines+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+%C2%A0360%0AChapter+1.+OptaPlanner+Introduction%0A1.1.+What+is+OptaPlanner%3F%0AEvery+organization+faces+planning+problems%3A+providing+products+or+services+with+a+limited+set+of%0Aconstrained+resources+%28employees%2C+assets%2C+time+and+money%29.+OptaPlanner+optimizes+such+planning%0Ato+do+more+business+with+less+resources.+This+is+known+as+Constraint+Satisfaction+Programming%0A%28which+is+part+of+the+Operations+Research+discipline%29.%0AOptaPlanner+is+a+lightweight%2C+embeddable+constraint+satisfaction+engine+which+optimizes+planning%0Aproblems.+It+solves+use+cases+such+as%3A%0A%E2%80%A2+Employee+shift+rostering%3A+timetabling+nurses%2C+repairmen%2C+%E2%80%A6%0A%E2%80%A2+Agenda+scheduling%3A+scheduling+meetings%2C+appointments%2C+maintenance+jobs%2C+advertisements%2C+%E2%80%A6%0A%E2%80%A2+Educational+timetabling%3A+scheduling+lessons%2C+courses%2C+exams%2C+conference+presentations%2C+%E2%80%A6%0A%E2%80%A2+Vehicle+routing%3A+planning+vehicle+routes+%28trucks%2C+trains%2C+boats%2C+airplanes%2C+%E2%80%A6%29+for+moving+freight%0Aand%2For+passengers+through+multiple+destinations+using+known+mapping+tools+%E2%80%A6%0A%E2%80%A2+Bin+packing%3A+filling+containers%2C+trucks%2C+ships%2C+and+storage+warehouses+with+items%2C+but+also%0Apacking+information+across+computer+resources%2C+as+in+cloud+computing+%E2%80%A6%0A%E2%80%A2+Job+shop+scheduling%3A+planning+car+assembly+lines%2C+machine+queue+planning%2C+workforce+task%0Aplanning%2C+%E2%80%A6%0A%E2%80%A2+Cutting+stock%3A+minimizing+waste+while+cutting+paper%2C+steel%2C+carpet%2C+%E2%80%A6%0A%E2%80%A2+Sport+scheduling%3A+planning+games+and+training+schedules+for+football+leagues%2C+baseball+leagues%2C%0A%E2%80%A6%0A%E2%80%A2+Financial+optimization%3A+investment+portfolio+optimization%2C+risk+spreading%2C+%E2%80%A6%0A1%0A1.2.+What+is+a+Planning+Problem%3F%0A2%0AA+planning+problem+has+an+optimal+goal%2C+based+on+limited+resources+and+under+specific+constraints.%0AOptimal+goals+can+be+any+number+of+things%2C+such+as%3A%0A%E2%80%A2+Maximized+profits+-+the+optimal+goal+results+in+the+highest+possible+profit.%0A%E2%80%A2+Minimized+ecological+footprint+-+the+optimal+goal+has+the+least+amount+of+environmental+impact.%0A%E2%80%A2+Maximized+satisfaction+for+employees+or+customers+-+the+optimal+goal+prioritizes+the+needs+of%0Aemployees+or+customers.%0AThe+ability+to+achieve+these+goals+relies+on+the+number+of+resources+available%2C+such+as%3A%0A%E2%80%A2+The+number+of+people.%0A%E2%80%A2+Amount+of+time.%0A%E2%80%A2+Budget.%0A%E2%80%A2+Physical+assets%2C+for+example%2C+machinery%2C+vehicles%2C+computers%2C+buildings%2C+etc.%0ASpecific+constraints+related+to+these+resources+must+also+be+taken+into+account%2C+such+as+the+number%0Aof+hours+a+person+works%2C+their+ability+to+use+certain+machines%2C+or+compatibility+between+pieces+of%0Aequipment.%0AOptaPlanner+helps+JavaTM+programmers+solve+constraint+satisfaction+problems+efficiently.+Under+the%0Ahood%2C+it+combines+optimization+heuristics+and+metaheuristics+with+very+efficient+score+calculation.%0A3%0A1.2.1.+A+Planning+Problem+is+NP-complete+or+NP-hard%0AAll+the+use+cases+above+are+probably+NP-complete%2FNP-hard%2C+which+means+in+layman%E2%80%99s+terms%3A%0A%E2%80%A2+It%E2%80%99s+easy+to+verify+a+given+solution+to+a+problem+in+reasonable+time.%0A%E2%80%A2+There+is+no+silver+bullet+to+find+the+optimal+solution+of+a+problem+in+reasonable+time+%28*%29.%0A%28*%29+At+least%2C+none+of+the+smartest+computer+scientists+in+the+world+have+found+such%0Aa+silver+bullet+yet.+But+if+they+find+one+for+1+NP-complete+problem%2C+it+will+work+for%0A%EF%81%9A+every+NP-complete+problem.%0AIn+fact%2C+there%E2%80%99s+a+%24+1%2C000%2C000+reward+for+anyone+that+proves+if+such+a+silver+bullet%0Aactually+exists+or+not.%0AThe+implication+of+this+is+pretty+dire%3A+solving+your+problem+is+probably+harder+than+you+anticipated%2C%0Abecause+the+two+common+techniques+won%E2%80%99t+suffice%3A%0A%E2%80%A2+A+Brute+Force+algorithm+%28even+a+smarter+variant%29+will+take+too+long.%0A%E2%80%A2+A+quick+algorithm%2C+for+example+in+bin+packing%2C+putting+in+the+largest+items+first%2C+will+return+a%0Asolution+that+is+far+from+optimal.%0ABy+using+advanced+optimization+algorithms%2C+OptaPlanner+does+find+a+good+solution+in%0Areasonable+time+for+such+planning+problems.%0A1.2.2.+A+Planning+Problem+Has+%28Hard+and+Soft%29+Constraints%0AUsually%2C+a+planning+problem+has+at+least+two+levels+of+constraints%3A%0A%E2%80%A2+A+%28negative%29+hard+constraint+must+not+be+broken.+For+example%3A+1+teacher+can+not+teach+2+different%0Alessons+at+the+same+time.%0A%E2%80%A2+A+%28negative%29+soft+constraint+should+not+be+broken+if+it+can+be+avoided.+For+example%3A+Teacher+A%0Adoes+not+like+to+teach+on+Friday+afternoon.%0ASome+problems+have+positive+constraints+too%3A%0A%E2%80%A2+A+positive+soft+constraint+%28or+reward%29+should+be+fulfilled+if+possible.+For+example%3A+Teacher+B+likes%0Ato+teach+on+Monday+morning.%0ASome+basic+problems+%28such+as+N+queens%29+only+have+hard+constraints.+Some+problems+have+three+or%0Amore+levels+of+constraints%2C+for+example+hard%2C+medium+and+soft+constraints.%0AThese+constraints+define+the+score+calculation+%28AKA+fitness+function%29+of+a+planning+problem.+Each%0Asolution+of+a+planning+problem+can+be+graded+with+a+score.+With+OptaPlanner%2C+score+constraints%0Aare+written+in+an+Object+Oriented+language%2C+such+as+JavaTM+code+or+Drools+rules.+Such+code+is%0Aeasy%2C+flexible+and+scalable.%0A1.2.3.+A+Planning+Problem+Has+a+Huge+Search+Space%0AA+planning+problem+has+a+number+of+solutions.+There+are+several+categories+of+solutions%3A%0A4%0A%E2%80%A2+A+possible+solution+is+any+solution%2C+whether+or+not+it+breaks+any+number+of+constraints.+Planning%0Aproblems+tend+to+have+an+incredibly+large+number+of+possible+solutions.+Many+of+those+solutions%0Aare+worthless.%0A%E2%80%A2+A+feasible+solution+is+a+solution+that+does+not+break+any+%28negative%29+hard+constraints.+The+number%0Aof+feasible+solutions+tends+to+be+relative+to+the+number+of+possible+solutions.+Sometimes+there%0Aare+no+feasible+solutions.+Every+feasible+solution+is+a+possible+solution.%0A%E2%80%A2+An+optimal+solution+is+a+solution+with+the+highest+score.+Planning+problems+tend+to+have+1+or+a%0Afew+optimal+solutions.+There+is+always+at+least+1+optimal+solution%2C+even+in+the+case+that+there+are%0Ano+feasible+solutions+and+the+optimal+solution+isn%E2%80%99t+feasible.%0A%E2%80%A2+The+best+solution+found+is+the+solution+with+the+highest+score+found+by+an+implementation+in+a%0Agiven+amount+of+time.+The+best+solution+found+is+likely+to+be+feasible+and%2C+given+enough+time%2C+it%E2%80%99s%0Aan+optimal+solution.%0ACounterintuitively%2C+the+number+of+possible+solutions+is+huge+%28if+calculated+correctly%29%2C+even+with+a%0Asmall+dataset.+As+you+can+see+in+the+examples%2C+most+instances+have+a+lot+more+possible+solutions%0Athan+the+minimal+number+of+atoms+in+the+known+universe+%2810%5E80%29.+Because+there+is+no+silver+bullet%0Ato+find+the+optimal+solution%2C+any+implementation+is+forced+to+evaluate+at+least+a+subset+of+all+those%0Apossible+solutions.%0AOptaPlanner+supports+several+optimization+algorithms+to+efficiently+wade+through+that+incredibly%0Alarge+number+of+possible+solutions.+Depending+on+the+use+case%2C+some+optimization+algorithms%0Aperform+better+than+others%2C+but+it%E2%80%99s+impossible+to+tell+in+advance.+With+OptaPlanner%2C+it+is+easy+to%0Aswitch+the+optimization+algorithm%2C+by+changing+the+solver+configuration+in+a+few+lines+of+XML+or%0Acode.%0A1.3.+Requirements%0AOptaPlanner+is+open+source+software%2C+released+under+the+Apache+Software+License+2.0.+This+license%0Ais+very+liberal+and+allows+reuse+for+commercial+purposes.+Read+the+layman%E2%80%99s+explanation.%0AOptaPlanner+is+100%25+pure+JavaTM+and+runs+on+any+JVM+8+or+higher.+It+integrates+very+easily+with%0Aother+JavaTM+technologies.+OptaPlanner+is+available+in+the+Maven+Central+Repository.%0APlanner+works+on+any+Java+Virtual+Machine+and+is+compatible+with+Standard+Java%2C+Enterprise+Java%2C%0Aand+all+JVM+languages.%0A5%0A1.4.+Governance%0A1.4.1.+Status+of+OptaPlanner%0AOptaPlanner+is+stable%2C+reliable+and+scaleable.+It+has+been+heavily+tested+with+unit%2C+integration%2C+and%0Astress+tests%2C+and+is+used+in+production+throughout+the+world.+One+example+handles+over+50+000%0Avariables+with+5000+variables+each%2C+multiple+constraint+types+and+billions+of+possible+constraint%0Amatches.%0A1.4.2.+Release+Notes%0AWe+release+every+month.+Read+the+release+notes+of+each+release+on+our+website.%0A1.4.3.+Backwards+Compatibility%0AOptaPlanner+separates+its+API+and+implementation%3A%0A%E2%80%A2+Public+API%3A+All+classes+in+the+package+namespace+org.optaplanner.core.api+are+100%25%0Abackwards+compatible+in+future+releases+%28especially+minor+and+hotfix+releases%29.+In+rare%0Acircumstances%2C+if+the+major+version+number+changes%2C+a+few+specific+classes+might+have+a+few%0Abackwards+incompatible+changes%2C+but+those+will+be+clearly+documented+in+the+upgrade+recipe.%0A%E2%80%A2+XML+configuration%3A+The+XML+solver+configuration+is+backwards+compatible+for+all+elements%2C%0Aexcept+for+elements+that+require+the+use+of+non+public+API+classes.+The+XML+solver+configuration%0A6%0Ais+defined+by+the+classes+in+the+package+namespace+org.optaplanner.core.config.%0A%E2%80%A2+Implementation+classes%3A+All+classes+in+the+package+namespace+org.optaplanner.core.impl+are%0Anot+backwards+compatible%3A+they+will+change+in+future+major+or+minor+releases+%28but+probably+not%0Ain+hotfix+releases%29.+The+upgrade+recipe+describes+every+such+relevant+change+and+on+how+to%0Aquickly+deal+with+it+when+upgrading+to+a+newer+version.%0AThis+documentation+covers+some+impl+classes+too.+Those+documented+impl+classes%0Aare+reliable+and+safe+to+use+%28unless+explicitly+marked+as+experimental+in+this%0A%EF%81%9A+documentation%29%2C+but+we%E2%80%99re+just+not+entirely+comfortable+yet+to+write+their%0Asignatures+in+stone.%0A1.4.4.+Community+and+Support%0AFor+news+and+articles%2C+check+our+blog%2C+twitter+%28including+Geoffrey%E2%80%99s+twitter%29+and+facebook.%0AIf+you%E2%80%99re+happy+with+OptaPlanner%2C+make+us+happy+by+posting+a+tweet+or+blog+article+about+it.%0APublic+questions+are+welcome+on+here.+Bugs+and+feature+requests+are+welcome+in+our+issue+tracker.%0APull+requests+are+very+welcome+on+GitHub+and+get+priority+treatment%21+By+open+sourcing+your%0Aimprovements%2C+you+%27ll+benefit+from+our+peer+review+and+from+our+improvements+made+on+top+of%0Ayour+improvements.%0ARed+Hat+sponsors+OptaPlanner+development+by+employing+the+core+team.+For+enterprise+support%0Aand+consulting%2C+take+a+look+at+these+services.%0A1.4.5.+Relationship+with+Drools+and+jBPM%0AOptaPlanner+is+part+of+the+KIE+group+of+projects.+It+releases+regularly+%28often+once+or+twice+per%0Amonth%29+together+with+the+Drools+rule+engine+and+the+jBPM+workflow+engine.%0A7%0ASee+the+architecture+overview+to+learn+more+about+the+optional+integration+with+Drools.%0A1.5.+Download+and+Run+the+Examples%0A1.5.1.+Get+the+Release+zip+and+Run+the+Examples%0ATo+try+it+now%3A%0A1.+Download+a+release+zip+of+OptaPlanner+from+the+OptaPlanner+website+and+unzip+it.%0A2.+Open+the+directory+examples+and+run+the+script.%0ALinux+or+Mac%3A%0A%24+cd+examples%0A%24+.%2FrunExamples.sh%0AWindows%3A%0A%24+cd+examples%0A%24+runExamples.bat%0A8%0AThe+Examples+GUI+application+will+open.+Pick+an+example+to+try+it+out%3A%0A9%0AOptaPlanner+itself+has+no+GUI+dependencies.+It+runs+just+as+well+on+a+server+or+a%0A%EF%81%9A+mobile+JVM+as+it+does+on+the+desktop.%0A1.5.2.+Run+the+Webexamples%0ABesides+the+GUI+examples%2C+there+are+also+a+set+of+webexamples+to+try+out.+The+webexamples+include%3A%0A%E2%80%A2+Vehicle+routing%3A+calculating+the+shortest+possible+route+to+pick+up+all+items+required+for+a%0Anumber+of+different+customers+using+either+Leaflet+or+Google+Maps+visualizations.%0A%E2%80%A2+Cloud+balancing%3A+Assigning+processes+across+computers+with+different+specifications+and+costs.%0APrerequisites%0AThe+webexamples+require+several+JEE+APIs+to+run%2C+such+as%3A%0A%E2%80%A2+Servlet%0A%E2%80%A2+JAX-RS%0A%E2%80%A2+CDI%0AThese+are+not+required+for+Planner+itself.%0ARunning+the+Webexamples+on+a+JEE+Application+Server%0A1.+Download+a+JEE+application+server%2C+such+as+JBoss+EAP+or+WildFly+and+unzip+it.%0A10%0A2.+Download+a+release+zip+of+OptaPlanner+from+the+OptaPlanner+website+and+unzip+it.%0A3.+Open+the+directory+webexamples+and+deploy+the+optaplanner-webexamples-*.war+file+on+the+JEE%0Aapplication+server.%0AIf+using+JBoss+EAP+in+standalone+mode%2C+this+can+be+done+by+adding+the+optaplanner-webexamples-%0A.war+file+to+the+jboss-eap-%2Fstandalone%2Fdeployments+folder.%0A4.+Open+the+following+address+in+a+web+browser%3A+http%3A%2F%2Flocalhost%3A8080%2Foptaplanner-webexamples-%0A*%2F+%28replace+the+*+with+the+actual+version%29.%0ADeploying+Webexamples+on+a+Servlet+Container%0ATo+successfully+deploy+the+webexamples+on+a+servlet+container+%28such+as+Jetty+or+Tomcat%29+instead+of%0Aon+a+real+JEE+application+server+%28such+as+WildFly%29%3A%0A1.+Add+the+missing+implementation+libraries+%28for+example+RestEasy+and+Weld%29+in+the+optaplanner-%0Awebexamples-*.war+manually.%0A2.+Deploy+the+optaplanner-webexamples-*.war+on+the+servlet+container.%0APick+an+example+to+try+it+out%2C+such+as+the+Vehicle+Routing+example%3A%0A1.5.3.+Run+the+Examples+in+an+IDE+%28IntelliJ%2C+Eclipse%2C+NetBeans%29%0ATo+run+the+examples+in+your+favorite+IDE%3A%0A11%0A%E2%80%A2+In+IntelliJ+IDEA%2C+NetBeans+or+a+non-vanilla+Eclipse%3A%0A1.+Open+the+file+examples%2Fsources%2Fpom.xml+as+a+new+project%2C+the+maven+integration+will+take%0Acare+of+the+rest.%0A2.+Run+the+examples+from+the+project.%0A%E2%80%A2+In+a+vanilla+Eclipse+%28which+lacks+the+M2Eclipse+plugin%29%3A%0A1.+Open+a+new+project+for+the+directory+examples%2Fsources+.%0A2.+Add+all+the+jars+to+the+classpath+from+the+directory+binaries+and+the+directory%0Aexamples%2Fbinaries+%2C+except+for+the+file+examples%2Fbinaries%2Foptaplanner-examples-*.jar+.%0A3.+Add+the+Java+source+directory+src%2Fmain%2Fjava+and+the+Java+resources+directory%0Asrc%2Fmain%2Fresources+.%0A4.+Create+a+run+configuration%3A%0A%E2%96%AA+Main+class%3A+org.optaplanner.examples.app.OptaPlannerExamplesApp%0A%E2%96%AA+VM+parameters+%28optional%29%3A+-Xmx512M+-server%0Aa.+To+run+a+specific+example+directly+and+skip+the+example+selection+window%2C+run+its+App%0Aclass+%28for+example+CloudBalancingApp%29+instead+of+OptaPlannerExamplesApp.%0A5.+Run+that+run+configuration.%0A1.5.4.+Use+OptaPlanner+with+Maven%2C+Gradle%2C+Ivy%2C+Buildr+or+ANT%0AThe+OptaPlanner+jars+are+also+available+in+the+central+maven+repository+%28and+also+in+the+JBoss%0Amaven+repository%29.%0AIf+you+use+Maven%2C+add+a+dependency+to+optaplanner-core+in+your+project%E2%80%99s+pom.xml+%3A%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eoptaplanner-core%3C%2FartifactId%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AThis+is+similar+for+Gradle%2C+Ivy+and+Buildr.+To+identify+the+latest+version%2C+check+the+central+maven%0Arepository.%0ABecause+you+might+end+up+using+other+OptaPlanner+modules+too%2C+it%E2%80%99s+recommended+to+import+the%0Aoptaplanner-bom+in+Maven%E2%80%99s+dependencyManagement+so+the+OptaPlanner+version+is+specified+only+once%3A%0A12%0A%C2%A0+%3CdependencyManagement%3E%0A%C2%A0+++%3Cdependencies%3E%0A%C2%A0+++++%3Cdependency%3E%0A%C2%A0+++++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++++%3CartifactId%3Eoptaplanner-bom%3C%2FartifactId%3E%0A%C2%A0+++++++%3Ctype%3Epom%3C%2Ftype%3E%0A%C2%A0+++++++%3Cversion%3E...%3C%2Fversion%3E%0A%C2%A0+++++++%3Cscope%3Eimport%3C%2Fscope%3E%0A%C2%A0+++++%3C%2Fdependency%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fdependencies%3E%0A%C2%A0+%3C%2FdependencyManagement%3E%0AIf+you%E2%80%99re+still+using+ANT+%28without+Ivy%29%2C+copy+all+the+jars+from+the+download+zip%E2%80%99s+binaries+directory+in%0Ayour+classpath.%0AThe+download+zip%E2%80%99s+binaries+directory+contains+far+more+jars+then+optaplanner-core%0Aactually+uses.+It+also+contains+the+jars+used+by+other+modules%2C+such+as+optaplanner-%0A%EF%81%9A+benchmark.%0ACheck+the+maven+repository+pom.xml+files+to+determine+the+minimal+dependency%0Aset+of+a+specific+module+%28for+a+specific+version%29.%0A1.5.5.+Build+OptaPlanner+from+Source%0APrerequisites%0A%E2%80%A2+Set+up+Git.%0A%E2%80%A2+Authenticate+on+GitHub+using+either+HTTPS+or+SSH.%0A%E2%97%A6+See+GitHub+for+more+information+about+setting+up+and+authenticating+Git.%0A%E2%80%A2+Set+up+Maven.%0ABuild+and+run+the+examples+from+source.%0A1.+Clone+optaplanner+from+GitHub+%28or+alternatively%2C+download+the+zipball%29%3A%0A%24+git+clone+https%3A%2F%2Fgithub.com%2Fkiegroup%2Foptaplanner.git%0A...%0A2.+Build+it+with+Maven%3A%0A%24+cd+optaplanner%0A%24+mvn+clean+install+-DskipTests%0A...%0A13%0AThe+first+time%2C+Maven+might+take+a+long+time%2C+because+it+needs+to+download%0A%EF%81%9A+jars.%0A3.+Run+the+examples%3A%0A%24+cd+optaplanner-examples%0A%24+mvn+exec%3Ajava%0A...%0A4.+Edit+the+sources+in+your+favorite+IDE.%0Aa.+Optional%3A+use+a+Java+profiler.%0A14%0AChapter+2.+Getting+Started%3A+A+Cloud%0ABalancing+Demonstration%0A2.1.+Cloud+Balancing+Tutorial%0A2.1.1.+Problem+Description%0ASuppose+your+company+owns+a+number+of+cloud+computers+and+needs+to+run+a+number+of%0Aprocesses+on+those+computers.+Assign+each+process+to+a+computer.%0AThe+following+hard+constraints+must+be+fulfilled%3A%0A%E2%80%A2+Every+computer+must+be+able+to+handle+the+minimum+hardware+requirements+of+the+sum+of+its%0Aprocesses%3A%0A%E2%97%A6+CPU+capacity%3A+The+CPU+power+of+a+computer+must+be+at+least+the+sum+of+the+CPU+power%0Arequired+by+the+processes+assigned+to+that+computer.%0A%E2%97%A6+Memory+capacity%3A+The+RAM+memory+of+a+computer+must+be+at+least+the+sum+of+the+RAM%0Amemory+required+by+the+processes+assigned+to+that+computer.%0A%E2%97%A6+Network+capacity%3A+The+network+bandwidth+of+a+computer+must+be+at+least+the+sum+of+the%0Anetwork+bandwidth+required+by+the+processes+assigned+to+that+computer.%0AThe+following+soft+constraints+should+be+optimized%3A%0A%E2%80%A2+Each+computer+that+has+one+or+more+processes+assigned%2C+incurs+a+maintenance+cost+%28which+is%0Afixed+per+computer%29.%0A%E2%97%A6+Cost%3A+Minimize+the+total+maintenance+cost.%0AThis+problem+is+a+form+of+bin+packing.+The+following+is+a+simplified+example%2C+in+which+we+assign%0Afour+processes+to+two+computers+with+two+constraints+%28CPU+and+RAM%29+with+a+simple+algorithm%3A%0A15%0AThe+simple+algorithm+used+here+is+the+First+Fit+Decreasing+algorithm%2C+which+assigns+the+bigger%0Aprocesses+first+and+assigns+the+smaller+processes+to+the+remaining+space.+As+you+can+see%2C+it+is+not%0Aoptimal%2C+as+it+does+not+leave+enough+room+to+assign+the+yellow+process+D.%0APlanner+does+find+the+more+optimal+solution+by+using+additional%2C+smarter+algorithms.+It+also+scales%3A%0Aboth+in+data+%28more+processes%2C+more+computers%29+and+constraints+%28more+hardware+requirements%2C%0Aother+constraints%29.+So+let%E2%80%99s+see+how+Planner+can+be+used+in+this+scenario.%0AHere%E2%80%99s+an+executive+summary+of+this+example+and+an+advanced+implementation+with+more%0Aconstraints%3A%0A16%0A2.1.2.+Problem+Size%0ATable+1.+Cloud+Balancing+Problem+Size%0AProblem+Size+Computers+Processes+Search+Space%0A2computers-6processes+2+6+64%0A3computers-9processes+3+9+10%5E4%0A4computers-+4+12+10%5E7%0A012processes%0A100computers-+100+300+10%5E600%0A300processes%0A200computers-+200+600+10%5E1380%0A600processes%0A400computers-+400+1200+10%5E3122%0A1200processes%0A800computers-+800+2400+10%5E6967%0A2400processes%0A2.2.+Using+the+Domain+Model%0A17%0A2.2.1.+Domain+Model+Design%0AUsing+a+domain+model+helps+determine+which+classes+are+planning+entities+and+which+of+their%0Aproperties+are+planning+variables.+It+also+helps+to+simplify+contraints%2C+improve+performance%2C+and%0Aincrease+flexibility+for+future+needs.%0A1.+Draw+a+class+diagram+of+your+domain+model.%0A2.+Normalize+it+to+remove+duplicate+data.%0A3.+Write+down+some+sample+instances+for+each+class.%0A%E2%97%A6+Computer%3A+represents+a+computer+with+certain+hardware+and+maintenance+costs.%0AIn+this+example%2C+the+sample+instances+for+the+Computer+class+are%3A+cpuPower%2C+memory%2C%0AnetworkBandwidth%2C+cost.%0A%E2%97%A6+Process%3A+represents+a+process+with+a+demand.+Needs+to+be+assigned+to+a+Computer+by+Planner.%0ASample+instances+for+Process+are%3A+requiredCpuPower%2C+requiredMemory%2C+and%0ArequiredNetworkBandwidth.%0A%E2%97%A6+CloudBalance%3A+represents+a+problem.+Contains+every+Computer+and+Process+for+a+certain+data%0Aset.%0AThe+sample+instance+for+CloudBalance+is+score.%0A4.+Determine+which+relationships+%28or+fields%29+change+during+planning.%0A%E2%97%A6+Planning+entity%3A+the+class+%28or+classes%29+that+changes+during+solving.+In+this+example%2C+it+is+the%0Aclass+Process.%0A%E2%97%A6+Planning+variable%3A+the+property+%28or+properties%29+of+a+planning+entity+class+that+changes+during%0Asolving.+In+this+example%2C+it+is+the+property+computer+on+the+class+Process.%0A%E2%97%A6+Planning+solution%3A+the+class+that+represents+a+data+set+and+contains+all+planning+entities.+In%0Athis+example+that+is+the+class+CloudBalance.%0AIn+the+UML+class+diagram+below%2C+the+Planner+concepts+are+already+annotated%3A%0A18%0A2.2.2.+Domain+Model+Implementation%0A2.2.2.1.+The+Computer+Class%0AThe+Computer+class+is+a+POJO+%28Plain+Old+Java+Object%29.+Usually%2C+you+will+have+more+of+this+kind+of%0Aclasses+with+input+data.%0AExample+1.+CloudComputer.java%0Apublic+class+CloudComputer+...+%7B%0A%C2%A0+++private+int+cpuPower%3B%0A%C2%A0+++private+int+memory%3B%0A%C2%A0+++private+int+networkBandwidth%3B%0A%C2%A0+++private+int+cost%3B%0A%C2%A0+++...+%2F%2F+getters%0A%7D%0A2.2.2.2.+The+Process+Class%0AThe+Process+class+is+particularly+important.+It+is+the+class+that+is+modified+during+solving.%0A19%0AWe+need+to+tell+Planner+that+it+can+change+the+property+computer.+To+do+this%3A+.+Annotate+the+class%0Awith+%40PlanningEntity.+.+Annotate+the+getter+getComputer%28%29+with+%40PlanningVariable.%0AOf+course%2C+the+property+computer+needs+a+setter+too%2C+so+Planner+can+change+it+during+solving.%0AExample+2.+CloudProcess.java%0A%40PlanningEntity%28...%29%0Apublic+class+CloudProcess+...+%7B%0A%C2%A0+++private+int+requiredCpuPower%3B%0A%C2%A0+++private+int+requiredMemory%3B%0A%C2%A0+++private+int+requiredNetworkBandwidth%3B%0A%C2%A0+++private+CloudComputer+computer%3B%0A%C2%A0+++...+%2F%2F+getters%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22computerRange%22%7D%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setComputer%28CloudComputer+computer%29+%7B%0A%C2%A0+++++++computer+%3D+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+************************************************************************%0A%C2%A0+++%2F%2F+Complex+methods%0A%C2%A0+++%2F%2F+************************************************************************%0A%C2%A0+++...%0A%7D%0A%E2%80%A2+Planner+needs+to+know+which+values+it+can+choose+from+to+assign+to+the+property+computer.%0AThose+values+are+retrieved+from+the+method+CloudBalance.getComputerList%28%29+on+the+planning%0Asolution%2C+which+returns+a+list+of+all+computers+in+the+current+data+set.%0A%E2%80%A2+The+%40PlanningVariable%27s+valueRangeProviderRefs+parameter+on+CloudProcess.getComputer%28%29+needs%0Ato+match+with+the+%40ValueRangeProvider%27s+id+on+CloudBalance.getComputerList%28%29.%0A%EF%81%9A+Instead+of+getter+annotations%2C+it+is+also+possible+to+use+field+annotations.%0A2.2.2.3.+The+CloudBalance+Class%0AThe+CloudBalance+class+has+a+%40PlanningSolution+annotation.%0A%E2%80%A2+It+holds+a+list+of+all+computers+and+processes.%0A20%0A%E2%80%A2+It+represents+both+the+planning+problem+and+%28if+it%E2%80%99s+initialized%29+the+planning+solution.%0A1.+Planner+needs+to+retrieve+the+collection+of+processes+that+it+can+change%2C+therefore+we%0Aannotate+the+getter+getProcessList%28%29+with+%40PlanningEntityCollectionProperty.%0A2.+The+CloudBalance+class+also+has+a+%40PlanningScore+annotated+property+score%2C+which+is+the+Score%0Aof+that+solution+in+its+current+state.+Planner+automatically+updates+it+when+it+calculates+a%0AScore+for+a+solution+instance+and+therefore+it+needs+a+setter.%0A3.+Especially+for+score+calculation+with+Drools%2C+the+property+computerList+needs+to+be+annotated%0Awith+a+%40ProblemFactCollectionProperty+so+the+computers+are+known+to+it.%0AExample+3.+CloudBalance.java%0A%40PlanningSolution%0Apublic+class+CloudBalance+...+%7B%0A%C2%A0+++private+List%3CCloudComputer%3E+computerList%3B%0A%C2%A0+++private+List%3CCloudProcess%3E+processList%3B%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22computerRange%22%29%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CCloudComputer%3E+getComputerList%28%29+%7B%0A%C2%A0+++++++return+computerList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40PlanningEntityCollectionProperty%0A%C2%A0+++public+List%3CCloudProcess%3E+getProcessList%28%29+%7B%0A%C2%A0+++++++return+processList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+HardSoftScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28HardSoftScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A2.3.+Run+the+Cloud+Balancing+Hello+World%0A1.+Download+and+configure+the+examples+in+your+preferred+IDE.%0A21%0A2.+Create+a+run+configuration+with+the+following+main+class%3A%0Aorg.optaplanner.examples.cloudbalancing.app.CloudBalancingHelloWorld%0ABy+default%2C+the+Cloud+Balancing+Hello+World+is+configured+to+run+for+120+seconds.%0AIt+will+execute+the+following+code%3A%0AExample+4.+CloudBalancingHelloWorld.java%0Apublic+class+CloudBalancingHelloWorld+%7B%0A%C2%A0+++public+static+void+main%28String%5B%5D+args%29+%7B%0A%C2%A0+++++++%2F%2F+Build+the+Solver%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%3B%0A%C2%A0+++++++Solver%3CCloudBalance%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0A%C2%A0+++++++%2F%2F+Load+a+problem+with+400+computers+and+1200+processes%0A%C2%A0+++++++CloudBalance+unsolvedCloudBalance+%3D+new+CloudBalancingGenerator%28%29%0A.createCloudBalance%28400%2C+1200%29%3B%0A%C2%A0+++++++%2F%2F+Solve+the+problem%0A%C2%A0+++++++CloudBalance+solvedCloudBalance+%3D+solver.solve%28unsolvedCloudBalance%29%3B%0A%C2%A0+++++++%2F%2F+Display+the+result%0A%C2%A0+++++++System.out.println%28%22%5CnSolved+cloudBalance+with+400+computers+and+1200%0Aprocesses%3A%5Cn%22%0A%C2%A0+++++++++++++++%2B+toDisplayString%28solvedCloudBalance%29%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0AThe+code+example+does+the+following%3A%0A1.+Build+the+Solver+based+on+a+solver+configuration+%28in+this+case+an+XML+file%2C%0AcloudBalancingSolverConfig.xml%2C+from+the+classpath%29.%0ABuilding+the+Solver+is+the+most+complicated+part+of+this+procedure.+For+more+detail%2C+see+Solver%0AConfiguration.%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%3B%0A%C2%A0+++++++Solver+solver%3CCloudBalance%3E+%3D+solverFactory.buildSolver%28%29%3B%0A22%0A2.+Load+the+problem.%0ACloudBalancingGenerator+generates+a+random+problem%3A+you+will+replace+this+with+a+class+that%0Aloads+a+real+problem%2C+for+example+from+a+database.%0A%C2%A0+++++++CloudBalance+unsolvedCloudBalance+%3D+new+CloudBalancingGenerator%28%29%0A.createCloudBalance%28400%2C+1200%29%3B%0A3.+Solve+the+problem.%0A%C2%A0+++++++CloudBalance+solvedCloudBalance+%3D+solver.solve%28unsolvedCloudBalance%29%3B%0A4.+Display+the+result.%0A%C2%A0+++++++System.out.println%28%22%5CnSolved+cloudBalance+with+400+computers+and+1200%0Aprocesses%3A%5Cn%22%0A%C2%A0+++++++++++++++%2B+toDisplayString%28solvedCloudBalance%29%29%3B%0A2.4.+Solver+Configuration%0ATake+a+look+at+the+solver+configuration%3A%0AExample+5.+cloudBalancingSolverConfig.xml%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Domain+model+configuration+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+%3C%21--+Score+configuration+--%3E%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.C%0AloudBalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%21--%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.%0Adrl%3C%2FscoreDrl%3E--%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A%C2%A0+%3C%21--+Optimization+algorithms+configuration+--%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E30%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%3C%2Fsolver%3E%0A23%0AThis+solver+configuration+consists+of+three+parts%3A%0A1.+Domain+model+configuration%3A+What+can+Planner+change%3F%0AWe+need+to+make+Planner+aware+of+our+domain+classes.+In+this+configuration%2C+it+will%0Aautomatically+scan+all+classes+in+your+classpath+%28for+a+%40PlanningEntity+or+%40PlanningSolution%0Aannotation%29%3A%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A2.+Score+configuration%3A+How+should+Planner+optimize+the+planning+variables%3F+What+is+our+goal%3F%0ASince+we+have+hard+and+soft+constraints%2C+we+use+a+HardSoftScore.+But+we+need+to+tell+Planner%0Ahow+to+calculate+the+score%2C+depending+on+our+business+requirements.+Further+down%2C+we+will%0Alook+into+two+alternatives+to+calculate+the+score%3A+using+an+easy+Java+implementation%2C+or+using%0ADrools+DRL.%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.Cl%0AoudBalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%21--%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.d%0Arl%3C%2FscoreDrl%3E--%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A3.+Optimization+algorithms+configuration%3A+How+should+Planner+optimize+it%3F%0AIn+this+case%2C+we+use+the+default+optimization+algorithms+%28because+no+explicit+optimization%0Aalgorithms+are+configured%29+for+30+seconds%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E30%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0APlanner+should+get+a+good+result+in+seconds+%28and+even+in+less+than+15+milliseconds+with+real-%0Atime+planning%29%2C+but+the+more+time+it+has%2C+the+better+the+result+will+be.+Advanced+use+cases+might%0Ause+a+different+termination+criteria+than+a+hard+time+limit.%0AThe+default+algorithms+will+already+easily+surpass+human+planners+and+most+in-house%0Aimplementations.+Use+the+Benchmarker+to+power+tweak+to+get+even+better+results.%0A2.5.+Score+Configuration%0APlanner+will+search+for+the+Solution+with+the+highest+Score.+This+example+uses+a+HardSoftScore%2C%0Awhich+means+Planner+will+look+for+the+solution+with+no+hard+constraints+broken+%28fulfill+hardware%0A24%0Arequirements%29+and+as+little+as+possible+soft+constraints+broken+%28minimize+maintenance+cost%29.%0AOf+course%2C+Planner+needs+to+be+told+about+these+domain-specific+score+constraints.+There+are+several%0Aways+to+implement+such+a+score+function%3A%0A%E2%80%A2+Easy+Java%0A%E2%80%A2+Incremental+Java%0A%E2%80%A2+Drools%0A2.5.1.+Easy+Java+Score+Configuration%0AOne+way+to+define+a+score+function+is+to+implement+the+interface+EasyScoreCalculator+in+plain+Java.%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.cloudbalancing.optional.score.Cloud%0ABalancingEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AJust+implement+the+calculateScore%28Solution%29+method+to+return+a+HardSoftScore+instance.%0AExample+6.+CloudBalancingEasyScoreCalculator.java%0A25%0Apublic+class+CloudBalancingEasyScoreCalculator+implements+EasyScoreCalculator%0A%3CCloudBalance%3E+%7B%0A%C2%A0+++%2F**%0A%C2%A0++++*+A+very+simple+implementation.+The+double+loop+can+easily+be+removed+by%0Ausing+Maps+as+shown+in%0A%C2%A0++++*+%7B%40link%0ACloudBalancingMapBasedEasyScoreCalculator%23calculateScore%28CloudBalance%29%7D.%0A%C2%A0++++*%2F%0A%C2%A0+++public+HardSoftScore+calculateScore%28CloudBalance+cloudBalance%29+%7B%0A%C2%A0+++++++int+hardScore+%3D+0%3B%0A%C2%A0+++++++int+softScore+%3D+0%3B%0A%C2%A0+++++++for+%28CloudComputer+computer+%3A+cloudBalance.getComputerList%28%29%29+%7B%0A%C2%A0+++++++++++int+cpuPowerUsage+%3D+0%3B%0A%C2%A0+++++++++++int+memoryUsage+%3D+0%3B%0A%C2%A0+++++++++++int+networkBandwidthUsage+%3D+0%3B%0A%C2%A0+++++++++++boolean+used+%3D+false%3B%0A%C2%A0+++++++++++%2F%2F+Calculate+usage%0A%C2%A0+++++++++++for+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++++++if+%28computer.equals%28process.getComputer%28%29%29%29+%7B%0A%C2%A0+++++++++++++++++++cpuPowerUsage+%2B%3D+process.getRequiredCpuPower%28%29%3B%0A%C2%A0+++++++++++++++++++memoryUsage+%2B%3D+process.getRequiredMemory%28%29%3B%0A%C2%A0+++++++++++++++++++networkBandwidthUsage+%2B%3D+process.getRequiredNetworkBandwidth%28%0A%29%3B%0A%C2%A0+++++++++++++++++++used+%3D+true%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+Hard+constraints%0A%C2%A0+++++++++++int+cpuPowerAvailable+%3D+computer.getCpuPower%28%29+-+cpuPowerUsage%3B%0A%C2%A0+++++++++++if+%28cpuPowerAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+cpuPowerAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++int+memoryAvailable+%3D+computer.getMemory%28%29+-+memoryUsage%3B%0A%C2%A0+++++++++++if+%28memoryAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+memoryAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++int+networkBandwidthAvailable+%3D+computer.getNetworkBandwidth%28%29+-%0AnetworkBandwidthUsage%3B%0A%C2%A0+++++++++++if+%28networkBandwidthAvailable+%3C+0%29+%7B%0A%C2%A0+++++++++++++++hardScore+%2B%3D+networkBandwidthAvailable%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+Soft+constraints%0A%C2%A0+++++++++++if+%28used%29+%7B%0A%C2%A0+++++++++++++++softScore+-%3D+computer.getCost%28%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+HardSoftScore.valueOf%28hardScore%2C+softScore%29%3B%0A%C2%A0+++%7D%0A26%0A%7D%0AEven+if+we+optimize+the+code+above+to+use+Maps+to+iterate+through+the+processList+only+once%2C+it+is+still%0Aslow+because+it+does+not+do+incremental+score+calculation.+To+fix+that%2C+either+use+incremental+Java%0Ascore+calculation+or+Drools+score+calculation.%0A2.5.2.+Drools+Score+Configuration%0ADrools+score+calculation+uses+incremental+calculation%2C+where+every+score+constraint+is+written+as%0Aone+or+more+score+rules.%0AUsing+the+Drools+rule+engine+for+score+calculation%2C+allows+you+to+integrate+with+other+Drools%0Atechnologies%2C+such+as+decision+tables+%28XLS+or+web+based%29%2C+the+KIE+Workbench%2C+%E2%80%A6%0APrerequisite+To+use+the+Drools+rule+engine+as+a+score+function%2C+simply+add+a+scoreDrl+resource+in%0Athe+classpath%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingScoreRules.drl%3C%0A%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A1.+We+want+to+make+sure+that+all+computers+have+enough+CPU%2C+RAM+and+network+bandwidth+to%0Asupport+all+their+processes%2C+so+we+make+these+hard+constraints%3A%0A27%0AExample+7.+cloudBalancingScoreRules.drl+-+Hard+Constraints%0A...%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudBalance%3B%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudComputer%3B%0Aimport+org.optaplanner.examples.cloudbalancing.domain.CloudProcess%3B%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%2F%2F+Hard+constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0Arule+%22requiredCpuPowerTotal%22%0A%C2%A0+++when%0A%C2%A0+++++++%24computer+%3A+CloudComputer%28%24cpuPower+%3A+cpuPower%29%0A%C2%A0+++++++accumulate%28%0A%C2%A0+++++++++++CloudProcess%28%0A%C2%A0+++++++++++++++computer+%3D%3D+%24computer%2C%0A%C2%A0+++++++++++++++%24requiredCpuPower+%3A+requiredCpuPower%29%3B%0A%C2%A0+++++++++++%24requiredCpuPowerTotal+%3A+sum%28%24requiredCpuPower%29%3B%0A%C2%A0+++++++++++%24requiredCpuPowerTotal+%3E+%24cpuPower%0A%C2%A0+++++++%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addHardConstraintMatch%28kcontext%2C+%24cpuPower+-%0A%24requiredCpuPowerTotal%29%3B%0Aend%0Arule+%22requiredMemoryTotal%22%0A%C2%A0+++...%0Aend%0Arule+%22requiredNetworkBandwidthTotal%22%0A%C2%A0+++...%0Aend%0A2.+If+those+constraints+are+met%2C+we+want+to+minimize+the+maintenance+cost%2C+so+we+add+that+as+a+soft%0Aconstraint%3A%0A28%0AExample+8.+cloudBalancingScoreRules.drl+-+Soft+Constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%2F%2F+Soft+constraints%0A%2F%2F+%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0Arule+%22computerCost%22%0A%C2%A0+++when%0A%C2%A0+++++++%24computer+%3A+CloudComputer%28%24cost+%3A+cost%29%0A%C2%A0+++++++exists+CloudProcess%28computer+%3D%3D+%24computer%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-+%24cost%29%3B%0Aend%0A2.6.+Beyond+this+Tutorial%0ANow+that+this+simple+example+works%2C+try+going+further.+Enrich+the+domain+model+and+add+extra%0Aconstraints+such+as+these%3A%0A%E2%80%A2+Each+Process+belongs+to+a+Service.+A+computer+might+crash%2C+so+processes+running+the+same%0Aservice+should+be+assigned+to+different+computers.%0A%E2%80%A2+Each+Computer+is+located+in+a+Building.+A+building+might+burn+down%2C+so+processes+of+the+same%0Aservices+should+be+assigned+to+computers+in+different+buildings.%0A29%0AChapter+3.+Use+Cases+and+Examples%0A3.1.+Examples+Overview%0APlanner+has+several+examples.+In+this+manual+we+explain+mainly+using+the+n+queens+example+and%0Acloud+balancing+example.+So+it+is+advisable+to+read+at+least+those+sections.%0AThe+Competition%3F+column+in+the+following+table+identifies+an+example+as+being+either+realistic+or%0Aunrealistic.+A+realistic+competition+is+an+official%2C+independent+competition%3A%0A%E2%80%A2+that+clearly+defines+a+real-word+use+case.%0A%E2%80%A2+with+real-world+constraints.%0A%E2%80%A2+with+multiple%2C+real-world+datasets.%0A%E2%80%A2+that+expects+reproducible+results+within+a+specific+time+limit+on+specific+hardware.%0A%E2%80%A2+that+has+had+serious+participation+from+the+academic+and%2For+enterprise+Operations+Research%0Acommunity.%0AThese+realistic+competitions+provide+an+objective+comparison+of+Planner+with+competitive+software%0Aand+academic+research.%0AThe+source+code+of+all+these+examples+is+available+in+the+distribution+zip+under+examples%2Fsources%0Aand+also+in+git+under+optaplanner%2Foptaplanner-examples.%0ATable+2.+Examples+Overview%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0AN+queens+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+256+%E2%80%A2+Pointless+None%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%28cheatable%29256%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E616%0ACloud+balancing+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2400+%E2%80%A2+No+%E2%80%A2+Real-time%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+planning800%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E6967%0ATraveling+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+980+%E2%80%A2+Unrealistic+%E2%80%A2+Real-time%0Asalesman%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+980+%E2%80%A2+TSP+web+planning%0Avariable+%E2%80%A2+Search+space%0A%E2%87%90+10%5E2504%0A30%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0ADinner+party+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+144+%E2%80%A2+Unrealistic+%E2%80%A2+Decision+Table%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+spreadsheet72%0A%28XLS%29+for+score%0A%E2%80%A2+Search+space+constraints%0A%E2%87%90+10%5E310%0ATennis+club+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+72+%E2%80%A2+No+%E2%80%A2+Fairness+score%0Ascheduling%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+constraints7%0A%E2%80%A2+Search+space+%E2%80%A2+Immovable%0A%E2%87%90+entities10%5E60%0AMeeting+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+10+%E2%80%A2+No+%E2%80%A2+TimeGrain%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+pattern320%0Aand+%E2%87%90+5%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E320%0ACourse+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+434+%E2%80%A2+Realistic+%E2%80%A2+Immovable%0Atimetabling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+ITC+2007+track+entities25%0Aand+%E2%87%90+20+3%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E1171%0AMachine+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+50000+%E2%80%A2+Nearly+%E2%80%A2+Real-time%0Areassignment%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+realistic+planning5000%0A%E2%80%A2+Search+space+%E2%80%A2+ROADEF+2012%0A%E2%87%90+10%5E184948%0AVehicle+routing+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2740+%E2%80%A2+Unrealistic+%E2%80%A2+Shadow%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+2795+%E2%80%A2+VRP+web+variable%0Avariable+%E2%80%A2+Search+space+%E2%80%A2+Real-time%0A%E2%80%A2+1+shadow+%E2%87%90+planning10%5E8380%0Aentity+class+%E2%80%A2+Nearby%0A%E2%97%A6+1+selection%0Aautomatic+%E2%80%A2+Real+road%0Ashadow+distances%0Avariable%0A31%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0AVehicle+routing+%E2%80%A2+All+of+Vehicle+%E2%80%A2+Entity+%E2%87%90+2740+%E2%80%A2+Unrealistic+%E2%80%A2+All+of+Vehicle%0Awith+time+routing%0Awindows+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+VRP+web%0Arouting%0A2795%0A%E2%80%A2+1+shadow+%E2%80%A2+Search+space+%E2%80%A2+Custom%0Avariable+%E2%87%90+VariableListen10%5E8380%0Aer%0AProject+job+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+640+%E2%80%A2+Nearly+%E2%80%A2+Bendable%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+%3F+and+realistic+score%0A%E2%97%A6+1+shadow+%E2%87%90+%3F+%E2%80%A2+MISTA+2013+%E2%80%A2+Custom%0Avariable+%E2%80%A2+Search+space+VariableListen%0A%E2%87%90+er%3F%0A%E2%80%A2+ValueRangeFa%0Actory%0AHospital+bed+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+2750+%E2%80%A2+Unrealistic+%E2%80%A2+Overconstrain%0Aplanning%0A%E2%97%A6+1+nullable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Kaho+PAS+ed+planning471%0Avariable+%E2%80%A2+Search+space%0A%E2%87%90+10%5E6851%0ATask+assigning+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+500+%E2%80%A2+No+%E2%80%A2+Bendable%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+Defined+by+us+score520%0Avariable+%E2%80%A2+Search+space+%E2%80%A2+Chained%0A%E2%97%A6+1+shadow+%E2%87%90+through+time10%5E1168%0Avariable+pattern%0A%E2%80%A2+1+shadow+%E2%80%A2+Custom%0Aentity+class+VariableListen%0Aer%0A%E2%97%A6+1%0Aautomatic+%E2%80%A2+Continuous%0Ashadow+planning%0Avariable+%E2%80%A2+Real-time%0Aplanning%0AExam+timetabling+%E2%80%A2+2+entity+classes+%E2%80%A2+Entity+%E2%87%90+1096+%E2%80%A2+Realistic+%E2%80%A2+Custom%0A%28same+%E2%80%A2+Value+%E2%87%90+80+%E2%80%A2+ITC+2007+track+VariableListen%0Ahierarchy%29+and+%E2%87%90+1+er49%0A%E2%97%A6+2+variables+%E2%80%A2+Search+space%0A%E2%87%90+10%5E3374%0A32%0AExample+Domain+Size+Competition%3F+Special+features%0Aused%0ANurse+rostering+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+752+%E2%80%A2+Realistic+%E2%80%A2+Continuous%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+INRC+2010+planning50%0A%E2%80%A2+Search+space+%E2%80%A2+Real-time%0A%E2%87%90+planning10%5E1277%0ATraveling+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+1560+%E2%80%A2+Unrealistic+%E2%80%A2+Custom%0Atournament%0A%E2%97%A6+1+variable+%E2%80%A2+Value+%E2%87%90+%E2%80%A2+TTP+MoveListFacto78%0Ary%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E2301%0ACheap+time+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+500+%E2%80%A2+Nearly+%E2%80%A2+Field%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+realistic+annotations100%0Aand+%E2%87%90+288+%E2%80%A2+ICON+Energy+%E2%80%A2+ValueRangeFa%0A%E2%80%A2+Search+space+ctory%0A%E2%87%90+10%5E20078%0AInvestment+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+11+%E2%80%A2+No+%E2%80%A2+ValueRangeFa%0A%E2%80%A2+1+variable+%E2%80%A2+Value+%3D+ctory1000+%E2%80%A2+Defined+by+us%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E4%0AConference+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+216+%E2%80%A2+No%0Ascheduling%0A%E2%97%A6+2+variables+%E2%80%A2+Value+%E2%87%90+18+%E2%80%A2+Defined+by+us%0Aand+%E2%87%90+20%0A%E2%80%A2+Search+space%0A%E2%87%90+10%5E552%0ARock+Tour+%E2%80%A2+1+entity+class+%E2%80%A2+Entity+%E2%87%90+47+%E2%80%A2+No%0A%E2%97%A6+1+chained+%E2%80%A2+Value+%E2%87%90+48+%E2%80%A2+Defined+by+us%0Avariable+%E2%80%A2+Search+space%0A%E2%97%A6+4+shadow+%E2%87%90+10%5E59%0Avariables%0A%E2%80%A2+1+shadow%0Aentity+class%0A%E2%97%A6+1%0Aautomatic%0Ashadow%0Avariable%0A33%0A3.2.+N+Queens%0A3.2.1.+Problem+Description%0APlace+n+queens+on+a+n+sized+chessboard+so+that+no+two+queens+can+attack+each+other.+The+most%0Acommon+n+queens+puzzle+is+the+eight+queens+puzzle%2C+with+n+%3D+8%3A%0AConstraints%3A%0A%E2%80%A2+Use+a+chessboard+of+n+columns+and+n+rows.%0A%E2%80%A2+Place+n+queens+on+the+chessboard.%0A%E2%80%A2+No+two+queens+can+attack+each+other.+A+queen+can+attack+any+other+queen+on+the+same%0Ahorizontal%2C+vertical+or+diagonal+line.%0AThis+documentation+heavily+uses+the+four+queens+puzzle+as+the+primary+example.%0AA+proposed+solution+could+be%3A%0A34%0AFigure+1.+A+Wrong+Solution+for+the+Four+Queens+Puzzle%0AThe+above+solution+is+wrong+because+queens+A1+and+B0+can+attack+each+other+%28so+can+queens+B0+and%0AD0%29.+Removing+queen+B0+would+respect+the+%22no+two+queens+can+attack+each+other%22+constraint%2C+but%0Awould+break+the+%22place+n+queens%22+constraint.%0ABelow+is+a+correct+solution%3A%0AFigure+2.+A+Correct+Solution+for+the+Four+Queens+Puzzle%0AAll+the+constraints+have+been+met%2C+so+the+solution+is+correct.%0ANote+that+most+n+queens+puzzles+have+multiple+correct+solutions.+We+will+focus+on+finding+a+single%0Acorrect+solution+for+a+given+n%2C+not+on+finding+the+number+of+possible+correct+solutions+for+a+given+n.%0A3.2.2.+Problem+Size%0A4queens+++has+++4+queens+with+a+search+space+of++++256.%0A8queens+++has+++8+queens+with+a+search+space+of+++10%5E7.%0A16queens++has++16+queens+with+a+search+space+of++10%5E19.%0A32queens++has++32+queens+with+a+search+space+of++10%5E48.%0A64queens++has++64+queens+with+a+search+space+of+10%5E115.%0A256queens+has+256+queens+with+a+search+space+of+10%5E616.%0AThe+implementation+of+the+n+queens+example+has+not+been+optimized+because+it+functions+as+a%0Abeginner+example.+Nevertheless%2C+it+can+easily+handle+64+queens.+With+a+few+changes+it+has+been%0Ashown+to+easily+handle+5000+queens+and+more.%0A3.2.3.+Domain+Model%0AThis+example+uses+the+domain+model+to+solve+the+four+queens+problem.%0A1.+Creating+a+Domain+Model+A+good+domain+model+will+make+it+easier+to+understand+and+solve%0A35%0Ayour+planning+problem.%0AThis+is+the+domain+model+for+the+n+queens+example%3A%0Apublic+class+Column+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0Apublic+class+Row+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0Apublic+class+Queen+%7B%0A%C2%A0+++private+Column+column%3B%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++public+int+getAscendingDiagonalIndex%28%29+%7B...%7D%0A%C2%A0+++public+int+getDescendingDiagonalIndex%28%29+%7B...%7D%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0A2.+Calculating+the+Search+Space.%0AA+Queen+instance+has+a+Column+%28for+example%3A+0+is+column+A%2C+1+is+column+B%2C+%E2%80%A6%29+and+a+Row+%28its+row%2C%0Afor+example%3A+0+is+row+0%2C+1+is+row+1%2C+%E2%80%A6%29.%0AThe+ascending+diagonal+line+and+the+descending+diagonal+line+can+be+calculated+based+on+the%0Acolumn+and+the+row.%0AThe+column+and+row+indexes+start+from+the+upper+left+corner+of+the+chessboard.%0A36%0Apublic+class+NQueens+%7B%0A%C2%A0+++private+int+n%3B%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0A3.+Finding+the+Solution%0AA+single+NQueens+instance+contains+a+list+of+all+Queen+instances.+It+is+the+Solution+implementation%0Awhich+will+be+supplied+to%2C+solved+by%2C+and+retrieved+from+the+Solver.%0ANotice+that+in+the+four+queens+example%2C+NQueens%E2%80%99s+getN%28%29+method+will+always+return+four.%0ATable+3.+A+Solution+for+Four+Queens+Shown+in+the+Domain+Model%0AA+solution+Queen+column+rowInd+ascend+descen%0AIndex+ex+ingDia+dingDi%0AgonalI+agonalI%0Andex+ndex%0A%28colum+%28colum%0AnIndex+nIndex%0A%2B+-%0ArowInd+rowInd%0Aex%29+ex%29%0AA1+0+1+1+%28**%29+-1%0AB0+1+0+%28*%29+1+%28**%29+1%0AC2+2+2+4+0%0AD0+3+0+%28*%29+3+3%0AWhen+two+queens+share+the+same+column%2C+row+or+diagonal+line%2C+such+as+%28*%29+and+%28**%29%2C+they+can+attack%0Aeach+other.%0A3.3.+Cloud+Balancing%0AThis+example+is+explained+in+a+tutorial.%0A37%0A3.4.+Traveling+Salesman+%28TSP+-+Traveling+Salesman%0AProblem%29%0A3.4.1.+Problem+Description%0AGiven+a+list+of+cities%2C+find+the+shortest+tour+for+a+salesman+that+visits+each+city+exactly+once.%0AThe+problem+is+defined+by+Wikipedia.+It+is+one+of+the+most+intensively+studied+problems+in%0Acomputational+mathematics.+Yet%2C+in+the+real+world%2C+it+is+often+only+part+of+a+planning+problem%2C+along%0Awith+other+constraints%2C+such+as+employee+shift+rostering+constraints.%0A3.4.2.+Problem+Size%0Adj38+++++has++38+cities+with+a+search+space+of+++10%5E43.%0Aeurope40+has++40+cities+with+a+search+space+of+++10%5E46.%0Ast70+++++has++70+cities+with+a+search+space+of+++10%5E98.%0Apcb442+++has+442+cities+with+a+search+space+of++10%5E976.%0Alu980++++has+980+cities+with+a+search+space+of+10%5E2504.%0A3.4.3.+Problem+Difficulty%0ADespite+TSP%E2%80%99s+simple+definition%2C+the+problem+is+surprisingly+hard+to+solve.+Because+it+is+an+NP-hard%0Aproblem+%28like+most+planning+problems%29%2C+the+optimal+solution+for+a+specific+problem+dataset+can%0Achange+a+lot+when+that+problem+dataset+is+slightly+altered%3A%0A38%0A3.5.+Dinner+Party%0A3.5.1.+Problem+Description%0AMiss+Manners+is+throwing+another+dinner+party.%0A%E2%80%A2+This+time+she+invited+144+guests+and+prepared+12+round+tables+with+12+seats+each.%0A%E2%80%A2+Every+guest+should+sit+next+to+someone+%28left+and+right%29+of+the+opposite+gender.%0A%E2%80%A2+And+that+neighbour+should+have+at+least+one+hobby+in+common+with+the+guest.%0A%E2%80%A2+At+every+table%2C+there+should+be+two+politicians%2C+two+doctors%2C+two+socialites%2C+two+coaches%2C+two%0Ateachers+and+two+programmers.%0A%E2%80%A2+And+the+two+politicians%2C+two+doctors%2C+two+coaches+and+two+programmers+should+not+be+the+same%0Akind+at+a+table.%0ADrools+Expert+also+has+the+normal+Miss+Manners+example+%28which+is+much+smaller%29+and+employs+an%0Aexhaustive+heuristic+to+solve+it.+Planner%E2%80%99s+implementation+is+far+more+scalable+because+it+uses%0Aheuristics+to+find+the+best+solution+and+Drools+Expert+to+calculate+the+score+of+each+solution.%0A3.5.2.+Problem+Size%0A39%0Awedding01+has+18+jobs%2C+144+guests%2C+288+hobby+practicians%2C+12+tables+and+144+seats+with%0Aa+search+space+of+10%5E310.%0A3.6.+Tennis+Club+Scheduling%0A3.6.1.+Problem+Description%0AEvery+week+the+tennis+club+has+four+teams+playing+round+robin+against+each+other.+Assign+those%0Afour+spots+to+the+teams+fairly.%0AHard+constraints%3A%0A%E2%80%A2+Conflict%3A+A+team+can+only+play+once+per+day.%0A%E2%80%A2+Unavailability%3A+Some+teams+are+unavailable+on+some+dates.%0AMedium+constraints%3A%0A%E2%80%A2+Fair+assignment%3A+All+teams+should+play+an+%28almost%29+equal+number+of+times.%0ASoft+constraints%3A%0A%E2%80%A2+Evenly+confrontation%3A+Each+team+should+play+against+every+other+team+an+equal+number+of%0Atimes.%0A3.6.2.+Problem+Size%0Amunich-7teams+has+7+teams%2C+18+days%2C+12+unavailabilityPenalties+and+72+teamAssignments%0Awith+a+search+space+of+10%5E60.%0A3.6.3.+Domain+Model%0A40%0A3.7.+Meeting+Scheduling%0A3.7.1.+Problem+Description%0AAssign+each+meeting+to+a+starting+time+and+a+room.+Meetings+have+different+durations.%0AHard+constraints%3A%0A%E2%80%A2+Room+conflict%3A+two+meetings+must+not+use+the+same+room+at+the+same+time.%0A%E2%80%A2+Required+attendance%3A+A+person+cannot+have+two+required+meetings+at+the+same+time.%0A%E2%80%A2+Required+room+capacity%3A+A+meeting+must+not+be+in+a+room+that+doesn%E2%80%99t+fit+all+of+the+meeting%E2%80%99s%0Aattendees.%0A%E2%80%A2+Start+and+end+on+same+day%3A+A+meeting+shouldn%E2%80%99t+be+scheduled+over+multiple+days.%0AMedium+constraints%3A%0A%E2%80%A2+Preferred+attendance%3A+A+person+cannot+have+two+preferred+meetings+at+the+same+time%2C+nor+a%0Apreferred+and+a+required+meeting+at+the+same+time.%0ASoft+constraints%3A%0A%E2%80%A2+Sooner+rather+than+later%3A+Schedule+all+meetings+as+soon+as+possible.%0A41%0A%E2%80%A2+A+break+between+meetings%3A+Any+two+meetings+should+have+at+least+one+time+grain+break%0Abetween+them.%0A%E2%80%A2+Overlapping+meetings%3A+To+minimize+the+number+of+meetings+in+parallel+so+people+don%E2%80%99t+have+to%0Achoose+one+meeting+over+the+other.%0A%E2%80%A2+Assign+larger+rooms+first%3A+If+a+larger+room+is+available+any+meeting+should+be+assigned+to+that%0Aroom+in+order+to+accommodate+as+many+people+as+possible+even+if+they+haven%E2%80%99t+signed+up+to+that%0Ameeting.%0A%E2%80%A2+Room+stability%3A+If+a+person+has+two+consecutive+meetings+with+two+or+less+time+grains+break%0Abetween+them+they+better+be+in+the+same+room.%0A3.7.2.+Problem+Size%0A50meetings-160timegrains-5rooms++has++50+meetings%2C+160+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E145.%0A100meetings-320timegrains-5rooms+has+100+meetings%2C+320+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E320.%0A200meetings-640timegrains-5rooms+has+200+meetings%2C+640+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E701.%0A400meetings-1280timegrains-5rooms+has+400+meetings%2C+1280+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E1522.%0A800meetings-2560timegrains-5rooms+has+800+meetings%2C+2560+timeGrains+and+5+rooms+with+a%0Asearch+space+of+10%5E3285.%0A3.8.+Course+Timetabling+%28ITC+2007+Track+3+-+Curriculum%0ACourse+Scheduling%29%0A3.8.1.+Problem+Description%0ASchedule+each+lecture+into+a+timeslot+and+into+a+room.%0AHard+constraints%3A%0A%E2%80%A2+Teacher+conflict%3A+A+teacher+must+not+have+two+lectures+in+the+same+period.%0A%E2%80%A2+Curriculum+conflict%3A+A+curriculum+must+not+have+two+lectures+in+the+same+period.%0A%E2%80%A2+Room+occupancy%3A+two+lectures+must+not+be+in+the+same+room+in+the+same+period.%0A%E2%80%A2+Unavailable+period+%28specified+per+dataset%29%3A+A+specific+lecture+must+not+be+assigned+to+a+specific%0Aperiod.%0ASoft+constraints%3A%0A%E2%80%A2+Room+capacity%3A+A+room%E2%80%99s+capacity+should+not+be+less+than+the+number+of+students+in+its+lecture.%0A%E2%80%A2+Minimum+working+days%3A+Lectures+of+the+same+course+should+be+spread+out+into+a+minimum%0Anumber+of+days.%0A%E2%80%A2+Curriculum+compactness%3A+Lectures+belonging+to+the+same+curriculum+should+be+adjacent+to+each%0A42%0Aother+%28so+in+consecutive+periods%29.%0A%E2%80%A2+Room+stability%3A+Lectures+of+the+same+course+should+be+assigned+to+the+same+room.%0AThe+problem+is+defined+by+the+International+Timetabling+Competition+2007+track+3.%0A3.8.2.+Problem+Size%0Acomp01+has+24+teachers%2C++14+curricula%2C++30+courses%2C+160+lectures%2C+30+periods%2C++6+rooms%0Aand+++53+unavailable+period+constraints+with+a+search+space+of++10%5E360.%0Acomp02+has+71+teachers%2C++70+curricula%2C++82+courses%2C+283+lectures%2C+25+periods%2C+16+rooms%0Aand++513+unavailable+period+constraints+with+a+search+space+of++10%5E736.%0Acomp03+has+61+teachers%2C++68+curricula%2C++72+courses%2C+251+lectures%2C+25+periods%2C+16+rooms%0Aand++382+unavailable+period+constraints+with+a+search+space+of++10%5E653.%0Acomp04+has+70+teachers%2C++57+curricula%2C++79+courses%2C+286+lectures%2C+25+periods%2C+18+rooms%0Aand++396+unavailable+period+constraints+with+a+search+space+of++10%5E758.%0Acomp05+has+47+teachers%2C+139+curricula%2C++54+courses%2C+152+lectures%2C+36+periods%2C++9+rooms%0Aand++771+unavailable+period+constraints+with+a+search+space+of++10%5E381.%0Acomp06+has+87+teachers%2C++70+curricula%2C+108+courses%2C+361+lectures%2C+25+periods%2C+18+rooms%0Aand++632+unavailable+period+constraints+with+a+search+space+of++10%5E957.%0Acomp07+has+99+teachers%2C++77+curricula%2C+131+courses%2C+434+lectures%2C+25+periods%2C+20+rooms%0Aand++667+unavailable+period+constraints+with+a+search+space+of+10%5E1171.%0Acomp08+has+76+teachers%2C++61+curricula%2C++86+courses%2C+324+lectures%2C+25+periods%2C+18+rooms%0Aand++478+unavailable+period+constraints+with+a+search+space+of++10%5E859.%0Acomp09+has+68+teachers%2C++75+curricula%2C++76+courses%2C+279+lectures%2C+25+periods%2C+18+rooms%0Aand++405+unavailable+period+constraints+with+a+search+space+of++10%5E740.%0Acomp10+has+88+teachers%2C++67+curricula%2C+115+courses%2C+370+lectures%2C+25+periods%2C+18+rooms%0Aand++694+unavailable+period+constraints+with+a+search+space+of++10%5E981.%0Acomp11+has+24+teachers%2C++13+curricula%2C++30+courses%2C+162+lectures%2C+45+periods%2C++5+rooms%0Aand+++94+unavailable+period+constraints+with+a+search+space+of++10%5E381.%0Acomp12+has+74+teachers%2C+150+curricula%2C++88+courses%2C+218+lectures%2C+36+periods%2C+11+rooms%0Aand+1368+unavailable+period+constraints+with+a+search+space+of++10%5E566.%0Acomp13+has+77+teachers%2C++66+curricula%2C++82+courses%2C+308+lectures%2C+25+periods%2C+19+rooms%0Aand++468+unavailable+period+constraints+with+a+search+space+of++10%5E824.%0Acomp14+has+68+teachers%2C++60+curricula%2C++85+courses%2C+275+lectures%2C+25+periods%2C+17+rooms%0Aand++486+unavailable+period+constraints+with+a+search+space+of++10%5E722.%0A3.8.3.+Domain+Model%0A43%0A3.9.+Machine+Reassignment+%28Google+ROADEF+2012%29%0A3.9.1.+Problem+Description%0AAssign+each+process+to+a+machine.+All+processes+already+have+an+original+%28unoptimized%29+assignment.%0AEach+process+requires+an+amount+of+each+resource+%28such+as+CPU%2C+RAM%2C+%E2%80%A6%29.+This+is+a+more+complex%0Aversion+of+the+Cloud+Balancing+example.%0AHard+constraints%3A%0A%E2%80%A2+Maximum+capacity%3A+The+maximum+capacity+for+each+resource+for+each+machine+must+not+be%0Aexceeded.%0A%E2%80%A2+Conflict%3A+Processes+of+the+same+service+must+run+on+distinct+machines.%0A%E2%80%A2+Spread%3A+Processes+of+the+same+service+must+be+spread+out+across+locations.%0A%E2%80%A2+Dependency%3A+The+processes+of+a+service+depending+on+another+service+must+run+in+the%0Aneighborhood+of+a+process+of+the+other+service.%0A%E2%80%A2+Transient+usage%3A+Some+resources+are+transient+and+count+towards+the+maximum+capacity+of%0Aboth+the+original+machine+as+the+newly+assigned+machine.%0ASoft+constraints%3A%0A%E2%80%A2+Load%3A+The+safety+capacity+for+each+resource+for+each+machine+should+not+be+exceeded.%0A44%0A%E2%80%A2+Balance%3A+Leave+room+for+future+assignments+by+balancing+the+available+resources+on+each%0Amachine.%0A%E2%80%A2+Process+move+cost%3A+A+process+has+a+move+cost.%0A%E2%80%A2+Service+move+cost%3A+A+service+has+a+move+cost.%0A%E2%80%A2+Machine+move+cost%3A+Moving+a+process+from+machine+A+to+machine+B+has+another+A-B+specific%0Amove+cost.%0AThe+problem+is+defined+by+the+Google+ROADEF%2FEURO+Challenge+2012.%0A3.9.2.+Value+Proposition%0A45%0A3.9.3.+Problem+Size%0A46%0Amodel_a1_1+has++2+resources%2C++1+neighborhoods%2C+++4+locations%2C++++4+machines%2C++++79%0Aservices%2C+++100+processes+and+1+balancePenalties+with+a+search+space+of+++++10%5E60.%0Amodel_a1_2+has++4+resources%2C++2+neighborhoods%2C+++4+locations%2C++100+machines%2C+++980%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a1_3+has++3+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++216%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a1_4+has++3+resources%2C+50+neighborhoods%2C++50+locations%2C+++50+machines%2C+++142%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_a1_5+has++4+resources%2C++2+neighborhoods%2C+++4+locations%2C+++12+machines%2C+++981%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1079.%0Amodel_a2_1+has++3+resources%2C++1+neighborhoods%2C+++1+locations%2C++100+machines%2C++1000%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_2+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++170%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_3+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C++100+machines%2C+++129%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E2000.%0Amodel_a2_4+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C+++50+machines%2C+++180%0Aservices%2C++1000+processes+and+1+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_a2_5+has+12+resources%2C++5+neighborhoods%2C++25+locations%2C+++50+machines%2C+++153%0Aservices%2C++1000+processes+and+0+balancePenalties+with+a+search+space+of+++10%5E1698.%0Amodel_b_1++has+12+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C++2512%0Aservices%2C++5000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E10000.%0Amodel_b_2++has+12+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C++2462%0Aservices%2C++5000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E10000.%0Amodel_b_3++has++6+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+15025%0Aservices%2C+20000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E40000.%0Amodel_b_4++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C++500+machines%2C++1732%0Aservices%2C+20000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E53979.%0Amodel_b_5++has++6+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+35082%0Aservices%2C+40000+processes+and+0+balancePenalties+with+a+search+space+of++10%5E80000.%0Amodel_b_6++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C++200+machines%2C+14680%0Aservices%2C+40000+processes+and+1+balancePenalties+with+a+search+space+of++10%5E92041.%0Amodel_b_7++has++6+resources%2C++5+neighborhoods%2C++50+locations%2C+4000+machines%2C+15050%0Aservices%2C+40000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E144082.%0Amodel_b_8++has++3+resources%2C++5+neighborhoods%2C++10+locations%2C++100+machines%2C+45030%0Aservices%2C+50000+processes+and+0+balancePenalties+with+a+search+space+of+10%5E100000.%0Amodel_b_9++has++3+resources%2C++5+neighborhoods%2C+100+locations%2C+1000+machines%2C++4609%0Aservices%2C+50000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E150000.%0Amodel_b_10+has++3+resources%2C++5+neighborhoods%2C+100+locations%2C+5000+machines%2C++4896%0Aservices%2C+50000+processes+and+1+balancePenalties+with+a+search+space+of+10%5E184948.%0A3.9.4.+Domain+Model%0A47%0A3.10.+Vehicle+Routing%0A3.10.1.+Problem+Description%0AUsing+a+fleet+of+vehicles%2C+pick+up+the+objects+of+each+customer+and+bring+them+to+the+depot.+Each%0Avehicle+can+service+multiple+customers%2C+but+it+has+a+limited+capacity.%0A48%0ABesides+the+basic+case+%28CVRP%29%2C+there+is+also+a+variant+with+time+windows+%28CVRPTW%29.%0AHard+constraints%3A%0A%E2%80%A2+Vehicle+capacity%3A+a+vehicle+cannot+carry+more+items+then+its+capacity.%0A%E2%80%A2+Time+windows+%28only+in+CVRPTW%29%3A%0A%E2%97%A6+Travel+time%3A+Traveling+from+one+location+to+another+takes+time.%0A%E2%97%A6+Customer+service+duration%3A+a+vehicle+must+stay+at+the+customer+for+the+length+of+the+service%0Aduration.%0A%E2%97%A6+Customer+ready+time%3A+a+vehicle+may+arrive+before+the+customer%E2%80%99s+ready+time%2C+but+it+must%0Await+until+the+ready+time+before+servicing.%0A%E2%97%A6+Customer+due+time%3A+a+vehicle+must+arrive+on+time%2C+before+the+customer%E2%80%99s+due+time.%0ASoft+constraints%3A%0A%E2%80%A2+Total+distance%3A+minimize+the+total+distance+driven+%28fuel+consumption%29+of+all+vehicles.%0AThe+capacitated+vehicle+routing+problem+%28CVRP%29+and+its+timewindowed+variant+%28CVRPTW%29+are%0A49%0Adefined+by+the+VRP+web.%0A3.10.2.+Value+Proposition%0A3.10.3.+Problem+Size%0ACVRP+instances+%28without+time+windows%29%3A%0Abelgium-n50-k10+++++++++++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-n100-k10++++++++++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-n500-k20++++++++++++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-n1000-k20+++++++++++has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-n2750-k55+++++++++++has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-road-km-n50-k10+++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-road-km-n100-k10++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-road-km-n500-k20++++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0A50%0Abelgium-road-km-n1000-k20+++has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-road-km-n2750-k55+++has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-road-time-n50-k10+++has++1+depots%2C+10+vehicles+and+++49+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-road-time-n100-k10++has++1+depots%2C+10+vehicles+and+++99+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-road-time-n500-k20++has++1+depots%2C+20+vehicles+and++499+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-road-time-n1000-k20+has++1+depots%2C+20+vehicles+and++999+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-road-time-n2750-k55+has++1+depots%2C+55+vehicles+and+2749+customers+with+a%0Asearch+space+of+10%5E8380.%0Abelgium-d2-n50-k10++++++++++has++2+depots%2C+10+vehicles+and+++48+customers+with+a%0Asearch+space+of+++10%5E74.%0Abelgium-d3-n100-k10+++++++++has++3+depots%2C+10+vehicles+and+++97+customers+with+a%0Asearch+space+of++10%5E170.%0Abelgium-d5-n500-k20+++++++++has++5+depots%2C+20+vehicles+and++495+customers+with+a%0Asearch+space+of+10%5E1168.%0Abelgium-d8-n1000-k20++++++++has++8+depots%2C+20+vehicles+and++992+customers+with+a%0Asearch+space+of+10%5E2607.%0Abelgium-d10-n2750-k55+++++++has+10+depots%2C+55+vehicles+and+2740+customers+with+a%0Asearch+space+of+10%5E8380.%0AA-n32-k5++has+1+depots%2C++5+vehicles+and++31+customers+with+a+search+space+of++10%5E40.%0AA-n33-k5++has+1+depots%2C++5+vehicles+and++32+customers+with+a+search+space+of++10%5E41.%0AA-n33-k6++has+1+depots%2C++6+vehicles+and++32+customers+with+a+search+space+of++10%5E42.%0AA-n34-k5++has+1+depots%2C++5+vehicles+and++33+customers+with+a+search+space+of++10%5E43.%0AA-n36-k5++has+1+depots%2C++5+vehicles+and++35+customers+with+a+search+space+of++10%5E46.%0AA-n37-k5++has+1+depots%2C++5+vehicles+and++36+customers+with+a+search+space+of++10%5E48.%0AA-n37-k6++has+1+depots%2C++6+vehicles+and++36+customers+with+a+search+space+of++10%5E49.%0AA-n38-k5++has+1+depots%2C++5+vehicles+and++37+customers+with+a+search+space+of++10%5E49.%0AA-n39-k5++has+1+depots%2C++5+vehicles+and++38+customers+with+a+search+space+of++10%5E51.%0AA-n39-k6++has+1+depots%2C++6+vehicles+and++38+customers+with+a+search+space+of++10%5E52.%0AA-n44-k7++has+1+depots%2C++7+vehicles+and++43+customers+with+a+search+space+of++10%5E61.%0AA-n45-k6++has+1+depots%2C++6+vehicles+and++44+customers+with+a+search+space+of++10%5E62.%0AA-n45-k7++has+1+depots%2C++7+vehicles+and++44+customers+with+a+search+space+of++10%5E63.%0AA-n46-k7++has+1+depots%2C++7+vehicles+and++45+customers+with+a+search+space+of++10%5E65.%0AA-n48-k7++has+1+depots%2C++7+vehicles+and++47+customers+with+a+search+space+of++10%5E68.%0AA-n53-k7++has+1+depots%2C++7+vehicles+and++52+customers+with+a+search+space+of++10%5E77.%0AA-n54-k7++has+1+depots%2C++7+vehicles+and++53+customers+with+a+search+space+of++10%5E79.%0AA-n55-k9++has+1+depots%2C++9+vehicles+and++54+customers+with+a+search+space+of++10%5E82.%0AA-n60-k9++has+1+depots%2C++9+vehicles+and++59+customers+with+a+search+space+of++10%5E91.%0AA-n61-k9++has+1+depots%2C++9+vehicles+and++60+customers+with+a+search+space+of++10%5E93.%0AA-n62-k8++has+1+depots%2C++8+vehicles+and++61+customers+with+a+search+space+of++10%5E94.%0AA-n63-k9++has+1+depots%2C++9+vehicles+and++62+customers+with+a+search+space+of++10%5E97.%0AA-n63-k10+has+1+depots%2C+10+vehicles+and++62+customers+with+a+search+space+of++10%5E98.%0AA-n64-k9++has+1+depots%2C++9+vehicles+and++63+customers+with+a+search+space+of++10%5E99.%0AA-n65-k9++has+1+depots%2C++9+vehicles+and++64+customers+with+a+search+space+of+10%5E101.%0AA-n69-k9++has+1+depots%2C++9+vehicles+and++68+customers+with+a+search+space+of+10%5E108.%0A51%0AA-n80-k10+has+1+depots%2C+10+vehicles+and++79+customers+with+a+search+space+of+10%5E130.%0AF-n45-k4++has+1+depots%2C++4+vehicles+and++44+customers+with+a+search+space+of++10%5E60.%0AF-n72-k4++has+1+depots%2C++4+vehicles+and++71+customers+with+a+search+space+of+10%5E108.%0AF-n135-k7+has+1+depots%2C++7+vehicles+and+134+customers+with+a+search+space+of+10%5E240.%0ACVRPTW+instances+%28with+time+windows%29%3A%0Abelgium-tw-d2-n50-k10++++has++2+depots%2C+10+vehicles+and+++48+customers+with+a+search%0Aspace+of+++10%5E74.%0Abelgium-tw-d3-n100-k10+++has++3+depots%2C+10+vehicles+and+++97+customers+with+a+search%0Aspace+of++10%5E170.%0Abelgium-tw-d5-n500-k20+++has++5+depots%2C+20+vehicles+and++495+customers+with+a+search%0Aspace+of+10%5E1168.%0Abelgium-tw-d8-n1000-k20++has++8+depots%2C+20+vehicles+and++992+customers+with+a+search%0Aspace+of+10%5E2607.%0Abelgium-tw-d10-n2750-k55+has+10+depots%2C+55+vehicles+and+2740+customers+with+a+search%0Aspace+of+10%5E8380.%0Abelgium-tw-n50-k10+++++++has++1+depots%2C+10+vehicles+and+++49+customers+with+a+search%0Aspace+of+++10%5E74.%0Abelgium-tw-n100-k10++++++has++1+depots%2C+10+vehicles+and+++99+customers+with+a+search%0Aspace+of++10%5E170.%0Abelgium-tw-n500-k20++++++has++1+depots%2C+20+vehicles+and++499+customers+with+a+search%0Aspace+of+10%5E1168.%0Abelgium-tw-n1000-k20+++++has++1+depots%2C+20+vehicles+and++999+customers+with+a+search%0Aspace+of+10%5E2607.%0Abelgium-tw-n2750-k55+++++has++1+depots%2C+55+vehicles+and+2749+customers+with+a+search%0Aspace+of+10%5E8380.%0ASolomon_025_C101+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_C201+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_R101+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_R201+++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_RC101++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_025_RC201++++++has+1+depots%2C++25+vehicles+and+++25+customers+with+a+search%0Aspace+of+++10%5E40.%0ASolomon_100_C101+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_C201+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_R101+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_R201+++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0ASolomon_100_RC101++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0A52%0ASolomon_100_RC201++++++has+1+depots%2C++25+vehicles+and++100+customers+with+a+search%0Aspace+of++10%5E185.%0AHomberger_0200_C1_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_C2_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_R1_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_R2_2_1++has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_RC1_2_1+has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0200_RC2_2_1+has+1+depots%2C++50+vehicles+and++200+customers+with+a+search%0Aspace+of++10%5E429.%0AHomberger_0400_C1_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_C2_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_R1_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_R2_4_1++has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_RC1_4_1+has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0400_RC2_4_1+has+1+depots%2C+100+vehicles+and++400+customers+with+a+search%0Aspace+of++10%5E978.%0AHomberger_0600_C1_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_C2_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_R1_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_R2_6_1++has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_RC1_6_1+has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0600_RC2_6_1+has+1+depots%2C+150+vehicles+and++600+customers+with+a+search%0Aspace+of+10%5E1571.%0AHomberger_0800_C1_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_C2_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_R1_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_R2_8_1++has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_RC1_8_1+has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_0800_RC2_8_1+has+1+depots%2C+200+vehicles+and++800+customers+with+a+search%0Aspace+of+10%5E2195.%0AHomberger_1000_C110_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0A53%0Aspace+of+10%5E2840.%0AHomberger_1000_C210_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_R110_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_R210_1++has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_RC110_1+has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0AHomberger_1000_RC210_1+has+1+depots%2C+250+vehicles+and+1000+customers+with+a+search%0Aspace+of+10%5E2840.%0A3.10.4.+Domain+Model%0AThe+vehicle+routing+with+timewindows+domain+model+makes+heavily+use+of+shadow+variables.+This%0Aallows+it+to+express+its+constraints+more+naturally%2C+because+properties+such+as+arrivalTime+and%0AdepartureTime%2C+are+directly+available+on+the+domain+model.%0A3.10.4.1.+Road+Distances+Instead+of+Air+Distances%0AIn+the+real+world%2C+vehicles+cannot+follow+a+straight+line+from+location+to+location%3A+they+have+to+use%0Aroads+and+highways.+From+a+business+point+of+view%2C+this+matters+a+lot%3A%0A54%0AFor+the+optimization+algorithm%2C+this+does+not+matter+much%2C+as+long+as+the+distance+between+two%0Apoints+can+be+looked+up+%28and+are+preferably+precalculated%29.+The+road+cost+does+not+even+need+to+be%0Aa+distance%2C+it+can+also+be+travel+time%2C+fuel+cost%2C+or+a+weighted+function+of+those.+There+are+several%0Atechnologies+available+to+precalculate+road+costs%2C+such+as+GraphHopper+%28embeddable%2C+offline+Java%0Aengine%29%2C+Open+MapQuest+%28web+service%29+and+Google+Maps+Client+API+%28web+service%29.%0A55%0AThere+are+also+several+technologies+to+render+it%2C+such+as+Leaflet+and+Google+Maps+for+developers%3A+the%0Aoptaplanner-webexamples-*.war+has+an+example+which+demonstrates+such+rendering%3A%0A56%0AIt+is+even+possible+to+render+the+actual+road+routes+with+GraphHopper+or+Google+Map+Directions%2C%0Abut+because+of+route+overlaps+on+highways%2C+it+can+become+harder+to+see+the+standstill+order%3A%0A57%0ATake+special+care+that+the+road+costs+between+two+points+use+the+same+optimization+criteria+as+the%0Aone+used+in+Planner.+For+example%2C+GraphHopper+etc+will+by+default+return+the+fastest+route%2C+not+the%0Ashortest+route.+Don%E2%80%99t+use+the+km+%28or+miles%29+distances+of+the+fastest+GPS+routes+to+optimize+the%0Ashortest+trip+in+Planner%3A+this+leads+to+a+suboptimal+solution+as+shown+below%3A%0A58%0AContrary+to+popular+belief%2C+most+users+do+not+want+the+shortest+route%3A+they+want+the+fastest+route%0Ainstead.+They+prefer+highways+over+normal+roads.+They+prefer+normal+roads+over+dirt+roads.+In+the%0Areal+world%2C+the+fastest+and+shortest+route+are+rarely+the+same.%0A3.11.+Project+Job+Scheduling%0A3.11.1.+Problem+Description%0ASchedule+all+jobs+in+time+and+execution+mode+to+minimize+project+delays.+Each+job+is+part+of+a%0Aproject.+A+job+can+be+executed+in+different+ways%3A+each+way+is+an+execution+mode+that+implies+a%0Adifferent+duration+but+also+different+resource+usages.+This+is+a+form+of+flexible+job+shop+scheduling.%0A59%0AHard+constraints%3A%0A%E2%80%A2+Job+precedence%3A+a+job+can+only+start+when+all+its+predecessor+jobs+are+finished.%0A%E2%80%A2+Resource+capacity%3A+do+not+use+more+resources+than+available.%0A%E2%97%A6+Resources+are+local+%28shared+between+jobs+of+the+same+project%29+or+global+%28shared+between+all%0Ajobs%29%0A%E2%97%A6+Resource+are+renewable+%28capacity+available+per+day%29+or+nonrenewable+%28capacity+available%0Afor+all+days%29%0AMedium+constraints%3A%0A%E2%80%A2+Total+project+delay%3A+minimize+the+duration+%28makespan%29+of+each+project.%0ASoft+constraints%3A%0A%E2%80%A2+Total+makespan%3A+minimize+the+duration+of+the+whole+multi-project+schedule.%0AThe+problem+is+defined+by+the+MISTA+2013+challenge.%0A3.11.2.+Problem+Size%0A60%0ASchedule+A-1++has++2+projects%2C++24+jobs%2C+++64+execution+modes%2C++7+resources+and++150%0Aresource+requirements.%0ASchedule+A-2++has++2+projects%2C++44+jobs%2C++124+execution+modes%2C++7+resources+and++420%0Aresource+requirements.%0ASchedule+A-3++has++2+projects%2C++64+jobs%2C++184+execution+modes%2C++7+resources+and++630%0Aresource+requirements.%0ASchedule+A-4++has++5+projects%2C++60+jobs%2C++160+execution+modes%2C+16+resources+and++390%0Aresource+requirements.%0ASchedule+A-5++has++5+projects%2C+110+jobs%2C++310+execution+modes%2C+16+resources+and++900%0Aresource+requirements.%0ASchedule+A-6++has++5+projects%2C+160+jobs%2C++460+execution+modes%2C+16+resources+and+1440%0Aresource+requirements.%0ASchedule+A-7++has+10+projects%2C+120+jobs%2C++320+execution+modes%2C+22+resources+and++900%0Aresource+requirements.%0ASchedule+A-8++has+10+projects%2C+220+jobs%2C++620+execution+modes%2C+22+resources+and+1860%0Aresource+requirements.%0ASchedule+A-9++has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+2880%0Aresource+requirements.%0ASchedule+A-10+has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+2970%0Aresource+requirements.%0ASchedule+B-1++has+10+projects%2C+120+jobs%2C++320+execution+modes%2C+31+resources+and++900%0Aresource+requirements.%0ASchedule+B-2++has+10+projects%2C+220+jobs%2C++620+execution+modes%2C+22+resources+and+1740%0Aresource+requirements.%0ASchedule+B-3++has+10+projects%2C+320+jobs%2C++920+execution+modes%2C+31+resources+and+3060%0Aresource+requirements.%0ASchedule+B-4++has+15+projects%2C+180+jobs%2C++480+execution+modes%2C+46+resources+and+1530%0Aresource+requirements.%0ASchedule+B-5++has+15+projects%2C+330+jobs%2C++930+execution+modes%2C+46+resources+and+2760%0Aresource+requirements.%0ASchedule+B-6++has+15+projects%2C+480+jobs%2C+1380+execution+modes%2C+46+resources+and+4500%0Aresource+requirements.%0ASchedule+B-7++has+20+projects%2C+240+jobs%2C++640+execution+modes%2C+61+resources+and+1710%0Aresource+requirements.%0ASchedule+B-8++has+20+projects%2C+440+jobs%2C+1240+execution+modes%2C+42+resources+and+3180%0Aresource+requirements.%0ASchedule+B-9++has+20+projects%2C+640+jobs%2C+1840+execution+modes%2C+61+resources+and+5940%0Aresource+requirements.%0ASchedule+B-10+has+20+projects%2C+460+jobs%2C+1300+execution+modes%2C+42+resources+and+4260%0Aresource+requirements.%0A3.12.+Hospital+Bed+Planning+%28PAS+-+Patient+Admission%0AScheduling%29%0A3.12.1.+Problem+Description%0AAssign+each+patient+%28that+will+come+to+the+hospital%29+into+a+bed+for+each+night+that+the+patient+will%0Astay+in+the+hospital.+Each+bed+belongs+to+a+room+and+each+room+belongs+to+a+department.+The%0A61%0Aarrival+and+departure+dates+of+the+patients+is+fixed%3A+only+a+bed+needs+to+be+assigned+for+each+night.%0AThis+problem+features+overconstrained+datasets.%0AHard+constraints%3A%0A%E2%80%A2+Two+patients+must+not+be+assigned+to+the+same+bed+in+the+same+night.+Weight%3A+-1000hard+*%0AconflictNightCount.%0A%E2%80%A2+A+room+can+have+a+gender+limitation%3A+only+females%2C+only+males%2C+the+same+gender+in+the+same%0Anight+or+no+gender+limitation+at+all.+Weight%3A+-50hard+*+nightCount.%0A%E2%80%A2+A+department+can+have+a+minimum+or+maximum+age.+Weight%3A+-100hard+*+nightCount.%0A%E2%80%A2+A+patient+can+require+a+room+with+specific+equipment%28s%29.+Weight%3A+-50hard+*+nightCount.%0AMedium+constraints%3A%0A%E2%80%A2+Assign+every+patient+to+a+bed%2C+unless+the+dataset+is+overconstrained.+Weight%3A+-1medium+*%0AnightCount.%0ASoft+constraints%3A%0A%E2%80%A2+A+patient+can+prefer+a+maximum+room+size%2C+for+example+if+he%2Fshe+wants+a+single+room.+Weight%3A%0A-8soft+*+nightCount.%0A%E2%80%A2+A+patient+is+best+assigned+to+a+department+that+specializes+in+his%2Fher+problem.+Weight%3A+-10soft+*%0A62%0AnightCount.%0A%E2%80%A2+A+patient+is+best+assigned+to+a+room+that+specializes+in+his%2Fher+problem.+Weight%3A+-20soft+*%0AnightCount.%0A%E2%97%A6+That+room+speciality+should+be+priority+1.+Weight%3A+-10soft+*+%28priority+-+1%29+*+nightCount.%0A%E2%80%A2+A+patient+can+prefer+a+room+with+specific+equipment%28s%29.+Weight%3A+-20soft+*+nightCount.%0AThe+problem+is+a+variant+on+Kaho%E2%80%99s+Patient+Scheduling+and+the+datasets+come+from+real+world%0Ahospitals.%0A3.12.2.+Problem+Size%0Atestdata01+has+4+specialisms%2C+2+equipments%2C+4+departments%2C++98+rooms%2C+286+beds%2C+14%0Anights%2C++652+patients+and++652+admissions+with+a+search+space+of+10%5E1601.%0Atestdata02+has+6+specialisms%2C+2+equipments%2C+6+departments%2C+151+rooms%2C+465+beds%2C+14%0Anights%2C++755+patients+and++755+admissions+with+a+search+space+of+10%5E2013.%0Atestdata03+has+5+specialisms%2C+2+equipments%2C+5+departments%2C+131+rooms%2C+395+beds%2C+14%0Anights%2C++708+patients+and++708+admissions+with+a+search+space+of+10%5E1838.%0Atestdata04+has+6+specialisms%2C+2+equipments%2C+6+departments%2C+155+rooms%2C+471+beds%2C+14%0Anights%2C++746+patients+and++746+admissions+with+a+search+space+of+10%5E1994.%0Atestdata05+has+4+specialisms%2C+2+equipments%2C+4+departments%2C+102+rooms%2C+325+beds%2C+14%0Anights%2C++587+patients+and++587+admissions+with+a+search+space+of+10%5E1474.%0Atestdata06+has+4+specialisms%2C+2+equipments%2C+4+departments%2C+104+rooms%2C+313+beds%2C+14%0Anights%2C++685+patients+and++685+admissions+with+a+search+space+of+10%5E1709.%0Atestdata07+has+6+specialisms%2C+4+equipments%2C+6+departments%2C+162+rooms%2C+472+beds%2C+14%0Anights%2C++519+patients+and++519+admissions+with+a+search+space+of+10%5E1387.%0Atestdata08+has+6+specialisms%2C+4+equipments%2C+6+departments%2C+148+rooms%2C+441+beds%2C+21%0Anights%2C++895+patients+and++895+admissions+with+a+search+space+of+10%5E2366.%0Atestdata09+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+105+rooms%2C+310+beds%2C+28%0Anights%2C+1400+patients+and+1400+admissions+with+a+search+space+of+10%5E3487.%0Atestdata10+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+104+rooms%2C+308+beds%2C+56%0Anights%2C+1575+patients+and+1575+admissions+with+a+search+space+of+10%5E3919.%0Atestdata11+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+107+rooms%2C+318+beds%2C+91%0Anights%2C+2514+patients+and+2514+admissions+with+a+search+space+of+10%5E6291.%0Atestdata12+has+4+specialisms%2C+4+equipments%2C+4+departments%2C+105+rooms%2C+310+beds%2C+84%0Anights%2C+2750+patients+and+2750+admissions+with+a+search+space+of+10%5E6851.%0Atestdata13+has+5+specialisms%2C+4+equipments%2C+5+departments%2C+125+rooms%2C+368+beds%2C+28%0Anights%2C++907+patients+and+1109+admissions+with+a+search+space+of+10%5E2845.%0A3.12.3.+Domain+Model%0A63%0A3.13.+Task+assigning%0A3.13.1.+Problem+Description%0AAssign+each+task+to+a+spot+in+an+employee%E2%80%99s+queue.+Each+task+has+a+duration+which+is+affected+by+the%0Aemployee%E2%80%99s+affinity+level+with+the+task%E2%80%99s+customer.%0AHard+constraints%3A%0A%E2%80%A2+Skill%3A+Each+task+requires+one+or+more+skills.+The+employee+must+posses+all+these+skills.%0ASoft+level+0+constraints%3A%0A%E2%80%A2+Critical+tasks%3A+Complete+critical+tasks+first%2C+sooner+than+major+and+minor+tasks.%0ASoft+level+1+constraints%3A%0A%E2%80%A2+Minimize+makespan%3A+Reduce+the+time+to+complete+all+tasks.%0A%E2%97%A6+Start+with+the+longest+working+employee+first%2C+then+the+second+longest+working+employee%0Aand+so+forth%2C+to+creates+fairness+and+load+balancing.%0ASoft+level+2+constraints%3A%0A%E2%80%A2+Major+tasks%3A+Complete+major+tasks+as+soon+as+possible%2C+sooner+than+minor+tasks.%0A64%0ASoft+level+3+constraints%3A%0A%E2%80%A2+Minor+tasks%3A+Complete+minor+tasks+as+soon+as+possible.%0A3.13.2.+Value+Proposition%0A3.13.3.+Problem+Size%0A24tasks-8employees+++has++24+tasks%2C+6+skills%2C++8+employees%2C+++4+task+types+and++4%0Acustomers+with+a+search+space+of+++10%5E30.%0A50tasks-5employees+++has++50+tasks%2C+5+skills%2C++5+employees%2C++10+task+types+and+10%0Acustomers+with+a+search+space+of+++10%5E69.%0A100tasks-5employees++has+100+tasks%2C+5+skills%2C++5+employees%2C++20+task+types+and+15%0Acustomers+with+a+search+space+of++10%5E164.%0A500tasks-20employees+has+500+tasks%2C+6+skills%2C+20+employees%2C+100+task+types+and+60%0Acustomers+with+a+search+space+of+10%5E1168.%0A3.13.4.+Domain+Model%0A65%0A3.14.+Exam+Timetabling+%28ITC+2007+track+1+-%0AExamination%29%0A3.14.1.+Problem+Description%0ASchedule+each+exam+into+a+period+and+into+a+room.+Multiple+exams+can+share+the+same+room+during%0Athe+same+period.%0A66%0AHard+constraints%3A%0A%E2%80%A2+Exam+conflict%3A+two+exams+that+share+students+must+not+occur+in+the+same+period.%0A%E2%80%A2+Room+capacity%3A+A+room%E2%80%99s+seating+capacity+must+suffice+at+all+times.%0A%E2%80%A2+Period+duration%3A+A+period%E2%80%99s+duration+must+suffice+for+all+of+its+exams.%0A%E2%80%A2+Period+related+hard+constraints+%28specified+per+dataset%29%3A%0A%E2%97%A6+Coincidence%3A+two+specified+exams+must+use+the+same+period+%28but+possibly+another+room%29.%0A%E2%97%A6+Exclusion%3A+two+specified+exams+must+not+use+the+same+period.%0A%E2%97%A6+After%3A+A+specified+exam+must+occur+in+a+period+after+another+specified+exam%E2%80%99s+period.%0A%E2%80%A2+Room+related+hard+constraints+%28specified+per+dataset%29%3A%0A%E2%97%A6+Exclusive%3A+one+specified+exam+should+not+have+to+share+its+room+with+any+other+exam.%0ASoft+constraints+%28each+of+which+has+a+parametrized+penalty%29%3A%0A%E2%80%A2+The+same+student+should+not+have+two+exams+in+a+row.%0A%E2%80%A2+The+same+student+should+not+have+two+exams+on+the+same+day.%0A%E2%80%A2+Period+spread%3A+two+exams+that+share+students+should+be+a+number+of+periods+apart.%0A%E2%80%A2+Mixed+durations%3A+two+exams+that+share+a+room+should+not+have+different+durations.%0A%E2%80%A2+Front+load%3A+Large+exams+should+be+scheduled+earlier+in+the+schedule.%0A67%0A%E2%80%A2+Period+penalty+%28specified+per+dataset%29%3A+Some+periods+have+a+penalty+when+used.%0A%E2%80%A2+Room+penalty+%28specified+per+dataset%29%3A+Some+rooms+have+a+penalty+when+used.%0AIt+uses+large+test+data+sets+of+real-life+universities.%0AThe+problem+is+defined+by+the+International+Timetabling+Competition+2007+track+1.+Geoffrey+De%0ASmet+finished+4th+in+that+competition+with+a+very+early+version+of+Planner.+Many+improvements%0Ahave+been+made+since+then.%0A3.14.2.+Problem+Size%0Aexam_comp_set1+has++7883+students%2C++607+exams%2C+54+periods%2C++7+rooms%2C++12+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E1564.%0Aexam_comp_set2+has+12484+students%2C++870+exams%2C+40+periods%2C+49+rooms%2C++12+period%0Aconstraints+and++2+room+constraints+with+a+search+space+of+10%5E2864.%0Aexam_comp_set3+has+16365+students%2C++934+exams%2C+36+periods%2C+48+rooms%2C+168+period%0Aconstraints+and+15+room+constraints+with+a+search+space+of+10%5E3023.%0Aexam_comp_set4+has++4421+students%2C++273+exams%2C+21+periods%2C++1+rooms%2C++40+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of++10%5E360.%0Aexam_comp_set5+has++8719+students%2C+1018+exams%2C+42+periods%2C++3+rooms%2C++27+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E2138.%0Aexam_comp_set6+has++7909+students%2C++242+exams%2C+16+periods%2C++8+rooms%2C++22+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of++10%5E509.%0Aexam_comp_set7+has+13795+students%2C+1096+exams%2C+80+periods%2C+15+rooms%2C++28+period%0Aconstraints+and++0+room+constraints+with+a+search+space+of+10%5E3374.%0Aexam_comp_set8+has++7718+students%2C++598+exams%2C+80+periods%2C++8+rooms%2C++20+period%0Aconstraints+and++1+room+constraints+with+a+search+space+of+10%5E1678.%0A3.14.3.+Domain+Model%0ABelow+you+can+see+the+main+examination+domain+classes%3A%0A68%0AFigure+3.+Examination+Domain+Class+Diagram%0ANotice+that+we%E2%80%99ve+split+up+the+exam+concept+into+an+Exam+class+and+a+Topic+class.+The+Exam+instances%0Achange+during+solving+%28this+is+the+planning+entity+class%29%2C+when+their+period+or+room+property%0Achanges.+The+Topic%2C+Period+and+Room+instances+never+change+during+solving+%28these+are+problem+facts%2C%0Ajust+like+some+other+classes%29.%0A3.15.+Nurse+Rostering+%28INRC+2010%29%0A3.15.1.+Problem+Description%0AFor+each+shift%2C+assign+a+nurse+to+work+that+shift.%0A69%0AHard+constraints%3A%0A%E2%80%A2+No+unassigned+shifts+%28built-in%29%3A+Every+shift+need+to+be+assigned+to+an+employee.%0A%E2%80%A2+Shift+conflict%3A+An+employee+can+have+only+one+shift+per+day.%0ASoft+constraints%3A%0A%E2%80%A2+Contract+obligations.+The+business+frequently+violates+these%2C+so+they+decided+to+define+these+as%0Asoft+constraints+instead+of+hard+constraints.%0A%E2%97%A6+Minimum+and+maximum+assignments%3A+Each+employee+needs+to+work+more+than+x+shifts%0Aand+less+than+y+shifts+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+working+days%3A+Each+employee+needs+to+work%0Abetween+x+and+y+days+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+free+days%3A+Each+employee+needs+to+be+free+between%0Ax+and+y+days+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Minimum+and+maximum+consecutive+working+weekends%3A+Each+employee+needs+to+work%0Abetween+x+and+y+weekends+in+a+row+%28depending+on+their+contract%29.%0A%E2%97%A6+Complete+weekends%3A+Each+employee+needs+to+work+every+day+in+a+weekend+or+not+at+all.%0A%E2%97%A6+Identical+shift+types+during+weekend%3A+Each+weekend+shift+for+the+same+weekend+of+the%0Asame+employee+must+be+the+same+shift+type.%0A%E2%97%A6+Unwanted+patterns%3A+A+combination+of+unwanted+shift+types+in+a+row.+For+example%3A+a+late%0A70%0Ashift+followed+by+an+early+shift+followed+by+a+late+shift.%0A%E2%80%A2+Employee+wishes%3A%0A%E2%97%A6+Day+on+request%3A+An+employee+wants+to+work+on+a+specific+day.%0A%E2%97%A6+Day+off+request%3A+An+employee+does+not+want+to+work+on+a+specific+day.%0A%E2%97%A6+Shift+on+request%3A+An+employee+wants+to+be+assigned+to+a+specific+shift.%0A%E2%97%A6+Shift+off+request%3A+An+employee+does+not+want+to+be+assigned+to+a+specific+shift.%0A%E2%80%A2+Alternative+skill%3A+An+employee+assigned+to+a+skill+should+have+a+proficiency+in+every+skill%0Arequired+by+that+shift.%0AThe+problem+is+defined+by+the+International+Nurse+Rostering+Competition+2010.%0A3.15.2.+Value+Proposition%0A3.15.3.+Problem+Size%0AThere+are+three+dataset+types%3A%0A%E2%80%A2+sprint%3A+must+be+solved+in+seconds.%0A%E2%80%A2+medium%3A+must+be+solved+in+minutes.%0A%E2%80%A2+long%3A+must+be+solved+in+hours.%0A71%0Atoy1++++++++++has+1+skills%2C+3+shiftTypes%2C+2+patterns%2C+1+contracts%2C++6+employees%2C++7%0AshiftDates%2C++35+shiftAssignments+and+++0+requests+with+a+search+space+of+++10%5E27.%0Atoy2++++++++++has+1+skills%2C+3+shiftTypes%2C+3+patterns%2C+2+contracts%2C+20+employees%2C+28%0AshiftDates%2C+180+shiftAssignments+and+140+requests+with+a+search+space+of++10%5E234.%0Asprint01++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint02++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint03++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint04++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint05++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint06++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint07++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint08++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint09++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint10++++++has+1+skills%2C+4+shiftTypes%2C+3+patterns%2C+4+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint01+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint02+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_hint03+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late01+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late02+has+1+skills%2C+3+shiftTypes%2C+4+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+144+shiftAssignments+and+139+requests+with+a+search+space+of++10%5E144.%0Asprint_late03+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+160+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E160.%0Asprint_late04+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+160+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E160.%0Asprint_late05+has+1+skills%2C+4+shiftTypes%2C+8+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late06+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late07+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0Asprint_late08+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+++0+requests+with+a+search+space+of++10%5E152.%0Asprint_late09+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+++0+requests+with+a+search+space+of++10%5E152.%0Asprint_late10+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+3+contracts%2C+10+employees%2C+28%0AshiftDates%2C+152+shiftAssignments+and+150+requests+with+a+search+space+of++10%5E152.%0A72%0Amedium01++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium02++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium03++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium04++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium05++++++has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+31+employees%2C+28%0AshiftDates%2C+608+shiftAssignments+and+403+requests+with+a+search+space+of++10%5E906.%0Amedium_hint01+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_hint02+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_hint03+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late01+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+424+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E626.%0Amedium_late02+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late03+has+1+skills%2C+4+shiftTypes%2C+0+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+428+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E632.%0Amedium_late04+has+1+skills%2C+4+shiftTypes%2C+7+patterns%2C+3+contracts%2C+30+employees%2C+28%0AshiftDates%2C+416+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E614.%0Amedium_late05+has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+4+contracts%2C+30+employees%2C+28%0AshiftDates%2C+452+shiftAssignments+and+390+requests+with+a+search+space+of++10%5E667.%0Along01++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along02++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along03++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along04++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along05++++++++has+2+skills%2C+5+shiftTypes%2C+3+patterns%2C+3+contracts%2C+49+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+735+requests+with+a+search+space+of+10%5E1250.%0Along_hint01+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_hint02+++has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_hint03+++has+2+skills%2C+5+shiftTypes%2C+7+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0Along_late01+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late02+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+4+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late03+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late04+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+4+contracts%2C+50+employees%2C+28%0A73%0AshiftDates%2C+752+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1277.%0Along_late05+++has+2+skills%2C+5+shiftTypes%2C+9+patterns%2C+3+contracts%2C+50+employees%2C+28%0AshiftDates%2C+740+shiftAssignments+and+++0+requests+with+a+search+space+of+10%5E1257.%0A3.15.4.+Domain+Model%0A3.16.+Traveling+Tournament+Problem+%28TTP%29%0A3.16.1.+Problem+Description%0ASchedule+matches+between+n+teams.%0A74%0AHard+constraints%3A%0A%E2%80%A2+Each+team+plays+twice+against+every+other+team%3A+once+home+and+once+away.%0A%E2%80%A2+Each+team+has+exactly+one+match+on+each+timeslot.%0A%E2%80%A2+No+team+must+have+more+than+three+consecutive+home+or+three+consecutive+away+matches.%0A%E2%80%A2+No+repeaters%3A+no+two+consecutive+matches+of+the+same+two+opposing+teams.%0ASoft+constraints%3A%0A%E2%80%A2+Minimize+the+total+distance+traveled+by+all+teams.%0AThe+problem+is+defined+on+Michael+Trick%E2%80%99s+website+%28which+contains+the+world+records+too%29.%0A3.16.2.+Problem+Size%0A75%0A1-nl04+++++has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A1-nl06+++++has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A1-nl08+++++has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A1-nl10+++++has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A1-nl12+++++has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A1-nl14+++++has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A1-nl16+++++has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A2-bra24++++has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A3-nfl16++++has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A3-nfl18++++has+34+days%2C+18+teams+and++306+matches+with+a+search+space+of++10%5E346.%0A3-nfl20++++has+38+days%2C+20+teams+and++380+matches+with+a+search+space+of++10%5E447.%0A3-nfl22++++has+42+days%2C+22+teams+and++462+matches+with+a+search+space+of++10%5E562.%0A3-nfl24++++has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A3-nfl26++++has+50+days%2C+26+teams+and++650+matches+with+a+search+space+of++10%5E838.%0A3-nfl28++++has+54+days%2C+28+teams+and++756+matches+with+a+search+space+of++10%5E999.%0A3-nfl30++++has+58+days%2C+30+teams+and++870+matches+with+a+search+space+of+10%5E1175.%0A3-nfl32++++has+62+days%2C+32+teams+and++992+matches+with+a+search+space+of+10%5E1367.%0A4-super04++has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A4-super06++has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A4-super08++has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A4-super10++has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A4-super12++has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A4-super14++has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A5-galaxy04+has++6+days%2C++4+teams+and+++12+matches+with+a+search+space+of++++10%5E5.%0A5-galaxy06+has+10+days%2C++6+teams+and+++30+matches+with+a+search+space+of+++10%5E19.%0A5-galaxy08+has+14+days%2C++8+teams+and+++56+matches+with+a+search+space+of+++10%5E43.%0A5-galaxy10+has+18+days%2C+10+teams+and+++90+matches+with+a+search+space+of+++10%5E79.%0A5-galaxy12+has+22+days%2C+12+teams+and++132+matches+with+a+search+space+of++10%5E126.%0A5-galaxy14+has+26+days%2C+14+teams+and++182+matches+with+a+search+space+of++10%5E186.%0A5-galaxy16+has+30+days%2C+16+teams+and++240+matches+with+a+search+space+of++10%5E259.%0A5-galaxy18+has+34+days%2C+18+teams+and++306+matches+with+a+search+space+of++10%5E346.%0A5-galaxy20+has+38+days%2C+20+teams+and++380+matches+with+a+search+space+of++10%5E447.%0A5-galaxy22+has+42+days%2C+22+teams+and++462+matches+with+a+search+space+of++10%5E562.%0A5-galaxy24+has+46+days%2C+24+teams+and++552+matches+with+a+search+space+of++10%5E692.%0A5-galaxy26+has+50+days%2C+26+teams+and++650+matches+with+a+search+space+of++10%5E838.%0A5-galaxy28+has+54+days%2C+28+teams+and++756+matches+with+a+search+space+of++10%5E999.%0A5-galaxy30+has+58+days%2C+30+teams+and++870+matches+with+a+search+space+of+10%5E1175.%0A5-galaxy32+has+62+days%2C+32+teams+and++992+matches+with+a+search+space+of+10%5E1367.%0A5-galaxy34+has+66+days%2C+34+teams+and+1122+matches+with+a+search+space+of+10%5E1576.%0A5-galaxy36+has+70+days%2C+36+teams+and+1260+matches+with+a+search+space+of+10%5E1801.%0A5-galaxy38+has+74+days%2C+38+teams+and+1406+matches+with+a+search+space+of+10%5E2042.%0A5-galaxy40+has+78+days%2C+40+teams+and+1560+matches+with+a+search+space+of+10%5E2301.%0A3.17.+Cheap+Time+Scheduling%0A3.17.1.+Problem+Description%0ASchedule+all+tasks+in+time+and+on+a+machine+to+minimize+power+cost.+Power+prices+differs+in+time.%0AThis+is+a+form+of+job+shop+scheduling.%0A76%0AHard+constraints%3A%0A%E2%80%A2+Start+time+limits%3A+each+task+must+start+between+its+earliest+start+and+latest+start+limit.%0A%E2%80%A2+Maximum+capacity%3A+the+maximum+capacity+for+each+resource+for+each+machine+must+not+be%0Aexceeded.%0A%E2%80%A2+Startup+and+shutdown%3A+each+machine+must+be+active+in+the+periods+during+which+it+has+assigned%0Atasks.+Between+tasks+it+is+allowed+to+be+idle+to+avoid+startup+and+shutdown+costs.%0AMedium+constraints%3A%0A%E2%80%A2+Power+cost%3A+minimize+the+total+power+cost+of+the+whole+schedule.%0A%E2%97%A6+Machine+power+cost%3A+Each+active+or+idle+machine+consumes+power%2C+which+infers+a+power%0Acost+%28depending+on+the+power+price+during+that+time%29.%0A%E2%97%A6+Task+power+cost%3A+Each+task+consumes+power+too%2C+which+infers+a+power+cost+%28depending+on%0Athe+power+price+during+its+time%29.%0A%E2%97%A6+Machine+startup+and+shutdown+cost%3A+Every+time+a+machine+starts+up+or+shuts+down%2C+an+extra%0Acost+is+inflicted.%0ASoft+constraints+%28addendum+to+the+original+problem+definition%29%3A%0A%E2%80%A2+Start+early%3A+prefer+starting+a+task+sooner+rather+than+later.%0AThe+problem+is+defined+by+the+ICON+challenge.%0A3.17.2.+Problem+Size%0Asample01+++has+3+resources%2C+++2+machines%2C+288+periods+and+++25+tasks+with+a+search%0Aspace+of++++10%5E53.%0Asample02+++has+3+resources%2C+++2+machines%2C+288+periods+and+++50+tasks+with+a+search%0Aspace+of+++10%5E114.%0Asample03+++has+3+resources%2C+++2+machines%2C+288+periods+and++100+tasks+with+a+search%0Aspace+of+++10%5E226.%0Asample04+++has+3+resources%2C+++5+machines%2C+288+periods+and++100+tasks+with+a+search%0Aspace+of+++10%5E266.%0Asample05+++has+3+resources%2C+++2+machines%2C+288+periods+and++250+tasks+with+a+search%0Aspace+of+++10%5E584.%0Asample06+++has+3+resources%2C+++5+machines%2C+288+periods+and++250+tasks+with+a+search%0Aspace+of+++10%5E673.%0Asample07+++has+3+resources%2C+++2+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E2388.%0Asample08+++has+3+resources%2C+++5+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E2748.%0Asample09+++has+4+resources%2C++20+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E6668.%0Ainstance00+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E595.%0Ainstance01+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E599.%0A77%0Ainstance02+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E599.%0Ainstance03+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E591.%0Ainstance04+has+1+resources%2C++10+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E590.%0Ainstance05+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E667.%0Ainstance06+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E660.%0Ainstance07+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E662.%0Ainstance08+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E651.%0Ainstance09+has+2+resources%2C++25+machines%2C+288+periods+and++200+tasks+with+a+search%0Aspace+of+++10%5E659.%0Ainstance10+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1657.%0Ainstance11+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1644.%0Ainstance12+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1637.%0Ainstance13+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1659.%0Ainstance14+has+2+resources%2C++20+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1643.%0Ainstance15+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1782.%0Ainstance16+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1778.%0Ainstance17+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1764.%0Ainstance18+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1769.%0Ainstance19+has+3+resources%2C++40+machines%2C+288+periods+and++500+tasks+with+a+search%0Aspace+of++10%5E1778.%0Ainstance20+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3689.%0Ainstance21+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3678.%0Ainstance22+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3706.%0Ainstance23+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3676.%0Ainstance24+has+3+resources%2C++50+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3681.%0Ainstance25+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3774.%0Ainstance26+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3737.%0Ainstance27+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0A78%0Aspace+of++10%5E3744.%0Ainstance28+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3731.%0Ainstance29+has+3+resources%2C++60+machines%2C+288+periods+and+1000+tasks+with+a+search%0Aspace+of++10%5E3746.%0Ainstance30+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7718.%0Ainstance31+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7740.%0Ainstance32+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7686.%0Ainstance33+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7672.%0Ainstance34+has+4+resources%2C++70+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7695.%0Ainstance35+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7807.%0Ainstance36+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7814.%0Ainstance37+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7764.%0Ainstance38+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7736.%0Ainstance39+has+4+resources%2C++80+machines%2C+288+periods+and+2000+tasks+with+a+search%0Aspace+of++10%5E7783.%0Ainstance40+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15976.%0Ainstance41+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15935.%0Ainstance42+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15887.%0Ainstance43+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15896.%0Ainstance44+has+4+resources%2C++90+machines%2C+288+periods+and+4000+tasks+with+a+search%0Aspace+of+10%5E15885.%0Ainstance45+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20173.%0Ainstance46+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20132.%0Ainstance47+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20126.%0Ainstance48+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20110.%0Ainstance49+has+4+resources%2C+100+machines%2C+288+periods+and+5000+tasks+with+a+search%0Aspace+of+10%5E20078.%0A79%0A3.18.+Investment+Asset+Class+Allocation+%28Portfolio%0AOptimization%29%0A3.18.1.+Problem+Description%0ADecide+the+relative+quantity+to+invest+in+each+asset+class.%0AHard+constraints%3A%0A%E2%80%A2+Risk+maximum%3A+the+total+standard+deviation+must+not+be+higher+than+the+standard+deviation%0Amaximum.%0A%E2%97%A6+Total+standard+deviation+calculation+takes+asset+class+correlations+into+account+by+applying%0AMarkowitz+Portfolio+Theory.%0A%E2%80%A2+Region+maximum%3A+Each+region+has+a+quantity+maximum.%0A%E2%80%A2+Sector+maximum%3A+Each+sector+has+a+quantity+maximum.%0ASoft+constraints%3A%0A%E2%80%A2+Maximize+expected+return.%0A3.18.2.+Problem+Size%0Ade_smet_1+has+1+regions%2C+3+sectors+and+11+asset+classes+with+a+search+space+of+10%5E4.%0Airrinki_1+has+2+regions%2C+3+sectors+and+6+asset+classes+with+a+search+space+of+10%5E3.%0ALarger+datasets+have+not+been+created+or+tested+yet%2C+but+should+not+pose+a+problem.+A+good+source%0Aof+data+is+this+Asset+Correlation+website.%0A3.19.+Conference+Scheduling%0A3.19.1.+Problem+Description%0AAssign+each+conference+talk+to+a+timeslot+and+a+room.+Timeslots+can+overlap.+Read%2Fwrite+to%2Ffrom+an%0A*.xlsx+file+that+can+be+edited+with+LibreOffice+or+Excel+too.%0AHard+constraints%3A%0A%E2%80%A2+Talk+type+of+timeslot%3A+The+type+of+a+talk+must+match+the+timeslot%E2%80%99s+talk+type.%0A%E2%80%A2+Room+unavailable+timeslots%3A+A+talk%E2%80%99s+room+must+be+available+during+the+talk%E2%80%99s+timeslot.%0A%E2%80%A2+Room+conflict%3A+Two+talks+can%E2%80%99t+use+the+same+room+during+overlapping+timeslots.%0A%E2%80%A2+Speaker+unavailable+timeslots%3A+Every+talk%E2%80%99s+speaker+must+be+available+during+the+talk%E2%80%99s+timeslot.%0A%E2%80%A2+Speaker+conflict%3A+Two+talks+can%E2%80%99t+share+a+speaker+during+overlapping+timeslots.%0A%E2%80%A2+Generic+purpose+timeslot+and+room+tags%0A80%0A%E2%97%A6+Speaker+required+timeslot+tag%3A+If+a+speaker+has+a+required+timeslot+tag%2C+then+all+his%2Fher+talks%0Amust+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+prohibited+timeslot+tag%3A+If+a+speaker+has+a+prohibited+timeslot+tag%2C+then+all+his%2Fher%0Atalks+cannot+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+required+timeslot+tag%3A+If+a+talk+has+a+required+timeslot+tag%2C+then+it+must+be+assigned+to+a%0Atimeslot+with+that+tag.%0A%E2%97%A6+Talk+prohibited+timeslot+tag%3A+If+a+talk+has+a+prohibited+timeslot+tag%2C+then+it+cannot+be%0Aassigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+required+room+tag%3A+If+a+speaker+has+a+required+room+tag%2C+then+all+his%2Fher+talks+must%0Abe+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Speaker+prohibited+room+tag%3A+If+a+speaker+has+a+prohibited+room+tag%2C+then+all+his%2Fher+talks%0Acannot+be+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Talk+required+room+tag%3A+If+a+talk+has+a+required+room+tag%2C+then+it+must+be+assigned+to+a+room%0Awith+that+tag.%0A%E2%97%A6+Talk+prohibited+room+tag%3A+If+a+talk+has+a+prohibited+room+tag%2C+then+it+cannot+be+assigned+to+a%0Aroom+with+that+tag.%0ASoft+constraints%3A%0A%E2%80%A2+Theme+track+conflict%3A+Minimize+the+number+of+talks+that+share+a+same+theme+tag+during%0Aoverlapping+timeslots.%0A%E2%80%A2+Sector+conflict%3A+Minimize+the+number+of+talks+that+share+a+same+sector+tag+during+overlapping%0Atimeslots.%0A%E2%80%A2+Content+audience+level+flow+violation%3A+For+every+content+tag%2C+schedule+the+introductory+talks%0Abefore+the+advanced+talks.%0A%E2%80%A2+Audience+level+diversity%3A+For+every+timeslot%2C+maximize+the+number+of+talks+with+a+different%0Aaudience+level.%0A%E2%80%A2+Language+diversity%3A+For+every+timeslot%2C+maximize+the+number+of+talks+with+a+different+language.%0A%E2%80%A2+Generic+purpose+timeslot+and+room+tags%0A%E2%97%A6+Speaker+preferred+timeslot+tag%3A+If+a+speaker+has+a+preferred+timeslot+tag%2C+then+all+his%2Fher%0Atalks+should+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+undesired+timeslot+tag%3A+If+a+speaker+has+a+undesired+timeslot+tag%2C+then+all+his%2Fher%0Atalks+should+not+be+assigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+preferred+timeslot+tag%3A+If+a+talk+has+a+preferred+timeslot+tag%2C+then+it+should+be+assigned%0Ato+a+timeslot+with+that+tag.%0A%E2%97%A6+Talk+undesired+timeslot+tag%3A+If+a+talk+has+a+undesired+timeslot+tag%2C+then+it+should+not+be%0Aassigned+to+a+timeslot+with+that+tag.%0A%E2%97%A6+Speaker+preferred+room+tag%3A+If+a+speaker+has+a+preferred+room+tag%2C+then+all+his%2Fher+talks%0Ashould+be+assigned+to+a+room+with+that+tag.%0A%E2%97%A6+Speaker+undesired+room+tag%3A+If+a+speaker+has+a+undesired+room+tag%2C+then+all+his%2Fher+talks%0Ashould+not+be+assigned+to+a+room+with+that+tag.%0A81%0A%E2%97%A6+Talk+preferred+room+tag%3A+If+a+talk+has+a+preferred+room+tag%2C+then+it+should+be+assigned+to+a%0Aroom+with+that+tag.%0A%E2%97%A6+Talk+undesired+room+tag%3A+If+a+talk+has+a+undesired+room+tag%2C+then+it+should+not+be+assigned+to%0Aa+room+with+that+tag.%0A3.19.2.+Value+Proposition%0A3.19.3.+Problem+Size%0A18talks-6timeslots-5rooms++++has++18+talks%2C++6+timeslots+and++5+rooms+with+a+search%0Aspace+of++10%5E26.%0A36talks-12timeslots-5rooms+++has++36+talks%2C+12+timeslots+and++5+rooms+with+a+search%0Aspace+of++10%5E64.%0A72talks-12timeslots-10rooms++has++72+talks%2C+12+timeslots+and+10+rooms+with+a+search%0Aspace+of+10%5E149.%0A108talks-18timeslots-10rooms+has+108+talks%2C+18+timeslots+and+10+rooms+with+a+search%0Aspace+of+10%5E243.%0A216talks-18timeslots-20rooms+has+216+talks%2C+18+timeslots+and+20+rooms+with+a+search%0Aspace+of+10%5E552.%0A82%0A3.20.+Rock+Tour%0A3.20.1.+Problem+Description%0ADrive+the+rock+bus+from+show+to+show%2C+but+schedule+shows+only+on+available+days.%0AHard+constraints%3A%0A%E2%80%A2+Schedule+every+required+show.%0A%E2%80%A2+Schedule+as+many+shows+as+possible.%0AMedium+constraints%3A%0A%E2%80%A2+Maximize+revenue+opportunity.%0A%E2%80%A2+Minimize+driving+time.%0A%E2%80%A2+Visit+sooner+than+later.%0ASoft+constraints%3A%0A%E2%80%A2+Avoid+long+driving+times.%0A3.20.2.+Problem+Size%0A47shows+has+47+shows+with+a+search+space+of+10%5E59.%0A83%0AChapter+4.+Planner+Configuration%0A4.1.+Overview%0ASolving+a+planning+problem+with+Planner+consists+of+the+following+steps%3A%0A1.+Model+your+planning+problem+as+a+class+that+implements+the+interface+Solution%2C+for+example%0Athe+class+NQueens.%0A2.+Configure+a+Solver%2C+for+example+a+First+Fit+and+Tabu+Search+solver+for+any+NQueens+instance.%0A3.+Load+a+problem+data+set+from+your+data+layer%2C+for+example+a+Four+Queens+instance.+That+is+the%0Aplanning+problem.%0A4.+Solve+it+with+Solver.solve%28problem%29+which+returns+the+best+solution+found.%0A4.2.+Solver+Configuration%0A4.2.1.+Solver+Configuration+by+XML%0ABuild+a+Solver+instance+with+the+SolverFactory.+Configure+the+SolverFactory+with+a+solver%0Aconfiguration+XML+file%2C+provided+as+a+classpath+resource+%28as+defined+by+ClassLoader.getResource%28%29%29%3A%0A84%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0++++++++++++++%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0AIn+a+typical+project+%28following+the+Maven+directory+structure%29%2C+that+solverConfig+XML+file+would+be%0Alocated+at%0A%24PROJECT_DIR%2Fsrc%2Fmain%2Fresources%2Forg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%0A.+Alternatively%2C+a+SolverFactory+can+be+created+from+a+File%2C+an+InputStream+or+a+Reader+with+methods%0Asuch+as+SolverFactory.createFromXmlFile%28%29.+However%2C+for+portability+reasons%2C+a+classpath+resource+is%0Arecommended.%0AOn+some+environments+%28OSGi%2C+JBoss+modules%2C+%E2%80%A6%29%2C+classpath+resources+%28such+as+the%0Asolver+config%2C+score+DRL%E2%80%99s+and+domain+classes%29+in+your+jars+might+not+be+available%0Ato+the+default+ClassLoader+of+the+optaplanner-core+jar.+In+those+cases%2C+provide+the%0AClassLoader+of+your+classes+as+a+parameter%3A%0A%EF%81%9A%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28%0A%C2%A0++++++++++++++%22...%2FnqueensSolverConfig.xml%22%2C+getClass%28%29.%0AgetClassLoader%28%29%29%3B%0AWhen+using+Workbench+or+Execution+Server+or+to+take+advantage+of+Drools%E2%80%99s%0AKieContainer+features%2C+provide+the+KieContainer+as+a+parameter%3A%0A%C2%A0++++++KieServices+kieServices+%3D+KieServices.Factory.get%28%29%3B%0A%C2%A0++++++KieContainer+kieContainer+%3D+kieServices.newKieContainer%28%0A%EF%81%9A+%C2%A0++++++++++++++kieServices.newReleaseId%28%22org.nqueens%22%2C+%22nqueens%22%2C%221.0.0%22%29%29%3B%0A%C2%A0++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory%0A.createFromKieContainerXmlResource%28%0A%C2%A0++++++++++++++kieContainer%2C+%22...%2FnqueensSolverConfig.xml%22%29%3B%0AAlso+use+a+ksessionName+in+the+solver+configuration.%0ABoth+a+Solver+and+a+SolverFactory+have+a+generic+type+called+Solution_%2C+which+is+the+class%0Arepresenting+a+planning+problem+and+solution.%0AA+solver+configuration+XML+file+looks+like+this%3A%0A85%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+%3C%21--+Define+the+score+function+--%3E%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A%C2%A0+%3C%21--+Configure+the+optimization+algorithms+%28optional%29+--%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0ANotice+the+three+parts+in+it%3A%0A%E2%80%A2+Define+the+model.%0A%E2%80%A2+Define+the+score+function.%0A%E2%80%A2+Optionally+configure+the+optimization+algorithm%28s%29.%0AThese+various+parts+of+a+configuration+are+explained+further+in+this+manual.%0APlanner+makes+it+relatively+easy+to+switch+optimization+algorithm%28s%29+just+by+changing+the%0Aconfiguration.+There+is+even+a+Benchmarker+which+allows+you+to+play+out+different+configurations%0Aagainst+each+other+and+report+the+most+appropriate+configuration+for+your+use+case.%0A4.2.2.+Solver+Configuration+by+Java+API%0AA+solver+configuration+can+also+be+configured+with+the+SolverConfig+API.+This+is+especially+useful+to%0Achange+some+values+dynamically+at+runtime.+For+example%2C+to+change+the+running+time+based+on%0Auser+input%2C+before+building+the+Solver%3A%0A86%0A%C2%A0+++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0+++++++TerminationConfig+terminationConfig+%3D+new+TerminationConfig%28%29%3B%0A%C2%A0+++++++terminationConfig.setMinutesSpentLimit%28userInput%29%3B%0A%C2%A0+++++++solverFactory.getSolverConfig%28%29.setTerminationConfig%28terminationConfig%29%3B%0A%C2%A0+++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0AEvery+element+in+the+solver+configuration+XML+is+available+as+a+*Config+class+or+a+property+on+a%0A*Config+class+in+the+package+namespace+org.optaplanner.core.config.+These+*Config+classes+are+the%0AJava+representation+of+the+XML+format.+They+build+the+runtime+components+%28of+the+package%0Anamespace+org.optaplanner.core.impl%29+and+assemble+them+into+an+efficient+Solver.%0AThe+SolverFactory+is+only+thread-safe+after+it%E2%80%99s+configured.+So+the+getSolverConfig%28%29%0Amethod+is+not+thread-safe.+To+configure+a+SolverFactory+dynamically+for+each+user%0Arequest%2C+build+a+basic+SolverFactory+during+initialization+and+clone+it+with+the%0AcloneSolverFactory%28%29+method+for+a+user+request%3A%0A%C2%A0+++private+SolverFactory%3CNQueens%3E+base%3B%0A%C2%A0+++public+void+init%28%29+%7B%0A%C2%A0+++++++base+%3D+SolverFactory.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnqueensSolverConfig.xml%22%29%3B%0A%C2%A0+++++++base.getSolverConfig%28%29.setTerminationConfig%28new%0A%EF%81%AA+TerminationConfig%28%29%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+Called+concurrently+from+different+threads%0A%C2%A0+++public+void+userRequest%28...%2C+long+userInput%29%0A%C2%A0+++++++SolverFactory%3CNQueens%3E+solverFactory+%3D+base.cloneSolverFactory%0A%28%29%3B%0A%C2%A0+++++++solverFactory.getSolverConfig%28%29.getTerminationConfig%28%29%0A.setMinutesSpentLimit%28userInput%29%3B%0A%C2%A0+++++++Solver%3CNQueens%3E+solver+%3D+solverFactory.buildSolver%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A4.2.3.+Annotations+Configuration%0A4.2.3.1.+Automatic+Scanning+for+Annotations%0AInstead+of+the+declaring+the+classes+that+have+a+%40PlanningSolution+or+%40PlanningEntity+manually%3A%0A87%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0APlanner+can+find+scan+the+classpath+and+find+them+automatically%3A%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AOn+environments+such+as+OSGi+and+Android%2C+which+use+a+non-standard%0A%EF%81%9A+ClassLoader%2C+automated+scanning+might+not+find+the+%40PlanningSolution+or%0A%40PlanningEntity+classes.%0AAutomated+scanning+inflicts+a+performance+cost+during+bootstrap.+To+speed+up+scanning+or+if+there%0Aare+multiple+models+in+your+classpath%2C+specify+the+packages+to+scan%3A%0A%3Csolver%3E%0A%C2%A0+%3C%21--+Define+the+model+--%3E%0A%C2%A0+%3CscanAnnotatedClasses%3E%0A%C2%A0+++%3CpackageInclude%3Eorg.optaplanner.examples.cloudbalancing%3C%2FpackageInclude%3E%0A%C2%A0+%3C%2FscanAnnotatedClasses%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThis+finds+all+solution+and+entity+classes+in+that+package+or+its+subpackages.%0AIf+scanAnnotatedClasses+is+not+specified%2C+the+org.reflections+transitive+maven%0A%EF%81%9A+dependency+can+be+excluded.%0A4.2.3.2.+Annotation+Alternatives%0APlanner+needs+to+be+told+which+classes+in+your+domain+model+are+planning+entities%2C+which%0Aproperties+are+planning+variables%2C+etc.+There+are+several+ways+to+deliver+this+information%3A%0A%E2%80%A2+Add+class+annotations+and+JavaBean+property+annotations+on+the+domain+model%0A%28recommended%29.+The+property+annotations+must+be+on+the+getter+method%2C+not+on+the+setter%0Amethod.+Such+a+getter+does+not+need+to+be+public.%0A88%0A%E2%80%A2+Add+class+annotations+and+field+annotations+on+the+domain+model.+Such+a+field+does+not+need+to%0Abe+public.%0A%E2%80%A2+No+annotations%3A+externalize+the+domain+configuration+in+an+XML+file.+This+is+not+yet+supported.%0AThis+manual+focuses+on+the+first+manner%2C+but+every+feature+supports+all+three+manners%2C+even+if+it%E2%80%99s%0Anot+explicitly+mentioned.%0A4.2.4.+Custom+Properties+Configuration%0ASolver+configuration+elements%2C+that+instantiate+classes+and+explicitly+mention+it%2C+support+custom%0Aproperties.+Custom+properties+are+useful+to+tweak+dynamic+values+through+the+Benchmarker.+For%0Aexample%2C+presume+your+EasyScoreCalculator+has+heavy+calculations+%28which+are+cached%29+and+you%0Awant+to+increase+the+cache+size+in+one+benchmark%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CeasyScoreCalculatorClass%3E...MyEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3CeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%3C%21--+Override+value+--%3E%0A%C2%A0+++%3C%2FeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AAdd+a+public+setter+for+each+custom+property%2C+which+is+called+when+a+Solver+is+build.%0Apublic+class+MyEasyScoreCalculator+extends+EasyScoreCalculator%3CMySolution%3E+%7B%0A%C2%A0+++++++private+int+myCacheSize+%3D+500%3B+%2F%2F+Default+value%0A%C2%A0+++++++%40SuppressWarnings%28%22unused%22%29%0A%C2%A0+++++++public+void+setMyCacheSize%28int+myCacheSize%29+%7B%0A%C2%A0+++++++++++this.myCacheSize+%3D+myCacheSize%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++...%0A%7D%0AMost+value+types+are+supported+%28including+boolean%2C+int%2C+double%2C+BigDecimal%2C+String+and+enums%29.%0A4.3.+Model+a+Planning+Problem%0A4.3.1.+Is+This+Class+a+Problem+Fact+or+Planning+Entity%3F%0ALook+at+a+dataset+of+your+planning+problem.+You+will+recognize+domain+classes+in+there%2C+each+of%0Awhich+can+be+categorized+as+one+of+the+following%3A%0A%E2%80%A2+An+unrelated+class%3A+not+used+by+any+of+the+score+constraints.+From+a+planning+standpoint%2C+this%0Adata+is+obsolete.%0A89%0A%E2%80%A2+A+problem+fact+class%3A+used+by+the+score+constraints%2C+but+does+NOT+change+during+planning+%28as%0Along+as+the+problem+stays+the+same%29.+For+example%3A+Bed%2C+Room%2C+Shift%2C+Employee%2C+Topic%2C+Period%2C+%E2%80%A6+All%0Athe+properties+of+a+problem+fact+class+are+problem+properties.%0A%E2%80%A2+A+planning+entity+class%3A+used+by+the+score+constraints+and+changes+during+planning.+For%0Aexample%3A+BedDesignation%2C+ShiftAssignment%2C+Exam%2C+%E2%80%A6+The+properties+that+change+during+planning%0Aare+planning+variables.+The+other+properties+are+problem+properties.%0AAsk+yourself%3A+What+class+changes+during+planning%3F+Which+class+has+variables+that+I+want+the+Solver%0Ato+change+for+me%3F+That+class+is+a+planning+entity.+Most+use+cases+have+only+one+planning+entity+class.%0AMost+use+cases+also+have+only+one+planning+variable+per+planning+entity+class.%0AIn+real-time+planning%2C+even+though+the+problem+itself+changes%2C+problem+facts+do%0A%EF%81%9A+not+really+change+during+planning%2C+instead+they+change+between+planning%0A%28because+the+Solver+temporarily+stops+to+apply+the+problem+fact+changes%29.%0ATo+create+a+good+domain+model%2C+read+the+domain+modeling+guide.%0AIn+Planner%2C+all+problem+facts+and+planning+entities+are+plain+old+JavaBeans+%28POJOs%29.+Load+them%0Afrom+a+database%2C+an+XML+file%2C+a+data+repository%2C+a+REST+service%2C+a+noSQL+cloud%2C+%E2%80%A6+%28see+integration%29%3A%0Ait+doesn%E2%80%99t+matter.%0A4.3.2.+Problem+Fact%0AA+problem+fact+is+any+JavaBean+%28POJO%29+with+getters+that+does+not+change+during+planning.%0AImplementing+the+interface+Serializable+is+recommended+%28but+not+required%29.+For+example+in+n%0Aqueens%2C+the+columns+and+rows+are+problem+facts%3A%0Apublic+class+Column+implements+Serializable+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0Apublic+class+Row+implements+Serializable+%7B%0A%C2%A0+++private+int+index%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0AA+problem+fact+can+reference+other+problem+facts+of+course%3A%0A90%0Apublic+class+Course+implements+Serializable+%7B%0A%C2%A0+++private+String+code%3B%0A%C2%A0+++private+Teacher+teacher%3B+%2F%2F+Other+problem+fact%0A%C2%A0+++private+int+lectureSize%3B%0A%C2%A0+++private+int+minWorkingDaySize%3B%0A%C2%A0+++private+List%3CCurriculum%3E+curriculumList%3B+%2F%2F+Other+problem+facts%0A%C2%A0+++private+int+studentSize%3B%0A%C2%A0+++%2F%2F+...+getters%0A%7D%0AA+problem+fact+class+does+not+require+any+Planner+specific+code.+For+example%2C+you+can+reuse+your%0Adomain+classes%2C+which+might+have+JPA+annotations.%0AGenerally%2C+better+designed+domain+classes+lead+to+simpler+and+more+efficient+score%0Aconstraints.+Therefore%2C+when+dealing+with+a+messy+%28denormalized%29+legacy+system%2C%0Ait+can+sometimes+be+worthwhile+to+convert+the+messy+domain+model+into+a+Planner%0Aspecific+model+first.+For+example%3A+if+your+domain+model+has+two+Teacher+instances%0A%EF%81%9A+for+the+same+teacher+that+teaches+at+two+different+departments%2C+it+is+harder+towrite+a+correct+score+constraint+that+constrains+a+teacher%E2%80%99s+spare+time+on+the%0Aoriginal+model+than+on+an+adjusted+model.%0AAlternatively%2C+you+can+sometimes+also+introduce+a+cached+problem+fact+to+enrich%0Athe+domain+model+for+planning+only.%0A4.3.3.+Planning+Entity%0A4.3.3.1.+Planning+Entity+Annotation%0AA+planning+entity+is+a+JavaBean+%28POJO%29+that+changes+during+solving%2C+for+example+a+Queen+that%0Achanges+to+another+row.+A+planning+problem+has+multiple+planning+entities%2C+for+example+for+a%0Asingle+n+queens+problem%2C+each+Queen+is+a+planning+entity.+But+there+is+usually+only+one+planning%0Aentity+class%2C+for+example+the+Queen+class.%0AA+planning+entity+class+needs+to+be+annotated+with+the+%40PlanningEntity+annotation.%0AEach+planning+entity+class+has+one+or+more+planning+variables+%28which+can+be+genuine+or+shadows%29.%0AIt+should+also+have+one+or+more+defining+properties.+For+example+in+n+queens%2C+a+Queen+is+defined+by%0Aits+Column+and+has+a+planning+variable+Row.+This+means+that+a+Queen%E2%80%99s+column+never+changes+during%0Asolving%2C+while+its+row+does+change.%0A91%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++private+Column+column%3B%0A%C2%A0+++%2F%2F+Planning+variables%3A+changes+during+planning%2C+between+score+calculations.%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++%2F%2F+...+getters+and+setters%0A%7D%0AA+planning+entity+class+can+have+multiple+planning+variables.+For+example%2C+a+Lecture+is+defined+by%0Aits+Course+and+its+index+in+that+course+%28because+one+course+has+multiple+lectures%29.+Each+Lecture%0Aneeds+to+be+scheduled+into+a+Period+and+a+Room+so+it+has+two+planning+variables+%28period+and+room%29.%0AFor+example%3A+the+course+Mathematics+has+eight+lectures+per+week%2C+of+which+the+first+lecture+is%0AMonday+morning+at+08%3A00+in+room+212.%0A%40PlanningEntity%0Apublic+class+Lecture+%7B%0A%C2%A0+++private+Course+course%3B%0A%C2%A0+++private+int+lectureIndexInCourse%3B%0A%C2%A0+++%2F%2F+Planning+variables%3A+changes+during+planning%2C+between+score+calculations.%0A%C2%A0+++private+Period+period%3B%0A%C2%A0+++private+Room+room%3B%0A%C2%A0+++%2F%2F+...%0A%7D%0AWithout+automated+scanning%2C+the+solver+configuration+also+needs+to+declare+each+planning+entity%0Aclass%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CentityClass%3Eorg.optaplanner.examples.nqueens.domain.Queen%3C%2FentityClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ASome+uses+cases+have+multiple+planning+entity+classes.+For+example%3A+route+freight+and+trains+into%0Arailway+network+arcs%2C+where+each+freight+can+use+multiple+trains+over+its+journey+and+each+train%0Acan+carry+multiple+freights+per+arc.+Having+multiple+planning+entity+classes+directly+raises+the%0Aimplementation+complexity+of+your+use+case.%0A92%0ADo+not+create+unnecessary+planning+entity+classes.+This+leads+to+difficult+Move%0Aimplementations+and+slower+score+calculation.%0AFor+example%2C+do+not+create+a+planning+entity+class+to+hold+the+total+free+time+of+a%0Ateacher%2C+which+needs+to+be+kept+up+to+date+as+the+Lecture+planning+entities+change.%0AInstead%2C+calculate+the+free+time+in+the+score+constraints+%28or+as+a+shadow+variable%29%0A%EF%81%9A+and+put+the+result+per+teacher+into+a+logically+inserted+score+object.%0AIf+historic+data+needs+to+be+considered+too%2C+then+create+problem+fact+to+hold+the%0Atotal+of+the+historic+assignments+up+to%2C+but+not+including%2C+the+planning+window+%28so%0Athat+it+does+not+change+when+a+planning+entity+changes%29+and+let+the+score%0Aconstraints+take+it+into+account.%0A4.3.3.2.+Planning+Entity+Difficulty%0ASome+optimization+algorithms+work+more+efficiently+if+they+have+an+estimation+of+which+planning%0Aentities+are+more+difficult+to+plan.+For+example%3A+in+bin+packing+bigger+items+are+harder+to+fit%2C+in%0Acourse+scheduling+lectures+with+more+students+are+more+difficult+to+schedule%2C+and+in+n+queens+the%0Amiddle+queens+are+more+difficult+to+fit+on+the+board.%0ADo+not+try+to+use+planning+entity+difficulty+to+implement+a+business%0Aconstraint.+It+will+not+affect+the+score+function%3A+if+we+have+infinite+solving+time%2C%0Athe+returned+solution+will+be+the+same.%0A%EF%81%9A+To+attain+a+schedule+in+which+certain+entities+are+scheduled+earlier+in+the+schedule%2C%0Aadd+a+score+constraint+to+change+the+score+function+so+it+prefers+such+solutions.%0AOnly+consider+adding+planning+entity+difficulty+too+if+it+can+make+the+solver+more%0Aefficient.%0ATo+allow+the+heuristics+to+take+advantage+of+that+domain+specific+information%2C+set+a%0AdifficultyComparatorClass+to+the+%40PlanningEntity+annotation%3A%0A%40PlanningEntity%28difficultyComparatorClass+%3D+CloudProcessDifficultyComparator.class%29%0Apublic+class+CloudProcess+%7B%0A%C2%A0+++%2F%2F+...%0A%7D%0Apublic+class+CloudProcessDifficultyComparator+implements+Comparator%3CCloudProcess%3E+%7B%0A%C2%A0+++public+int+compare%28CloudProcess+a%2C+CloudProcess+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getRequiredMultiplicand%28%29%2C+b.getRequiredMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0A93%0AAlternatively%2C+you+can+also+set+a+difficultyWeightFactoryClass+to+the+%40PlanningEntity+annotation%2C+so%0Athat+you+have+access+to+the+rest+of+the+problem+facts+from+the+Solution+too%3A%0A%40PlanningEntity%28difficultyWeightFactoryClass+%3D+QueenDifficultyWeightFactory.class%29%0Apublic+class+Queen+%7B%0A%C2%A0+++%2F%2F+...%0A%7D%0ASee+sorted+selection+for+more+information.%0ADifficulty+should+be+implemented+ascending%3A+easy+entities+are+lower%2C+difficult%0Aentities+are+higher.+For+example%2C+in+bin+packing%3A+small+item+%3C+medium+item+%3C+big%0A%EF%81%AA+item.%0AAlthough+most+algorithms+start+with+the+more+difficult+entities+first%2C+they+just%0Areverse+the+ordering.%0ANone+of+the+current+planning+variable+states+should+be+used+to+compare+planning+entity+difficulty.%0ADuring+Construction+Heuristics%2C+those+variables+are+likely+to+be+null+anyway.+For+example%2C+a+Queen%27s%0Arow+variable+should+not+be+used.%0A4.3.4.+Planning+Variable+%28genuine%29%0A4.3.4.1.+Planning+Variable+Annotation%0AA+planning+variable+is+a+JavaBean+property+%28so+a+getter+and+setter%29+on+a+planning+entity.+It+points+to%0Aa+planning+value%2C+which+changes+during+planning.+For+example%2C+a+Queen%27s+row+property+is+a+genuine%0Aplanning+variable.+Note+that+even+though+a+Queen%27s+row+property+changes+to+another+Row+during%0Aplanning%2C+no+Row+instance+itself+is+changed.+Normally+planning+variables+are+genuine%2C+but+advanced%0Acases+can+also+have+shadows.%0AA+genuine+planning+variable+getter+needs+to+be+annotated+with+the+%40PlanningVariable+annotation%2C%0Awhich+needs+a+non-empty+valueRangeProviderRefs+property.%0A94%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++...%0A%C2%A0+++private+Row+row%3B%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setRow%28Row+row%29+%7B%0A%C2%A0+++++++this.row+%3D+row%3B%0A%C2%A0+++%7D%0A%7D%0AThe+valueRangeProviderRefs+property+defines+what+are+the+possible+planning+values+for+this%0Aplanning+variable.+It+references+one+or+more+%40ValueRangeProvider+id%27s.%0AA+%40PlanningVariable+annotation+needs+to+be+on+a+member+in+a+class+with+a%0A%EF%81%9A+%40PlanningEntity+annotation.+It+is+ignored+on+parent+classes+or+subclasses+without%0Athat+annotation.%0AAnnotating+the+field+instead+of+the+property+works+too%3A%0A%40PlanningEntity%0Apublic+class+Queen+%7B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++private+Row+row%3B%0A%7D%0A4.3.4.2.+Nullable+Planning+Variable%0ABy+default%2C+an+initialized+planning+variable+cannot+be+null%2C+so+an+initialized+solution+will+never+use%0Anull+for+any+of+its+planning+variables.+In+an+over-constrained+use+case%2C+this+can+be%0Acounterproductive.+For+example%3A+in+task+assignment+with+too+many+tasks+for+the+workforce%2C+we%0Awould+rather+leave+low+priority+tasks+unassigned+instead+of+assigning+them+to+an+overloaded%0Aworker.%0ATo+allow+an+initialized+planning+variable+to+be+null%2C+set+nullable+to+true%3A%0A95%0A%C2%A0+++%40PlanningVariable%28...%2C+nullable+%3D+true%29%0A%C2%A0+++public+Worker+getWorker%28%29+%7B%0A%C2%A0+++++++return+worker%3B%0A%C2%A0+++%7D%0APlanner+will+automatically+add+the+value+null+to+the+value+range.+There+is+no+need%0A%EF%81%AA+to+add+null+in+a+collection+used+by+a+ValueRangeProvider.%0AUsing+a+nullable+planning+variable+implies+that+your+score+calculation+is%0A%EF%81%9A+responsible+for+punishing+%28or+even+rewarding%29+variables+with+a+null+value.%0ARepeated+planning+%28especially+real-time+planning%29+does+not+mix+well+with+a+nullable+planning%0Avariable.+Every+time+the+Solver+starts+or+a+problem+fact+change+is+made%2C+the+Construction+Heuristics%0Awill+try+to+initialize+all+the+null+variables+again%2C+which+can+be+a+huge+waste+of+time.+One+way+to+deal%0Awith+this%2C+is+to+change+when+a+planning+entity+should+be+reinitialized+with+an%0AreinitializeVariableEntityFilter%3A%0A%C2%A0+++%40PlanningVariable%28...%2C+nullable+%3D+true%2C+reinitializeVariableEntityFilter+%3D%0AReinitializeTaskFilter.class%29%0A%C2%A0+++public+Worker+getWorker%28%29+%7B%0A%C2%A0+++++++return+worker%3B%0A%C2%A0+++%7D%0A4.3.4.3.+When+is+a+Planning+Variable+Considered+Initialized%3F%0AA+planning+variable+is+considered+initialized+if+its+value+is+not+null+or+if+the+variable+is+nullable.+So+a%0Anullable+variable+is+always+considered+initialized%2C+even+when+a+custom%0AreinitializeVariableEntityFilter+triggers+a+reinitialization+during+construction+heuristics.%0AA+planning+entity+is+initialized+if+all+of+its+planning+variables+are+initialized.%0AA+Solution+is+initialized+if+all+of+its+planning+entities+are+initialized.%0A4.3.5.+Planning+Value+and+Planning+Value+Range%0A4.3.5.1.+Planning+Value%0AA+planning+value+is+a+possible+value+for+a+genuine+planning+variable.+Usually%2C+a+planning+value+is+a%0Aproblem+fact%2C+but+it+can+also+be+any+object%2C+for+example+a+double.+It+can+even+be+another+planning%0Aentity+or+even+a+interface+implemented+by+both+a+planning+entity+and+a+problem+fact.%0AA+planning+value+range+is+the+set+of+possible+planning+values+for+a+planning+variable.+This+set+can+be%0Aa+countable+%28for+example+row+1%2C+2%2C+3+or+4%29+or+uncountable+%28for+example+any+double+between+0.0+and%0A1.0%29.%0A96%0A4.3.5.2.+Planning+Value+Range+Provider%0A4.3.5.2.1.+Overview%0AThe+value+range+of+a+planning+variable+is+defined+with+the+%40ValueRangeProvider+annotation.+A%0A%40ValueRangeProvider+annotation+always+has+a+property+id%2C+which+is+referenced+by+the%0A%40PlanningVariable%27s+property+valueRangeProviderRefs.%0AThis+annotation+can+be+located+on+two+types+of+methods%3A%0A%E2%80%A2+On+the+Solution%3A+All+planning+entities+share+the+same+value+range.%0A%E2%80%A2+On+the+planning+entity%3A+The+value+range+differs+per+planning+entity.+This+is+less+common.%0AA+%40ValueRangeProvider+annotation+needs+to+be+on+a+member+in+a+class+with+a%0A%EF%81%9A+%40PlanningSolution+or+a+%40PlanningEntity+annotation.+It+is+ignored+on+parent%0Aclasses+or+subclasses+without+those+annotations.%0AThe+return+type+of+that+method+can+be+three+types%3A%0A%E2%80%A2+Collection%3A+The+value+range+is+defined+by+a+Collection+%28usually+a+List%29+of+its+possible+values.%0A%E2%80%A2+Array%3A+The+value+range+is+defined+by+an+array+of+its+possible+values.%0A%E2%80%A2+ValueRange%3A+The+value+range+is+defined+by+its+bounds.+This+is+less+common.%0A4.3.5.2.2.+ValueRangeProvider+on+the+Solution%0AAll+instances+of+the+same+planning+entity+class+share+the+same+set+of+possible+planning+values+for%0Athat+planning+variable.+This+is+the+most+common+way+to+configure+a+value+range.%0AThe+Solution+implementation+has+method+that+returns+a+Collection+%28or+a+ValueRange%29.+Any+value%0Afrom+that+Collection+is+a+possible+planning+value+for+this+planning+variable.%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22rowRange%22%7D%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22rowRange%22%29%0A%C2%A0+++public+List%3CRow%3E+getRowList%28%29+%7B%0A%C2%A0+++++++return+rowList%3B%0A%C2%A0+++%7D%0A%7D%0A97%0AThat+Collection+%28or+ValueRange%29+must+not+contain+the+value+null%2C+not+even+for+a%0A%EF%81%AA+nullable+planning+variable.%0AAnnotating+the+field+instead+of+the+property+works+too%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22rowRange%22%29%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%7D%0A4.3.5.2.3.+ValueRangeProvider+on+the+Planning+Entity%0AEach+planning+entity+has+its+own+value+range+%28a+set+of+possible+planning+values%29+for+the+planning%0Avariable.+For+example%2C+if+a+teacher+can+never+teach+in+a+room+that+does+not+belong+to+his%0Adepartment%2C+lectures+of+that+teacher+can+limit+their+room+value+range+to+the+rooms+of+his%0Adepartment.%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22departmentRoomRange%22%7D%29%0A%C2%A0+++public+Room+getRoom%28%29+%7B%0A%C2%A0+++++++return+room%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22departmentRoomRange%22%29%0A%C2%A0+++public+List%3CRoom%3E+getPossibleRoomList%28%29+%7B%0A%C2%A0+++++++return+getCourse%28%29.getTeacher%28%29.getDepartment%28%29.getRoomList%28%29%3B%0A%C2%A0+++%7D%0ANever+use+this+to+enforce+a+soft+constraint+%28or+even+a+hard+constraint+when+the+problem+might+not%0Ahave+a+feasible+solution%29.+For+example%3A+Unless+there+is+no+other+way%2C+a+teacher+can+not+teach+in+a%0Aroom+that+does+not+belong+to+his+department.+In+this+case%2C+the+teacher+should+not+be+limited+in+his%0Aroom+value+range+%28because+sometimes+there+is+no+other+way%29.%0ABy+limiting+the+value+range+specifically+of+one+planning+entity%2C+you+are+effectively%0Acreating+a+built-in+hard+constraint.+This+can+have+the+benefit+of+severely+lowering%0A%EF%81%9A+the+number+of+possible+solutions%3B+however%2C+it+can+also+take+away+the+freedom+of%0Athe+optimization+algorithms+to+temporarily+break+that+constraint+in+order+to+escape%0Afrom+a+local+optimum.%0AA+planning+entity+should+not+use+other+planning+entities+to+determinate+its+value+range.+That+would%0Aonly+try+to+make+the+planning+entity+solve+the+planning+problem+itself+and+interfere+with+the%0Aoptimization+algorithms.%0AEvery+entity+has+its+own+List+instance%2C+unless+multiple+entities+have+the+same+value+range.+For%0A98%0Aexample%2C+if+teacher+A+and+B+belong+to+the+same+department%2C+they+use+the+same+List%3CRoom%3E+instance.%0AFurthermore%2C+each+List+contains+a+subset+of+the+same+set+of+planning+value+instances.+For+example%2C%0Aif+department+A+and+B+can+both+use+room+X%2C+then+their+List%3CRoom%3E+instances+contain+the+same+Room%0Ainstance.%0AA+ValueRangeProvider+on+the+planning+entity+consumes+more+memory+than%0A%EF%81%9A+ValueRangeProvider+on+the+Solution+and+disables+certain+automatic+performance%0Aoptimizations.%0AA+ValueRangeProvider+on+the+planning+entity+is+not+currently+compatible+with+a%0A%EF%81%B1+chained+variable.%0A4.3.5.2.4.+ValueRangeFactory%0AInstead+of+a+Collection%2C+you+can+also+return+a+ValueRange+or+CountableValueRange%2C+build+by+the%0AValueRangeFactory%3A%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22delayRange%22%29%0A%C2%A0+++public+CountableValueRange%3CInteger%3E+getDelayRange%28%29+%7B%0A%C2%A0+++++++return+ValueRangeFactory.createIntValueRange%280%2C+5000%29%3B%0A%C2%A0+++%7D%0AA+ValueRange+uses+far+less+memory%2C+because+it+only+holds+the+bounds.+In+the+example+above%2C+a%0ACollection+would+need+to+hold+all+5000+ints%2C+instead+of+just+the+two+bounds.%0AFurthermore%2C+an+incrementUnit+can+be+specified%2C+for+example+if+you+have+to+buy+stocks+in+units+of%0A200+pieces%3A%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22stockAmountRange%22%29%0A%C2%A0+++public+CountableValueRange%3CInteger%3E+getStockAmountRange%28%29+%7B%0A%C2%A0++++++++%2F%2F+Range%3A+0%2C+200%2C+400%2C+600%2C+...%2C+9999600%2C+9999800%2C+10000000%0A%C2%A0+++++++return+ValueRangeFactory.createIntValueRange%280%2C+10000000%2C+200%29%3B%0A%C2%A0+++%7D%0AReturn+CountableValueRange+instead+of+ValueRange+whenever+possible+%28so+Planner%0A%EF%81%9A+knows+that+it%E2%80%99s+countable%29.%0AThe+ValueRangeFactory+has+creation+methods+for+several+value+class+types%3A%0A%E2%80%A2+boolean%3A+A+boolean+range.%0A%E2%80%A2+int%3A+A+32bit+integer+range.%0A%E2%80%A2+long%3A+A+64bit+integer+range.%0A%E2%80%A2+double%3A+A+64bit+floating+point+range+which+only+supports+random+selection+%28because+it+does+not%0Aimplement+CountableValueRange%29.%0A%E2%80%A2+BigInteger%3A+An+arbitrary-precision+integer+range.%0A99%0A%E2%80%A2+BigDecimal%3A+A+decimal+point+range.+By+default%2C+the+increment+unit+is+the+lowest+non-zero+value+in%0Athe+scale+of+the+bounds.%0A%E2%80%A2+Temporal+%28such+as+LocalDate%2C+LocalDateTime%2C+%E2%80%A6%29%3A+A+time+range.%0A4.3.5.2.5.+Combine+ValueRangeProviders%0AValue+range+providers+can+be+combined%2C+for+example%3A%0A%C2%A0+++%40PlanningVariable%28valueRangeProviderRefs+%3D+%7B%22companyCarRange%22%2C+%22personalCarRange%22%0A%7D%29%0A%C2%A0+++public+Car+getCar%28%29+%7B%0A%C2%A0+++++++return+car%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22companyCarRange%22%29%0A%C2%A0+++public+List%3CCompanyCar%3E+getCompanyCarList%28%29+%7B%0A%C2%A0+++++++return+companyCarList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22personalCarRange%22%29%0A%C2%A0+++public+List%3CPersonalCar%3E+getPersonalCarList%28%29+%7B%0A%C2%A0+++++++return+personalCarList%3B%0A%C2%A0+++%7D%0A4.3.5.3.+Planning+Value+Strength%0ASome+optimization+algorithms+work+a+bit+more+efficiently+if+they+have+an+estimation+of+which%0Aplanning+values+are+stronger%2C+which+means+they+are+more+likely+to+satisfy+a+planning+entity.+For%0Aexample%3A+in+bin+packing+bigger+containers+are+more+likely+to+fit+an+item+and+in+course+scheduling%0Abigger+rooms+are+less+likely+to+break+the+student+capacity+constraint.+Usually%2C+the+efficiency+gain+of%0Aplanning+value+strength+is+far+less+than+that+of+planning+entity+difficulty.%0ADo+not+try+to+use+planning+value+strength+to+implement+a+business+constraint.%0AIt+will+not+affect+the+score+function%3A+if+we+have+infinite+solving+time%2C+the+returned%0A%EF%81%9A+solution+will+be+the+same.%0ATo+affect+the+score+function%2C+add+a+score+constraint.+Only+consider+adding+planning%0Avalue+strength+too+if+it+can+make+the+solver+more+efficient.%0ATo+allow+the+heuristics+to+take+advantage+of+that+domain+specific+information%2C+set+a%0AstrengthComparatorClass+to+the+%40PlanningVariable+annotation%3A%0A100%0A%C2%A0+++%40PlanningVariable%28...%2C+strengthComparatorClass+%3D+CloudComputerStrengthComparator%0A.class%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0Apublic+class+CloudComputerStrengthComparator+implements+Comparator%3CCloudComputer%3E+%7B%0A%C2%A0+++public+int+compare%28CloudComputer+a%2C+CloudComputer+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getMultiplicand%28%29%2C+b.getMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28b.getCost%28%29%2C+a.getCost%28%29%29+%2F%2F+Descending+%28but+this+is%0Adebatable%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AIf+you+have+multiple+planning+value+classes+in+the+same+value+range%2C+the%0AstrengthComparatorClass+needs+to+implement+a+Comparator+of+a+common+superclass%0A%EF%81%9A+%28for+example+Comparator%3CObject%3E%29+and+be+able+to+handle+comparing+instances+of%0Athose+different+classes.%0AAlternatively%2C+you+can+also+set+a+strengthWeightFactoryClass+to+the+%40PlanningVariable+annotation%2C+so%0Ayou+have+access+to+the+rest+of+the+problem+facts+from+the+solution+too%3A%0A%C2%A0+++%40PlanningVariable%28...%2C+strengthWeightFactoryClass+%3D+RowStrengthWeightFactory.%0Aclass%29%0A%C2%A0+++public+Row+getRow%28%29+%7B%0A%C2%A0+++++++return+row%3B%0A%C2%A0+++%7D%0ASee+sorted+selection+for+more+information.%0AStrength+should+be+implemented+ascending%3A+weaker+values+are+lower%2C+stronger%0A%EF%81%AA+values+are+higher.+For+example+in+bin+packing%3A+small+container+%3C+medium%0Acontainer+%3C+big+container.%0ANone+of+the+current+planning+variable+state+in+any+of+the+planning+entities+should+be+used+to+compare%0Aplanning+values.+During+construction+heuristics%2C+those+variables+are+likely+to+be+null.+For+example%2C%0Anone+of+the+row+variables+of+any+Queen+may+be+used+to+determine+the+strength+of+a+Row.%0A4.3.5.4.+Chained+Planning+Variable+%28TSP%2C+VRP%2C+%E2%80%A6%29%0ASome+use+cases%2C+such+as+TSP+and+Vehicle+Routing%2C+require+chaining.+This+means+the+planning+entities%0A101%0Apoint+to+each+other+and+form+a+chain.+By+modeling+the+problem+as+a+set+of+chains+%28instead+of+a+set+of%0Atrees%2Floops%29%2C+the+search+space+is+heavily+reduced.%0AA+planning+variable+that+is+chained+either%3A%0A%E2%80%A2+Directly+points+to+a+problem+fact+%28or+planning+entity%29%2C+which+is+called+an+anchor.%0A%E2%80%A2+Points+to+another+planning+entity+with+the+same+planning+variable%2C+which+recursively+points+to%0Aan+anchor.%0AHere+are+some+example+of+valid+and+invalid+chains%3A%0AEvery+initialized+planning+entity+is+part+of+an+open-ended+chain+that+begins+from+an+anchor.+A%0Avalid+model+means+that%3A%0A%E2%80%A2+A+chain+is+never+a+loop.+The+tail+is+always+open.%0A%E2%80%A2+Every+chain+always+has+exactly+one+anchor.+The+anchor+is+a+problem+fact%2C+never+a+planning%0Aentity.%0A%E2%80%A2+A+chain+is+never+a+tree%2C+it+is+always+a+line.+Every+anchor+or+planning+entity+has+at+most+one%0Atrailing+planning+entity.%0A%E2%80%A2+Every+initialized+planning+entity+is+part+of+a+chain.%0A%E2%80%A2+An+anchor+with+no+planning+entities+pointing+to+it%2C+is+also+considered+a+chain.%0A102%0A%EF%81%B1+A+planning+problem+instance+given+to+the+Solver+must+be+valid.%0AIf+your+constraints+dictate+a+closed+chain%2C+model+it+as+an+open-ended+chain+%28which%0A%EF%81%9A+is+easier+to+persist+in+a+database%29+and+implement+a+score+constraint+for+the+last%0Aentity+back+to+the+anchor.%0AThe+optimization+algorithms+and+built-in+Moves+do+chain+correction+to+guarantee+that+the+model%0Astays+valid%3A%0A%EF%81%B1+A+custom+Move+implementation+must+leave+the+model+in+a+valid+state.%0AFor+example%2C+in+TSP+the+anchor+is+a+Domicile+%28in+vehicle+routing+it+is+Vehicle%29%3A%0Apublic+class+Domicile+...+implements+Standstill+%7B%0A%C2%A0+++...%0A%C2%A0+++public+City+getCity%28%29+%7B...%7D%0A%7D%0AThe+anchor+%28which+is+a+problem+fact%29+and+the+planning+entity+implement+a+common+interface%2C+for%0Aexample+TSP%E2%80%99s+Standstill%3A%0A103%0Apublic+interface+Standstill+%7B%0A%C2%A0+++City+getCity%28%29%3B%0A%7D%0AThat+interface+is+the+return+type+of+the+planning+variable.+Furthermore%2C+the+planning+variable+is%0Achained.+For+example+TSP%E2%80%99s+Visit+%28in+vehicle+routing+it+is+Customer%29%3A%0A%40PlanningEntity%0Apublic+class+Visit+...+implements+Standstill+%7B%0A%C2%A0+++...%0A%C2%A0+++public+City+getCity%28%29+%7B...%7D%0A%C2%A0+++%40PlanningVariable%28graphType+%3D+PlanningVariableGraphType.CHAINED%2C%0A%C2%A0+++++++valueRangeProviderRefs+%3D+%7B%22domicileRange%22%2C+%22visitRange%22%7D%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setPreviousStandstill%28Standstill+previousStandstill%29+%7B%0A%C2%A0+++++++this.previousStandstill+%3D+previousStandstill%3B%0A%C2%A0+++%7D%0A%7D%0ANotice+how+two+value+range+providers+are+usually+combined%3A%0A%E2%80%A2+The+value+range+provider+that+holds+the+anchors%2C+for+example+domicileList.%0A%E2%80%A2+The+value+range+provider+that+holds+the+initialized+planning+entities%2C+for+example+visitList.%0A4.3.6.+Planning+Problem+and+Planning+Solution%0A4.3.6.1.+Planning+Problem+Instance%0AA+dataset+for+a+planning+problem+needs+to+be+wrapped+in+a+class+for+the+Solver+to+solve.+That%0Asolution+class+represents+both+the+planning+problem+and+%28if+solved%29+a+solution.+It+is+annotated+with+a%0A%40PlanningSolution+annotation.+For+example+in+n+queens%2C+the+solution+class+is+the+NQueens+class%2C+which%0Acontains+a+Column+list%2C+a+Row+list%2C+and+a+Queen+list.%0AA+planning+problem+is+actually+an+unsolved+planning+solution+or+-+stated+differently+-+an%0Auninitialized+solution.+For+example+in+n+queens%2C+that+NQueens+class+has+the+%40PlanningSolution%0Aannotation%2C+yet+every+Queen+in+an+unsolved+NQueens+class+is+not+yet+assigned+to+a+Row+%28their+row%0Aproperty+is+null%29.+That%E2%80%99s+not+a+feasible+solution.+It%E2%80%99s+not+even+a+possible+solution.+It%E2%80%99s+an+uninitialized%0Asolution.%0A104%0A4.3.6.2.+Solution+Class%0AA+solution+class+holds+all+problem+facts%2C+planning+entities+and+a+score.+It+is+annotated+with+a%0A%40PlanningSolution+annotation.+For+example%2C+an+NQueens+instance+holds+a+list+of+all+columns%2C+all+rows%0Aand+all+Queen+instances%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++%2F%2F+Problem+facts%0A%C2%A0+++private+int+n%3B%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++%2F%2F+Planning+entities%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++...%0A%7D%0AWithout+automated+scanning%2C+the+solver+configuration+also+needs+to+declare+the+planning+solution%0Aclass%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CsolutionClass%3Eorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FsolutionClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0A4.3.6.3.+Planning+Entities+of+a+Solution+%28%40PlanningEntityCollectionProperty%29%0APlanner+needs+to+extract+the+entity+instances+from+the+solution+instance.+It+gets+those+collection%28s%29+by%0Acalling+every+getter+%28or+field%29+that+is+annotated+with+%40PlanningEntityCollectionProperty%3A%0A105%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+List%3CQueen%3E+queenList%3B%0A%C2%A0+++%40PlanningEntityCollectionProperty%0A%C2%A0+++public+List%3CQueen%3E+getQueenList%28%29+%7B%0A%C2%A0+++++++return+queenList%3B%0A%C2%A0+++%7D%0A%7D%0AThere+can+be+multiple+%40PlanningEntityCollectionProperty+annotated+members.+Those+can+even%0Areturn+a+Collection+with+the+same+entity+class+type.+Instead+of+Collection%2C+it+can+also+return+an%0Aarray.%0AA+%40PlanningEntityCollectionProperty+annotation+needs+to+be+on+a+member+in+a%0A%EF%81%9A+class+with+a+%40PlanningSolution+annotation.+It+is+ignored+on+parent+classes+or%0Asubclasses+without+that+annotation.%0AIn+rare+cases%2C+a+planning+entity+might+be+a+singleton%3A+use+%40PlanningEntityProperty+on+its+getter+%28or%0Afield%29+instead.%0ABoth+annotations+can+also+be+auto+discovered+if+enabled.%0A4.3.6.4.+Score+of+a+Solution+%28%40PlanningScore%29%0AA+Solution+requires+a+score+property+%28or+field%29%2C+which+is+annotated+with+a+%40PlanningScore%0Aannotation.+The+score+property+is+null+if+the+the+score+hasn%E2%80%99t+been+calculated+yet.+The+score+property%0Ais+typed+to+the+specific+Score+implementation+of+your+use+case.+For+example%2C+NQueens+uses+a%0ASimpleScore%3A%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+SimpleScore+score%3B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+SimpleScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28SimpleScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%7D%0A106%0AMost+use+cases+use+a+HardSoftScore+instead%3A%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++...%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++public+HardSoftScore+getScore%28%29+%7B%0A%C2%A0+++++++return+score%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setScore%28HardSoftScore+score%29+%7B%0A%C2%A0+++++++this.score+%3D+score%3B%0A%C2%A0+++%7D%0A%7D%0ASome+use+cases+use+other+score+types.%0AThis+annotation+can+also+be+auto+discovered+if+enabled.%0A4.3.6.5.+Problem+Facts+of+a+Solution+%28%40ProblemFactCollectionProperty%29%0AFor+Drools+score+calculation%2C+Planner+needs+to+extract+the+problem+fact+instances+from+the+solution%0Ainstance.+It+gets+those+collection%28s%29+by+calling+every+method+%28or+field%29+that+is+annotated+with%0A%40ProblemFactCollectionProperty.+All+objects+returned+by+those+methods+will+be+inserted+into+the%0ADrools+session%2C+so+the+score+rules+can+access+them.+For+example+in+NQueens+all+Column+and+Row%0Ainstances+are+problem+facts.%0A107%0A%40PlanningSolution%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%C2%A0+++private+List%3CColumn%3E+columnList%3B%0A%C2%A0+++private+List%3CRow%3E+rowList%3B%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CColumn%3E+getColumnList%28%29+%7B%0A%C2%A0+++++++return+columnList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++public+List%3CRow%3E+getRowList%28%29+%7B%0A%C2%A0+++++++return+rowList%3B%0A%C2%A0+++%7D%0A%7D%0AAll+planning+entities+are+automatically+inserted+into+the+Drools+working+memory.+Do+note+add+an%0Aannotation+on+their+properties.%0AThe+problem+facts+methods+are+not+called+often%3A+at+most+only+once+per+solver+phase%0A%EF%81%9A+per+solver+thread.%0AThere+can+be+multiple+%40ProblemFactCollectionProperty+annotated+members.+Those+can+even+return%0Aa+Collection+with+the+same+class+type%2C+but+they+shouldn%E2%80%99t+return+the+same+instance+twice.+Instead+of%0ACollection%2C+it+can+also+return+an+array.%0AA+%40ProblemFactCollectionProperty+annotation+needs+to+be+on+a+member+in+a+class%0A%EF%81%9A+with+a+%40PlanningSolution+annotation.+It+is+ignored+on+parent+classes+or+subclasses%0Awithout+that+annotation.%0AIn+rare+cases%2C+a+problem+fact+might+be+a+singleton%3A+use+%40ProblemFactProperty+on+its+method+%28or+field%29%0Ainstead.%0ABoth+annotations+can+also+be+auto+discovered+if+enabled.%0A4.3.6.5.1.+Cached+Problem+Fact%0AA+cached+problem+fact+is+a+problem+fact+that+does+not+exist+in+the+real+domain+model%2C+but+is%0Acalculated+before+the+Solver+really+starts+solving.+The+problem+facts+methods+have+the+opportunity%0Ato+enrich+the+domain+model+with+such+cached+problem+facts%2C+which+can+lead+to+simpler+and+faster%0Ascore+constraints.%0AFor+example+in+examination%2C+a+cached+problem+fact+TopicConflict+is+created+for+every+two+Topics%0Awhich+share+at+least+one+Student.%0A108%0A%C2%A0+++%40ProblemFactCollectionProperty%0A%C2%A0+++private+List%3CTopicConflict%3E+calculateTopicConflictList%28%29+%7B%0A%C2%A0+++++++List%3CTopicConflict%3E+topicConflictList+%3D+new+ArrayList%3CTopicConflict%3E%28%29%3B%0A%C2%A0+++++++for+%28Topic+leftTopic+%3A+topicList%29+%7B%0A%C2%A0+++++++++++for+%28Topic+rightTopic+%3A+topicList%29+%7B%0A%C2%A0+++++++++++++++if+%28leftTopic.getId%28%29+%3C+rightTopic.getId%28%29%29+%7B%0A%C2%A0+++++++++++++++++++int+studentSize+%3D+0%3B%0A%C2%A0+++++++++++++++++++for+%28Student+student+%3A+leftTopic.getStudentList%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++if+%28rightTopic.getStudentList%28%29.contains%28student%29%29+%7B%0A%C2%A0+++++++++++++++++++++++++++studentSize%2B%2B%3B%0A%C2%A0+++++++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28studentSize+%3E+0%29+%7B%0A%C2%A0+++++++++++++++++++++++topicConflictList.add%28new+TopicConflict%28leftTopic%2C+rightTopic%2C%0AstudentSize%29%29%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+topicConflictList%3B%0A%C2%A0+++%7D%0AWhere+a+score+constraint+needs+to+check+that+no+two+exams+with+a+topic+that+shares+a+student+are%0Ascheduled+close+together+%28depending+on+the+constraint%3A+at+the+same+time%2C+in+a+row%2C+or+in+the+same%0Aday%29%2C+the+TopicConflict+instance+can+be+used+as+a+problem+fact%2C+rather+than+having+to+combine+every%0Atwo+Student+instances.%0A4.3.6.6.+Auto+Discover+Solution+Properties%0AInstead+of+configuring+each+property+%28or+field%29+annotation+explicitly%2C+some+can+also+be+deduced%0Aautomatically+by+Planner.+For+example%2C+on+the+cloud+balancing+example%3A%0A%40PlanningSolution%28autoDiscoverMemberType+%3D+AutoDiscoverMemberType.FIELD%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40ProblemFactCollectionProperty%0A%C2%A0+++%40ValueRangeProvider%28id+%3D+%22computerRange%22%29+%2F%2F+Not+%28yet%29+auto+discovered%0A%C2%A0+++private+List%3CCloudComputer%3E+computerList%3B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40PlanningEntityCollectionProperty%0A%C2%A0+++private+List%3CCloudProcess%3E+processList%3B%0A%C2%A0+++%2F%2F+Auto+discovered+as+%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0A109%0AThe+AutoDiscoverMemberType+can+be%3A%0A%E2%80%A2+NONE%3A+No+auto+discovery.%0A%E2%80%A2+FIELD%3A+Auto+discover+all+fields+on+the+%40PlanningSolution+class%0A%E2%80%A2+GETTER%3A+Auto+discover+all+getters+on+the+%40PlanningSolution+class%0AThe+automatic+annotation+is+based+on+the+field+type+%28or+getter+return+type%29%3A%0A%E2%80%A2+%40ProblemFactProperty%3A+when+it+isn%E2%80%99t+a+Collection%2C+an+array%2C+a+%40PlanningEntity+class+or+a+Score%0A%E2%80%A2+%40ProblemFactCollectionProperty%3A+when+it%E2%80%99s+a+Collection+%28or+array%29+of+a+type+that+isn%E2%80%99t+a%0A%40PlanningEntity+class%0A%E2%80%A2+%40PlanningEntityProperty%3A+when+it+is+a+configured+%40PlanningEntity+class+or+subclass%0A%E2%80%A2+%40PlanningEntityCollectionProperty%3A+when+it%E2%80%99s+a+Collection+%28or+array%29+of+a+type+that+is+a%0Aconfigured+%40PlanningEntity+class+or+subclass%0A%E2%80%A2+%40PlanningScore%3A+when+it+is+a+Score+or+subclass%0AThese+automatic+annotation+can+still+be+overwritten+per+field+%28or+getter%29.+Specifically%2C+a%0ABendableScore+always+needs+to+override+with+an+explicit+%40PlanningScore+annotation+to+define+the%0Anumber+of+hard+and+soft+levels.%0A4.3.6.7.+Cloning+a+Solution%0AMost+%28if+not+all%29+optimization+algorithms+clone+the+solution+each+time+they+encounter+a+new+best%0Asolution+%28so+they+can+recall+it+later%29+or+to+work+with+multiple+solutions+in+parallel.%0AThere+are+many+ways+to+clone%2C+such+as+a+shallow+clone%2C+deep+clone%2C+%E2%80%A6+This+context%0A%EF%81%9A+focuses+on+a+planning+clone.%0AA+planning+clone+of+a+solution+must+fulfill+these+requirements%3A%0A%E2%80%A2+The+clone+must+represent+the+same+planning+problem.+Usually+it+reuses+the+same+instances+of%0Athe+problem+facts+and+problem+fact+collections+as+the+original.%0A%E2%80%A2+The+clone+must+use+different%2C+cloned+instances+of+the+entities+and+entity+collections.+Changes+to%0Aan+original+Solution+entity%E2%80%99s+variables+must+not+affect+its+clone.%0A110%0AImplementing+a+planning+clone+method+is+hard%2C+therefore+you+do+not+need+to+implement+it.%0A4.3.6.7.1.+FieldAccessingSolutionCloner%0AThis+SolutionCloner+is+used+by+default.+It+works+well+for+most+use+cases.%0AWhen+the+FieldAccessingSolutionCloner+clones+one+of+your+collections+or+maps%2C+it%0Amay+not+recognize+the+implementation+and+replace+it+with+ArrayList%2C%0A%EF%81%B1+LinkedHashSet%2C+TreeSet%2C+LinkedHashMap+or+TreeMap+%28whichever+is+more+applicable%29+.+It%0Arecognizes+most+of+the+common+JDK+collection+and+map+implementations.%0AThe+FieldAccessingSolutionCloner+does+not+clone+problem+facts+by+default.+If+any+of+your+problem%0Afacts+needs+to+be+deep+cloned+for+a+planning+clone%2C+for+example+if+the+problem+fact+references+a%0Aplanning+entity+or+the+planning+solution%2C+mark+it+with+a+%40DeepPlanningClone+annotation%3A%0A%40DeepPlanningClone%0Apublic+class+SeatDesignationDependency+%7B%0A%C2%A0+++private+SeatDesignation+leftSeatDesignation%3B+%2F%2F+planning+entity%0A%C2%A0+++private+SeatDesignation+rightSeatDesignation%3B+%2F%2F+planning+entity%0A%C2%A0+++...%0A%7D%0AIn+the+example+above%2C+because+SeatDesignation+is+a+planning+entity+%28which+is+deep+planning+cloned%0A111%0Aautomatically%29%2C+SeatDesignationDependency+must+also+be+deep+planning+cloned.%0AAlternatively%2C+the+%40DeepPlanningClone+annotation+can+also+be+used+on+a+getter+method.%0A4.3.6.7.2.+Custom+Cloning+with+a+SolutionCloner%0ATo+use+a+custom+cloner%2C+configure+it+on+the+planning+solution%3A%0A%40PlanningSolution%28solutionCloner+%3D+NQueensSolutionCloner.class%29%0Apublic+class+NQueens+%7B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+a+NQueens+planning+clone+only+deep+clones+all+Queen+instances.+So+when+the+original%0Asolution+changes+%28later+on+during+planning%29+and+one+or+more+Queen+instances+change%2C+the+planning%0Aclone+isn%E2%80%99t+affected.%0Apublic+class+NQueensSolutionCloner+implements+SolutionCloner%3CNQueens%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+NQueens+cloneSolution%28CloneLedger+ledger%2C+NQueens+original%29+%7B%0A%C2%A0+++++++NQueens+clone+%3D+new+NQueens%28%29%3B%0A%C2%A0+++++++ledger.registerClone%28original%2C+clone%29%3B%0A%C2%A0+++++++clone.setId%28original.getId%28%29%29%3B%0A%C2%A0+++++++clone.setN%28original.getN%28%29%29%3B%0A%C2%A0+++++++clone.setColumnList%28original.getColumnList%28%29%29%3B%0A%C2%A0+++++++clone.setRowList%28original.getRowList%28%29%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+original.getQueenList%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+clonedQueenList+%3D+new+ArrayList%3CQueen%3E%28queenList.size%28%29%29%3B%0A%C2%A0+++++++for+%28Queen+originalQueen+%3A+queenList%29+%7B%0A%C2%A0+++++++++++Queen+cloneQueen+%3D+new+Queen%28%29%3B%0A%C2%A0+++++++++++ledger.registerClone%28originalQueen%2C+cloneQueen%29%3B%0A%C2%A0+++++++++++cloneQueen.setId%28originalQueen.getId%28%29%29%3B%0A%C2%A0+++++++++++cloneQueen.setColumn%28originalQueen.getColumn%28%29%29%3B%0A%C2%A0+++++++++++cloneQueen.setRow%28originalQueen.getRow%28%29%29%3B%0A%C2%A0+++++++++++clonedQueenList.add%28cloneQueen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++clone.setQueenList%28clonedQueenList%29%3B%0A%C2%A0+++++++clone.setScore%28original.getScore%28%29%29%3B%0A%C2%A0+++++++return+clone%3B%0A%C2%A0+++%7D%0A%7D%0AThe+cloneSolution%28%29+method+should+only+deep+clone+the+planning+entities.+Notice+that+the+problem%0Afacts%2C+such+as+Column+and+Row+are+normally+not+cloned%3A+even+their+List+instances+are+not+cloned.+If+the%0Aproblem+facts+were+cloned+too%2C+then+you+would+have+to+make+sure+that+the+new+planning+entity%0Aclones+also+refer+to+the+new+problem+facts+clones+used+by+the+cloned+solution.+For+example%2C+if+you%0A112%0Awere+to+clone+all+Row+instances%2C+then+each+Queen+clone+and+the+NQueens+clone+itself+should+refer+to%0Athose+new+Row+clones.%0ACloning+an+entity+with+a+chained+variable+is+devious%3A+a+variable+of+an+entity+A%0A%EF%81%B1+might+point+to+another+entity+B.+If+A+is+cloned%2C+then+its+variable+must+point+to+the%0Aclone+of+B%2C+not+the+original+B.%0A4.3.6.8.+Create+an+Uninitialized+Solution%0ACreate+a+Solution+instance+to+represent+your+planning+problem%E2%80%99s+dataset%2C+so+it+can+be+set+on+the%0ASolver+as+the+planning+problem+to+solve.+For+example+in+n+queens%2C+an+NQueens+instance+is+created%0Awith+the+required+Column+and+Row+instances+and+every+Queen+set+to+a+different+column+and+every+row%0Aset+to+null.%0A%C2%A0+++private+NQueens+createNQueens%28int+n%29+%7B%0A%C2%A0+++++++NQueens+nQueens+%3D+new+NQueens%28%29%3B%0A%C2%A0+++++++nQueens.setId%280L%29%3B%0A%C2%A0+++++++nQueens.setN%28n%29%3B%0A%C2%A0+++++++nQueens.setColumnList%28createColumnList%28nQueens%29%29%3B%0A%C2%A0+++++++nQueens.setRowList%28createRowList%28nQueens%29%29%3B%0A%C2%A0+++++++nQueens.setQueenList%28createQueenList%28nQueens%29%29%3B%0A%C2%A0+++++++return+nQueens%3B%0A%C2%A0+++%7D%0A%C2%A0+++private+List%3CQueen%3E+createQueenList%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+new+ArrayList%3CQueen%3E%28n%29%3B%0A%C2%A0+++++++long+id+%3D+0L%3B%0A%C2%A0+++++++for+%28Column+column+%3A+nQueens.getColumnList%28%29%29+%7B%0A%C2%A0+++++++++++Queen+queen+%3D+new+Queen%28%29%3B%0A%C2%A0+++++++++++queen.setId%28id%29%3B%0A%C2%A0+++++++++++id%2B%2B%3B%0A%C2%A0+++++++++++queen.setColumn%28column%29%3B%0A%C2%A0+++++++++++%2F%2F+Notice+that+we+leave+the+PlanningVariable+properties+on+null%0A%C2%A0+++++++++++queenList.add%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+queenList%3B%0A%C2%A0+++%7D%0AFigure+4.+Uninitialized+Solution+for+the+Four+Queens+Puzzle%0A113%0AUsually%2C+most+of+this+data+comes+from+your+data+layer%2C+and+your+Solution+implementation+just%0Aaggregates+that+data+and+creates+the+uninitialized+planning+entity+instances+to+plan%3A%0A%C2%A0+++++++private+void+createLectureList%28CourseSchedule+schedule%29+%7B%0A%C2%A0+++++++++++List%3CCourse%3E+courseList+%3D+schedule.getCourseList%28%29%3B%0A%C2%A0+++++++++++List%3CLecture%3E+lectureList+%3D+new+ArrayList%3CLecture%3E%28courseList.size%28%29%29%3B%0A%C2%A0+++++++++++long+id+%3D+0L%3B%0A%C2%A0+++++++++++for+%28Course+course+%3A+courseList%29+%7B%0A%C2%A0+++++++++++++++for+%28int+i+%3D+0%3B+i+%3C+course.getLectureSize%28%29%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++++++++++Lecture+lecture+%3D+new+Lecture%28%29%3B%0A%C2%A0+++++++++++++++++++lecture.setId%28id%29%3B%0A%C2%A0+++++++++++++++++++id%2B%2B%3B%0A%C2%A0+++++++++++++++++++lecture.setCourse%28course%29%3B%0A%C2%A0+++++++++++++++++++lecture.setLectureIndexInCourse%28i%29%3B%0A%C2%A0+++++++++++++++++++%2F%2F+Notice+that+we+leave+the+PlanningVariable+properties+%28period%0Aand+room%29+on+null%0A%C2%A0+++++++++++++++++++lectureList.add%28lecture%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++schedule.setLectureList%28lectureList%29%3B%0A%C2%A0+++++++%7D%0A4.4.+Use+the+Solver%0A4.4.1.+The+Solver+Interface%0AA+Solver+implementation+will+solve+your+planning+problem.%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++Solution_+solve%28Solution_+problem%29%3B%0A%C2%A0+++...%0A%7D%0AA+Solver+can+only+solve+one+planning+problem+instance+at+a+time.+A+Solver+should+only+be+accessed%0Afrom+a+single+thread%2C+except+for+the+methods+that+are+specifically+javadocced+as+being+thread-safe.+It%0Ais+built+with+a+SolverFactory%2C+there+is+no+need+to+implement+it+yourself.%0A4.4.2.+Solving+a+Problem%0ASolving+a+problem+is+quite+easy+once+you+have%3A%0A%E2%80%A2+A+Solver+built+from+a+solver+configuration%0A%E2%80%A2+A+Solution+that+represents+the+planning+problem+instance%0AJust+provide+the+planning+problem+as+argument+to+the+solve%28%29+method+and+it+will+return+the+best%0A114%0Asolution+found%3A%0A%C2%A0+++NQueens+bestSolution+%3D+solver.solve%28problem%29%3B%0AFor+example+in+n+queens%2C+the+solve%28%29+method+will+return+an+NQueens+instance+with+every+Queen%0Aassigned+to+a+Row.%0AFigure+5.+Best+Solution+for+the+Four+Queens+Puzzle+in+8ms+%28Also+an+Optimal+Solution%29%0AThe+solve%28Solution%29+method+can+take+a+long+time+%28depending+on+the+problem+size+and+the+solver%0Aconfiguration%29.+The+Solver+intelligently+wades+through+the+search+space+of+possible+solutions+and%0Aremembers+the+best+solution+it+encounters+during+solving.+Depending+on+a+number+of+factors%0A%28including+problem+size%2C+how+much+time+the+Solver+has%2C+the+solver+configuration%2C+%E2%80%A6%29%2C+that+best%0Asolution+might+or+might+not+be+an+optimal+solution.%0AThe+Solution+instance+given+to+the+method+solve%28Solution%29+is+changed+by+the%0ASolver%2C+but+do+not+mistake+it+for+the+best+solution.%0A%EF%81%9A+The+Solution+instance+returned+by+the+methods+solve%28Solution%29+or%0AgetBestSolution%28%29+is+most+likely+a+planning+clone+of+the+instance+given+to+the%0Amethod+solve%28Solution%29%2C+which+implies+it+is+a+different+instance.%0AThe+Solution+instance+given+to+the+solve%28Solution%29+method+does+not+need+to+be%0A%EF%81%9A+uninitialized.+It+can+be+partially+or+fully+initialized%2C+which+is+often+the+case+in%0Arepeated+planning.%0A4.4.3.+Environment+Mode%3A+Are+There+Bugs+in+my+Code%3F%0AThe+environment+mode+allows+you+to+detect+common+bugs+in+your+implementation.+It+does+not%0Aaffect+the+logging+level.%0AYou+can+set+the+environment+mode+in+the+solver+configuration+XML+file%3A%0A%3Csolver%3E%0A%C2%A0+%3CenvironmentMode%3EFAST_ASSERT%3C%2FenvironmentMode%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AA+solver+has+a+single+Random+instance.+Some+solver+configurations+use+the+Random+instance+a+lot+more%0A115%0Athan+others.+For+example%2C+Simulated+Annealing+depends+highly+on+random+numbers%2C+while+Tabu%0ASearch+only+depends+on+it+to+deal+with+score+ties.+The+environment+mode+influences+the+seed+of+that%0ARandom+instance.%0AThese+are+the+environment+modes%3A%0A4.4.3.1.+FULL_ASSERT%0AThe+FULL_ASSERT+mode+turns+on+all+assertions+%28such+as+assert+that+the+incremental+score%0Acalculation+is+uncorrupted+for+each+move%29+to+fail-fast+on+a+bug+in+a+Move+implementation%2C+a+score%0Arule%2C+the+rule+engine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+also+intrusive+because+it+calls+the%0Amethod+calculateScore%28%29+more+frequently+than+a+non-assert+mode.%0AThe+FULL_ASSERT+mode+is+horribly+slow+%28because+it+does+not+rely+on+incremental+score%0Acalculation%29.%0A4.4.3.2.+NON_INTRUSIVE_FULL_ASSERT%0AThe+NON_INTRUSIVE_FULL_ASSERT+turns+on+several+assertions+to+fail-fast+on+a+bug+in+a+Move%0Aimplementation%2C+a+score+rule%2C+the+rule+engine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+non-intrusive+because+it+does+not+call%0Athe+method+calculateScore%28%29+more+frequently+than+a+non+assert+mode.%0AThe+NON_INTRUSIVE_FULL_ASSERT+mode+is+horribly+slow+%28because+it+does+not+rely+on+incremental%0Ascore+calculation%29.%0A4.4.3.3.+FAST_ASSERT%0AThe+FAST_ASSERT+mode+turns+on+most+assertions+%28such+as+assert+that+an+undoMove%E2%80%99s+score+is+the%0Asame+as+before+the+Move%29+to+fail-fast+on+a+bug+in+a+Move+implementation%2C+a+score+rule%2C+the+rule%0Aengine+itself%2C+%E2%80%A6%0AThis+mode+is+reproducible+%28see+the+reproducible+mode%29.+It+is+also+intrusive+because+it+calls+the%0Amethod+calculateScore%28%29+more+frequently+than+a+non+assert+mode.%0AThe+FAST_ASSERT+mode+is+slow.%0AIt+is+recommended+to+write+a+test+case+that+does+a+short+run+of+your+planning+problem+with+the%0AFAST_ASSERT+mode+on.%0A4.4.3.4.+REPRODUCIBLE+%28default%29%0AThe+reproducible+mode+is+the+default+mode+because+it+is+recommended+during+development.+In+this%0Amode%2C+two+runs+in+the+same+Planner+version+will+execute+the+same+code+in+the+same+order.+Those%0Atwo+runs+will+have+the+same+result+at+every+step%2C+except+if+the+note+below+applies.+This+enables%0Ayou+to+reproduce+bugs+consistently.+It+also+allows+you+to+benchmark+certain+refactorings+%28such+as+a%0Ascore+constraint+performance+optimization%29+fairly+across+runs.%0A116%0ADespite+the+reproducible+mode%2C+your+application+might+still+not+be+fully%0Areproducible+because+of%3A%0A%E2%80%A2+Use+of+HashSet+%28or+another+Collection+which+has+an+inconsistent+order+between%0AJVM+runs%29+for+collections+of+planning+entities+or+planning+values+%28but+not%0Anormal+problem+facts%29%2C+especially+in+the+Solution+implementation.+Replace+it%0A%EF%81%9A+with+LinkedHashSet.%0A%E2%80%A2+Combining+a+time+gradient+dependent+algorithms+%28most+notably+Simulated%0AAnnealing%29+together+with+time+spent+termination.+A+sufficiently+large%0Adifference+in+allocated+CPU+time+will+influence+the+time+gradient+values.%0AReplace+Simulated+Annealing+with+Late+Acceptance.+Or+instead%2C+replace+time%0Aspent+termination+with+step+count+termination.%0AThe+reproducible+mode+can+be+slightly+slower+than+the+non-reproducible+mode.+If+your+production%0Aenvironment+can+benefit+from+reproducibility%2C+use+this+mode+in+production.%0AIn+practice%2C+this+mode+uses+the+default%2C+fixed+random+seed+if+no+seed+is+specified%2C+and+it+also+disables%0Acertain+concurrency+optimizations+%28such+as+work+stealing%29.%0A4.4.3.5.+NON_REPRODUCIBLE%0AThe+non-reproducible+mode+can+be+slightly+faster+than+the+reproducible+mode.+Avoid+using+it%0Aduring+development+as+it+makes+debugging+and+bug+fixing+painful.+If+your+production+environment%0Adoesn%E2%80%99t+care+about+reproducibility%2C+use+this+mode+in+production.%0AIn+practice%2C+this+mode+uses+no+fixed+random+seed+if+no+seed+is+specified.%0A4.4.4.+Logging+Level%3A+What+is+the+Solver+Doing%3F%0AThe+best+way+to+illuminate+the+black+box+that+is+a+Solver%2C+is+to+play+with+the+logging+level%3A%0A%E2%80%A2+error%3A+Log+errors%2C+except+those+that+are+thrown+to+the+calling+code+as+a+RuntimeException.%0AIf+an+error+happens%2C+Planner+normally+fails+fast%3A+it+throws+a+subclass+of%0ARuntimeException+with+a+detailed+message+to+the+calling+code.+It+does+not+log+it%0Aas+an+error+itself+to+avoid+duplicate+log+messages.+Except+if+the+calling+code%0A%EF%81%9A+explicitly+catches+and+eats+that+RuntimeException%2C+a+Thread%27s+default%0AExceptionHandler+will+log+it+as+an+error+anyway.+Meanwhile%2C+the+code+is%0Adisrupted+from+doing+further+harm+or+obfuscating+the+error.%0A%E2%80%A2+warn%3A+Log+suspicious+circumstances.%0A%E2%80%A2+info%3A+Log+every+phase+and+the+solver+itself.+See+scope+overview.%0A%E2%80%A2+debug%3A+Log+every+step+of+every+phase.+See+scope+overview.%0A%E2%80%A2+trace%3A+Log+every+move+of+every+step+of+every+phase.+See+scope+overview.%0A117%0ATurning+on+trace+logging%2C+will+slow+down+performance+considerably%3A+it+is+often%0Afour+times+slower.+However%2C+it+is+invaluable+during+development+to+discover+a%0Abottleneck.%0AEven+debug+logging+can+slow+down+performance+considerably+for+fast+stepping%0Aalgorithms+%28such+as+Late+Acceptance+and+Simulated+Annealing%29%2C+but+not+for+slow%0A%EF%81%9A+stepping+algorithms+%28such+as+Tabu+Search%29.%0ABoth+cause+congestion+in+multithreaded+solving+with+most+appenders%2C+see+below.%0AIn+Eclipse%2C+debug+logging+to+the+console+tends+to+cause+congestion+with+a+score%0Acalculation+speeds+above+10+000+per+second.+Nor+IntelliJ%2C+nor+the+Maven+command%0Aline+suffer+from+this+problem.%0AFor+example%2C+set+it+to+debug+logging%2C+to+see+when+the+phases+end+and+how+fast+steps+are+taken%3A%0AINFO++Solving+started%3A+time+spent+%283%29%2C+best+score+%28-4init%2F0%29%2C+random+%28JDK+with+seed%0A0%29.%0ADEBUG+++++CH+step+%280%29%2C+time+spent+%285%29%2C+score+%28-3init%2F0%29%2C+selected+move+count+%281%29%2C%0Apicked+move+%28Queen-2+%7Bnull+-%3E+Row-0%7D%29.%0ADEBUG+++++CH+step+%281%29%2C+time+spent+%287%29%2C+score+%28-2init%2F0%29%2C+selected+move+count+%283%29%2C%0Apicked+move+%28Queen-1+%7Bnull+-%3E+Row-2%7D%29.%0ADEBUG+++++CH+step+%282%29%2C+time+spent+%2810%29%2C+score+%28-1init%2F0%29%2C+selected+move+count+%284%29%2C%0Apicked+move+%28Queen-3+%7Bnull+-%3E+Row-3%7D%29.%0ADEBUG+++++CH+step+%283%29%2C+time+spent+%2812%29%2C+score+%28-1%29%2C+selected+move+count+%284%29%2C+picked%0Amove+%28Queen-0+%7Bnull+-%3E+Row-1%7D%29.%0AINFO++Construction+Heuristic+phase+%280%29+ended%3A+time+spent+%2812%29%2C+best+score+%28-1%29%2C+score%0Acalculation+speed+%289000%2Fsec%29%2C+step+total+%284%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%2819%29%2C+score+%28-1%29%2C+++++best+score+%28-1%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-2+-%3E+Row-3%7D%29.%0ADEBUG+++++LS+step+%281%29%2C+time+spent+%2824%29%2C+score+%280%29%2C+new+best+score+%280%29%2C%0Aaccepted%2Fselected+move+count+%289%2F12%29%2C+picked+move+%28Queen-3+%7BRow-3+-%3E+Row-2%7D%29.%0AINFO++Local+Search+phase+%281%29+ended%3A+time+spent+%2824%29%2C+best+score+%280%29%2C+score+calculation%0Aspeed+%284000%2Fsec%29%2C+step+total+%282%29.%0AINFO++Solving+ended%3A+time+spent+%2824%29%2C+best+score+%280%29%2C+score+calculation+speed%0A%287000%2Fsec%29%2C+phase+total+%282%29%2C+environment+mode+%28REPRODUCIBLE%29.%0AAll+time+spent+values+are+in+milliseconds.%0AEverything+is+logged+to+SLF4J%2C+which+is+a+simple+logging+facade+which+delegates+every+log+message%0Ato+Logback%2C+Apache+Commons+Logging%2C+Log4j+or+java.util.logging.+Add+a+dependency+to+the+logging%0Aadaptor+for+your+logging+framework+of+choice.%0AIf+you+are+not+using+any+logging+framework+yet%2C+use+Logback+by+adding+this+Maven+dependency%0A%28there+is+no+need+to+add+an+extra+bridge+dependency%29%3A%0A118%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Ech.qos.logback%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Elogback-classic%3C%2FartifactId%3E%0A%C2%A0+++++%3Cversion%3E1.x%3C%2Fversion%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AConfigure+the+logging+level+on+the+org.optaplanner+package+in+your+logback.xml+file%3A%0A%3Cconfiguration%3E%0A%C2%A0+%3Clogger+name%3D%22org.optaplanner%22+level%3D%22debug%22%2F%3E%0A%C2%A0+...%0A%3C%2Fconfiguration%3E%0AIf+it+isn%E2%80%99t+picked+up%2C+temporarily+add+the+system+property+-Dlogback.debug%3Dtrue+to+figure+out+why.%0AWhen+running+multiple+solvers+or+one+multithreaded+solver%2C+most+appenders%0A%EF%81%9A+%28including+the+console%29+cause+congestion+with+debug+and+trace+logging.+Switch+to+an%0Aasync+appender+to+avoid+this+problem+or+turn+off+debug+logging.%0AIf+instead%2C+you+are+still+using+Log4J+1.x+%28and+you+do+not+want+to+switch+to+its+faster+successor%2C%0ALogback%29%2C+add+the+bridge+dependency%3A%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.slf4j%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eslf4j-log4j12%3C%2FartifactId%3E%0A%C2%A0+++++%3Cversion%3E1.x%3C%2Fversion%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AAnd+configure+the+logging+level+on+the+package+org.optaplanner+in+your+log4j.xml+file%3A%0A%3Clog4j%3Aconfiguration+xmlns%3Alog4j%3D%22http%3A%2F%2Fjakarta.apache.org%2Flog4j%2F%22%3E%0A%C2%A0+%3Ccategory+name%3D%22org.optaplanner%22%3E%0A%C2%A0+++%3Cpriority+value%3D%22debug%22+%2F%3E%0A%C2%A0+%3C%2Fcategory%3E%0A%C2%A0+...%0A%3C%2Flog4j%3Aconfiguration%3E%0A119%0AIn+a+multitenant+application%2C+multiple+Solver+instances+might+be+running+at+the%0Asame+time.+To+separate+their+logging+into+distinct+files%2C+surround+the+solve%28%29+call%0Awith+an+MDC%3A%0A%C2%A0+++++++MDC.put%28%22tenant.name%22%2CtenantName%29%3B%0A%C2%A0+++++++MySolution+bestSolution+%3D+solver.solve%28problem%29%3B%0A%C2%A0+++++++MDC.remove%28%22tenant.name%22%29%3B%0AThen+configure+your+logger+to+use+different+files+for+each+%24%7Btenant.name%7D.+For%0Aexample+in+Logback%2C+use+a+SiftingAppender+in+logback.xml%3A%0A%EF%81%9A+%C2%A0+%3Cappender+name%3D%22fileAppender%22+class%3D%22ch.qos.logback.classic.sift.SiftingAppender%22%3E%0A%C2%A0+++%3Cdiscriminator%3E%0A%C2%A0+++++%3Ckey%3Etenant.name%3C%2Fkey%3E%0A%C2%A0+++++%3CdefaultValue%3Eunknown%3C%2FdefaultValue%3E%0A%C2%A0+++%3C%2Fdiscriminator%3E%0A%C2%A0+++%3Csift%3E%0A%C2%A0+++++%3Cappender+name%3D%22fileAppender.%24%7Btenant.name%7D%22+class%3D%0A%22...FileAppender%22%3E%0A%C2%A0+++++++%3Cfile%3Elocal%2Flog%2Foptaplanner-%24%7Btenant.name%7D.log%3C%2Ffile%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2Fappender%3E%0A%C2%A0+++%3C%2Fsift%3E%0A%C2%A0+%3C%2Fappender%3E%0A4.4.5.+Random+Number+Generator%0AMany+heuristics+and+metaheuristics+depend+on+a+pseudorandom+number+generator+for+move%0Aselection%2C+to+resolve+score+ties%2C+probability+based+move+acceptance%2C+%E2%80%A6+During+solving%2C+the+same%0ARandom+instance+is+reused+to+improve+reproducibility%2C+performance+and+uniform+distribution+of%0Arandom+values.%0ATo+change+the+random+seed+of+that+Random+instance%2C+specify+a+randomSeed%3A%0A%3Csolver%3E%0A%C2%A0+%3CrandomSeed%3E0%3C%2FrandomSeed%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ATo+change+the+pseudorandom+number+generator+implementation%2C+specify+a+randomType%3A%0A120%0A%3Csolver%3E%0A%C2%A0+%3CrandomType%3EMERSENNE_TWISTER%3C%2FrandomType%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThe+following+types+are+supported%3A%0A%E2%80%A2+JDK+%28default%29%3A+Standard+implementation+%28java.util.Random%29.%0A%E2%80%A2+MERSENNE_TWISTER%3A+Implementation+by+Commons+Math.%0A%E2%80%A2+WELL512A%2C+WELL1024A%2C+WELL19937A%2C+WELL19937C%2C+WELL44497A+and+WELL44497B%3A+Implementation+by%0ACommons+Math.%0AFor+most+use+cases%2C+the+randomType+has+no+significant+impact+on+the+average+quality+of+the+best%0Asolution+on+multiple+datasets.+If+you+want+to+confirm+this+on+your+use+case%2C+use+the+benchmarker.%0A121%0AChapter+5.+Score+Calculation%0A5.1.+Score+Terminology%0A5.1.1.+What+is+a+Score%3F%0AEvery+Solution+has+a+score.+The+score+is+an+objective+way+to+compare+two+solutions.+The+solution%0Awith+the+higher+score+is+better.+The+Solver+aims+to+find+the+Solution+with+the+highest+Score+of+all%0Apossible+solutions.+The+best+solution+is+the+Solution+with+the+highest+Score+that+Solver+has%0Aencountered+during+solving%2C+which+might+be+the+optimal+solution.%0APlanner+cannot+automatically+know+which+Solution+is+best+for+your+business%2C+so+you+need+to+tell+it%0Ahow+to+calculate+the+score+of+a+given+Solution+according+to+your+business+needs.+If+you+forget+or+are%0Aunable+to+implement+an+important+business+constraint%2C+the+solution+is+probably+useless%3A%0A5.1.2.+Formalize+the+Business+Constraints%0ATo+implement+a+verbal+business+constraint%2C+it+needs+to+be+formalized+as+a+score+constraint.+Luckily%2C%0Adefining+constraints+in+Planner+is+very+flexible+through+the+following+score+techniques%3A%0A%E2%80%A2+Score+signum+%28positive+or+negative%29%3A+maximize+or+minimize+a+constraint+type%0A%E2%80%A2+Score+weight%3A+put+a+cost%2Fprofit+on+a+constraint+type%0A122%0A%E2%80%A2+Score+level+%28hard%2C+soft%2C+%E2%80%A6%29%3A+prioritize+a+group+of+constraint+types%0A%E2%80%A2+Pareto+scoring+%28rarely+used%29%0ATake+the+time+to+acquaint+yourself+with+the+first+three+techniques.+Once+you+understand+them%2C%0Aformalizing+most+business+constraints+becomes+straightforward.%0A5.1.3.+Score+Constraint+Signum+%28Positive+or+Negative%29%0AAll+score+techniques+are+based+on+constraints.+A+constraint+can+be+a+simple+pattern+%28such+as%0AMaximize+the+apple+harvest+in+the+solution%29+or+a+more+complex+pattern.+A+positive+constraint+is+a%0Aconstraint+you+want+to+maximize.+A+negative+constraint+is+a+constraint+you+want+to+minimize.%0AThe+image+above+illustrates+that+the+optimal+solution+always+has+the+highest+score%2C+regardless+if%0Athe+constraints+are+positive+or+negative.%0AMost+planning+problems+have+only+negative+constraints+and+therefore+have+a+negative+score.+In+that%0Acase%2C+the+score+is+the+sum+of+the+weight+of+the+negative+constraints+being+broken%2C+with+a+perfect%0Ascore+of+0.+This+explains+why+the+score+of+a+solution+of+four+queens+is+the+negative+of+the+number+of%0Aqueen+pairs+which+can+attack+each+other.%0ANegative+and+positive+constraints+can+be+combined%2C+even+in+the+same+score+level.%0A123%0ADo+not+presume+that+your+business+knows+all+its+score+constraints+in+advance.%0A%EF%81%9A+Expect+score+constraints+to+be+added+or+changed+after+the+first+releases.%0AWhen+a+constraint+activates+%28because+the+negative+constraint+is+broken+or+the+positive+constraint+is%0Afulfilled%29+on+a+certain+planning+entity+set%2C+it+is+called+a+constraint+match.%0A5.1.4.+Score+Constraint+Weight%0ANot+all+score+constraints+are+equally+important.+If+breaking+one+constraint+is+equally+bad+as%0Abreaking+another+constraint+x+times%2C+then+those+two+constraints+have+a+different+weight+%28but+they%0Aare+in+the+same+score+level%29.+For+example+in+vehicle+routing%2C+you+can+make+one+%22unhappy+driver%22%0Aconstraint+match+count+as+much+as+two+%22fuel+tank+usage%22+constraint+matches%3A%0AScore+weighting+is+easy+in+use+cases+where+you+can+put+a+price+tag+on+everything.+In+that+case%2C+the%0Apositive+constraints+maximize+revenue+and+the+negative+constraints+minimize+expenses%2C+so+together%0Athey+maximize+profit.+Alternatively%2C+score+weighting+is+also+often+used+to+create+social+fairness.+For%0Aexample%2C+a+nurse%2C+who+requests+a+free+day%2C+pays+a+higher+weight+on+New+Years+eve+than+on+a+normal%0Aday.%0AThe+weight+of+a+constraint+match+can+be+dynamically+based+on+the+planning+entities+involved.+For%0Aexample+in+cloud+balance%2C+the+weight+of+the+soft+constraint+match+for+an+active+Computer+is+the+cost%0Aof+that+Computer+%28which+differs+per+computer%29.%0APutting+a+good+weight+on+a+constraint+can+be+a+difficult+analytical+decision%2C+because+it+is+about%0A124%0Amaking+choices+and+tradeoffs+with+other+constraints.+Don%E2%80%99t+spend+too+much+time+on+it+at+the+start+of%0Aan+implementation.+A+non-accurate+weight+is+less+damaging+than+mediocre+algorithms%3A%0AWhen+deciding+the+weights+of+some+constraints+is+debatable%2C+it%E2%80%99s+recommended+to%0Amake+them+configurable+at+runtime%2C+as+demonstrated+in+the+exam+timetabling%0A%EF%81%9A+example+with+the+InstitutionParametrization+class.+This+allow+the+end-user+to%0Arecalibrate+constraint+weights+in+the+user+interface+and+immediately+discover+the%0Aimpact+of+the+new+weights+by+running+the+solver+again.%0AMost+use+cases+use+a+Score+with+int+weights%2C+such+as+HardSoftScore.%0A5.1.5.+Score+Constraint+Level+%28hard%2C+soft%2C+%E2%80%A6%29%0ASometimes+a+score+constraint+outranks+another+score+constraint%2C+no+matter+how+many+times+the%0Aother+is+broken.+In+that+case%2C+those+score+constraints+are+in+different+levels.+For+example%2C+a+nurse%0Acannot+do+two+shifts+at+the+same+time+%28due+to+the+constraints+of+physical+reality%29%2C+this+outranks+all%0Anurse+happiness+constraints.%0AMost+use+cases+have+only+two+score+levels%2C+hard+and+soft.+The+levels+of+two+scores+are+compared%0Alexicographically.+The+first+score+level+gets+compared+first.+If+those+differ%2C+the+remaining+score+levels%0Aare+ignored.+For+example%2C+a+score+that+breaks+0+hard+constraints+and+1000000+soft+constraints+is%0Abetter+than+a+score+that+breaks+1+hard+constraint+and+0+soft+constraints.%0A125%0AIf+there+are+two+%28or+more%29+score+levels%2C+for+example+a+hard+and+soft+level%2C+then+a+score+is+feasible+if%0Ano+hard+constraints+are+broken.%0ABy+default%2C+Planner+will+always+assign+all+planning+variables+a+planning+value.+If%0Athere+is+no+feasible+solution%2C+this+means+the+best+solution+will+be+infeasible.+To%0A%EF%81%9A+instead+leave+some+of+the+planning+entities+unassigned%2C+apply+overconstrained%0Aplanning.%0AFor+each+constraint%2C+you+need+to+pick+a+score+level%2C+a+score+weight+and+a+score+signum.+For+example%3A%0A-1soft+which+has+score+level+of+soft%2C+a+weight+of+1+and+a+negative+signum.+Do+not+use+a+big%0Aconstraint+weight+when+your+business+actually+wants+different+score+levels.+That+hack%2C+known+as%0Ascore+folding%2C+is+broken%3A%0A126%0AYour+business+might+tell+you+that+your+hard+constraints+all+have+the+same+weight%2C%0Abecause+they+cannot+be+broken+%28so+the+weight+does+not+matter%29.+This+is+not+true%0Abecause+if+no+feasible+solution+exists+for+a+specific+dataset%2C+the+least+infeasible%0Asolution+allows+the+business+to+estimate+how+many+business+resources+they+are%0A%EF%81%9A+lacking.+For+example+in+cloud+balancing%2C+how+many+new+computers+to+buy.%0AFurthermore%2C+it+will+likely+create+a+score+trap.+For+example+in+cloud+balance+if+a%0AComputer+has+seven+CPU+too+little+for+its+Processes%2C+then+it+must+be+weighted+seven%0Atimes+as+much+as+if+it+had+only+one+CPU+too+little.%0AThree+or+more+score+levels+are+supported.+For+example%3A+a+company+might+decide+that+profit%0Aoutranks+employee+satisfaction+%28or+vice+versa%29%2C+while+both+are+outranked+by+the+constraints+of%0Aphysical+reality.%0ATo+model+fairness+or+load+balancing%2C+there+is+no+need+to+use+lots+of+score+levels%0A%EF%81%9A+%28even+though+Planner+can+handle+many+score+levels%29.%0AMost+use+cases+use+a+Score+with+two+weights%2C+such+as+HardSoftScore.%0A5.1.6.+Pareto+Scoring+%28AKA+Multi-objective+Optimization+Scoring%29%0AFar+less+common+is+the+use+case+of+pareto+optimization%2C+which+is+also+known+under+the+more%0Aconfusing+term+multi-objective+optimization.+In+pareto+scoring%2C+score+constraints+are+in+the+same%0A127%0Ascore+level%2C+yet+they+are+not+weighted+against+each+other.+When+two+scores+are+compared%2C+each+of%0Athe+score+constraints+are+compared+individually+and+the+score+with+the+most+dominating+score%0Aconstraints+wins.+Pareto+scoring+can+even+be+combined+with+score+levels+and+score+constraint%0Aweighting.%0AConsider+this+example+with+positive+constraints%2C+where+we+want+to+get+the+most+apples+and+oranges.%0ASince+it+is+impossible+to+compare+apples+and+oranges%2C+we+can+not+weight+them+against+each+other.%0AYet%2C+despite+that+we+can+not+compare+them%2C+we+can+state+that+two+apples+are+better+then+one+apple.%0ASimilarly%2C+we+can+state+that+two+apples+and+one+orange+are+better+than+just+one+orange.+So+despite%0Aour+inability+to+compare+some+Scores+conclusively+%28at+which+point+we+declare+them+equal%29%2C+we+can%0Afind+a+set+of+optimal+scores.+Those+are+called+pareto+optimal.%0AScores+are+considered+equal+far+more+often.+It+is+left+up+to+a+human+to+choose+the+better+out+of+a+set%0Aof+best+solutions+%28with+equal+scores%29+found+by+Planner.+In+the+example+above%2C+the+user+must+choose%0Abetween+solution+A+%28three+apples+and+one+orange%29+and+solution+B+%28one+apple+and+six+oranges%29.+It+is%0Aguaranteed+that+Planner+has+not+found+another+solution+which+has+more+apples+or+more+oranges+or%0Aeven+a+better+combination+of+both+%28such+as+two+apples+and+three+oranges%29.%0ATo+implement+pareto+scoring+in+Planner%2C+implement+a+custom+ScoreDefinition+and+Score+%28and%0Areplace+the+BestSolutionRecaller%29.+Future+versions+will+provide+out-of-the-box+support.%0A128%0AA+pareto+Score%27s+compareTo+method+is+not+transitive+because+it+does+a+pareto%0Acomparison.+For+example%3A+having+two+apples+is+greater+than+one+apple.+One+apple%0Ais+equal+to+One+orange.+Yet%2C+two+apples+are+not+greater+than+one+orange+%28but%0A%EF%81%9A+actually+equal%29.+Pareto+comparison+violates+the+contract+of+the+interface%0Ajava.lang.Comparable%27s+compareTo+method%2C+but+Planners+systems+are+pareto%0Acomparison+safe%2C+unless+explicitly+stated+otherwise+in+this+documentation.%0A5.1.7.+Combining+Score+Techniques%0AAll+the+score+techniques+mentioned+above%2C+can+be+combined+seamlessly%3A%0A5.1.8.+Score+interface%0AA+score+is+represented+by+the+Score+interface%2C+which+naturally+extends+Comparable%3A%0Apublic+interface+Score%3C...%3E+extends+Comparable%3C...%3E+%7B%0A%C2%A0+++...%0A%7D%0AThe+Score+implementation+to+use+depends+on+your+use+case.+Your+score+might+not+efficiently+fit+in+a%0Asingle+long+value.+Planner+has+several+built-in+Score+implementations%2C+but+you+can+implement+a%0Acustom+Score+too.+Most+use+cases+tend+to+use+the+built-in+HardSoftScore.%0A129%0AAll+Score+implementations+also+have+an+initScore+%28which+is+an+int%29.+It+is+mostly+intended+for%0Ainternal+use+in+Planner%3A+it+is+the+negative+number+of+uninitialized+planning+variables.+From+a+user%E2%80%99s%0Aperspective+this+is+0%2C+unless+a+Construction+Heuristic+is+terminated+before+it+could+initialize+all%0Aplanning+variables+%28in+which+case+Score.isSolutionInitialized%28%29+returns+false%29.%0AThe+Score+implementation+%28for+example+HardSoftScore%29+must+be+the+same+throughout+a+Solver%0Aruntime.+The+Score+implementation+is+configured+in+the+solution+domain+class%3A%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%7D%0A5.1.9.+Avoid+Floating+Point+Numbers+in+Score+Calculation%0AAvoid+the+use+of+float+or+double+in+score+calculation.+Use+BigDecimal+or+scaled+long+instead.%0AFloating+point+numbers+%28float+and+double%29+cannot+represent+a+decimal+number+correctly.+For%0Aexample%3A+a+double+cannot+hold+the+value+0.05+correctly.+Instead%2C+it+holds+the+nearest+representable%0A130%0Avalue.+Arithmetic+%28including+addition+and+subtraction%29+with+floating+point+numbers%2C+especially+for%0Aplanning+problems%2C+leads+to+incorrect+decisions%3A%0AAdditionally%2C+floating+point+number+addition+is+not+associative%3A%0ASystem.out.println%28+%28%280.01+%2B+0.02%29+%2B+0.03%29+%3D%3D+%280.01+%2B+%280.02+%2B+0.03%29%29+%29%3B+%2F%2F+returns%0Afalse%0AThis+leads+to+score+corruption.%0ADecimal+numbers+%28BigDecimal%29+have+none+of+these+problems.%0ABigDecimal+arithmetic+is+considerably+slower+than+int%2C+long+or+double+arithmetic.%0AIn+experiments+we+have+seen+the+score+calculation+take+five+times+longer.%0A%EF%81%9A+Therefore%2C+in+many+cases%2C+it+can+be+worthwhile+to+multiply+all+numbers+for+a+single%0Ascore+weight+by+a+plural+of+ten%2C+so+the+score+weight+fits+in+a+scaled+int+or+long.+For%0Aexample%2C+if+we+multiply+all+weights+by+1000%2C+a+fuelCost+of+0.07+becomes+a%0AfuelCostMillis+of+70+and+no+longer+uses+a+decimal+score+weight.%0A131%0A5.2.+Choose+a+Score+Type%0ADepending+on+the+number+of+score+levels+and+type+of+score+weights+you+need%2C+choose+a+Score+type.%0AMost+use+cases+use+a+HardSoftScore.%0ATo+properly+write+a+Score+to+a+database+%28with+JPA%2FHibernate%29+or+to+XML%2FJSON+%28with%0A%EF%81%9A+XStream%2FJAXB%2FJackson%29%2C+see+the+integration+chapter.%0A5.2.1.+SimpleScore%0AA+SimpleScore+has+a+single+int+value%2C+for+example+-123.+It+has+a+single+score+level.%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+SimpleScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+SimpleLongScore+uses+a+long+value+instead+of+an+int+value.%0A%E2%80%A2+SimpleDoubleScore+uses+a+double+value+instead+of+an+int+value.+Not+recommended+to+use.%0A%E2%80%A2+SimpleBigDecimalScore+uses+a+BigDecimal+value+instead+of+an+int+value.%0A5.2.2.+HardSoftScore+%28Recommended%29%0AA+HardSoftScore+has+a+hard+int+value+and+a+soft+int+value%2C+for+example+-123hard%2F-456soft.+It+has+two%0Ascore+levels+%28hard+and+soft%29.%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+HardSoftLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+HardSoftDoubleScore+uses+double+values+instead+of+int+values.+Not+recommended+to+use.%0A%E2%80%A2+HardSoftBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.3.+HardMediumSoftScore%0AA+HardMediumSoftScore+which+has+a+hard+int+value%2C+a+medium+int+value+and+a+soft+int+value%2C+for%0Aexample+-123hard%2F-456medium%2F-789soft.+It+has+three+score+levels+%28hard%2C+medium+and+soft%29.+The+hard%0Alevel+determines+if+the+solution+is+feasible%2C+and+the+medium+level+and+soft+level+score+values%0Adetermine+how+well+the+solution+meets+business+goals.+Higher+medium+values+take+precedence+over%0Asoft+values+irrespective+of+the+soft+value.%0A132%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardMediumSoftScore+score%3B%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+HardMediumSoftLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+HardMediumSoftBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.4.+BendableScore%0AA+BendableScore+has+a+configurable+number+of+score+levels.+It+has+an+array+of+hard+int+values+and+an%0Aarray+of+soft+int+values%2C+for+example+with+two+hard+levels+and+three+soft+levels%2C+the+score+can+be+%5B-%0A123%2F-456%5Dhard%2F%5B-789%2F-012%2F-345%5Dsoft.+In+that+case%2C+it+has+five+score+levels.+A+solution+is+feasible+if+all%0Ahard+levels+are+at+least+zero.%0AA+BendableScore+with+one+hard+level+and+one+soft+level+is+equivalent+to+a+HardSoftScore%2C+while+a%0ABendableScore+with+one+hard+level+and+two+soft+levels+is+equivalent+to+a+HardMediumSoftScore.%0A%C2%A0+++%40PlanningScore%28bendableHardLevelsSize+%3D+2%2C+bendableSoftLevelsSize+%3D+3%29%0A%C2%A0+++private+BendableScore+score%3B%0AThe+number+of+hard+and+soft+score+levels+need+to+be+set+at+compilation+time.+It+is+not+flexible+to%0Achange+during+solving.%0ADo+not+use+a+BendableScore+with+seven+levels+just+because+you+have+seven%0Aconstraints.+It+is+extremely+rare+to+use+a+different+score+level+for+each+constraint%2C%0Abecause+that+means+one+constraint+match+on+soft+0+outweighs+even+a+million%0A%EF%81%9A+constraint+matches+of+soft+1.%0AUsually%2C+multiple+constraints+share+the+same+level+and+are+weighted+against+each%0Aother.+Use+explaining+the+score+to+get+the+weight+of+individual+constraints+in+the%0Asame+level.%0AVariants+of+this+Score+type%3A%0A%E2%80%A2+BendableLongScore+uses+long+values+instead+of+int+values.%0A%E2%80%A2+BendableBigDecimalScore+uses+BigDecimal+values+instead+of+int+values.%0A5.2.5.+Implementing+a+Custom+Score%0AInternally%2C+each+Score+implementation+also+has+a+ScoreDefinition+implementation.+For+example%3A%0ASimpleScore+is+defined+by+SimpleScoreDefinition.+The+ScoreDefinition+interface+defines+the+score%0Arepresentation.%0ATo+implement+a+custom+Score%2C+also+implement+such+a+custom+ScoreDefinition.+Extend%0AAbstractScoreDefinition+%28preferably+by+copy+pasting+HardSoftScoreDefinition%29+and+start+from+there.%0A133%0AThen+hook+your+custom+ScoreDefinition+in+the+domain%3A%0A%C2%A0+++%40PlanningScore%28scoreDefinitionClass+%3D+MyCustomScoreDefinition.class%29%0A%C2%A0+++private+MyCustomScore+score%3B%0ATo+have+it+integrate+seamlessly+with+JPA%2FHibernate%2C+XStream%2C+Jackson%2C+%E2%80%A6%2C+you%E2%80%99ll+need+to+write%0Acustom+glue+code+too.%0A5.3.+Calculate+the+Score%0A5.3.1.+Score+Calculation+Types%0AThere+are+several+ways+to+calculate+the+Score+of+a+Solution%3A%0A%E2%80%A2+Easy+Java+score+calculation%3A+implement+a+single+Java+method%0A%E2%80%A2+Incremental+Java+score+calculation%3A+implement+multiple+Java+methods%0A%E2%80%A2+Drools+score+calculation+%28recommended%29%3A+implement+score+rules%0AEvery+score+calculation+type+can+use+any+Score+definition.+For+example%2C+easy+Java+score+calculation%0Acan+output+a+HardSoftScore.%0AAll+score+calculation+types+are+Object+Oriented+and+can+reuse+existing+Java+code.%0AThe+score+calculation+must+be+read-only.+It+must+not+change+the+planning+entities%0Aor+the+problem+facts+in+any+way.+For+example%2C+it+must+not+call+a+setter+method+on+a%0Aplanning+entity+in+a+Drools+score+rule%E2%80%99s+RHS.+This+does+not+apply+to+logically%0Ainserted+objects%2C+which+can+be+changed+by+the+score+rules+that+logically+inserted%0Athem+in+the+first+place.%0A%EF%81%AA%0APlanner+will+not+recalculate+the+score+of+a+Solution+if+it+can+predict+it+%28unless+an%0AenvironmentMode+assertion+is+enabled%29.+For+example%2C+after+a+winning+step+is+done%2C%0Athere+is+no+need+to+calculate+the+score+because+that+move+was+done+and+undone%0Aearlier.+As+a+result%2C+there+is+no+guarantee+that+such+changes+applied+during+score%0Acalculation+are+actually+done.%0A5.3.2.+Easy+Java+Score+Calculation%0AAn+easy+way+to+implement+your+score+calculation+in+Java.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Plain+old+Java%3A+no+learning+curve%0A%E2%97%A6+Opportunity+to+delegate+score+calculation+to+an+existing+code+base+or+legacy+system%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+Slower%0A%E2%97%A6+Does+not+scale+because+there+is+no+incremental+score+calculation%0A134%0AImplement+the+one+method+of+the+interface+EasyScoreCalculator%3A%0Apublic+interface+EasyScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++Score+calculateScore%28Solution_+solution%29%3B%0A%7D%0AFor+example+in+n+queens%3A%0Apublic+class+NQueensEasyScoreCalculator+implements+EasyScoreCalculator%3CNQueens%3E+%7B%0A%C2%A0+++public+SimpleScore+calculateScore%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++List%3CQueen%3E+queenList+%3D+nQueens.getQueenList%28%29%3B%0A%C2%A0+++++++int+score+%3D+0%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+n%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++for+%28int+j+%3D+i+%2B+1%3B+j+%3C+n%3B+j%2B%2B%29+%7B%0A%C2%A0+++++++++++++++Queen+leftQueen+%3D+queenList.get%28i%29%3B%0A%C2%A0+++++++++++++++Queen+rightQueen+%3D+queenList.get%28j%29%3B%0A%C2%A0+++++++++++++++if+%28leftQueen.getRow%28%29+%21%3D+null+%26%26+rightQueen.getRow%28%29+%21%3D+null%29+%7B%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getRowIndex%28%29+%3D%3D+rightQueen.getRowIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getAscendingDiagonalIndex%28%29+%3D%3D+rightQueen%0A.getAscendingDiagonalIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++++++if+%28leftQueen.getDescendingDiagonalIndex%28%29+%3D%3D+rightQueen%0A.getDescendingDiagonalIndex%28%29%29+%7B%0A%C2%A0+++++++++++++++++++++++score--%3B%0A%C2%A0+++++++++++++++++++%7D%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+SimpleScore.valueOf%28score%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+it+in+the+solver+configuration%3A%0A135%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueensEasySco%0AreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0ATo+configure+values+of+an+EasyScoreCalculator+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+easyScoreCalculatorCustomProperties+element%0Aand+use+custom+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CeasyScoreCalculatorClass%3E...MyEasyScoreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3CeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%0A%C2%A0+++%3C%2FeasyScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.3.+Incremental+Java+Score+Calculation%0AA+way+to+implement+your+score+calculation+incrementally+in+Java.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Very+fast+and+scalable%0A%E2%96%AA+Currently+the+fastest+if+implemented+correctly%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+Hard+to+write%0A%E2%96%AA+A+scalable+implementation+heavily+uses+maps%2C+indexes%2C+%E2%80%A6+%28things+the+Drools+rule+engine%0Acan+do+for+you%29%0A%E2%96%AA+You+have+to+learn%2C+design%2C+write+and+improve+all+these+performance+optimizations%0Ayourself%0A%E2%97%A6+Hard+to+read%0A%E2%96%AA+Regular+score+constraint+changes+can+lead+to+a+high+maintenance+cost%0AImplement+all+the+methods+of+the+interface+IncrementalScoreCalculator+and+extend+the+class%0AAbstractIncrementalScoreCalculator%3A%0A136%0Apublic+interface+IncrementalScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++void+resetWorkingSolution%28Solution_+workingSolution%29%3B%0A%C2%A0+++void+beforeEntityAdded%28Object+entity%29%3B%0A%C2%A0+++void+afterEntityAdded%28Object+entity%29%3B%0A%C2%A0+++void+beforeVariableChanged%28Object+entity%2C+String+variableName%29%3B%0A%C2%A0+++void+afterVariableChanged%28Object+entity%2C+String+variableName%29%3B%0A%C2%A0+++void+beforeEntityRemoved%28Object+entity%29%3B%0A%C2%A0+++void+afterEntityRemoved%28Object+entity%29%3B%0A%C2%A0+++Score+calculateScore%28%29%3B%0A%7D%0AFor+example+in+n+queens%3A%0Apublic+class+NQueensAdvancedIncrementalScoreCalculator+extends%0A137%0AAbstractIncrementalScoreCalculator%3CNQueens%3E+%7B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+rowIndexMap%3B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+ascendingDiagonalIndexMap%3B%0A%C2%A0+++private+Map%3CInteger%2C+List%3CQueen%3E%3E+descendingDiagonalIndexMap%3B%0A%C2%A0+++private+int+score%3B%0A%C2%A0+++public+void+resetWorkingSolution%28NQueens+nQueens%29+%7B%0A%C2%A0+++++++int+n+%3D+nQueens.getN%28%29%3B%0A%C2%A0+++++++rowIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n%29%3B%0A%C2%A0+++++++ascendingDiagonalIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n+*+2%29%3B%0A%C2%A0+++++++descendingDiagonalIndexMap+%3D+new+HashMap%3CInteger%2C+List%3CQueen%3E%3E%28n+*+2%29%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+n%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++rowIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexMap.put%28i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++if+%28i+%21%3D+0%29+%7B%0A%C2%A0+++++++++++++++ascendingDiagonalIndexMap.put%28n+-+1+%2B+i%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++++++descendingDiagonalIndexMap.put%28%28-i%29%2C+new+ArrayList%3CQueen%3E%28n%29%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++score+%3D+0%3B%0A%C2%A0+++++++for+%28Queen+queen+%3A+nQueens.getQueenList%28%29%29+%7B%0A%C2%A0+++++++++++insert%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeEntityAdded%28Object+entity%29+%7B%0A%C2%A0+++++++%2F%2F+Do+nothing%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterEntityAdded%28Object+entity%29+%7B%0A%C2%A0+++++++insert%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeVariableChanged%28Object+entity%2C+String+variableName%29+%7B%0A%C2%A0+++++++retract%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterVariableChanged%28Object+entity%2C+String+variableName%29+%7B%0A%C2%A0+++++++insert%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+beforeEntityRemoved%28Object+entity%29+%7B%0A%C2%A0+++++++retract%28%28Queen%29+entity%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterEntityRemoved%28Object+entity%29+%7B%0A%C2%A0+++++++%2F%2F+Do+nothing%0A%C2%A0+++%7D%0A138%0A%C2%A0+++private+void+insert%28Queen+queen%29+%7B%0A%C2%A0+++++++Row+row+%3D+queen.getRow%28%29%3B%0A%C2%A0+++++++if+%28row+%21%3D+null%29+%7B%0A%C2%A0+++++++++++int+rowIndex+%3D+queen.getRowIndex%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+rowIndexList+%3D+rowIndexMap.get%28rowIndex%29%3B%0A%C2%A0+++++++++++score+-%3D+rowIndexList.size%28%29%3B%0A%C2%A0+++++++++++rowIndexList.add%28queen%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+ascendingDiagonalIndexList+%3D+ascendingDiagonalIndexMap.get%0A%28queen.getAscendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++score+-%3D+ascendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexList.add%28queen%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+descendingDiagonalIndexList+%3D+descendingDiagonalIndexMap.get%0A%28queen.getDescendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++score+-%3D+descendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexList.add%28queen%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++private+void+retract%28Queen+queen%29+%7B%0A%C2%A0+++++++Row+row+%3D+queen.getRow%28%29%3B%0A%C2%A0+++++++if+%28row+%21%3D+null%29+%7B%0A%C2%A0+++++++++++List%3CQueen%3E+rowIndexList+%3D+rowIndexMap.get%28queen.getRowIndex%28%29%29%3B%0A%C2%A0+++++++++++rowIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+rowIndexList.size%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+ascendingDiagonalIndexList+%3D+ascendingDiagonalIndexMap.get%0A%28queen.getAscendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++ascendingDiagonalIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+ascendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++++++List%3CQueen%3E+descendingDiagonalIndexList+%3D+descendingDiagonalIndexMap.get%0A%28queen.getDescendingDiagonalIndex%28%29%29%3B%0A%C2%A0+++++++++++descendingDiagonalIndexList.remove%28queen%29%3B%0A%C2%A0+++++++++++score+%2B%3D+descendingDiagonalIndexList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++public+SimpleScore+calculateScore%28%29+%7B%0A%C2%A0+++++++return+SimpleScore.valueOf%28score%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+it+in+the+solver+configuration%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0%0A%3CincrementalScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueens%0AAdvancedIncrementalScoreCalculator%3C%2FincrementalScoreCalculatorClass%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A139%0AA+piece+of+incremental+score+calculator+code+can+be+difficult+to+write+and+to+review.%0A%EF%81%AA+Assert+its+correctness+by+using+an+EasyScoreCalculator+to+fulfill+the+assertions%0Atriggered+by+the+environmentMode.%0ATo+configure+values+of+an+IncrementalScoreCalculator+dynamically+in+the+solver+configuration+%28so%0Athe+Benchmarker+can+tweak+those+parameters%29%2C+add+the%0AincrementalScoreCalculatorCustomProperties+element+and+use+custom+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CincrementalScoreCalculatorClass%3E%0A...MyIncrementalScoreCalculator%3C%2FincrementalScoreCalculatorClass%3E%0A%C2%A0+++%3CincrementalScoreCalculatorCustomProperties%3E%0A%C2%A0+++++%3CmyCacheSize%3E1000%3C%2FmyCacheSize%3E%0A%C2%A0+++%3C%2FincrementalScoreCalculatorCustomProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.3.1.+ConstraintMatchAwareIncrementalScoreCalculator%0AOptionally%2C+also+implement+the+ConstraintMatchAwareIncrementalScoreCalculator+interface+to%3A%0A%E2%80%A2+Explain+a+score+by+splitting+it+up+per+score+constraint+with%0AScoreDirector.getConstraintMatchTotals%28%29.%0A%E2%80%A2+Visualize+or+sort+planning+entities+by+how+many+constraints+each+one+breaks+with%0AScoreDirector.getIndictmentMap%28%29.%0A%E2%80%A2+Receive+a+detailed+analysis+if+the+IncrementalScoreCalculator+is+corrupted+in+FAST_ASSERT+or%0AFULL_ASSERT+environmentMode%2C%0Apublic+interface+ConstraintMatchAwareIncrementalScoreCalculator%3CSolution_%3E+%7B%0A%C2%A0+++void+resetWorkingSolution%28Solution_+workingSolution%2C+boolean%0AconstraintMatchEnabled%29%3B%0A%C2%A0+++Collection%3CConstraintMatchTotal%3E+getConstraintMatchTotals%28%29%3B%0A%C2%A0+++Map%3CObject%2C+Indictment%3E+getIndictmentMap%28%29%3B%0A%7D%0AFor+example+in+machine+reassignment%2C+create+one+ConstraintMatchTotal+per+constraint+type+and%0Acall+addConstraintMatch%28%29+for+each+constraint+match%3A%0A140%0Apublic+class+MachineReassignmentIncrementalScoreCalculator%0A%C2%A0+++++++implements+ConstraintMatchAwareIncrementalScoreCalculator%3CMachineReassignment%3E%0A%7B%0A%C2%A0+++...%0A%C2%A0+++%40Override%0A%C2%A0+++public+void+resetWorkingSolution%28MachineReassignment+workingSolution%2C+boolean%0AconstraintMatchEnabled%29+%7B%0A%C2%A0+++++++resetWorkingSolution%28workingSolution%29%3B%0A%C2%A0+++++++%2F%2F+ignore+constraintMatchEnabled%2C+it+is+always+presumed+enabled%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3CConstraintMatchTotal%3E+getConstraintMatchTotals%28%29+%7B%0A%C2%A0+++++++ConstraintMatchTotal+maximumCapacityMatchTotal+%3D+new+ConstraintMatchTotal%28%0A%C2%A0+++++++++++++++CONSTRAINT_PACKAGE%2C+%22maximumCapacity%22%2C+HardSoftLongScore.ZERO%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++++++for+%28MrMachineScorePart+machineScorePart+%3A+machineScorePartMap.values%28%29%29+%7B%0A%C2%A0+++++++++++for+%28MrMachineCapacityScorePart+machineCapacityScorePart+%3A%0AmachineScorePart.machineCapacityScorePartList%29+%7B%0A%C2%A0+++++++++++++++if+%28machineCapacityScorePart.maximumAvailable+%3C+0L%29+%7B%0A%C2%A0+++++++++++++++++++maximumCapacityMatchTotal.addConstraintMatch%28%0A%C2%A0+++++++++++++++++++++++++++Arrays.asList%28machineCapacityScorePart.machineCapacity%29%2C%0A%C2%A0+++++++++++++++++++++++++++HardSoftLongScore.valueOf%28machineCapacityScorePart%0A.maximumAvailable%2C+0%29%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++...%0A%C2%A0+++++++List%3CConstraintMatchTotal%3E+constraintMatchTotalList+%3D+new+ArrayList%3C%3E%284%29%3B%0A%C2%A0+++++++constraintMatchTotalList.add%28maximumCapacityMatchTotal%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++++++return+constraintMatchTotalList%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Map%3CObject%2C+Indictment%3E+getIndictmentMap%28%29+%7B%0A%C2%A0+++++++return+null%3B+%2F%2F+Calculate+it+non-incrementally+from+getConstraintMatchTotals%28%29%0A%C2%A0+++%7D%0A%7D%0AThat+getConstraintMatchTotals%28%29+code+often+duplicates+some+of+the+logic+of+the+normal%0AIncrementalScoreCalculator+methods.+Drools+Score+Calculation+doesn%E2%80%99t+have+this+disadvantage%2C%0Abecause+it+is+constraint+match+aware+automatically+when+needed%2C+without+any+extra+domain-%0Aspecific+code.%0A5.3.4.+Drools+Score+Calculation%0A141%0A5.3.4.1.+Overview%0AImplement+your+score+calculation+using+the+Drools+rule+engine.+Every+score+constraint+is+written+as%0Aone+or+more+score+rules.%0A%E2%80%A2+Advantages%3A%0A%E2%97%A6+Incremental+score+calculation+for+free%0A%E2%96%AA+Because+most+DRL+syntax+uses+forward+chaining%2C+it+does+incremental+calculation+without%0Aany+extra+code%0A%E2%97%A6+Score+constraints+are+isolated+as+separate+rules%0A%E2%96%AA+Easy+to+add+or+edit+existing+score+rules%0A%E2%97%A6+Flexibility+to+augment+your+score+constraints+by%0A%E2%96%AA+Defining+them+in+decision+tables%0A%E2%96%AA+Excel+%28XLS%29+spreadsheet%0A%E2%96%AA+KIE+Workbench+WebUI%0A%E2%96%AA+Translate+them+into+natural+language+with+DSL%0A%E2%96%AA+Store+and+release+in+the+KIE+Workbench+repository%0A%E2%97%A6+Performance+optimizations+in+future+versions+for+free%0A%E2%96%AA+In+every+release%2C+the+Drools+rule+engine+tends+to+become+faster%0A%E2%80%A2+Disadvantages%3A%0A%E2%97%A6+DRL+learning+curve%0A%E2%97%A6+Usage+of+DRL%0A%E2%96%AA+Polyglot+fear+can+prohibit+the+use+of+a+new+language+such+as+DRL+in+some+organizations%0A5.3.4.2.+Drools+Score+Rules+Configuration%0AThere+are+several+ways+to+define+where+your+score+rules+live.%0A5.3.4.2.1.+A+scoreDrl+Resource+on+the+Classpath%0AThis+is+the+easy+way.+The+score+rules+live+in+a+DRL+file+which+is+provided+as+a+classpath+resource.+Just%0Aadd+the+score+rules+DRL+file+in+the+solver+configuration+as+a+%3CscoreDrl%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AIn+a+typical+project+%28following+the+Maven+directory+structure%29%2C+that+DRL+file+would+be+located+at%0A%24PROJECT_DIR%2Fsrc%2Fmain%2Fresources%2Forg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%0A%28even+for+a+war+project%29.%0A142%0AThe+%3CscoreDrl%3E+element+expects+a+classpath+resource%2C+as+defined+by%0A%EF%81%9A+ClassLoader.getResource%28String%29%2C+it+does+not+accept+a+File%2C+nor+an+URL%2C+nor+a%0Awebapp+resource.+See+below+to+use+a+File+instead.%0AAdd+multiple+%3CscoreDrl%3E+elements+if+the+score+rules+are+split+across+multiple+DRL+files.%0AOptionally%2C+you+can+also+set+drools+configuration+properties%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CkieBaseConfigurationProperties%3E%0A%C2%A0+++++%3Cdrools.equalityBehavior%3E...%3C%2Fdrools.equalityBehavior%3E%0A%C2%A0+++%3C%2FkieBaseConfigurationProperties%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0ATo+enable+property+reactive+by+default%2C+without+a+%40propertyReactive+on+the+domain+classes%2C+add%0A%3Cdrools.propertySpecific%3EALWAYS%3C%2Fdrools.propertySpecific%3E+in+there.+Otherwise+Planner%0Aautomatically+changes+the+Drools+default+to+ALLOWED+so+property+reactive+is+not+active+by+default.%0A5.3.4.2.2.+A+scoreDrlFile%0ATo+use+File+on+the+local+file+system%2C+instead+of+a+classpath+resource%2C+add+the+score+rules+DRL+file+in%0Athe+solver+configuration+as+a+%3CscoreDrlFile%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrlFile%3E%2Fhome%2Fge0ffrey%2Ftmp%2FnQueensScoreRules.drl%3C%2FscoreDrlFile%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AFor+portability+reasons%2C+a+classpath+resource+is+recommended+over+a+File.+An%0Aapplication+build+on+one+computer%2C+but+used+on+another+computer%2C+might+not+find%0A%EF%81%B1+the+file+on+the+same+location.+Worse%2C+if+they+use+a+different+Operating+System%2C+it+is%0Ahard+to+choose+a+portable+file+path.%0AAdd+multiple+%3CscoreDrlFile%3E+elements+if+the+score+rules+are+split+across+multiple+DRL+files.%0A5.3.4.2.3.+A+ksessionName+in+a+Kjar+from+a+Maven+repository%0AThis+way+allows+you+to+use+score+rules+defined+by+the+Workbench+or+build+a+kjar+and+deploy+it+to+the%0AExecution+Server.+Both+the+score+rules+and+the+solver+configuration+are+resources+in+a+kjar.+Clients%0Acan+obtain+that+kjar+either+from+the+local+classpath%2C+from+a+local+Maven+repository+or+even+from+a%0Aremote+Maven+repository.%0AThe+score+rules+still+live+in+a+DRL+file%2C+but+the+KieContainer+finds+that+DRL+file+through+the+META-%0AINF%2Fkmodule.xml+file%3A%0A143%0A%3Ckmodule+xmlns%3D%22http%3A%2F%2Fwww.drools.org%2Fxsd%2Fkmodule%22%3E%0A%C2%A0+%3Cconfiguration%3E%0A%C2%A0+++%3C%21--+Don%27t+enable+propertyReactive+unless+there+is+a+%40PropertyReactive+annotation%0Aon+the+domain+classes+--%3E%0A%C2%A0+++%3Cproperty+key%3D%22drools.propertySpecific%22+value%3D%22ALLOWED%22%2F%3E%0A%C2%A0+%3C%2Fconfiguration%3E%0A%C2%A0+%3Ckbase+name%3D%22nQueensKbase%22+packages%3D%22org.optaplanner.examples.nqueens.solver%22%3E%0A%C2%A0+++%3Cksession+name%3D%22nQueensKsession%22%2F%3E%0A%C2%A0+%3C%2Fkbase%3E%0A%3C%2Fkmodule%3E%0AThe+kmodule+above+will+pick+up+all+the+DRL+files+in+the+package%0Aorg.optaplanner.examples.nqueens.solver.+A+kbase+can+even+extend+another+kbase.%0AStarting+from+version+7.0%2C+Drools+enables+property+reactive+by+default+for+all%0Aclasses.+This+means+if+you+have+a+non-simple+getter+and+forget+to+apply+%40Modifies%0A%EF%81%9A+correctly%2C+corruption+occurs.+To+avoid+this%2C+simply+set+drools.propertySpecific+to%0AALLOWED+as+shown+above.%0AAdd+the+ksession+name+in+the+solver+configuration+as+a+%3CksessionName%3E+element%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CksessionName%3EnQueensKsession%3C%2FksessionName%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AIn+this+approach%2C+it%E2%80%99s+required+to+use+a+SolverFactory.createFromKieContainerXmlResource%28%E2%80%A6%29%0Amethod+to+build+the+SolverFactory.+If+no+%3CksessionName%3E+element+is+specified%2C+the+default+ksession+of%0Athe+kmodule.xml+is+used.%0A5.3.4.3.+Implementing+a+Score+Rule%0AHere+is+an+example+of+a+score+constraint+implemented+as+a+score+rule+in+a+DRL+file%3A%0Arule+%22multipleQueensHorizontal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+rowIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+rowIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0AThis+score+rule+will+fire+once+for+every+two+queens+with+the+same+rowIndex.+The+%28id+%3E+%24id%29+condition%0Ais+needed+to+assure+that+for+two+queens+A+and+B%2C+it+can+only+fire+for+%28A%2C+B%29+and+not+for+%28B%2C+A%29%2C+%28A%2C+A%29+or%0A%28B%2C+B%29.+Let+us+take+a+closer+look+at+this+score+rule+on+this+solution+of+four+queens%3A%0A144%0AIn+this+solution+the+multipleQueensHorizontal+score+rule+will+fire+for+six+queen+couples%3A+%28A%2C+B%29%2C+%28A%2C%0AC%29%2C+%28A%2C+D%29%2C+%28B%2C+C%29%2C+%28B%2C+D%29+and+%28C%2C+D%29.+Because+none+of+the+queens+are+on+the+same+vertical+or+diagonal%0Aline%2C+this+solution+will+have+a+score+of+-6.+An+optimal+solution+of+four+queens+has+a+score+of+0.%0ANotice+that+every+score+rule+will+relate+to+at+least+one+planning+entity+class+%28directly%0Aor+indirectly+through+a+logically+inserted+fact%29.%0A%EF%81%9A+This+is+a+normal+case.+It+would+be+a+waste+of+time+to+write+a+score+rule+that+only%0Arelates+to+problem+facts%2C+as+the+consequence+will+never+change+during+planning%2C+no%0Amatter+what+the+possible+solution.%0AThe+kcontext+variable+is+a+magic+variable+in+Drools+Expert.+The+scoreHolder%27s%0A%EF%81%9A+method+uses+it+to+do+incremental+score+calculation+correctly+and+to+create+a%0AConstraintMatch+instance.%0A5.3.4.4.+Weighing+Score+Rules%0AA+ScoreHolder+instance+is+asserted+into+the+KieSession+as+a+global+called+scoreHolder.+The+score+rules%0Aneed+to+%28directly+or+indirectly%29+update+that+instance.%0A145%0Aglobal+SimpleScoreHolder+scoreHolder%3B%0Arule+%22multipleQueensHorizontal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+rowIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+rowIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0A%2F%2F+multipleQueensVertical+is+obsolete+because+it+is+always+0%0Arule+%22multipleQueensAscendingDiagonal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+ascendingDiagonalIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+ascendingDiagonalIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0Arule+%22multipleQueensDescendingDiagonal%22%0A%C2%A0+++when%0A%C2%A0+++++++Queen%28%24id+%3A+id%2C+row+%21%3D+null%2C+%24i+%3A+descendingDiagonalIndex%29%0A%C2%A0+++++++Queen%28id+%3E+%24id%2C+descendingDiagonalIndex+%3D%3D+%24i%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addConstraintMatch%28kcontext%2C+-1%29%3B%0Aend%0ATo+learn+more+about+the+Drools+rule+language+%28DRL%29%2C+consult+the+Drools%0A%EF%81%9A+documentation.%0AMost+use+cases+also+weigh+their+constraint+types+or+even+their+matches+differently%2C+by+using+a%0Aspecific+weight+for+each+constraint+match.+For+example+in+course+scheduling%2C+assigning+a+Lecture+to%0Aa+Room+that+is+lacking+two+seats+is+weighted+equally+bad+as+having+one+isolated+Lecture+in+a%0ACurriculum%3A%0A146%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0A%2F%2F+RoomCapacity%3A+For+each+lecture%2C+the+number+of+students+that+attend+the+course+must%0Abe+less+or+equal%0A%2F%2F+than+the+number+of+seats+of+all+the+rooms+that+host+its+lectures.%0Arule+%22roomCapacity%22%0A%C2%A0+++when%0A%C2%A0+++++++%24room+%3A+Room%28%24capacity+%3A+capacity%29%0A%C2%A0+++++++%24lecture+%3A+Lecture%28room+%3D%3D+%24room%2C+studentSize+%3E+%24capacity%2C+%24studentSize+%3A%0AstudentSize%29%0A%C2%A0+++then%0A%C2%A0+++++++%2F%2F+Each+student+above+the+capacity+counts+as+one+point+of+penalty.%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+%28%24capacity+-+%24studentSize%29%29%3B%0Aend%0A%2F%2F+CurriculumCompactness%3A+Lectures+belonging+to+a+curriculum+should+be+adjacent%0A%2F%2F+to+each+other+%28i.e.%2C+in+consecutive+periods%29.%0A%2F%2F+For+a+given+curriculum+we+account+for+a+violation+every+time+there+is+one+lecture%0Anot+adjacent%0A%2F%2F+to+any+other+lecture+within+the+same+day.%0Arule+%22curriculumCompactness%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++%2F%2F+Each+isolated+lecture+in+a+curriculum+counts+as+two+points+of+penalty.%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-2%29%3B%0Aend%0A5.3.5.+InitializingScoreTrend%0AThe+InitializingScoreTrend+specifies+how+the+Score+will+change+as+more+and+more+variables+are%0Ainitialized+%28while+the+already+initialized+variables+do+not+change%29.+Some+optimization+algorithms%0A%28such+Construction+Heuristics+and+Exhaustive+Search%29+run+faster+if+they+have+such+information.%0AFor+the+Score+%28or+each+score+level+separately%29%2C+specify+a+trend%3A%0A%E2%80%A2+ANY+%28default%29%3A+Initializing+an+extra+variable+can+change+the+score+positively+or+negatively.+Gives%0Ano+performance+gain.%0A%E2%80%A2+ONLY_UP+%28rare%29%3A+Initializing+an+extra+variable+can+only+change+the+score+positively.+Implies+that%3A%0A%E2%97%A6+There+are+only+positive+constraints%0A%E2%97%A6+And+initializing+the+next+variable+can+not+unmatch+a+positive+constraint+that+was+matched%0Aby+a+previous+initialized+variable.%0A%E2%80%A2+ONLY_DOWN%3A+Initializing+an+extra+variable+can+only+change+the+score+negatively.+Implies+that%3A%0A%E2%97%A6+There+are+only+negative+constraints%0A%E2%97%A6+And+initializing+the+next+variable+can+not+unmatch+a+negative+constraint+that+was+matched%0Aby+a+previous+initialized+variable.%0A147%0AMost+use+cases+only+have+negative+constraints.+Many+of+those+have+an+InitializingScoreTrend+that%0Aonly+goes+down%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3E...%2FcloudBalancingScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CinitializingScoreTrend%3EONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AAlternatively%2C+you+can+also+specify+the+trend+for+each+score+level+separately%3A%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3E...%2FcloudBalancingScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CinitializingScoreTrend%3EONLY_DOWN%2FONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0A5.3.6.+Invalid+Score+Detection%0AWhen+you+put+the+environmentModein+FULL_ASSERT+%28or+FAST_ASSERT%29%2C+it+will+detect+score+corruption+in%0Athe+incremental+score+calculation.+However%2C+that+will+not+verify+that+your+score+calculator+actually%0Aimplements+your+score+constraints+as+your+business+desires.+For+example%2C+one+score+rule+might%0Aconsistently+match+the+wrong+pattern.+To+verify+the+score+rules+against+an+independent%0Aimplementation%2C+configure+a+assertionScoreDirectorFactory%3A%0A%C2%A0+%3CenvironmentMode%3EFAST_ASSERT%3C%2FenvironmentMode%3E%0A%C2%A0+...%0A%C2%A0+%3CscoreDirectorFactory%3E%0A%C2%A0+++%3CscoreDrl%3Eorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++%3CassertionScoreDirectorFactory%3E%0A%C2%A0%0A%3CeasyScoreCalculatorClass%3Eorg.optaplanner.examples.nqueens.solver.score.NQueensEasySco%0AreCalculator%3C%2FeasyScoreCalculatorClass%3E%0A%C2%A0+++%3C%2FassertionScoreDirectorFactory%3E%0A%C2%A0+%3C%2FscoreDirectorFactory%3E%0AThis+way%2C+the+scoreDrl+will+be+validated+by+the+EasyScoreCalculator.%0AThis+works+well+to+isolate+score+corruption%2C+but+to+verify+that+the+score+rules%0A%EF%81%9A+implement+the+real+business+needs%2C+a+unit+test+with+a+ScoreVerifier+is+usually%0Abetter.%0A5.4.+Score+Calculation+Performance+Tricks%0A5.4.1.+Overview%0AThe+Solver+will+normally+spend+most+of+its+execution+time+running+the+score+calculation+%28which+is%0A148%0Acalled+in+its+deepest+loops%29.+Faster+score+calculation+will+return+the+same+solution+in+less+time+with%0Athe+same+algorithm%2C+which+normally+means+a+better+solution+in+equal+time.%0A5.4.2.+Score+Calculation+Speed%0AAfter+solving+a+problem%2C+the+Solver+will+log+the+score+calculation+speed+per+second.+This+is+a+good%0Ameasurement+of+Score+calculation+performance%2C+despite+that+it+is+affected+by+non+score+calculation%0Aexecution+time.+It+depends+on+the+problem+scale+of+the+problem+dataset.+Normally%2C+even+for+high%0Ascale+problems%2C+it+is+higher+than+1000%2C+except+when+you+are+using+an+EasyScoreCalculator.%0AWhen+improving+your+score+calculation%2C+focus+on+maximizing+the+score+calculation%0Aspeed%2C+instead+of+maximizing+the+best+score.+A+big+improvement+in+score%0Acalculation+can+sometimes+yield+little+or+no+best+score+improvement%2C+for+example%0Awhen+the+algorithm+is+stuck+in+a+local+or+global+optima.+If+you+are+watching+the%0A%EF%81%AA+calculation+speed+instead%2C+score+calculation+improvements+are+far+more+visible.%0AFurthermore%2C+watching+the+calculation+speed%2C+allows+you+to+remove+or+add+score%0Aconstraints%2C+and+still+compare+it+with+the+original+calculation+speed.+Comparing+the%0Abest+score+with+the+original+would+be+wrong%2C+because+it+is+comparing+apples+and%0Aoranges.%0A5.4.3.+Incremental+Score+Calculation+%28with+Deltas%29%0AWhen+a+Solution+changes%2C+incremental+score+calculation+%28AKA+delta+based+score+calculation%29%2C%0Acalculates+the+delta+with+the+previous+state+to+find+the+new+Score%2C+instead+of+recalculating+the+entire%0Ascore+on+every+solution+evaluation.%0AFor+example%2C+when+a+single+queen+A+moves+from+row+1+to+2%2C+it+will+not+bother+to+check+if+queen+B%0Aand+C+can+attack+each+other%2C+since+neither+of+them+changed%3A%0A149%0ASimilarly+in+employee+rostering%3A%0A150%0AThis+is+a+huge+performance+and+scalability+gain.+Drools+score+calculation+gives+you+this+huge%0Ascalability+gain+without+forcing+you+to+write+a+complicated+incremental+score+calculation%0Aalgorithm.+Just+let+the+Drools+rule+engine+do+the+hard+work.%0ANotice+that+the+speedup+is+relative+to+the+size+of+your+planning+problem+%28your+n%29%2C+making%0Aincremental+score+calculation+far+more+scalable.%0A5.4.4.+Avoid+Calling+Remote+Services+During+Score+Calculation%0ADo+not+call+remote+services+in+your+score+calculation+%28except+if+you+are+bridging+EasyScoreCalculator%0Ato+a+legacy+system%29.+The+network+latency+will+kill+your+score+calculation+performance.+Cache+the%0Aresults+of+those+remote+services+if+possible.%0AIf+some+parts+of+a+constraint+can+be+calculated+once%2C+when+the+Solver+starts%2C+and+never+change%0Aduring+solving%2C+then+turn+them+into+cached+problem+facts.%0A5.4.5.+Pointless+Constraints%0AIf+you+know+a+certain+constraint+can+never+be+broken+%28or+it+is+always+broken%29%2C+you+need+not+write+a%0Ascore+constraint+for+it.+For+example+in+n+queens%2C+the+score+calculation+does+not+check+if+multiple%0Aqueens+occupy+the+same+column%2C+because+a+Queen%27s+column+never+changes+and+every+Solution+starts%0Awith+each+Queen+on+a+different+column.%0A151%0ADo+not+go+overboard+with+this.+If+some+datasets+do+not+use+a+specific+constraint+but%0A%EF%81%9A+others+do%2C+just+return+out+of+the+constraint+as+soon+as+you+can.+There+is+no+need+to%0Adynamically+change+your+score+calculation+based+on+the+dataset.%0A5.4.6.+Built-in+Hard+Constraint%0AInstead+of+implementing+a+hard+constraint%2C+it+can+sometimes+be+built+in.+For+example%2C+if+Lecture+A%0Ashould+never+be+assigned+to+Room+X%2C+but+it+uses+ValueRangeProvider+on+Solution%2C+so+the+Solver+will%0Aoften+try+to+assign+it+to+Room+X+too+%28only+to+find+out+that+it+breaks+a+hard+constraint%29.+Use+a%0AValueRangeProvider+on+the+planning+entity+or+filtered+selection+to+define+that+Course+A+should+only%0Abe+assigned+a+Room+different+than+X.%0AThis+can+give+a+good+performance+gain+in+some+use+cases%2C+not+just+because+the+score+calculation+is%0Afaster%2C+but+mainly+because+most+optimization+algorithms+will+spend+less+time+evaluating+infeasible%0Asolutions.+However%2C+usually+this+not+a+good+idea+because+there+is+a+real+risk+of+trading+short+term%0Abenefits+for+long+term+harm%3A%0A%E2%80%A2+Many+optimization+algorithms+rely+on+the+freedom+to+break+hard+constraints+when+changing%0Aplanning+entities%2C+to+get+out+of+local+optima.%0A%E2%80%A2+Both+implementation+approaches+have+limitations+%28feature+compatibility%2C+disabling+automatic%0Aperformance+optimizations%29%2C+as+explained+in+their+documentation.%0A5.4.7.+Other+Score+Calculation+Performance+Tricks%0A%E2%80%A2+Verify+that+your+score+calculation+happens+in+the+correct+Number+type.+If+you+are+making+the+sum%0Aof+int+values%2C+do+not+let+Drools+sum+it+in+a+double+which+takes+longer.%0A%E2%80%A2+For+optimal+performance%2C+always+use+server+mode+%28java+-server%29.+We+have+seen+performance%0Aincreases+of+50%25+by+turning+on+server+mode.%0A%E2%80%A2+For+optimal+performance%2C+use+the+latest+Java+version.+For+example%2C+in+the+past+we+have+seen%0Aperformance+increases+of+30%25+by+switching+from+java+1.5+to+1.6.%0A%E2%80%A2+Always+remember+that+premature+optimization+is+the+root+of+all+evil.+Make+sure+your+design+is%0Aflexible+enough+to+allow+configuration+based+tweaking.%0A5.4.8.+Score+Trap%0AMake+sure+that+none+of+your+score+constraints+cause+a+score+trap.+A+trapped+score+constraint+uses%0Athe+same+weight+for+different+constraint+matches%2C+when+it+could+just+as+easily+use+a+different+weight.%0AIt+effectively+lumps+its+constraint+matches+together%2C+which+creates+a+flatlined+score+function+for+that%0Aconstraint.+This+can+cause+a+solution+state+in+which+several+moves+need+to+be+done+to+resolve+or%0Alower+the+weight+of+that+single+constraint.+Some+examples+of+score+traps%3A%0A%E2%80%A2+You+need+two+doctors+at+each+table%2C+but+you+are+only+moving+one+doctor+at+a+time.+So+the+solver%0Ahas+no+incentive+to+move+a+doctor+to+a+table+with+no+doctors.+Punish+a+table+with+no+doctors%0Amore+than+a+table+with+only+one+doctor+in+that+score+constraint+in+the+score+function.%0A%E2%80%A2+Two+exams+need+to+be+conducted+at+the+same+time%2C+but+you+are+only+moving+one+exam+at+a+time.%0ASo+the+solver+has+to+move+one+of+those+exams+to+another+timeslot+without+moving+the+other+in%0A152%0Athe+same+move.+Add+a+coarse-grained+move+that+moves+both+exams+at+the+same+time.%0AFor+example%2C+consider+this+score+trap.+If+the+blue+item+moves+from+an+overloaded+computer+to+an%0Aempty+computer%2C+the+hard+score+should+improve.+The+trapped+score+implementation+fails+to+do+that%3A%0AThe+Solver+should+eventually+get+out+of+this+trap%2C+but+it+will+take+a+lot+of+effort+%28especially+if+there+are%0Aeven+more+processes+on+the+overloaded+computer%29.+Before+they+do+that%2C+they+might+actually+start%0Amoving+more+processes+into+that+overloaded+computer%2C+as+there+is+no+penalty+for+doing+so.%0AAvoiding+score+traps+does+not+mean+that+your+score+function+should+be+smart%0Aenough+to+avoid+local+optima.+Leave+it+to+the+optimization+algorithms+to+deal+with%0A%EF%81%9A+the+local+optima.%0AAvoiding+score+traps+means+to+avoid%2C+for+each+score+constraint+individually%2C+a%0Aflatlined+score+function.%0AAlways+specify+the+degree+of+infeasibility.+The+business+will+often+say+%22if+the%0Asolution+is+infeasible%2C+it+does+not+matter+how+infeasible+it+is.%22+While+that+is+true+for%0A%EF%81%AA+the+business%2C+it+is+not+true+for+score+calculation+as+it+benefits+from+knowing+how%0Ainfeasible+it+is.+In+practice%2C+soft+constraints+usually+do+this+naturally+and+it+is+just+a%0Amatter+of+doing+it+for+the+hard+constraints+too.%0AThere+are+several+ways+to+deal+with+a+score+trap%3A%0A153%0A%E2%80%A2+Improve+the+score+constraint+to+make+a+distinction+in+the+score+weight.+For+example%2C+penalize%0A-1hard+for+every+missing+CPU%2C+instead+of+just+-1hard+if+any+CPU+is+missing.%0A%E2%80%A2+If+changing+the+score+constraint+is+not+allowed+from+the+business+perspective%2C+add+a+lower+score%0Alevel+with+a+score+constraint+that+makes+such+a+distinction.+For+example%2C+penalize+-1subsoft+for%0Aevery+missing+CPU%2C+on+top+of+-1hard+if+any+CPU+is+missing.+The+business+ignores+the+subsoft+score%0Alevel.%0A%E2%80%A2+Add+coarse-grained+moves+and+union+select+them+with+the+existing+fine-grained+moves.+A%0Acoarse-grained+move+effectively+does+multiple+moves+to+directly+get+out+of+a+score+trap+with+a%0Asingle+move.+For+example%2C+move+multiple+items+from+the+same+container+to+another+container.%0A5.4.9.+stepLimit+Benchmark%0ANot+all+score+constraints+have+the+same+performance+cost.+Sometimes+one+score+constraint+can+kill%0Athe+score+calculation+performance+outright.+Use+the+Benchmarker+to+do+a+one+minute+run+and+check%0Awhat+happens+to+the+score+calculation+speed+if+you+comment+out+all+but+one+of+the+score+constraints.%0A5.4.10.+Fairness+Score+Constraints%0ASome+use+cases+have+a+business+requirement+to+provide+a+fair+schedule+%28usually+as+a+soft+score%0Aconstraint%29%2C+for+example%3A%0A%E2%80%A2+Fairly+distribute+the+workload+amongst+the+employees%2C+to+avoid+envy.%0A%E2%80%A2+Evenly+distribute+the+workload+amongst+assets%2C+to+improve+reliability.%0AImplementing+such+a+constraint+can+seem+difficult+%28especially+because+there+are+different+ways+to%0Aformalize+fairness%29%2C+but+usually+the+squared+workload+implementation+behaves+most+desirable.+For%0Aeach+employee%2Fasset%2C+count+the+workload+w+and+subtract+w%C2%B2+from+the+score.%0A154%0AAs+shown+above%2C+the+squared+workload+implementation+guarantees+that+if+you+select+two+employees%0Afrom+a+given+solution+and+make+their+distribution+between+those+two+employees+fairer%2C+then+the%0Aresulting+new+solution+will+have+a+better+overall+score.+Do+not+just+use+the+difference+from+the%0Aaverage+workload%2C+as+that+can+lead+to+unfairness%2C+as+demonstrated+below.%0A155%0AInstead+of+the+squared+workload%2C+it+is+also+possible+to+use+the+variance+%28squared%0Adifference+to+the+average%29+or+the+standard+deviation+%28square+root+of+the+variance%29.%0A%EF%81%9A+This+has+no+effect+on+the+score+comparison%2C+because+the+average+will+not+change%0Aduring+planning.+It+is+just+more+work+to+implement+%28because+the+average+needs+to%0Abe+known%29+and+trivially+slower+%28because+the+calculation+is+a+bit+longer%29.%0AWhen+the+workload+is+perfectly+balanced%2C+the+user+often+likes+to+see+a+0+score%2C+instead+of+the%0Adistracting+-34soft+in+the+image+above+%28for+the+last+solution+which+is+almost+perfectly+balanced%29.+To%0Anullify+this%2C+either+add+the+average+multiplied+by+the+number+of+entities+to+the+score+or+instead+show%0Athe+variance+or+standard+deviation+in+the+UI.%0A5.5.+Explaining+the+Score%3A+Which+Constraints+Are%0ABroken%3F%0AThe+easiest+way+to+explain+the+score+during+development+is+to+print+the+return+value+of%0AexplainBestScore%28%29%2C+but+only+use+this+method+for+diagnostic+purposes%3A%0ASystem.out.println%28solver.explainBestScore%28%29%29%3B%0AFor+example+in+conference+scheduling%2C+this+prints+that+talk+S51+is+responsible+for+breaking+the+hard%0Aconstraint+Speaker+required+room+tag%3A%0A156%0AExplanation+of+score+%28-1hard%2F-806soft%29%3A%0A%C2%A0+++Constraint+match+totals%3A%0A%C2%A0+++++++-1hard%3A+constraint+%28Speaker+required+room+tag%29+has+1+matches%3A%0A%C2%A0+++++++++++-1hard%3A+justifications+%28%5BS51%5D%29%0A%C2%A0+++++++-340soft%3A+constraint+%28Theme+track+conflict%29+has+32+matches%3A%0A%C2%A0+++++++++++-20soft%3A+justifications+%28%5BS68%2C+S66%2C+ConferenceParametrization-0%5D%29%0A%C2%A0+++++++++++-20soft%3A+justifications+%28%5BS61%2C+S44%2C+ConferenceParametrization-0%5D%29%0A%C2%A0+++++++++++...%0A%C2%A0+++++++...%0A%C2%A0+++Indictments+%28top+5+of+72%29%3A%0A%C2%A0+++++++-1hard%2F-22soft%3A+justification+%28S51%29+has+12+matches%3A%0A%C2%A0+++++++++++-1hard%3A+constraint+%28Speaker+required+room+tag%29%0A%C2%A0+++++++++++-10soft%3A+constraint+%28Theme+track+conflict%29%0A%C2%A0+++++++++++...%0A%C2%A0+++++++...%0ADo+not+attempt+to+parse+this+string+or+use+it+in+your+UI+or+exposed+services.+Instead%0A%EF%81%AA+use+the+ConstraintMatch+API+below+and+do+it+properly.%0A5.5.1.+Using+Score+Calculation+Outside+the+Solver%0AIf+other+parts+of+your+application%2C+for+example+your+webUI%2C+need+to+calculate+the+score+of+a+solution%2C%0Areuse+the+ScoreDirectorFactory+of+the+Solver+to+build+a+separate+ScoreDirector+for+that+webUI%3A%0AScoreDirectorFactory%3CCloudBalance%3E+scoreDirectorFactory+%3D+solver%0A.getScoreDirectorFactory%28%29%3B%0Atry+%28ScoreDirector%3CCloudBalance%3E+guiScoreDirector+%3D+scoreDirectorFactory%0A.buildScoreDirector%28%29%29+%7B%0A%C2%A0+++...%0A%7D%0AThe+try+ARM+will+call+ScoreDirector.close%28%29+when+the+ScoreDirector+becomes%0A%EF%81%9A+useless%2C+to+avoid+a+memory+leak%2C+especially+with+Drools+score+calculation.%0AThen+use+it+when+you+need+to+calculate+the+Score+of+a+Solution%3A%0AguiScoreDirector.setWorkingSolution%28cloudBalance%29%3B%0AScore+score+%3D+guiScoreDirector.calculateScore%28%29%3B%0AFurthermore%2C+the+ScoreDirector+can+explain+the+score+through+constraint+match+totals+and%2For%0Aindictments%3A%0A157%0A5.5.2.+Constraint+Match+Total%3A+Break+down+the+Score+by+Constraint%0ATo+break+down+the+score+per+constraint+%28so+per+score+rule+with+Drools+score+calculation%29%2C+get+the%0AConstraintMatchTotals+from+the+ScoreDirector%3A%0Afor+%28ConstraintMatchTotal+constraintMatchTotal+%3A+guiScoreDirector%0A.getConstraintMatchTotals%28%29%29+%7B%0A%C2%A0+++String+constraintName+%3D+constraintMatchTotal.getConstraintName%28%29%3B%0A%C2%A0+++%2F%2F+The+score+impact+of+that+constraint%0A%C2%A0+++Score+scoreTotal+%3D+constraintMatchTotal.getScoreTotal%28%29%3B%0A%C2%A0+++for+%28ConstraintMatch+constraintMatch+%3A+constraintMatchTotal.getConstraintMatchSet%0A%28%29%29+%7B%0A%C2%A0+++++++List%3CObject%3E+justificationList+%3D+constraintMatch.getJustificationList%28%29%3B%0A%C2%A0+++++++Score+score+%3D+constraintMatch.getScore%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A%7D%0AEach+ConstraintMatchTotal+is+one+constraint+%28so+one+score+rule%29+and+has+a+part+of+the+overall+score.%0AThe+sum+of+ConstraintMatchTotal.getScoreTotal%28%29+equals+the+overall+score.%0A158%0ADrools+score+calculation+supports+constraint+matches+automatically%2C+but%0A%EF%81%9A+incremental+Java+score+calculation+requires+implementing+an+extra+interface.%0A5.5.3.+Indictment+Heat+Map%3A+Visualize+the+Hot+Planning+Entities%0ATo+show+a+heat+map+in+the+UI+that+highlights+the+planning+entities+and+problem+facts+have+an%0Aimpact+on+the+Score%2C+get+the+Indictment+map+from+the+ScoreDirector%3A%0AMap%3CObject%2C+Indictment%3E+indictmentMap+%3D+guiScoreDirector.getIndictmentMap%28%29%3B%0Afor+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++Indictment+indictment+%3D+indictmentMap.get%28process%29%3B%0A%C2%A0+++if+%28indictment+%3D%3D+null%29+%7B%0A%C2%A0+++++++continue%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+The+score+impact+of+that+planning+entity%0A%C2%A0+++Score+scoreTotal+%3D+indictment.getScoreTotal%28%29%3B%0A%C2%A0+++for+%28ConstraintMatch+constraintMatch+%3A+indictment.getConstraintMatchSet%28%29%29+%7B%0A%C2%A0+++++++String+constraintName+%3D+constraintMatch.getConstraintName%28%29%3B%0A%C2%A0+++++++Score+score+%3D+constraintMatch.getScore%28%29%3B%0A%C2%A0+++++++...%0A%C2%A0+++%7D%0A%7D%0AEach+Indictment+is+the+sum+of+all+constraints+where+that+justification+object+is+involved+with.+The%0Asum+of+Indictment.getScoreTotal%28%29+differs+from+the+overall+score%2C+because+multiple+Indictments+can%0Ashare+the+same+ConstraintMatch.%0ADrools+score+calculation+supports+indictments+and+constraint+matches%0A%EF%81%9A+automatically%2C+but+incremental+Java+score+calculation+requires+implementing+an%0Aextra+interface.%0A5.6.+Testing+score+constraints+with+JUnit%0AIt%E2%80%99s+recommended+to+write+a+unit+test+for+each+score+constraint+individually+to+check+that+it+behaves%0Acorrectly.%0AAdd+a+test+scoped+dependency+to+the+optaplanner-test+jar+to+take+advantage+of+the+JUnit+integration%0Aand+use+the+ScoreVerifier+classes+to+test+score+rules+in+DRL+%28or+a+constraint+match+aware%0Aincremental+score+calculator%29.+For+example%2C+suppose+we+want+to+test+these+score+rules%3A%0A159%0Aglobal+HardSoftScoreHolder+scoreHolder%3B%0Arule+%22requiredCpuPowerTotal%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addHardConstraintMatch%28...%29%3B%0Aend%0A...%0Arule+%22computerCost%22%0A%C2%A0+++when%0A%C2%A0+++++++...%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28...%29%3B%0Aend%0AFor+each+score+rule%2C+we+have+a+separate+%40Test+that+only+tests+the+effect+of+that+score+rule+on+the%0Ascore%3A%0Apublic+class+CloudBalancingScoreConstraintTest+%7B%0A%C2%A0+++private+HardSoftScoreVerifier%3CCloudBalance%3E+scoreVerifier+%3D+new%0AHardSoftScoreVerifier%3C%3E%28%0A%C2%A0+++++++++++SolverFactory.createFromXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Fsolver%2FcloudBalancingSolverConfig.xml%22%29%29%3B%0A%C2%A0+++%40Test%0A%C2%A0+++public+void+requiredCpuPowerTotal%28%29+%7B%0A%C2%A0+++++++CloudComputer+c1+%3D+new+CloudComputer%281L%2C+1000%2C+1%2C+1%2C+1%29%3B%0A%C2%A0+++++++CloudComputer+c2+%3D+new+CloudComputer%282L%2C+200%2C+1%2C+1%2C+1%29%3B%0A%C2%A0+++++++CloudProcess+p1+%3D+new+CloudProcess%281L%2C+700%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudProcess+p2+%3D+new+CloudProcess%282L%2C+70%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudBalance+solution+%3D+new+CloudBalance%280L%2C%0A%C2%A0+++++++++++++++Arrays.asList%28c1%2C+c2%29%2C%0A%C2%A0+++++++++++++++Arrays.asList%28p1%2C+p2%29%29%3B%0A%C2%A0+++++++%2F%2F+Uninitialized%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c1%29%3B%0A%C2%A0+++++++p2.setComputer%28c1%29%3B%0A%C2%A0+++++++%2F%2F+Usage+700+%2B+70+is+within+capacity+1000+of+c1%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c2%29%3B%0A%C2%A0+++++++p2.setComputer%28c2%29%3B%0A%C2%A0+++++++%2F%2F+Usage+700+%2B+70+is+above+capacity+200+of+c2%0A%C2%A0+++++++scoreVerifier.assertHardWeight%28%22requiredCpuPowerTotal%22%2C+-570%2C+solution%29%3B%0A%C2%A0+++%7D%0A160%0A%C2%A0+++...%0A%C2%A0+++%40Test%0A%C2%A0+++public+void+computerCost%28%29+%7B%0A%C2%A0+++++++CloudComputer+c1+%3D+new+CloudComputer%281L%2C+1%2C+1%2C+1%2C+200%29%3B%0A%C2%A0+++++++CloudComputer+c2+%3D+new+CloudComputer%282L%2C+1%2C+1%2C+1%2C+30%29%3B%0A%C2%A0+++++++CloudProcess+p1+%3D+new+CloudProcess%281L%2C+0%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudProcess+p2+%3D+new+CloudProcess%282L%2C+0%2C+0%2C+0%29%3B%0A%C2%A0+++++++CloudBalance+solution+%3D+new+CloudBalance%280L%2C%0A%C2%A0+++++++++++++++Arrays.asList%28c1%2C+c2%29%2C%0A%C2%A0+++++++++++++++Arrays.asList%28p1%2C+p2%29%29%3B%0A%C2%A0+++++++%2F%2F+Uninitialized%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+0%2C+solution%29%3B%0A%C2%A0+++++++p1.setComputer%28c1%29%3B%0A%C2%A0+++++++p2.setComputer%28c1%29%3B%0A%C2%A0+++++++%2F%2F+Pay+200+for+c1%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+-200%2C+solution%29%3B%0A%C2%A0+++++++p2.setComputer%28c2%29%3B%0A%C2%A0+++++++%2F%2F+Pay+200+%2B+30+for+c1+and+c2%0A%C2%A0+++++++scoreVerifier.assertSoftWeight%28%22computerCost%22%2C+-230%2C+solution%29%3B%0A%C2%A0+++%7D%0A%7D%0AThere+is+a+ScoreVerifier+implementation+for+each+Score+implementation.+In+the+assertHardWeight%28%29%0Aand+assertSoftWeight%28%29+methods%2C+the+weight+of+the+other+score+rules+is+ignored+%28even+those+of+the%0Asame+score+level%29.%0AA+ScoreVerifier+does+not+work+well+to+isolate+score+corruption%2C+use+an%0A%EF%81%9A+assertionScoreDirectorFactory+instead.%0A161%0AChapter+6.+Shadow+Variable%0A6.1.+Introduction%0AA+shadow+variable+is+a+planning+variable+whose+correct+value+can+be+deduced+from+the+state+of+the%0Agenuine+planning+variables.+Even+though+such+a+variable+violates+the+principle+of+normalization+by%0Adefinition%2C+in+some+use+cases+it+can+be+very+practical+to+use+a+shadow+variable%2C+especially+to+express%0Athe+constraints+more+naturally.+For+example+in+vehicle+routing+with+time+windows%3A+the+arrival+time%0Aat+a+customer+for+a+vehicle+can+be+calculated+based+on+the+previously+visited+customers+of+that%0Avehicle+%28and+the+known+travel+times+between+two+locations%29.%0AWhen+the+customers+for+a+vehicle+change%2C+the+arrival+time+for+each+customer+is+automatically%0Aadjusted.+For+more+information%2C+see+the+vehicle+routing+domain+model.%0AFrom+a+score+calculation+perspective%2C+a+shadow+variable+is+like+any+other+planning+variable.+From%0Aan+optimization+perspective%2C+Planner+effectively+only+optimizes+the+genuine+variables+%28and+mostly%0Aignores+the+shadow+variables%29%3A+it+just+assures+that+when+a+genuine+variable+changes%2C+any+dependent%0Ashadow+variables+are+changed+accordingly.%0A162%0AAny+class+that+has+at+least+one+shadow+variable%2C+is+a+planning+entity+class%0A%28even+if+it+has+no+genuine+planning+variables%29.+That+class+must+be+defined+in%0Athe+solver+configuration+%28unless+classes+are+automatically+scanned%29+and+have+a%0A%EF%81%AA+%40PlanningEntity+annotation.%0AA+genuine+planning+entity+class+has+at+least+one+genuine+planning+variable%2C+but+can%0Ahave+shadow+variables+too.+A+shadow+planning+entity+class+has+no+genuine%0Aplanning+variables+and+at+least+one+shadow+planning+variable.%0AThere+are+several+built-in+shadow+variables%3A%0A6.2.+Bi-directional+Variable+%28Inverse+Relation+Shadow%0AVariable%29%0ATwo+variables+are+bi-directional+if+their+instances+always+point+to+each+other+%28unless+one+side+points%0Ato+null+and+the+other+side+does+not+exist%29.+So+if+A+references+B%2C+then+B+references+A.%0AFor+a+non-chained+planning+variable%2C+the+bi-directional+relationship+must+be+a+many+to+one%0Arelationship.+To+map+a+bi-directional+relationship+between+two+planning+variables%2C+annotate+the%0Amaster+side+%28which+is+the+genuine+side%29+as+a+normal+planning+variable%3A%0A163%0A%40PlanningEntity%0Apublic+class+CloudProcess+%7B%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+CloudComputer+getComputer%28%29+%7B%0A%C2%A0+++++++return+computer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setComputer%28CloudComputer+computer%29+%7B...%7D%0A%7D%0AAnd+then+annotate+the+other+side+%28which+is+the+shadow+side%29+with+a+%40InverseRelationShadowVariable%0Aannotation+on+a+Collection+%28usually+a+Set+or+List%29+property%3A%0A%40PlanningEntity%0Apublic+class+CloudComputer+%7B%0A%C2%A0+++%40InverseRelationShadowVariable%28sourceVariableName+%3D+%22computer%22%29%0A%C2%A0+++public+List%3CCloudProcess%3E+getProcessList%28%29+%7B%0A%C2%A0+++++++return+processList%3B%0A%C2%A0+++%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.+The+sourceVariableName+property+is+the+name+of+the+genuine%0Aplanning+variable+on+the+return+type+of+the+getter+%28so+the+name+of+the+genuine+planning+variable+on%0Athe+other+side%29.%0AThe+shadow+property%2C+which+is+a+Collection%2C+can+never+be+null.+If+no+genuine%0Avariable+is+referencing+that+shadow+entity%2C+then+it+is+an+empty+Collection.%0A%EF%81%9A+Furthermore+it+must+be+a+mutable+Collection+because+once+the+Solver+starts%0Ainitializing+or+changing+genuine+planning+variables%2C+it+will+add+and+remove+to+the%0ACollections+of+those+shadow+variables+accordingly.%0AFor+a+chained+planning+variable%2C+the+bi-directional+relationship+is+always+a+one+to+one+relationship.%0AIn+that+case%2C+the+genuine+side+looks+like+this%3A%0A164%0A%40PlanningEntity%0Apublic+class+Customer+...+%7B%0A%C2%A0+++%40PlanningVariable%28graphType+%3D+PlanningVariableGraphType.CHAINED%2C+...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setPreviousStandstill%28Standstill+previousStandstill%29+%7B...%7D%0A%7D%0AAnd+the+shadow+side+looks+like+this%3A%0A%40PlanningEntity%0Apublic+class+Standstill+%7B%0A%C2%A0+++%40InverseRelationShadowVariable%28sourceVariableName+%3D+%22previousStandstill%22%29%0A%C2%A0+++public+Customer+getNextCustomer%28%29+%7B%0A%C2%A0++++++++return+nextCustomer%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+setNextCustomer%28Customer+nextCustomer%29+%7B...%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.%0AThe+input+planning+problem+of+a+Solver+must+not+violate+bi-directional%0A%EF%81%B1+relationships.+If+A+points+to+B%2C+then+B+must+point+to+A.+Planner+will+not+violate+that%0Aprinciple+during+planning%2C+but+the+input+must+not+violate+it+either.%0A6.3.+Anchor+Shadow+Variable%0AAn+anchor+shadow+variable+is+the+anchor+of+a+chained+variable.%0AAnnotate+the+anchor+property+as+a+%40AnchorShadowVariable+annotation%3A%0A%40PlanningEntity%0Apublic+class+Customer+%7B%0A%C2%A0+++%40AnchorShadowVariable%28sourceVariableName+%3D+%22previousStandstill%22%29%0A%C2%A0+++public+Vehicle+getVehicle%28%29+%7B...%7D%0A%C2%A0+++public+void+setVehicle%28Vehicle+vehicle%29+%7B...%7D%0A%7D%0ARegister+this+class+as+a+planning+entity.+The+sourceVariableName+property+is+the+name+of+the+chained%0A165%0Avariable+on+the+same+entity+class.%0A6.4.+Custom+VariableListener%0ATo+update+a+shadow+variable%2C+Planner+uses+a+VariableListener.+To+define+a+custom+shadow+variable%2C%0Awrite+a+custom+VariableListener%3A+implement+the+interface+and+annotate+it+on+the+shadow+variable%0Athat+needs+to+change.%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerClass+%3D+VehicleUpdatingVariableListener%0A.class%2C%0A%C2%A0+++++++++++sources+%3D+%7B%40PlanningVariableReference%28variableName+%3D+%22previousStandstill%22%0A%29%7D%29%0A%C2%A0+++public+Vehicle+getVehicle%28%29+%7B%0A%C2%A0+++++++return+vehicle%3B%0A%C2%A0+++%7D%0ARegister+this+class+as+a+planning+entity.+The+variableName+is+the+%28genuine+or+shadow%29+variable+that%0Atriggers+changes+to+this+shadow+variable.%0AIf+the+class+of+the+trigger+variable+is+different+than+the+shadow+variable%2C+also%0Aspecify+the+entityClass+on+%40PlanningVariableReference.+In+that+case%2C+make+sure+that%0A%EF%81%9A+entityClass+is+also+properly+configured+as+a+planning+entity+class+in+the+solver%0Aconfig%2C+or+the+VariableListener+will+simply+never+trigger.%0AFor+example%2C+the+VehicleUpdatingVariableListener+assures+that+every+Customer+in+a+chain+has+the%0Asame+Vehicle%2C+namely+the+chain%E2%80%99s+anchor.%0A166%0Apublic+class+VehicleUpdatingVariableListener+implements+VariableListener%3CCustomer%3E+%7B%0A%C2%A0+++public+void+afterEntityAdded%28ScoreDirector+scoreDirector%2C+Customer+customer%29+%7B%0A%C2%A0+++++++updateVehicle%28scoreDirector%2C+customer%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++public+void+afterVariableChanged%28ScoreDirector+scoreDirector%2C+Customer+customer%29+%7B%0A%C2%A0+++++++updateVehicle%28scoreDirector%2C+customer%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%C2%A0+++protected+void+updateVehicle%28ScoreDirector+scoreDirector%2C+Customer+sourceCustomer%29%0A%7B%0A%C2%A0+++++++Standstill+previousStandstill+%3D+sourceCustomer.getPreviousStandstill%28%29%3B%0A%C2%A0+++++++Vehicle+vehicle+%3D+previousStandstill+%3D%3D+null+%3F+null+%3A+previousStandstill%0A.getVehicle%28%29%3B%0A%C2%A0+++++++Customer+shadowCustomer+%3D+sourceCustomer%3B%0A%C2%A0+++++++while+%28shadowCustomer+%21%3D+null+%26%26+shadowCustomer.getVehicle%28%29+%21%3D+vehicle%29+%7B%0A%C2%A0+++++++++++scoreDirector.beforeVariableChanged%28shadowCustomer%2C+%22vehicle%22%29%3B%0A%C2%A0+++++++++++shadowCustomer.setVehicle%28vehicle%29%3B%0A%C2%A0+++++++++++scoreDirector.afterVariableChanged%28shadowCustomer%2C+%22vehicle%22%29%3B%0A%C2%A0+++++++++++shadowCustomer+%3D+shadowCustomer.getNextCustomer%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AA+VariableListener+can+only+change+shadow+variables.+It+must+never+change+a%0A%EF%81%B1+genuine+planning+variable+or+a+problem+fact.%0A%EF%81%B1+Any+change+of+a+shadow+variable+must+be+told+to+the+ScoreDirector.%0AIf+one+VariableListener+changes+two+shadow+variables+%28because+having+two+separate%0AVariableListeners+would+be+inefficient%29%2C+then+annotate+only+the+first+shadow+variable+with+the%0AvariableListenerClass+and+let+the+other+shadow+variable%28s%29+reference+the+first+shadow+variable%3A%0A167%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Standstill+getPreviousStandstill%28%29+%7B%0A%C2%A0+++++++return+previousStandstill%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerClass+%3D%0ATransportTimeAndCapacityUpdatingVariableListener.class%2C%0A%C2%A0+++++++++++sources+%3D+%7B%40PlanningVariableReference%28variableName+%3D+%22previousStandstill%22%0A%29%7D%29%0A%C2%A0+++public+Integer+getTransportTime%28%29+%7B%0A%C2%A0+++++++return+transportTime%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40CustomShadowVariable%28variableListenerRef+%3D+%40PlanningVariableReference%0A%28variableName+%3D+%22transportTime%22%29%29%0A%C2%A0+++public+Integer+getCapacity%28%29+%7B%0A%C2%A0+++++++return+capacity%3B%0A%C2%A0+++%7D%0A6.5.+VariableListener+triggering+order%0AAll+shadow+variables+are+triggered+by+a+VariableListener%2C+regardless+if+it%E2%80%99s+a+built-in+or+a+custom%0Ashadow+variable.+The+genuine+and+shadow+variables+form+a+graph%2C+that+determines+the+order+in%0Awhich+the+afterEntityAdded%28%29%2C+afterVariableChanged%28%29+and+afterEntityRemoved%28%29+methods+are+called%3A%0A168%0AIn+the+example+above%2C+D+could+have+also+been+ordered+after+E+%28or+F%29+because+there%0A%EF%81%9A+is+no+direct+or+indirect+dependency+between+D+and+E+%28or+F%29.%0APlanner+guarantees+that%3A%0A%E2%80%A2+The+first+VariableListener%27s+after*%28%29+methods+trigger+after+the+last+genuine+variable+has%0Achanged.+Therefore+the+genuine+variables+%28A+and+B+in+the+example+above%29+are+guaranteed+to+be%0Ain+a+consistent+state+across+all+its+instances+%28with+values+A1%2C+A2+and+B1+in+the+example+above%29%0Abecause+the+entire+Move+has+been+applied.%0A%E2%80%A2+The+second+VariableListener%27s+after*%28%29+methods+trigger+after+the+last+first+shadow+variable+has%0Achanged.+Therefore+the+first+shadow+variable+%28C+in+the+example+above%29+are+guaranteed+to+be+in%0Aconsistent+state+across+all+its+instances+%28with+values+C1+and+C2+in+the+example+above%29.+And+of%0Acourse+the+genuine+variables+too.%0A%E2%80%A2+And+so+forth.%0APlanner+does+not+guarantee+the+order+in+which+the+after*%28%29+methods+are+called+for+the%0AsameVariableListener+with+different+parameters+%28such+as+A1+and+A2+in+the+example+above%29%2C%0Aalthough+they+are+likely+to+be+in+the+order+in+which+they+were+affected.%0ABy+default%2C+Planner+does+not+guarantee+that+the+events+are+unique.+For+example%2C+if+a+shadow%0Avariable+on+an+entity+is+changed+twice+in+the+same+move+%28for+example+by+two+different+genuine%0Avariables%29%2C+then+that+will+cause+the+same+event+twice+on+the+VariableListeners+that+are+listening+to%0Athat+original+shadow+variable.+To+avoid+dealing+with+that+complexity%2C+overwrite+the+method%0A169%0ArequiresUniqueEntityEvents%28%29+to+receive+unique+events+at+the+cost+of+a+small+performance+penalty%3A%0Apublic+class+StartTimeUpdatingVariableListener+implements+VariableListener%3CTask%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+requiresUniqueEntityEvents%28%29+%7B%0A%C2%A0+++++++return+true%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A170%0AChapter+7.+Optimization+Algorithms%0A7.1.+Search+Space+Size+in+the+Real+World%0AThe+number+of+possible+solutions+for+a+planning+problem+can+be+mind+blowing.+For+example%3A%0A%E2%80%A2+Four+queens+has+256+possible+solutions+%284%5E4%29+and+two+optimal+solutions.%0A%E2%80%A2+Five+queens+has+3125+possible+solutions+%285%5E5%29+and+one+optimal+solution.%0A%E2%80%A2+Eight+queens+has+16777216+possible+solutions+%288%5E8%29+and+92+optimal+solutions.%0A%E2%80%A2+64+queens+has+more+than+10%5E115+possible+solutions+%2864%5E64%29.%0A%E2%80%A2+Most+real-life+planning+problems+have+an+incredible+number+of+possible+solutions+and+only+one%0Aor+a+few+optimal+solutions.%0AFor+comparison%3A+the+minimal+number+of+atoms+in+the+known+universe+%2810%5E80%29.+As+a+planning%0Aproblem+gets+bigger%2C+the+search+space+tends+to+blow+up+really+fast.+Adding+only+one+extra+planning%0Aentity+or+planning+value+can+heavily+multiply+the+running+time+of+some+algorithms.%0ACalculating+the+number+of+possible+solutions+depends+on+the+design+of+the+domain+model%3A%0A171%0AThis+search+space+size+calculation+includes+infeasible+solutions+%28if+they+can+be%0Arepresented+by+the+model%29%2C+because%3A%0A%E2%80%A2+The+optimal+solution+might+be+infeasible.%0A%EF%81%9A+%E2%80%A2+There+are+many+types+of+hard+constraints+that+cannot+be+incorporated+in+theformula+practically.+For+example%2C+in+Cloud+Balancing%2C+try+incorporating+the+CPU%0Acapacity+constraint+in+the+formula.%0AEven+in+cases+where+adding+some+of+the+hard+constraints+in+the+formula+is%0Apractical+%28for+example%2C+Course+Scheduling%29%2C+the+resulting+search+space+is+still+huge.%0AAn+algorithm+that+checks+every+possible+solution+%28even+with+pruning%2C+such+as+in+Branch+And+Bound%29%0Acan+easily+run+for+billions+of+years+on+a+single+real-life+planning+problem.+The+aim+is+to+find+the+best%0Asolution+in+the+available+timeframe.+Planning+competitions+%28such+as+the+International+Timetabling%0ACompetition%29+show+that+Local+Search+variations+%28Tabu+Search%2C+Simulated+Annealing%2C+Late%0AAcceptance%2C+%E2%80%A6%29+usually+perform+best+for+real-world+problems+given+real-world+time+limitations.%0A7.2.+Does+Planner+Find+the+Optimal+Solution%3F%0AThe+business+wants+the+optimal+solution%2C+but+they+also+have+other+requirements%3A%0A%E2%80%A2+Scale+out%3A+Large+production+data+sets+must+not+crash+and+have+also+good+results.%0A172%0A%E2%80%A2+Optimize+the+right+problem%3A+The+constraints+must+match+the+actual+business+needs.%0A%E2%80%A2+Available+time%3A+The+solution+must+be+found+in+time%2C+before+it+becomes+useless+to+execute.%0A%E2%80%A2+Reliability%3A+Every+data+set+must+have+at+least+a+decent+result+%28better+than+a+human+planner%29.%0AGiven+these+requirements%2C+and+despite+the+promises+of+some+salesmen%2C+it+is+usually+impossible+for%0Aanyone+or+anything+to+find+the+optimal+solution.+Therefore%2C+Planner+focuses+on+finding+the+best%0Asolution+in+available+time.+In+realistic%2C+independent+competitions%2C+it+often+comes+out+as+the+best%0Areusable+software.%0AThe+nature+of+NP-complete+problems+make+scaling+a+prime+concern.%0AThe+quality+of+a+result+from+a+small+data+set+is+no+indication+of+the+quality+of+a%0A%EF%81%9A+result+from+a+large+data+set.%0AScaling+issues+cannot+be+mitigated+by+hardware+purchases+later+on.+Start+testing+with+a+production%0Asized+data+set+as+soon+as+possible.+Do+not+assess+quality+on+small+data+sets+%28unless+production%0Aencounters+only+such+data+sets%29.+Instead%2C+solve+a+production+sized+data+set+and+compare+the+results%0Aof+longer+executions%2C+different+algorithms+and+-+if+available+-+the+human+planner.%0A7.3.+Architecture+Overview%0APlanner+is+the+first+framework+to+combine+optimization+algorithms+%28metaheuristics%2C+%E2%80%A6%29+with+score%0Acalculation+by+a+rule+engine+%28such+as+Drools+Expert%29.+This+combination+is+very+efficient%2C+because%3A%0A%E2%80%A2+A+rule+engine%2C+such+as+Drools+Expert%2C+is+great+for+calculating+the+score+of+a+solution+of+a%0Aplanning+problem.+It+makes+it+easy+and+scalable+to+add+additional+soft+or+hard+constraints+such%0Aas%2C+%22a+teacher+should+not+teach+more+then+seven+hours+a+day%22.+It+does+delta-based+score%0Acalculation+without+any+extra+code.+However+it+tends+to+be+not+suitable+to+actually+find+new%0Asolutions.%0A%E2%80%A2+An+optimization+algorithm+is+great+at+finding+new+improving+solutions+for+a+planning%0Aproblem%2C+without+necessarily+brute-forcing+every+possibility.+However%2C+it+needs+to+know+the%0Ascore+of+a+solution+and+offers+no+support+in+calculating+that+score+efficiently.%0A173%0A7.4.+Optimization+Algorithms+Overview%0APlanner+supports+three+families+of+optimization+algorithms%3A+Exhaustive+Search%2C+Construction%0AHeuristics+and+Metaheuristics.+In+practice%2C+Metaheuristics+%28in+combination+with+Construction%0AHeuristics+to+initialize%29+are+the+recommended+choice%3A%0A174%0AEach+of+these+algorithm+families+have+multiple+optimization+algorithms%3A%0ATable+4.+Optimization+Algorithms+Overview%0AAlgorithm+Scalable%3F+Optimal%3F+Easy+to+use%3F+Tweakable%3F+Requires+CH%3F%0AExhaustive+Search+%28ES%29%0A%C2%A0%C2%A0Brute+Force+0%2F5+5%2F5+5%2F5+0%2F5+No%0A%C2%A0%C2%A0Branch+And+0%2F5+5%2F5+4%2F5+2%2F5+No%0ABound%0AConstruction+heuristics+%28CH%29%0A%C2%A0%C2%A0First+Fit+5%2F5+1%2F5+5%2F5+1%2F5+No%0A%C2%A0%C2%A0First+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Weakest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0A%C2%A0%C2%A0Weakest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Strongest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0A%C2%A0%C2%A0Strongest+Fit+5%2F5+2%2F5+4%2F5+2%2F5+No%0ADecreasing%0A%C2%A0%C2%A0Cheapest+3%2F5+2%2F5+5%2F5+2%2F5+No%0AInsertion%0A175%0AAlgorithm+Scalable%3F+Optimal%3F+Easy+to+use%3F+Tweakable%3F+Requires+CH%3F%0A%C2%A0%C2%A0Regret+3%2F5+2%2F5+5%2F5+2%2F5+No%0AInsertion%0AMetaheuristics+%28MH%29%0A%C2%A0%C2%A0Local+Search+%28LS%29%0A%C2%A0%C2%A0%C2%A0%C2%A0Hill+Climbing+5%2F5+2%2F5+4%2F5+3%2F5+Yes%0A%C2%A0%C2%A0%C2%A0%C2%A0Tabu+Search+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0A%C2%A0%C2%A0%C2%A0%C2%A0Simulated+5%2F5+4%2F5+2%2F5+5%2F5+Yes%0AAnnealing%0A%C2%A0%C2%A0%C2%A0%C2%A0Late+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0AAcceptance%0A%C2%A0%C2%A0%C2%A0%C2%A0Step+5%2F5+4%2F5+3%2F5+5%2F5+Yes%0ACounting+Hill%0AClimbing%0A%C2%A0%C2%A0%C2%A0%C2%A0Variable+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0ANeighborhood%0ADescent%0A%C2%A0%C2%A0Evolutionary+Algorithms+%28EA%29%0A%C2%A0%C2%A0%C2%A0%C2%A0Evolutionary+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0AStrategies%0A%C2%A0%C2%A0%C2%A0%C2%A0Genetic+3%2F5+3%2F5+2%2F5+5%2F5+Yes%0AAlgorithms%0ATo+learn+more+about+metaheuristics%2C+see+Essentials+of+Metaheuristics+or+Clever+Algorithms.%0A7.5.+Which+Optimization+Algorithms+Should+I+Use%3F%0AThe+best+optimization+algorithms+configuration+to+use+depends+heavily+on+your+use+case.+However%2C%0Athis+basic+procedure+provides+a+good+starting+configuration+that+will+produce+better+than+average%0Aresults.%0A1.+Start+with+a+quick+configuration+that+involves+little+or+no+configuration+and+optimization+code%3A%0ASee+First+Fit.%0A2.+Next%2C+implement+planning+entity+difficulty+comparison+and+turn+it+into+First+Fit+Decreasing.%0A3.+Next%2C+add+Late+Acceptance+behind+it%3A%0Aa.+First+Fit+Decreasing.%0Ab.+Late+Acceptance.%0AAt+this+point%2C+the+return+on+invested+time+lowers+and+the+result+is+likely+to+be+sufficient.%0AHowever%2C+this+can+be+improved+at+a+lower+return+on+invested+time.+Use+the+Benchmarker+and+try+a%0Acouple+of+different+Tabu+Search%2C+Simulated+Annealing+and+Late+Acceptance+configurations%2C+for%0Aexample%3A%0A176%0A1.+First+Fit+Decreasing%3A+Tabu+Search.%0AUse+the+Benchmarker+to+improve+the+values+for+the+size+parameters.%0AOther+experiments+can+also+be+run.+For+example%2C+the+following+multiple+algorithms+can+be%0Acombined+together%3A%0A1.+First+Fit+Decreasing%0A2.+Late+Acceptance+%28relatively+long+time%29%0A3.+Tabu+Search+%28relatively+short+time%29%0A7.6.+Power+tweaking+or+default+parameter+values%0AMany+optimization+algorithms+have+parameters+that+affect+results+and+scalability.+Planner+applies%0Aconfiguration+by+exception%2C+so+all+optimization+algorithms+have+default+parameter+values.+This+is%0Avery+similar+to+the+Garbage+Collection+parameters+in+a+JVM%3A+most+users+have+no+need+to+tweak%0Athem%2C+but+power+users+often+do.%0AThe+default+parameter+values+are+sufficient+for+many+cases+%28and+especially+for+prototypes%29%2C+but+if%0Adevelopment+time+allows%2C+it+may+be+beneficial+to+power+tweak+them+with+the+benchmarker+for%0Abetter+results+and+scalability+on+a+specific+use+case.+The+documentation+for+each+optimization%0Aalgorithm+also+declares+the+advanced+configuration+for+power+tweaking.%0AThe+default+value+of+parameters+will+change+between+minor+versions%2C+to+improve%0A%EF%81%B1+them+for+most+users.+The+advanced+configuration+can+be+used+to+prevent%0Aunwanted+changes%2C+however%2C+this+is+not+recommended.%0A7.7.+Solver+Phase%0AA+Solver+can+use+multiple+optimization+algorithms+in+sequence.+Each+optimization+algorithm+is%0Arepresented+by+one+solver+Phase.+There+is+never+more+than+one+Phase+solving+at+the+same+time.%0ASome+Phase+implementations+can+combine+techniques+from+multiple+optimization%0A%EF%81%9A+algorithms%2C+but+it+is+still+just+one+Phase.+For+example%3A+a+Local+Search+Phase+can+do%0ASimulated+Annealing+with+entity+Tabu.%0AHere+is+a+configuration+that+runs+three+phases+in+sequence%3A%0A177%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...+%3C%21--+First+phase%3A+First+Fit+Decreasing+--%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...+%3C%21--+Second+phase%3A+Late+Acceptance+--%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...+%3C%21--+Third+phase%3A+Tabu+Search+--%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0AThe+solver+phases+are+run+in+the+order+defined+by+solver+configuration.%0A%E2%80%A2+When+the+first+Phase+terminates%2C+the+second+Phase+starts%2C+and+so+on.%0A%E2%80%A2+When+the+last+Phase+terminates%2C+the+Solver+terminates.%0AUsually%2C+a+Solver+will+first+run+a+construction+heuristic+and+then+run+one+or+multiple+metaheuristics%3A%0AIf+no+phases+are+configured%2C+Planner+will+default+to+a+Construction+Heuristic+phase+followed+by+a%0ALocal+Search+phase.%0A178%0ASome+phases+%28especially+construction+heuristics%29+will+terminate+automatically.+Other+phases%0A%28especially+metaheuristics%29+will+only+terminate+if+the+Phase+is+configured+to+terminate%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3Ctermination%3E%3C%21--+Solver+termination+--%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E90%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%3C%21--+Phase+termination+--%3E%0A%C2%A0+++++%3CsecondsSpentLimit%3E60%3C%2FsecondsSpentLimit%3E%3C%21--+Give+the+next+phase+a+chance+to%0Arun+too%2C+before+the+Solver+terminates+--%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0A%3C%2Fsolver%3E%0AIf+the+Solver+terminates+%28before+the+last+Phase+terminates+itself%29%2C+the+current+phase+is+terminated+and%0Aall+subsequent+phases+will+not+run.%0A7.8.+Scope+Overview%0AA+solver+will+iteratively+run+phases.+Each+phase+will+usually+iteratively+run+steps.+Each+step%2C+in+turn%2C%0Ausually+iteratively+runs+moves.+These+form+four+nested+scopes%3A%0A1.+Solver%0A2.+Phase%0A3.+Step%0A4.+Move%0A179%0AConfigure+logging+to+display+the+log+messages+of+each+scope.%0A7.9.+Termination%0ANot+all+phases+terminate+automatically+and+may+take+a+significant+amount+of+time.+A+Solver+can+be%0Aterminated+synchronously+by+up-front+configuration%2C+or+asynchronously+from+another+thread.%0AMetaheuristic+phases+in+particular+need+to+be+instructed+to+stop+solving.+This+can+be+because+of+a%0Anumber+of+reasons%2C+for+example%2C+if+the+time+is+up%2C+or+the+perfect+score+has+been+reached+just+before%0Aits+solution+is+used.+Finding+the+optimal+solution+cannot+be+relied+on+%28unless+you+know+the+optimal%0Ascore%29%2C+because+a+metaheuristic+algorithm+is+generally+unaware+of+the+optimal+solution.%0AThis+is+not+an+issue+for+real-life+problems%2C+as+finding+the+optimal+solution+may+take+more+time+than%0Ais+available.+Finding+the+best+solution+in+the+available+time+is+the+most+important+outcome.%0AIf+no+termination+is+configured+%28and+a+metaheuristic+algorithm+is+used%29%2C+the+Solver%0A%EF%81%AA+will+run+forever%2C+until+terminateEarly%28%29+is+called+from+another+thread.+This+is%0Aespecially+common+during+real-time+planning.%0AFor+synchronous+termination%2C+configure+a+Termination+on+a+Solver+or+a+Phase+when+it+needs+to+stop.%0AThe+built-in+implementations+of+these+should+be+sufficient%2C+but+custom+terminations+are+supported%0Atoo.+Every+Termination+can+calculate+a+time+gradient+%28needed+for+some+optimization+algorithms%29%2C%0Awhich+is+a+ratio+between+the+time+already+spent+solving+and+the+estimated+entire+solving+time+of+the%0A180%0ASolver+or+Phase.%0A7.9.1.+TimeMillisSpentTermination%0ATerminates+when+an+amount+of+time+has+been+used.%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CmillisecondsSpentLimit%3E500%3C%2FmillisecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CsecondsSpentLimit%3E10%3C%2FsecondsSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CminutesSpentLimit%3E5%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3ChoursSpentLimit%3E1%3C%2FhoursSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CdaysSpentLimit%3E2%3C%2FdaysSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AMultiple+time+types+can+be+used+together%2C+for+example+to+configure+150+minutes%2C+either+configure+it%0Adirectly%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CminutesSpentLimit%3E150%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AOr+use+a+combination+that+sums+up+to+150+minutes%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3ChoursSpentLimit%3E2%3C%2FhoursSpentLimit%3E%0A%C2%A0+++%3CminutesSpentLimit%3E30%3C%2FminutesSpentLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A181%0AThis+Termination+will+most+likely+sacrifice+perfect+reproducibility+%28even+with%0AenvironmentMode+REPRODUCIBLE%29+because+the+available+CPU+time+differs+frequently%0Abetween+runs%3A%0A%EF%81%9A+%E2%80%A2+The+available+CPU+time+influences+the+number+of+steps+that+can+be+taken%2Cwhich+might+be+a+few+more+or+less.%0A%E2%80%A2+The+Termination+might+produce+slightly+different+time+gradient+values%2C+which%0Awill+send+time+gradient-based+algorithms+%28such+as+Simulated+Annealing%29+on+a%0Aradically+different+path.%0A7.9.2.+UnimprovedTimeMillisSpentTermination%0ATerminates+when+the+best+score+has+not+improved+in+a+specified+amount+of+time.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedMillisecondsSpentLimit%3E500%3C%2FunimprovedMillisecondsSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedSecondsSpentLimit%3E10%3C%2FunimprovedSecondsSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedMinutesSpentLimit%3E5%3C%2FunimprovedMinutesSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedHoursSpentLimit%3E1%3C%2FunimprovedHoursSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedDaysSpentLimit%3E1%3C%2FunimprovedDaysSpentLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A182%0AThis+termination+should+not+be+applied+to+Construction+Heuristics+as+they+only+update+the+best%0Asolution+at+the+end.+Configuring+it+on+a+specific+Phase+%28such+as+%3ClocalSearch%3E%29%2C+instead+of+on+the%0ASolver+itself+may+be+a+better+option.%0AThis+Termination+will+most+likely+sacrifice+perfect+reproducibility+%28even+with%0AenvironmentMode+REPRODUCIBLE%29+as+the+available+CPU+time+differs+frequently+between%0Aruns%3A%0A%EF%81%9A+%E2%80%A2+The+available+CPU+time+influences+the+number+of+steps+that+can+be+taken%2Cwhich+might+be+a+few+more+or+less.%0A%E2%80%A2+The+Termination+might+produce+slightly+different+time+gradient+values%2C+which%0Awill+send+time+gradient+based+algorithms+%28such+as+Simulated+Annealing%29+on+a%0Aradically+different+path.%0A7.9.3.+BestScoreTermination%0ABestScoreTermination+terminates+when+a+certain+score+has+been+reached.+Use+this+Termination+where%0Athe+perfect+score+is+known%2C+for+example+for+four+queens+%28which+uses+a+SimpleScore%29%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E0%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AA+planning+problem+with+a+HardSoftScore+may+look+like+this%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E0hard%2F-5000soft%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AA+planning+problem+with+a+BendableScore+with+three+hard+levels+and+one+soft+level+may+look+like%0Athis%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreLimit%3E%5B0%2F0%2F0%5Dhard%2F%5B-5000%5Dsoft%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AIn+this+instance%2C+Termination+once+a+feasible+solution+has+been+reached+is+not+practical+because+it%0Arequires+a+bestScoreLimit+such+as+0hard%2F-2147483648soft.+Use+the+next+termination+instead.%0A7.9.4.+BestScoreFeasibleTermination%0ATerminates+as+soon+as+a+feasible+solution+has+been+discovered.+Requires+that+Score+implements%0AFeasibilityScore.%0A183%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CbestScoreFeasible%3Etrue%3C%2FbestScoreFeasible%3E%0A%C2%A0+%3C%2Ftermination%3E%0AThis+Termination+is+usually+combined+with+other+terminations.%0A7.9.5.+StepCountTermination%0ATerminates+when+a+number+of+steps+has+been+reached.+This+is+useful+for+hardware+performance%0Aindependent+runs.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CstepCountLimit%3E100%3C%2FstepCountLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AThis+Termination+can+only+be+used+for+a+Phase+%28such+as+%3ClocalSearch%3E%29%2C+not+for+the+Solver+itself.%0A7.9.6.+UnimprovedStepCountTermination%0ATerminates+when+the+best+score+has+not+improved+in+a+number+of+steps.+This+is+useful+for+hardware%0Aperformance+independent+runs.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3Ctermination%3E%0A%C2%A0+++++%3CunimprovedStepCountLimit%3E100%3C%2FunimprovedStepCountLimit%3E%0A%C2%A0+++%3C%2Ftermination%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AIf+the+score+has+not+improved+recently%2C+it+is+unlikely+to+improve+in+a+reasonable+timeframe.+It+has%0Abeen+observed+that+once+a+new+best+solution+is+found+%28even+after+a+long+time+without+improvement%0Aon+the+best+solution%29%2C+the+next+few+steps+tend+to+improve+the+best+solution.%0AThis+Termination+can+only+be+used+for+a+Phase+%28such+as+%3ClocalSearch%3E%29%2C+not+for+the+Solver+itself.%0A7.9.7.+ScoreCalculationCountTermination%0AScoreCalculationCountTermination+terminates+when+a+number+of+score+calculations+have+been%0Areached.+This+is+often+the+sum+of+the+number+of+moves+and+the+number+of+steps.+This+is+useful+for%0Abenchmarking.%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CscoreCalculationCountLimit%3E100000%3C%2FscoreCalculationCountLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0A184%0ASwitching+EnvironmentMode+can+heavily+impact+when+this+termination+ends.%0A7.9.8.+Combining+Multiple+Terminations%0ATerminations+can+be+combined%2C+for+example%3A+terminate+after+100+steps+or+if+a+score+of+0+has+been%0Areached%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CterminationCompositionStyle%3EOR%3C%2FterminationCompositionStyle%3E%0A%C2%A0+++%3CstepCountLimit%3E100%3C%2FstepCountLimit%3E%0A%C2%A0+++%3CbestScoreLimit%3E0%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AAlternatively+you+can+use+AND%2C+for+example%3A+terminate+after+reaching+a+feasible+score+of+at+least+-100%0Aand+no+improvements+in+5+steps%3A%0A%C2%A0+%3Ctermination%3E%0A%C2%A0+++%3CterminationCompositionStyle%3EAND%3C%2FterminationCompositionStyle%3E%0A%C2%A0+++%3CunimprovedStepCountLimit%3E5%3C%2FunimprovedStepCountLimit%3E%0A%C2%A0+++%3CbestScoreLimit%3E-100%3C%2FbestScoreLimit%3E%0A%C2%A0+%3C%2Ftermination%3E%0AThis+example+ensures+it+does+not+just+terminate+after+finding+a+feasible+solution%2C+but+also+completes%0Aany+obvious+improvements+on+that+solution+before+terminating.%0A7.9.9.+Asynchronous+Termination+from+Another+Thread%0AAsychronous+termination+from+another+thread+occurs+when+a+Solver+needs+to+be+terminated+early%0Afrom+another+thread%2C+for+example%2C+due+to+a+user+action+or+a+server+restart.+This+cannot+be%0Aconfigured+by+a+Termination+as+it+is+impossible+to+predict+when+and+if+it+will+occur.+Therefore+the%0ASolver+interface+has+the+following+thread-safe+methods%3A%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++boolean+terminateEarly%28%29%3B%0A%C2%A0+++boolean+isTerminateEarly%28%29%3B%0A%7D%0AWhen+calling+the+terminateEarly%28%29+method+from+another+thread%2C+the+Solver+will+terminate+at+its%0Aearliest+convenience+and+the+solve%28Solution%29+method+will+return+%28in+the+original+Solver+thread%29.%0A185%0AInterrupting+the+Solver+thread+%28which+is+the+thread+that+called%0ASolver.solve%28Solution%29%29+has+the+same+affect+as+calling+terminateEarly%28%29+except+that%0A%EF%81%9A+it+leaves+that+thread+in+the+interrupted+state.+This+guarantees+a+graceful+shutdown%0Awhen+an+ExecutorService+%28such+as+a+thread+pool%29+is+shutdown+because+that+only%0Ainterrupts+all+active+threads+in+the+pool.%0A7.10.+SolverEventListener%0AEach+time+a+new+best+solution+is+found%2C+a+new+BestSolutionChangedEvent+is+fired+in+the+Solver+thread.%0ATo+listen+to+such+events%2C+add+a+SolverEventListener+to+the+Solver%3A%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++void+addEventListener%28SolverEventListener%3CS%3E+eventListener%29%3B%0A%C2%A0+++void+removeEventListener%28SolverEventListener%3CS%3E+eventListener%29%3B%0A%7D%0AThe+BestSolutionChangedEvent%27s+newBestSolution+may+not+be+initialized+or+feasible.+Use+the%0AisFeasible%28%29+method+on+BestSolutionChangedEvent%27s+new+best+Score+to+detect+such+cases%3A%0A%C2%A0+++solver.addEventListener%28new+SolverEventListener%3CCloudBalance%3E%28%29+%7B%0A%C2%A0+++++++public+void+bestSolutionChanged%28BestSolutionChangedEvent%3CCloudBalance%3E+event%29%0A%7B%0A%C2%A0+++++++++++%2F%2F+Ignore+infeasible+%28including+uninitialized%29+solutions%0A%C2%A0+++++++++++if+%28event.getNewBestSolution%28%29.getScore%28%29.isFeasible%28%29%29+%7B%0A%C2%A0+++++++++++++++...%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%29%3B%0AUse+Score.isSolutionInitialized%28%29+instead+of+Score.isFeasible%28%29+to+only+ignore+uninitialized%0Asolutions%2C+but+also+accept+infeasible+solutions.%0AThe+bestSolutionChanged%28%29+method+is+called+in+the+solver%E2%80%99s+thread%2C+as+part+of%0A%EF%81%B1+Solver.solve%28%29.+So+it+should+return+quickly+to+avoid+slowing+down+the+solving.%0A7.11.+Custom+Solver+Phase%0ARun+a+custom+optimization+algorithm+between+phases+or+before+the+first+phase+to+initialize+the%0ASolution%2C+or+to+get+a+better+score+quickly.+You+will+still+want+to+reuse+the+score+calculation.+For%0Aexample%2C+to+implement+a+custom+Construction+Heuristic+without+implementing+an+entire+Phase.%0A186%0AMost+of+the+time%2C+a+custom+solver+phase+is+not+worth+the+development+time%0Ainvestment.+The+supported+Constructions+Heuristics+are+configurable+%28use+the%0A%EF%81%9A+Benchmarker+to+tweak+them%29%2C+Termination+aware+and+support+partially+initialized%0Asolutions+too.%0AThe+CustomPhaseCommand+interface+appears+as+follows%3A%0Apublic+interface+CustomPhaseCommand%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++void+changeWorkingSolution%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%7D%0AFor+example%2C+extend+AbstractCustomPhaseCommand+and+implement+the+changeWorkingSolution%28%29%0Amethod%3A%0Apublic+class+ToOriginalMachineSolutionInitializer+extends+AbstractCustomPhaseCommand%0A%3CMachineReassignment%3E+%7B%0A%C2%A0+++public+void+changeWorkingSolution%28ScoreDirector%3CMachineReassignment%3E%0AscoreDirector%29+%7B%0A%C2%A0+++++++MachineReassignment+machineReassignment+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++for+%28MrProcessAssignment+processAssignment+%3A+machineReassignment%0A.getProcessAssignmentList%28%29%29+%7B%0A%C2%A0+++++++++++scoreDirector.beforeVariableChanged%28processAssignment%2C+%22machine%22%29%3B%0A%C2%A0+++++++++++processAssignment.setMachine%28processAssignment.getOriginalMachine%28%29%29%3B%0A%C2%A0+++++++++++scoreDirector.afterVariableChanged%28processAssignment%2C+%22machine%22%29%3B%0A%C2%A0+++++++++++scoreDirector.triggerVariableListeners%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AAny+change+on+the+planning+entities+in+a+CustomPhaseCommand+must+be+notified+to+the%0A%EF%81%B1+ScoreDirector.%0ADo+not+change+any+of+the+problem+facts+in+a+CustomPhaseCommand.+That+will+corrupt%0Athe+Solver+because+any+previous+score+or+solution+was+for+a+different+problem.+To%0A%EF%81%9A+do+that%2C+read+about+repeated+planning+and+do+it+with+a+ProblemFactChange%0Ainstead.%0AConfigure+the+CustomPhaseCommand+in+the+solver+configuration%3A%0A187%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0%0A%3CcustomPhaseCommandClass%3Eorg.optaplanner.examples.machinereassignment.solver.solution.%0Ainitializer.ToOriginalMachineSolutionInitializer%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0A%C2%A0+...+%3C%21--+Other+phases+--%3E%0A%3C%2Fsolver%3E%0AConfigure+multiple+customPhaseCommandClass+instances+to+run+them+in+sequence.%0AIf+the+changes+of+a+CustomPhaseCommand+do+not+result+in+a+better+score%2C+the+best%0Asolution+will+not+be+changed+%28so+effectively+nothing+will+have+changed+for+the+next%0APhase+or+CustomPhaseCommand%29.+To+force+such+changes+anyway%2C+use%0AforceUpdateBestSolution%3A%0A%EF%81%AA%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0+++%3CcustomPhaseCommandClass%3E...MyCustomPhase%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+++%3CforceUpdateBestSolution%3Etrue%3C%2FforceUpdateBestSolution%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0AIf+the+Solver+or+a+Phase+wants+to+terminate+while+a+CustomPhaseCommand+is+still%0Arunning%2C+it+will+wait+to+terminate+until+the+CustomPhaseCommand+is+complete.+This%0A%EF%81%9A+may+take+a+significant+amount+of+time.+The+built-in+solver+phases+do+not+have+this%0Aissue.%0ATo+configure+values+of+a+CustomPhaseCommand+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+customProperties+element+and+use+custom%0Aproperties%3A%0A%C2%A0+%3CcustomPhase%3E%0A%C2%A0+++%3CcustomPhaseCommandClass%3E...MyCustomPhase%3C%2FcustomPhaseCommandClass%3E%0A%C2%A0+++%3CcustomProperties%3E%0A%C2%A0+++++%3CmySelectionSize%3E5%3C%2FmySelectionSize%3E%0A%C2%A0+++%3C%2FcustomProperties%3E%0A%C2%A0+%3C%2FcustomPhase%3E%0A7.12.+No+Change+Solver+Phase%0AIn+rare+cases%2C+it%E2%80%99s+useful+not+to+run+any+solver+phases.+But+by+default%2C+configuring+no+phase+will%0Atrigger+running+the+default+phases.+To+avoid+those%2C+configure+a+NoChangePhase%3A%0A188%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CnoChangePhase%2F%3E%0A%3C%2Fsolver%3E%0A7.13.+Multithreaded+Solving%0AThere+are+several+ways+of+doing+multithreaded+solving%3A%0A%E2%80%A2+Multitenancy%3A+solve+different+datasets+in+parallel%0A%E2%97%A6+The+SolverManager+will+make+it+even+easier+to+set+this+up%2C+in+a+future+version.%0A%E2%80%A2+Multi+bet+solving%3A+solve+1+dataset+with+multiple%2C+isolated+solvers+and+take+the+best+result.%0A%E2%97%A6+Not+recommended%3A+This+is+a+marginal+gain+for+a+high+cost+of+hardware+resources.%0A%E2%97%A6+Use+the+Benchmarker+during+development+to+determine+the+most+appropriate+algorithm%2C%0Aalthough+that%E2%80%99s+only+on+average.%0A%E2%97%A6+Use+multithreaded+incremental+solving+instead.%0A%E2%80%A2+Partitioned+Search%3A+Split+1+dataset+in+multiple+parts+and+solve+them+independently.%0A%E2%97%A6+Configure+a+Partitioned+Search.%0A%E2%80%A2+Multithreaded+incremental+solving%3A+solve+1+dataset+with+multiple+threads+without+sacrificing%0Aincremental+score+calculation.%0A%E2%97%A6+Donate+a+portion+of+your+CPU+cores+to+Planner+to+scale+up+the+score+calculation+speed+and%0Aget+the+same+results+in+fraction+of+the+time.%0A%E2%97%A6+Configure+multithreaded+incremental+solving.%0A189%0AA+logging+level+of+debug+or+trace+might+cause+congestion+multithreaded+solving+and%0A%EF%81%9A+slow+down+the+score+calculation+speed.%0A7.13.1.+Custom+Thread+Factory+%28WildFly%2C+Android%2C+GAE%2C+%E2%80%A6%29%0AThe+threadFactoryClass+allows+to+plug+in+a+custom+ThreadFactory+for+environments+where+arbitrary%0Athread+creation+should+be+avoided%2C+such+as+most+application+servers+%28including+WildFly%29%2C+Android%2C%0Aor+Google+App+Engine.%0AConfigure+the+ThreadFactory+on+the+solver+to+create+the+move+threads+and+the+Partition+Search%0Athreads+with+it%3A%0A%3Csolver%3E%0A%C2%A0+%3CthreadFactoryClass%3E...MyAppServerThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0A7.13.2.+Multithreaded+Incremental+Solving%0AEnable+multithreaded+incremental+solving+by+configuring+a+moveThreadCount%3A%0A190%0A%3Csolver%3E%0A%C2%A0+%3CmoveThreadCount%3EAUTO%3C%2FmoveThreadCount%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AThat+one+extra+line+heavily+improves+the+score+calculation+speed%2C+presuming+that+your+machine+has%0Aenough+free+CPU+cores.%0AAdvanced+configuration%3A%0A%3Csolver%3E%0A%C2%A0+%3CmoveThreadCount%3E4%3C%2FmoveThreadCount%3E%0A%C2%A0+%3CmoveThreadBufferSize%3E10%3C%2FmoveThreadBufferSize%3E%0A%C2%A0+%3CthreadFactoryClass%3E...MyAppServerThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0AA+moveThreadCount+of+4+saturates+almost+5+CPU+cores%3A+the+4+move+threads+fill+up+4+CPU+cores%0Acompletely+and+the+solver+thread+uses+most+of+another+CPU+core.%0AThe+following+moveThreadCounts+are+supported%3A%0A%E2%80%A2+NONE+%28default%29%3A+Don%E2%80%99t+run+any+move+threads.+Use+the+single+threaded+code.%0A%E2%80%A2+AUTO%3A+Let+Planner+decide+how+many+move+threads+to+run+in+parallel.+On+machines+or+containers%0Awith+little+or+no+CPUs%2C+this+falls+back+to+the+single+threaded+code.%0A%E2%80%A2+Static+number%3A+The+number+of+move+threads+to+run+in+parallel.%0A%3CmoveThreadCount%3E4%3C%2FmoveThreadCount%3E%0AThis+can+be+1+to+enforce+running+the+multithreaded+code+with+only+1+move+thread+%28which+is+less%0Aefficient+than+NONE%29.%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+move+threads+to+run+in+parallel.+It+can+use+the%0Avariable+availableProcessorCount.+For+example%3A%0A%3CmoveThreadCount%3E%28availableProcessorCount+%2F+2%29+%2B+1%3C%2FmoveThreadCount%3E%0AIt+is+counter-effective+to+set+a+moveThreadCount+that+is+higher+than+the+number+of+available+CPU+cores%2C%0Aas+that+will+slow+down+the+score+calculation+speed.+One+good+reason+to+do+it+anyway%2C+is+to+reproduce%0Aa+bug+of+a+high-end+production+machine.%0A191%0AMultithreaded+solving+is+still+reproducible%2C+as+long+as+the+resolved+moveThreadCount%0Ais+stable.+A+run+of+the+same+solver+configuration+on+2+machines+with+a+different%0A%EF%81%9A+number+of+CPUs%2C+is+still+reproducible%2C+unless+the+moveThreadCount+is+set+to+AUTO+or+a%0Afunction+of+availableProcessorCount.%0AThe+moveThreadBufferSize+power+tweaks+the+number+of+moves+that+are+selected+but+won%E2%80%99t+be%0Aforaged.+Setting+it+too+low+reduces+performance%2C+but+setting+it+too+high+too.+Unless+you%E2%80%99re+deeply%0Afamiliar+with+the+inner+workings+of+multithreaded+solving%2C+don%E2%80%99t+configure+this+parameter.%0ATo+run+in+an+environment+that+doesn%E2%80%99t+like+arbitrary+thread+creation%2C+use+threadFactoryClass+to+plug%0Ain+a+custom+thread+factory.%0A192%0AChapter+8.+Move+and+Neighborhood%0ASelection%0A8.1.+Move+and+Neighborhood+Introduction%0A8.1.1.+What+is+a+Move%3F%0AA+Move+is+a+change+%28or+set+of+changes%29+from+a+solution+A+to+a+solution+B.+For+example%2C+the+move+below%0Achanges+queen+C+from+row+0+to+row+2%3A%0AThe+new+solution+is+called+a+neighbor+of+the+original+solution%2C+because+it+can+be+reached+in+a+single%0AMove.+Although+a+single+move+can+change+multiple+queens%2C+the+neighbors+of+a+solution+should+always%0Abe+a+very+small+subset+of+all+possible+solutions.+For+example%2C+on+that+original+solution%2C+these+are+all%0Apossible+changeMove%27s%3A%0AIf+we+ignore+the+four+changeMove%27s+that+have+no+impact+and+are+therefore+not+doable%2C+we+can+see+that%0Anumber+of+moves+is+n+*+%28n+-+1%29+%3D+12.+This+is+far+less+than+the+number+of+possible+solutions%2C+which%0Ais+n+%5E+n+%3D+256.+As+the+problem+scales+out%2C+the+number+of+possible+moves+increases+far+less+than+the%0Anumber+of+possible+solutions.%0AYet%2C+in+four+changeMove%27s+or+less+we+can+reach+any+solution.+For+example+we+can+reach+a+very%0Adifferent+solution+in+three+changeMove%27s%3A%0A193%0AThere+are+many+other+types+of+moves+besides+changeMove%27s.+Many+move+types+are%0Aincluded+out-of-the-box%2C+but+you+can+also+implement+custom+moves.%0A%EF%81%9A%0AA+Move+can+affect+multiple+entities+or+even+create%2Fdelete+entities.+But+it+must+not%0Achange+the+problem+facts.%0AAll+optimization+algorithms+use+Move%27s+to+transition+from+one+solution+to+a+neighbor+solution.%0ATherefore%2C+all+the+optimization+algorithms+are+confronted+with+Move+selection%3A+the+craft+of+creating%0Aand+iterating+moves+efficiently+and+the+art+of+finding+the+most+promising+subset+of+random+moves%0Ato+evaluate+first.%0A8.1.2.+What+is+a+MoveSelector%3F%0AA+MoveSelector%27s+main+function+is+to+create+Iterator%3CMove%3E+when+needed.+An+optimization+algorithm%0Awill+iterate+through+a+subset+of+those+moves.%0AHere%E2%80%99s+an+example+how+to+configure+a+changeMoveSelector+for+the+optimization+algorithm+Local%0ASearch%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FlocalSearch%3E%0AOut+of+the+box%2C+this+works+and+all+properties+of+the+changeMoveSelector+are+defaulted+sensibly%0A%28unless+that+fails+fast+due+to+ambiguity%29.+On+the+other+hand%2C+the+configuration+can+be+customized%0Asignificantly+for+specific+use+cases.+For+example%3A+you+might+want+to+configure+a+filter+to+discard%0Apointless+moves.%0A8.1.3.+Subselecting+of+Entities%2C+Values+and+Other+Moves%0ATo+create+a+Move%2C+a+MoveSelector+needs+to+select+one+or+more+planning+entities+and%2For+planning%0Avalues+to+move.+Just+like+MoveSelectors%2C+EntitySelectors+and+ValueSelectors+need+to+support+a%0Asimilar+feature+set+%28such+as+scalable+just-in-time+selection%29.+Therefore%2C+they+all+implement+a+common%0Ainterface+Selector+and+they+are+configured+similarly.%0AA+MoveSelector+is+often+composed+out+of+EntitySelectors%2C+ValueSelectors+or+even+other%0AMoveSelectors%2C+which+can+be+configured+individually+if+desired%3A%0A194%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0ATogether%2C+this+structure+forms+a+Selector+tree%3A%0AThe+root+of+this+tree+is+a+MoveSelector+which+is+injected+into+the+optimization+algorithm%0Aimplementation+to+be+%28partially%29+iterated+in+every+step.%0A8.2.+Generic+MoveSelectors%0A195%0A8.2.1.+changeMoveSelector%0AFor+one+planning+variable%2C+the+ChangeMove+selects+one+planning+entity+and+one+planning+value+and%0Aassigns+the+entity%E2%80%99s+variable+to+that+value.%0ASimplest+configuration%3A%0A%C2%A0+++%3CchangeMoveSelector%2F%3E%0AIf+there+are+multiple+entity+classes+or+multiple+planning+variables+for+one+entity+class%2C+a+simple%0Aconfiguration+will+automatically+unfold+into+a+union+of+ChangeMove+selectors+for+every+planning%0Avariable.%0AAdvanced+configuration%3A%0A196%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AA+ChangeMove+is+the+finest+grained+move.%0AAlmost+every+moveSelector+configuration+injected+into+a+metaheuristic+algorithm%0Ashould+include+a+changeMoveSelector+or+a+custom+implementation.+This%0A%EF%81%AA+guarantees+that+every+possible+Solution+can+be+reached+through+applying+a%0Anumber+of+moves+in+sequence+%28not+taking+score+traps+into+account%29.+Of+course%2C%0Anormally+it+is+unioned+with+other%2C+more+coarse+grained+move+selectors.%0A8.2.2.+swapMoveSelector%0AThe+SwapMove+selects+two+different+planning+entities+and+swaps+the+planning+values+of+all+their%0Aplanning+variables.%0A197%0AAlthough+a+SwapMove+on+a+single+variable+is+essentially+just+two+ChangeMoves%2C+it%E2%80%99s+often+the+winning%0Astep+where+the+first+of+the+two+ChangeMoves+would+not+be+the+winning+step+because+it+leaves+the%0Asolution+in+a+state+with+broken+hard+constraints.+For+example%3A+swapping+the+room+of+two+lectures%0Adoesn%E2%80%99t+bring+the+solution+in+a+intermediate+state+where+both+lectures+are+in+the+same+room+which%0Abreaks+a+hard+constraint.%0ASimplest+configuration%3A%0A%C2%A0+++%3CswapMoveSelector%2F%3E%0AIf+there+are+multiple+entity+classes%2C+a+simple+configuration+will+automatically+unfold+into+a+union+of%0ASwapMove+selectors+for+every+entity+class.%0AAdvanced+configuration%3A%0A198%0A%C2%A0+++%3CswapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CsecondaryEntitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FsecondaryEntitySelector%3E%0A%C2%A0+++++%3CvariableNameInclude%3Eroom%3C%2FvariableNameInclude%3E%0A%C2%A0+++++%3CvariableNameInclude%3E...%3C%2FvariableNameInclude%3E%0A%C2%A0+++%3C%2FswapMoveSelector%3E%0AThe+secondaryEntitySelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0AentitySelector+are+swapped.%0AIf+one+or+more+variableNameInclude+properties+are+specified%2C+not+all+planning+variables+will+be%0Aswapped%2C+but+only+those+specified.+For+example+for+course+scheduling%2C+specifying+only%0AvariableNameInclude+room+will+make+it+only+swap+room%2C+not+period.%0A8.2.3.+pillarChangeMoveSelector%0AA+pillar+is+a+set+of+planning+entities+which+have+the+same+planning+value%28s%29+for+their+planning%0Avariable%28s%29.+The+PillarChangeMove+selects+one+entity+pillar+%28or+subset+of+those%29+and+changes+the+value%0Aof+one+variable+%28which+is+the+same+for+all+entities%29+to+another+value.%0A199%0AIn+the+example+above%2C+queen+A+and+C+have+the+same+value+%28row+0%29+and+are+moved+to+row+2.+Also+the%0Ayellow+and+blue+process+have+the+same+value+%28computer+Y%29+and+are+moved+to+computer+X.%0ASimplest+configuration%3A%0A%C2%A0+++%3CpillarChangeMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A200%0A%C2%A0+++%3CpillarChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CpillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CsubPillarEnabled%3Etrue%3C%2FsubPillarEnabled%3E%0A%C2%A0+++++++%3CminimumSubPillarSize%3E1%3C%2FminimumSubPillarSize%3E%0A%C2%A0+++++++%3CmaximumSubPillarSize%3E1000%3C%2FmaximumSubPillarSize%3E%0A%C2%A0+++++%3C%2FpillarSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FpillarChangeMoveSelector%3E%0AA+sub+pillar+is+a+subset+of+entities+that+share+the+same+value%28s%29+for+their+variable%28s%29.+For+example+if%0Aqueen+A%2C+B%2C+C+and+D+are+all+located+on+row+0%2C+they+are+a+pillar+and+%5BA%2C+D%5D+is+one+of+the+many+sub%0Apillars.+If+subPillarEnabled+%28defaults+to+true%29+is+false%2C+no+sub+pillars+are+selected.+If+sub+pillars+are%0Aenabled%2C+the+pillar+itself+is+also+included+and+the+properties+minimumSubPillarSize+%28defaults+to+1%29+and%0AmaximumSubPillarSize+%28defaults+to+infinity%29+limit+the+size+of+the+selected+%28sub%29+pillar.%0AThe+number+of+sub+pillars+of+a+pillar+is+exponential+to+the+size+of+the+pillar.+For%0A%EF%81%9A+example+a+pillar+of+size+32+has+%282%5E32+-+1%29+subpillars.+Therefore+a+pillarSelector%0Aonly+supports+JIT+random+selection+%28which+is+the+default%29.%0AThe+other+properties+are+explained+in+changeMoveSelector.%0A8.2.4.+pillarSwapMoveSelector%0AA+pillar+is+a+set+of+planning+entities+which+have+the+same+planning+value%28s%29+for+their+planning%0Avariable%28s%29.+The+PillarSwapMove+selects+two+different+entity+pillars+and+swaps+the+values+of+all+their%0Avariables+for+all+their+entities.%0A201%0ASimplest+configuration%3A%0A%C2%A0+++%3CpillarSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A202%0A%C2%A0+++%3CpillarSwapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CpillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CentityClass%3E...Lecture%3C%2FentityClass%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CsubPillarEnabled%3Etrue%3C%2FsubPillarEnabled%3E%0A%C2%A0+++++++%3CminimumSubPillarSize%3E1%3C%2FminimumSubPillarSize%3E%0A%C2%A0+++++++%3CmaximumSubPillarSize%3E1000%3C%2FmaximumSubPillarSize%3E%0A%C2%A0+++++%3C%2FpillarSelector%3E%0A%C2%A0+++++%3CsecondaryPillarSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FsecondaryPillarSelector%3E%0A%C2%A0+++++%3CvariableNameInclude%3Eroom%3C%2FvariableNameInclude%3E%0A%C2%A0+++++%3CvariableNameInclude%3E...%3C%2FvariableNameInclude%3E%0A%C2%A0+++%3C%2FpillarSwapMoveSelector%3E%0AThe+secondaryPillarSelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0ApillarSelector+are+swapped.%0AThe+other+properties+are+explained+in+swapMoveSelector+and+pillarChangeMoveSelector.%0A8.2.5.+tailChainSwapMoveSelector+or+2-opt+%28chained+variables+only%29%0AA+tailChain+is+a+set+of+planning+entities+with+a+chained+planning+variable+which+form+a+last+part+of+a%0Achain.+The+tailChainSwapMove+selects+a+tail+chain+and+swaps+it+with+the+tail+chain+of+another%0Aplanning+value+%28in+a+different+or+the+same+anchor+chain%29.+If+the+targeted+planning+value%2C+doesn%E2%80%99t%0Ahave+a+tail+chain%2C+it+swaps+with+nothing+%28resulting+in+a+change+like+move%29.+If+it+occurs+within+the%0Asame+anchor+chain%2C+a+partial+chain+reverse+occurs.+In+academic+papers%2C+this+is+often+called+a+2-opt%0Amove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CtailChainSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A203%0A%C2%A0+++%3CsubChainChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++++%3CnearbySelection%3E...%3C%2FnearbySelection%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FsubChainChangeMoveSelector%3E%0AThe+entitySelector+selects+the+start+of+the+tail+chain+that+is+being+moved.+The+valueSelector+selects%0Ato+where+that+tail+chain+is+moved.+If+it+has+a+tail+chain+itself%2C+that+is+moved+to+the+location+of+the%0Aoriginal+tail+chain.+It+uses+a+valueSelector+instead+of+a+secondaryEntitySelector+to+be+able+to+include%0Aall+possible+2opt+moves+%28such+as+moving+to+the+end+of+a+tail%29+and+to+work+correctly+with+nearby%0Aselection+%28because+of+asymmetric+distances+and+also+swapped+entity+distance+gives+an+incorrect%0Aselection+probability%29.%0AAlthough+subChainChangeMoveSelector+and+subChainSwapMoveSelector+include+almost%0A%EF%81%9A+every+possible+tailChainSwapMove%2C+experiments+have+shown+that+focusing+on%0AtailChainSwapMoves+increases+efficiency.%0A8.2.6.+subChainChangeMoveSelector+%28chained+variables+only%29%0AA+subChain+is+a+set+of+planning+entities+with+a+chained+planning+variable+which+form+part+of+a%0Achain.+The+subChainChangeMoveSelector+selects+a+subChain+and+moves+it+to+another+place+%28in+a%0Adifferent+or+the+same+anchor+chain%29.%0ASimplest+configuration%3A%0A%C2%A0+++%3CsubChainChangeMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A204%0A%C2%A0+++%3CsubChainChangeMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++%3CsubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsubChainSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3CselectReversingMoveToo%3Etrue%3C%2FselectReversingMoveToo%3E%0A%C2%A0+++%3C%2FsubChainChangeMoveSelector%3E%0AThe+subChainSelector+selects+a+number+of+entities%2C+no+less+than+minimumSubChainSize+%28defaults+to+1%29%0Aand+no+more+than+maximumSubChainSize+%28defaults+to+infinity%29.%0AIf+minimumSubChainSize+is+1+%28which+is+the+default%29%2C+this+selector+might+select+the+same%0Amove+as+a+ChangeMoveSelector%2C+at+a+far+lower+selection+probability+%28because+each%0Amove+type+has+the+same+selection+chance+by+default+%28not+every+move+instance%29+and%0Athere+are+far+more+SubChainChangeMove+instances+than+ChangeMove+instances%29.%0A%EF%81%9A+However%2C+don%E2%80%99t+just+remove+the+ChangeMoveSelector%2C+because+experiments+show%0Athat+it%E2%80%99s+good+to+focus+on+ChangeMoves.%0AFurthermore%2C+in+a+SubChainSwapMoveSelector%2C+setting+minimumSubChainSize+prevents%0Aswapping+a+subchain+of+size+1+with+a+subchain+of+at+least+size+2.%0AThe+selectReversingMoveToo+property+%28defaults+to+true%29+enables+selecting+the+reverse+of+every%0Asubchain+too.%0A8.2.7.+subChainSwapMoveSelector+%28chained+variables+only%29%0AThe+subChainSwapMoveSelector+selects+two+different+subChains+and+moves+them+to+another+place+in+a%0Adifferent+or+the+same+anchor+chain.%0ASimplest+configuration%3A%0A%C2%A0+++%3CsubChainSwapMoveSelector%2F%3E%0AAdvanced+configuration%3A%0A205%0A%C2%A0+++%3CsubChainSwapMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CentityClass%3E...Customer%3C%2FentityClass%3E%0A%C2%A0+++++%3CsubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsubChainSelector%3E%0A%C2%A0+++++%3CsecondarySubChainSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22previousStandstill%22%3E%0A%C2%A0+++++++++...%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++++%3CminimumSubChainSize%3E2%3C%2FminimumSubChainSize%3E%0A%C2%A0+++++++%3CmaximumSubChainSize%3E40%3C%2FmaximumSubChainSize%3E%0A%C2%A0+++++%3C%2FsecondarySubChainSelector%3E%0A%C2%A0+++++%3CselectReversingMoveToo%3Etrue%3C%2FselectReversingMoveToo%3E%0A%C2%A0+++%3C%2FsubChainSwapMoveSelector%3E%0AThe+secondarySubChainSelector+is+rarely+needed%3A+if+it+is+not+specified%2C+entities+from+the+same%0AsubChainSelector+are+swapped.%0AThe+other+properties+are+explained+in+subChainChangeMoveSelector.%0A8.3.+Combining+Multiple+MoveSelectors%0A8.3.1.+unionMoveSelector%0AA+unionMoveSelector+selects+a+Move+by+selecting+one+of+its+MoveSelector+children+to+supply+the+next%0AMove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AAdvanced+configuration%3A%0A206%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CselectorProbabilityWeightFactoryClass%3E%0A...ProbabilityWeightFactory%3C%2FselectorProbabilityWeightFactoryClass%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E...%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2F...MoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AThe+selectorProbabilityWeightFactory+determines+in+selectionOrder+RANDOM+how+often+a%0AMoveSelector+child+is+selected+to+supply+the+next+Move.+By+default%2C+each+MoveSelector+child+has+the%0Asame+chance+of+being+selected.%0A207%0AChange+the+fixedProbabilityWeight+of+such+a+child+to+select+it+more+often.+For+example%2C+the%0AunionMoveSelector+can+return+a+SwapMove+twice+as+often+as+a+ChangeMove%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E1.0%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CfixedProbabilityWeight%3E2.0%3C%2FfixedProbabilityWeight%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AThe+number+of+possible+ChangeMoves+is+very+different+from+the+number+of+possible+SwapMoves+and%0Afurthermore+it%E2%80%99s+problem+dependent.+To+give+each+individual+Move+the+same+selection+chance+%28as%0Aopposed+to+each+MoveSelector%29%2C+use+the+FairSelectorProbabilityWeightFactory%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0%0A%3CselectorProbabilityWeightFactoryClass%3Eorg.optaplanner.core.impl.heuristic.selector.co%0Ammon.decorator.FairSelectorProbabilityWeightFactory%3C%2FselectorProbabilityWeightFactoryC%0Alass%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.3.2.+cartesianProductMoveSelector%0AA+cartesianProductMoveSelector+selects+a+new+CompositeMove.+It+builds+that+CompositeMove+by+selecting%0Aone+Move+per+MoveSelector+child+and+adding+it+to+the+CompositeMove.%0ASimplest+configuration%3A%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++%3C...MoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0AAdvanced+configuration%3A%0A208%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3CignoreEmptyChildIterators%3Etrue%3C%2FignoreEmptyChildIterators%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3C...MoveSelector%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2F...MoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0AThe+ignoreEmptyChildIterators+property+%28true+by+default%29+will+ignore+every+empty+childMoveSelector%0Ato+avoid+returning+no+moves.+For+example%3A+a+cartesian+product+of+changeMoveSelector+A+and+B%2C+for%0Awhich+B+is+empty+%28because+all+it%E2%80%99s+entities+are+immovable%29+returns+no+move+if%0AignoreEmptyChildIterators+is+false+and+the+moves+of+A+if+ignoreEmptyChildIterators+is+true.%0ATo+enforce+that+two+child+selectors+use+the+same+entity+or+value+efficiently%2C+use+mimic+selection%2C+not%0Amove+filtering.%0A8.4.+EntitySelector%0ASimplest+configuration%3A%0A%C2%A0+++++%3CentitySelector%2F%3E%0AAdvanced+configuration%3A%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0+++++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++++%3CentityClass%3E%0Aorg.optaplanner.examples.curriculumcourse.domain.Lecture%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0AThe+entityClass+property+is+only+required+if+it+cannot+be+deduced+automatically+because+there+are%0Amultiple+entity+classes.%0A8.5.+ValueSelector%0ASimplest+configuration%3A%0A209%0A%C2%A0+++++%3CvalueSelector%2F%3E%0AAdvanced+configuration%3A%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%3E%0A%C2%A0+++++++...+%3C%21--+Normal+selector+properties+--%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0AThe+variableName+property+is+only+required+if+it+cannot+be+deduced+automatically+because+there+are%0Amultiple+variables+%28for+the+related+entity+class%29.%0AIn+exotic+Construction+Heuristic+configurations%2C+the+entityClass+from+the+EntitySelector+sometimes%0Aneeds+to+be+downcasted%2C+which+can+be+done+with+the+property+downcastEntityClass%3A%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22period%22%3E%0A%C2%A0+++++++%3CdowncastEntityClass%3E...LeadingExam%3C%2FdowncastEntityClass%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0AIf+a+selected+entity+cannot+be+downcasted%2C+the+ValueSelector+is+empty+for+that+entity.%0A8.6.+General+Selector+Features%0A8.6.1.+CacheType%3A+Create+Moves+Ahead+of+Time+or+Just+In+Time%0AA+Selector%27s+cacheType+determines+when+a+selection+%28such+as+a+Move%2C+an+entity%2C+a+value%2C+%E2%80%A6%29+is+created%0Aand+how+long+it+lives.%0AAlmost+every+Selector+supports+setting+a+cacheType%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AThe+following+cacheTypes+are+supported%3A%0A%E2%80%A2+JUST_IN_TIME+%28default%29%3A+Not+cached.+Construct+each+selection+%28Move%2C+%E2%80%A6%29+just+before+it%E2%80%99s+used.+This%0Ascales+up+well+in+memory+footprint.%0A%E2%80%A2+STEP%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+step+and+cache+them+in+a+list%0Afor+the+remainder+of+the+step.+This+scales+up+badly+in+memory+footprint.%0A%E2%80%A2+PHASE%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+solver+phase+and+cache+them%0Ain+a+list+for+the+remainder+of+the+phase.+Some+selections+cannot+be+phase+cached+because+the+list%0Achanges+every+step.+This+scales+up+badly+in+memory+footprint%2C+but+has+a+slight+performance%0Again.%0A210%0A%E2%80%A2+SOLVER%3A+Cached.+Create+each+selection+%28Move%2C+%E2%80%A6%29+at+the+beginning+of+a+Solver+and+cache+them+in+a%0Alist+for+the+remainder+of+the+Solver.+Some+selections+cannot+be+solver+cached+because+the+list%0Achanges+every+step.+This+scales+up+badly+in+memory+footprint%2C+but+has+a+slight+performance%0Again.%0AA+cacheType+can+be+set+on+composite+selectors+too%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0ANested+selectors+of+a+cached+selector+cannot+be+configured+to+be+cached+themselves%2C+unless+it%E2%80%99s+a%0Ahigher+cacheType.+For+example%3A+a+STEP+cached+unionMoveSelector+can+hold+a+PHASE+cached%0AchangeMoveSelector%2C+but+not+a+STEP+cached+changeMoveSelector.%0A8.6.2.+SelectionOrder%3A+Original%2C+Sorted%2C+Random%2C+Shuffled+or+Probabilistic%0AA+Selector%27s+selectionOrder+determines+the+order+in+which+the+selections+%28such+as+Moves%2C+entities%2C%0Avalues%2C+%E2%80%A6%29+are+iterated.+An+optimization+algorithm+will+usually+only+iterate+through+a+subset+of+its%0AMoveSelector%27s+selections%2C+starting+from+the+start%2C+so+the+selectionOrder+is+critical+to+decide+which%0AMoves+are+actually+evaluated.%0AAlmost+every+Selector+supports+setting+a+selectionOrder%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AThe+following+selectionOrders+are+supported%3A%0A%E2%80%A2+ORIGINAL%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+default+order.+Each+selection+will+be%0Aselected+only+once.%0A%E2%97%A6+For+example%3A+A0%2C+A1%2C+A2%2C+A3%2C+%E2%80%A6%2C+B0%2C+B1%2C+B2%2C+B3%2C+%E2%80%A6%2C+C0%2C+C1%2C+C2%2C+C3%2C+%E2%80%A6%0A%E2%80%A2+SORTED%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+sorted+order.+Each+selection+will+be%0Aselected+only+once.+Requires+cacheType+%3E%3D+STEP.+Mostly+used+on+an+entitySelector+or%0AvalueSelector+for+construction+heuristics.+See+sorted+selection.%0A%E2%97%A6+For+example%3A+A0%2C+B0%2C+C0%2C+%E2%80%A6%2C+A2%2C+B2%2C+C2%2C+%E2%80%A6%2C+A1%2C+B1%2C+C1%2C+%E2%80%A6%0A%E2%80%A2+RANDOM+%28default%29%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+non-shuffled+random%0Aorder.+A+selection+might+be+selected+multiple+times.+This+scales+up+well+in+performance+because%0Ait+does+not+require+caching.%0A211%0A%E2%97%A6+For+example%3A+C2%2C+A3%2C+B1%2C+C2%2C+A0%2C+C0%2C+%E2%80%A6%0A%E2%80%A2+SHUFFLED%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+shuffled+random+order.+Each%0Aselection+will+be+selected+only+once.+Requires+cacheType+%3E%3D+STEP.+This+scales+up+badly+in%0Aperformance%2C+not+just+because+it+requires+caching%2C+but+also+because+a+random+number+is%0Agenerated+for+each+element%2C+even+if+it%E2%80%99s+not+selected+%28which+is+the+grand+majority+when+scaling%0Aup%29.%0A%E2%97%A6+For+example%3A+C2%2C+A3%2C+B1%2C+A0%2C+C0%2C+%E2%80%A6%0A%E2%80%A2+PROBABILISTIC%3A+Select+the+selections+%28Moves%2C+entities%2C+values%2C+%E2%80%A6%29+in+random+order%2C+based+on+the%0Aselection+probability+of+each+element.+A+selection+with+a+higher+probability+has+a+higher+chance%0Ato+be+selected+than+elements+with+a+lower+probability.+A+selection+might+be+selected+multiple%0Atimes.+Requires+cacheType+%3E%3D+STEP.+Mostly+used+on+an+entitySelector+or+valueSelector.+See%0Aprobabilistic+selection.%0A%E2%97%A6+For+example%3A+B1%2C+B1%2C+A1%2C+B2%2C+B1%2C+C2%2C+B1%2C+B1%2C+%E2%80%A6%0AA+selectionOrder+can+be+set+on+composite+selectors+too.%0AWhen+a+Selector+is+cached%2C+all+of+its+nested+Selectors+will+naturally+default+to%0A%EF%81%9A+selectionOrder+ORIGINAL.+Avoid+overwriting+the+selectionOrder+of+those+nested%0ASelectors.%0A8.6.3.+Recommended+Combinations+of+CacheType+and+SelectionOrder%0A8.6.3.1.+Just+in+Time+Random+Selection+%28default%29%0AThis+combination+is+great+for+big+use+cases+%2810+000+entities+or+more%29%2C+as+it+scales+up+well+in+memory%0Afootprint+and+performance.+Other+combinations+are+often+not+even+viable+on+such+sizes.+It+works%0Afor+smaller+use+cases+too%2C+so+it%E2%80%99s+a+good+way+to+start+out.+It%E2%80%99s+the+default%2C+so+this+explicit+configuration%0Aof+cacheType+and+selectionOrder+is+actually+obsolete%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EJUST_IN_TIME%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AHere%E2%80%99s+how+it+works.+When+Iterator%3CMove%3E.next%28%29+is+called%2C+a+child+MoveSelector+is+randomly%0Aselected+%281%29%2C+which+creates+a+random+Move+%282%2C+3%2C+4%29+and+is+then+returned+%285%29%3A%0A212%0ANotice+that+it+never+creates+a+list+of+Moves+and+it+generates+random+numbers+only+for+Moves+that+are%0Aactually+selected.%0A8.6.3.2.+Cached+Shuffled+Selection%0AThis+combination+often+wins+for+small+and+medium+use+cases+%285000+entities+or+less%29.+Beyond+that%0Asize%2C+it+scales+up+badly+in+memory+footprint+and+performance.%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESHUFFLED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AHere%E2%80%99s+how+it+works%3A+At+the+start+of+the+phase+%28or+step+depending+on+the+cacheType%29%2C+all+moves+are%0Acreated+%281%29+and+cached+%282%29.+When+MoveSelector.iterator%28%29+is+called%2C+the+moves+are+shuffled+%283%29.%0AWhen+Iterator%3CMove%3E.next%28%29+is+called%2C+the+next+element+in+the+shuffled+list+is+returned+%284%29%3A%0A213%0ANotice+that+each+Move+will+only+be+selected+once%2C+even+though+they+are+selected+in+random+order.%0AUse+cacheType+PHASE+if+none+of+the+%28possibly+nested%29+Selectors+require+STEP.+Otherwise%2C+do%0Asomething+like+this%3A%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3ESTEP%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESHUFFLED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3CpillarSwapMoveSelector%2F%3E%3C%21--+Does+not+support+cacheType+PHASE+--%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.6.3.3.+Cached+Random+Selection%0AThis+combination+is+often+a+worthy+competitor+for+medium+use+cases%2C+especially+with+fast+stepping%0Aoptimization+algorithms+%28such+as+Simulated+Annealing%29.+Unlike+cached+shuffled+selection%2C+it+doesn%E2%80%99t%0Awaste+time+shuffling+the+moves+list+at+the+beginning+of+every+step.%0A214%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ERANDOM%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A8.6.4.+Filtered+Selection%0AThere+can+be+certain+moves+that+you+don%E2%80%99t+want+to+select%2C+because%3A%0A%E2%80%A2+The+move+is+pointless+and+would+only+waste+CPU+time.+For+example%2C+swapping+two+lectures+of%0Athe+same+course+will+result+in+the+same+score+and+the+same+schedule+because+all+lectures+of+one%0Acourse+are+interchangeable+%28same+teacher%2C+same+students%2C+same+topic%29.%0A%E2%80%A2+Doing+the+move+would+break+a+built-in+hard+constraint%2C+so+the+solution+would+be+infeasible+but%0Athe+score+function+doesn%E2%80%99t+check+built-in+hard+constraints+%28for+performance+gain%29.+For+example%2C%0Adon%E2%80%99t+change+a+gym+lecture+to+a+room+which+is+not+a+gym+room.%0AAny+built-in+hard+constraint+must+probably+be+filtered+on+every+move+type+of%0Aevery+solver+phase.+For+example+if+it+filters+the+change+move+of+Local+Search%2C+it%0Amust+also+filter+the+swap+move+that+swaps+the+room+of+a+gym+lecture+with%0A%EF%81%9A+another+lecture+for+which+the+other+lecture%E2%80%99s+original+room+isn%E2%80%99t+a+gym+room.%0AFurthermore%2C+it+must+also+filter+the+change+moves+of+the+Construction%0AHeuristics+%28which+requires+an+advanced+configuration%29.%0AIf+a+move+is+unaccepted+by+the+filter%2C+it%E2%80%99s+not+executed+and+the+score+isn%E2%80%99t+calculated.%0A215%0AFiltering+uses+the+interface+SelectionFilter%3A%0Apublic+interface+SelectionFilter%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++boolean+accept%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+T+selection%29%3B%0A%7D%0AImplement+the+accept+method+to+return+false+on+a+discarded+selection+%28see+below%29.+Filtered%0Aselection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+works+with+any+cacheType+and+selectionOrder.%0AApply+the+filter+on+the+lowest+level+possible.+In+most+cases%2C+you%E2%80%99ll+need+to+know%0A%EF%81%9A+both+the+entity+and+the+value+involved+so+you%E2%80%99ll+have+to+apply+it+on+the+move%0Aselector.%0A8.6.4.1.+Filtered+Move+Selection%0AUnaccepted+moves+will+not+be+selected+and+will+therefore+never+have+their+doMove%28%29+method+called%3A%0A216%0Apublic+class+DifferentCourseSwapMoveFilter+implements+SelectionFilter%3CSwapMove%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector+scoreDirector%2C+SwapMove+move%29+%7B%0A%C2%A0+++++++Lecture+leftLecture+%3D+%28Lecture%29+move.getLeftEntity%28%29%3B%0A%C2%A0+++++++Lecture+rightLecture+%3D+%28Lecture%29+move.getRightEntity%28%29%3B%0A%C2%A0+++++++return+%21leftLecture.getCourse%28%29.equals%28rightLecture.getCourse%28%29%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+moveSelector+%28potentially+both+in+the+Local+Search+and%0Athe+Construction+Heuristics+if+it+filters+ChangeMoves%29%3A%0A%C2%A0+++%3CswapMoveSelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.DifferentCourseSwap%0AMoveFilter%3C%2FfilterClass%3E%0A%C2%A0+++%3C%2FswapMoveSelector%3E%0AYou+can+configure+multiple+filterClass+elements+on+a+single+move+selector.%0A8.6.4.2.+Filtered+Entity+Selection%0AUnaccepted+entities+will+not+be+selected+and+will+therefore+never+be+used+to+create+a+move.%0Apublic+class+LongLectureSelectionFilter+implements+SelectionFilter%3CLecture%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CCourseSchedule%3E+scoreDirector%2C+Lecture%0Alecture%29+%7B%0A%C2%A0+++++++return+lecture.isLong%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+entitySelector+%28potentially+both+in+the+Local+Search%0Aand+the+Construction+Heuristics%29%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CentitySelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.LongLectureSelectio%0AnFilter%3C%2FfilterClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A217%0AIf+that+filter+should+apply+on+all+entities%2C+configure+it+as+a+global+movableEntitySelectionFilter%0Ainstead.%0AYou+can+configure+multiple+filterClass+elements+on+a+single+entity+selector.%0A8.6.4.3.+Filtered+Value+Selection%0AUnaccepted+values+will+not+be+selected+and+will+therefore+never+be+used+to+create+a+move.%0Apublic+class+LongPeriodSelectionFilter+implements+SelectionFilter%3CPeriod%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CCourseSchedule%3E+scoreDirector%2C+Period+period%29%0A%7B%0A%C2%A0+++++++return+period%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AConfigure+the+filterClass+on+every+targeted+valueSelector+%28potentially+both+in+the+Local+Search+and%0Athe+Construction+Heuristics%29%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector%3E%0A%C2%A0%0A%3CfilterClass%3Eorg.optaplanner.examples.curriculumcourse.solver.move.LongPeriodSelection%0AFilter%3C%2FfilterClass%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0AYou+can+configure+multiple+filterClass+elements+on+a+single+value+selector.%0A8.6.5.+Sorted+Selection%0ASorted+selection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+does+not+work+with+cacheType+JUST_IN_TIME+and+it+only+works%0Awith+selectionOrder+SORTED.%0AIt%E2%80%99s+mostly+used+in+construction+heuristics.%0AIf+the+chosen+construction+heuristic+implies+sorting%2C+for+example%0AFIRST_FIT_DECREASING+implies+that+the+EntitySelector+is+sorted%2C+there+is+no+need+to%0A%EF%81%9A+explicitly+configure+a+Selector+with+sorting.+If+you+do+explicitly+configure+the%0ASelector%2C+it+overwrites+the+default+settings+of+that+construction+heuristic.%0A8.6.5.1.+Sorted+Selection+by+SorterManner%0ASome+Selector+types+implement+a+SorterManner+out+of+the+box%3A%0A218%0A%E2%80%A2+EntitySelector+supports%3A%0A%E2%97%A6+DECREASING_DIFFICULTY%3A+Sorts+the+planning+entities+according+to+decreasing+planning+entity%0Adifficulty.+Requires+that+planning+entity+difficulty+is+annotated+on+the+domain+model.%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A%E2%80%A2+ValueSelector+supports%3A%0A%E2%97%A6+INCREASING_STRENGTH%3A+Sorts+the+planning+values+according+to+increasing+planning+value%0Astrength.+Requires+that+planning+value+strength+is+annotated+on+the+domain+model.%0A%C2%A0+++%3CvalueSelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++%3C%2FvalueSelector%3E%0A8.6.5.2.+Sorted+Selection+by+Comparator%0AAn+easy+way+to+sort+a+Selector+is+with+a+plain+old+Comparator%3A%0Apublic+class+CloudProcessDifficultyComparator+implements+Comparator%3CCloudProcess%3E+%7B%0A%C2%A0+++public+int+compare%28CloudProcess+a%2C+CloudProcess+b%29+%7B%0A%C2%A0+++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++.append%28a.getRequiredMultiplicand%28%29%2C+b.getRequiredMultiplicand%28%29%29%0A%C2%A0+++++++++++++++.append%28a.getId%28%29%2C+b.getId%28%29%29%0A%C2%A0+++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++%7D%0A%7D%0AYou%E2%80%99ll+also+need+to+configure+it+%28unless+it%E2%80%99s+annotated+on+the+domain+model+and+automatically%0Aapplied+by+the+optimization+algorithm%29%3A%0A219%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterComparatorClass%3E%0A...CloudProcessDifficultyComparator%3C%2FsorterComparatorClass%3E%0A%C2%A0+++++%3CsorterOrder%3EDESCENDING%3C%2FsorterOrder%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A8.6.5.3.+Sorted+Selection+by+SelectionSorterWeightFactory%0AIf+you+need+the+entire+Solution+to+sort+a+Selector%2C+use+a+SelectionSorterWeightFactory+instead%3A%0Apublic+interface+SelectionSorterWeightFactory%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++Comparable+createSorterWeight%28Solution_+solution%2C+T+selection%29%3B%0A%7D%0A220%0Apublic+class+QueenDifficultyWeightFactory+implements+SelectionSorterWeightFactory%0A%3CNQueens%2C+Queen%3E+%7B%0A%C2%A0+++public+QueenDifficultyWeight+createSorterWeight%28NQueens+nQueens%2C+Queen+queen%29+%7B%0A%C2%A0+++++++int+distanceFromMiddle+%3D+calculateDistanceFromMiddle%28nQueens.getN%28%29%2C+queen%0A.getColumnIndex%28%29%29%3B%0A%C2%A0+++++++return+new+QueenDifficultyWeight%28queen%2C+distanceFromMiddle%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%C2%A0+++public+static+class+QueenDifficultyWeight+implements+Comparable%0A%3CQueenDifficultyWeight%3E+%7B%0A%C2%A0+++++++private+final+Queen+queen%3B%0A%C2%A0+++++++private+final+int+distanceFromMiddle%3B%0A%C2%A0+++++++public+QueenDifficultyWeight%28Queen+queen%2C+int+distanceFromMiddle%29+%7B%0A%C2%A0+++++++++++this.queen+%3D+queen%3B%0A%C2%A0+++++++++++this.distanceFromMiddle+%3D+distanceFromMiddle%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++public+int+compareTo%28QueenDifficultyWeight+other%29+%7B%0A%C2%A0+++++++++++return+new+CompareToBuilder%28%29%0A%C2%A0+++++++++++++++++++%2F%2F+The+more+difficult+queens+have+a+lower+distance+to+the+middle%0A%C2%A0+++++++++++++++++++.append%28other.distanceFromMiddle%2C+distanceFromMiddle%29+%2F%2F%0ADecreasing%0A%C2%A0+++++++++++++++++++%2F%2F+Tie+breaker%0A%C2%A0+++++++++++++++++++.append%28queen.getColumnIndex%28%29%2C+other.queen.getColumnIndex%28%29%29%0A%C2%A0+++++++++++++++++++.toComparison%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%7D%0AYou%E2%80%99ll+also+need+to+configure+it+%28unless+it%E2%80%99s+annotated+on+the+domain+model+and+automatically%0Aapplied+by+the+optimization+algorithm%29%3A%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterWeightFactoryClass%3E%0A...QueenDifficultyWeightFactory%3C%2FsorterWeightFactoryClass%3E%0A%C2%A0+++++%3CsorterOrder%3EDESCENDING%3C%2FsorterOrder%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A221%0A8.6.5.4.+Sorted+Selection+by+SelectionSorter%0AAlternatively%2C+you+can+also+use+the+interface+SelectionSorter+directly%3A%0Apublic+interface+SelectionSorter%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++void+sort%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+List%3CT%3E+selectionList%29%3B%0A%7D%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CsorterClass%3E...MyEntitySorter%3C%2FsorterClass%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0A8.6.6.+Probabilistic+Selection%0AProbabilistic+selection+can+happen+on+any+Selector+in+the+selector+tree%2C+including+any+MoveSelector%2C%0AEntitySelector+or+ValueSelector.+It+does+not+work+with+cacheType+JUST_IN_TIME+and+it+only+works%0Awith+selectionOrder+PROBABILISTIC.%0A222%0AEach+selection+has+a+probabilityWeight%2C+which+determines+the+chance+that+selection+will+be+selected%3A%0Apublic+interface+SelectionProbabilityWeightFactory%3CSolution_%2C+T%3E+%7B%0A%C2%A0+++double+createProbabilityWeight%28ScoreDirector%3CSolution_%3E+scoreDirector%2C+T%0Aselection%29%3B%0A%7D%0A%C2%A0+++%3CentitySelector%3E%0A%C2%A0+++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++%3CselectionOrder%3EPROBABILISTIC%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CprobabilityWeightFactoryClass%3E%0A...MyEntityProbabilityWeightFactoryClass%3C%2FprobabilityWeightFactoryClass%3E%0A%C2%A0+++%3C%2FentitySelector%3E%0AFor+example%2C+if+there+are+three+entities%3A+process+A+%28probabilityWeight+2.0%29%2C+process+B%0A%28probabilityWeight+0.5%29+and+process+C+%28probabilityWeight+0.5%29%2C+then+process+A+will+be+selected+four%0Atimes+more+than+B+and+C.%0A8.6.7.+Limited+Selection%0ASelecting+all+possible+moves+sometimes+does+not+scale+well+enough%2C+especially+for+construction%0Aheuristics+%28which+don%E2%80%99t+support+acceptedCountLimit%29.%0ATo+limit+the+number+of+selected+selection+per+step%2C+apply+a+selectedCountLimit+on+the+selector%3A%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CselectedCountLimit%3E100%3C%2FselectedCountLimit%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0ATo+scale+Local+Search%2C+setting+acceptedCountLimit+is+usually+better+than+using%0A%EF%81%9A+selectedCountLimit.%0A8.6.8.+Mimic+Selection+%28Record%2FReplay%29%0ADuring+mimic+selection%2C+one+normal+selector+records+its+selection+and+one+or+multiple+other+special%0Aselectors+replay+that+selection.+The+recording+selector+acts+as+a+normal+selector+and+supports+all%0Aother+configuration+properties.+A+replaying+selector+mimics+the+recording+selection+and+supports+no%0Aother+configuration+properties.%0AThe+recording+selector+needs+an+id.+A+replaying+selector+must+reference+a+recorder%E2%80%99s+id+with+a%0AmimicSelectorRef%3A%0A223%0A%C2%A0+++++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++++%3CentitySelector+id%3D%22entitySelector%22%2F%3E%0A%C2%A0+++++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++++%3CentitySelector+mimicSelectorRef%3D%22entitySelector%22%2F%3E%0A%C2%A0+++++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3C%2FcartesianProductMoveSelector%3E%0AMimic+selection+is+useful+to+create+a+composite+move+from+two+moves+that+affect+the+same+entity.%0A8.6.9.+Nearby+Selection%0AIn+some+use+cases+%28such+as+TSP+and+VRP%2C+but+also+in+non-chained+variable+cases%29%2C+changing+entities%0Ato+nearby+values+or+swapping+nearby+entities+can+heavily+increase+scalability+and+improve%0Asolution+quality.%0ANearby+selection+increases+the+probability+of+selecting+an+entity+or+value+which+is+nearby+to+the+first%0Aentity+being+moved+in+that+move.%0A224%0AThe+distance+between+two+entities+or+values+is+domain+specific.+Therefore%2C+implement+the%0ANearbyDistanceMeter+interface%3A%0Apublic+interface+NearbyDistanceMeter%3CO%2C+D%3E+%7B%0A%C2%A0+++double+getNearbyDistance%28O+origin%2C+D+destination%29%3B%0A%7D%0AIt+returns+a+double+which+represents+the+distance%3A%0Apublic+class+CustomerNearbyDistanceMeter+implements+NearbyDistanceMeter%3CCustomer%2C%0AStandstill%3E+%7B%0A%C2%A0+++public+double+getNearbyDistance%28Customer+origin%2C+Standstill+destination%29+%7B%0A%C2%A0+++++++return+origin.getDistanceTo%28destination%29%3B%0A%C2%A0+++%7D%0A%7D%0ATo+configure+nearby+selection%2C+add+a+nearbySelection+element+in+the+entitySelector+or+valueSelector%0Aand+use+mimic+selection+to+specify+which+entity+should+be+near+by+the+selection.%0A225%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector1%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector1%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CswapMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector2%22%2F%3E%0A%C2%A0+++++++%3CsecondaryEntitySelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector2%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FsecondaryEntitySelector%3E%0A%C2%A0+++++%3C%2FswapMoveSelector%3E%0A%C2%A0+++++%3CtailChainSwapMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22entitySelector3%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CnearbySelection%3E%0A%C2%A0+++++++++++%3CoriginEntitySelector+mimicSelectorRef%3D%22entitySelector3%22%2F%3E%0A%C2%A0+++++++++++%3CnearbyDistanceMeterClass%3E%0A...CustomerNearbyDistanceMeter%3C%2FnearbyDistanceMeterClass%3E%0A%C2%A0+++++++++++%3CparabolicDistributionSizeMaximum%3E40%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+++++++++%3C%2FnearbySelection%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FtailChainSwapMoveSelector%3E%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0AA+distributionSizeMaximum+parameter+should+not+be+1+because+if+the+nearest+is+already+the+planning%0Avalue+of+the+current+entity%2C+then+the+only+move+that+is+selectable+is+not+doable.%0ATo+allow+every+element+to+be+selected%2C+regardless+of+the+number+of+entities%2C+only+set+the+distribution%0Atype+%28so+without+a+distributionSizeMaximum+parameter%29%3A%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CnearbySelectionDistributionType%3E%0APARABOLIC_DISTRIBUTION%3C%2FnearbySelectionDistributionType%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0AThe+following+NearbySelectionDistributionTypes+are+supported%3A%0A226%0A%E2%80%A2+BLOCK_DISTRIBUTION%3A+Only+the+n+nearest+are+selected%2C+with+an+equal+probability.+For+example%2C%0Aselect+the+20+nearest%3A%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CblockDistributionSizeMaximum%3E20%3C%2FblockDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+LINEAR_DISTRIBUTION%3A+Nearest+elements+are+selected+with+a+higher+probability.+The+probability%0Adecreases+linearly.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3ClinearDistributionSizeMaximum%3E40%3C%2FlinearDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+PARABOLIC_DISTRIBUTION+%28recommended%29%3A+Nearest+elements+are+selected+with+a+higher%0Aprobability.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CparabolicDistributionSizeMaximum%3E80%3C%2FparabolicDistributionSizeMaximum%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0A%E2%80%A2+BETA_DISTRIBUTION%3A+Selection+according+to+a+beta+distribution.+Slows+down+the+solver%0Asignificantly.%0A%C2%A0+%3CnearbySelection%3E%0A%C2%A0+++%3CbetaDistributionAlpha%3E1%3C%2FbetaDistributionAlpha%3E%0A%C2%A0+++%3CbetaDistributionBeta%3E5%3C%2FbetaDistributionBeta%3E%0A%C2%A0+%3C%2FnearbySelection%3E%0AAs+always%2C+use+the+Benchmarker+to+tweak+values+if+desired.%0A8.7.+Custom+Moves%0A8.7.1.+Which+Move+Types+Might+be+Missing+in+my+Implementation%3F%0ATo+determine+which+move+types+might+be+missing+in+your+implementation%2C+run+a+Benchmarker+for%0Aa+short+amount+of+time+and+configure+it+to+write+the+best+solutions+to+disk.+Take+a+look+at+such+a+best%0Asolution%3A+it+will+likely+be+a+local+optima.+Try+to+figure+out+if+there%E2%80%99s+a+move+that+could+get+out+of+that%0Alocal+optima+faster.%0AIf+you+find+one%2C+implement+that+coarse-grained+move%2C+mix+it+with+the+existing+moves+and%0Abenchmark+it+against+the+previous+configurations+to+see+if+you+want+to+keep+it.%0A227%0A8.7.2.+Custom+Moves+Introduction%0AInstead+of+using+the+generic+Moves+%28such+as+ChangeMove%29+you+can+also+implement+your+own+Move.%0AGeneric+and+custom+MoveSelectors+can+be+combined+as+desired.%0AA+custom+Move+can+be+tailored+to+work+to+the+advantage+of+your+constraints.+For+example+in%0Aexamination+scheduling%2C+changing+the+period+of+an+exam+A+would+also+change+the+period+of+all+the%0Aother+exams+that+need+to+coincide+with+exam+A.%0AA+custom+Move+is+also+slightly+faster+than+a+generic+Move.+However%2C+it%E2%80%99s+far+more+work+to+implement%0Aand+much+harder+to+avoid+bugs.+After+implementing+a+custom+Move%2C+turn+on+environmentMode%0AFULL_ASSERT+to+check+for+score+corruptions.%0A8.7.3.+The+Interface+Move%0AAll+moves+implement+the+Move+interface%3A%0Apublic+interface+Move%3CSolution_%3E+%7B%0A%C2%A0+++boolean+isMoveDoable%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Move%3CSolution_%3E+doMove%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++...%0A%7D%0ATo+implement+a+custom+move%2C+it%E2%80%99s+recommended+to+extend+AbstractMove+instead+implementing+Move%0Adirectly.+Planner+calls+AbstractMove.doMove%28ScoreDirector%29%2C+which+calls%0AdoMoveOnGenuineVariables%28ScoreDirector%29.+For+example+in+cloud+balancing%2C+this+move+changes+one%0Aprocess+to+another+computer%3A%0A228%0Apublic+class+CloudComputerChangeMove+extends+AbstractMove%3CCloudBalance%3E+%7B%0A%C2%A0+++private+CloudProcess+cloudProcess%3B%0A%C2%A0+++private+CloudComputer+toCloudComputer%3B%0A%C2%A0+++public+CloudComputerChangeMove%28CloudProcess+cloudProcess%2C+CloudComputer%0AtoCloudComputer%29+%7B%0A%C2%A0+++++++this.cloudProcess+%3D+cloudProcess%3B%0A%C2%A0+++++++this.toCloudComputer+%3D+toCloudComputer%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++protected+void+doMoveOnGenuineVariables%28ScoreDirector%3CCloudBalance%3E+scoreDirector%29%0A%7B%0A%C2%A0+++++++scoreDirector.beforeVariableChanged%28cloudProcess%2C+%22computer%22%29%3B%0A%C2%A0+++++++cloudProcess.setComputer%28toCloudComputer%29%3B%0A%C2%A0+++++++scoreDirector.afterVariableChanged%28cloudProcess%2C+%22computer%22%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%2F%2F+...%0A%7D%0AThe+implementation+must+notify+the+ScoreDirector+of+any+changes+it+makes+to+planning+entity%E2%80%99s%0Avariables%3A+Call+the+scoreDirector.beforeVariableChanged%28Object%2C+String%29+and%0AscoreDirector.afterVariableChanged%28Object%2C+String%29+methods+directly+before+and+after+modifying%0Aan+entity%E2%80%99s+planning+variable.%0AThe+example+move+above+is+a+fine-grained+move+because+it+changes+only+one+planning+variable.+On%0Athe+other+hand%2C+a+coarse-grained+move+changes+multiple+entities+or+multiple+planning+variables+in+a%0Asingle+move%2C+usually+to+avoid+breaking+hard+constraints+by+making+multiple+related+changes+at%0Aonce.+For+example%2C+a+swap+move+is+really+just+two+change+moves%2C+but+it+keeps+those+two+changes%0Atogether.%0AA+Move+can+only+change%2Fadd%2Fremove+planning+entities%2C+it+must+not+change+any+of%0A%EF%81%B1+the+problem+facts+as+that+will+cause+score+corruption.+Use+real-time+planning+to%0Achange+problem+facts+while+solving.%0APlanner+automatically+filters+out+non+doable+moves+by+calling+the+isMoveDoable%28ScoreDirector%29%0Amethod+on+each+selected+move.+A+non+doable+move+is%3A%0A%E2%80%A2+A+move+that+changes+nothing+on+the+current+solution.+For+example%2C+moving+process+P1+on%0Acomputer+X+to+computer+X+is+not+doable%2C+because+it+is+already+there.%0A%E2%80%A2+A+move+that+is+impossible+to+do+on+the+current+solution.+For+example%2C+moving+process+P1+to%0Acomputer+Q+%28when+Q+isn%E2%80%99t+in+the+list+of+computers%29+is+not+doable+because+it+would+assign+a%0Aplanning+value+that%E2%80%99s+not+inside+the+planning+variable%E2%80%99s+value+range.%0AIn+the+cloud+balancing+example%2C+a+move+which+assigns+a+process+to+the+computer+it%E2%80%99s+already%0A229%0Aassigned+to+is+not+doable%3A%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+isMoveDoable%28ScoreDirector%3CCloudBalance%3E+scoreDirector%29+%7B%0A%C2%A0+++++++return+%21Objects.equals%28cloudProcess.getComputer%28%29%2C+toCloudComputer%29%3B%0A%C2%A0+++%7D%0AWe+don%E2%80%99t+need+to+check+if+toCloudComputer+is+in+the+value+range%2C+because+we+only+generate+moves+for%0Awhich+that+is+the+case.+A+move+that+is+currently+not+doable+can+become+doable+when+the+working%0ASolution+changes+in+a+later+step%2C+otherwise+we+probably+shouldn%E2%80%99t+have+created+it+in+the+first+place.%0AEach+move+has+an+undo+move%3A+a+move+%28normally+of+the+same+type%29+which+does+the+exact+opposite.+In%0Athe+cloud+balancing+example+the+undo+move+of+P1+%7BX+%E2%86%92+Y%7D+is+the+move+P1+%7BY+%E2%86%92+X%7D.+The+undo+move%0Aof+a+move+is+created+when+the+Move+is+being+done+on+the+current+solution%2C+before+the+genuine%0Avariables+change%3A%0A%C2%A0+++%40Override%0A%C2%A0+++public+CloudComputerChangeMove+createUndoMove%28ScoreDirector%3CCloudBalance%3E%0AscoreDirector%29+%7B%0A%C2%A0+++++++return+new+CloudComputerChangeMove%28cloudProcess%2C+cloudProcess.getComputer%28%29%29%3B%0A%C2%A0+++%7D%0ANotice+that+if+P1+would+have+already+been+moved+to+Y%2C+the+undo+move+would+create+the+move+P1+%7BY%0A%E2%86%92+Y%7D%2C+instead+of+the+move+P1+%7BY+%E2%86%92+X%7D.%0AA+solver+phase+might+do+and+undo+the+same+Move+more+than+once.+In+fact%2C+many+solver+phases+will%0Aiteratively+do+and+undo+a+number+of+moves+to+evaluate+them%2C+before+selecting+one+of+those+and%0Adoing+that+move+again+%28without+undoing+it+the+last+time%29.%0AA+Move+must+also+implement+the+getPlanningEntities%28%29+and+getPlanningValues%28%29+methods.+Those+are%0Aused+by+entity+tabu+and+value+tabu+respectively.+They+are+called+after+the+Move+has+already+been%0Adone.%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningEntities%28%29+%7B%0A%C2%A0+++++++return+Collections.singletonList%28cloudProcess%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningValues%28%29+%7B%0A%C2%A0+++++++return+Collections.singletonList%28toCloudComputer%29%3B%0A%C2%A0+++%7D%0AIf+the+Move+changes+multiple+planning+entities%2C+such+as+in+a+swap+move%2C+return+all+of+them+in%0AgetPlanningEntities%28%29+and+return+all+their+values+%28to+which+they+are+changing%29+in%0AgetPlanningValues%28%29.%0A230%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningEntities%28%29+%7B%0A%C2%A0+++++++return+Arrays.asList%28leftCloudProcess%2C+rightCloudProcess%29%3B%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+Collection%3C%3F+extends+Object%3E+getPlanningValues%28%29+%7B%0A%C2%A0+++++++return+Arrays.asList%28leftCloudProcess.getComputer%28%29%2C+rightCloudProcess%0A.getComputer%28%29%29%3B%0A%C2%A0+++%7D%0AA+Move+must+implement+the+equals%28%29+and+hashCode%28%29+methods+for+move+tabu.+Two+moves+which%0Amake+the+same+change+on+a+solution%2C+should+be+equal+ideally.%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+equals%28Object+o%29+%7B%0A%C2%A0+++++++if+%28this+%3D%3D+o%29+%7B%0A%C2%A0+++++++++++return+true%3B%0A%C2%A0+++++++%7D+else+if+%28o+instanceof+CloudComputerChangeMove%29+%7B%0A%C2%A0+++++++++++CloudComputerChangeMove+other+%3D+%28CloudComputerChangeMove%29+o%3B%0A%C2%A0+++++++++++return+new+EqualsBuilder%28%29%0A%C2%A0+++++++++++++++++++.append%28cloudProcess%2C+other.cloudProcess%29%0A%C2%A0+++++++++++++++++++.append%28toCloudComputer%2C+other.toCloudComputer%29%0A%C2%A0+++++++++++++++++++.isEquals%28%29%3B%0A%C2%A0+++++++%7D+else+%7B%0A%C2%A0+++++++++++return+false%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A%C2%A0+++%40Override%0A%C2%A0+++public+int+hashCode%28%29+%7B%0A%C2%A0+++++++return+new+HashCodeBuilder%28%29%0A%C2%A0+++++++++++++++.append%28cloudProcess%29%0A%C2%A0+++++++++++++++.append%28toCloudComputer%29%0A%C2%A0+++++++++++++++.toHashCode%28%29%3B%0A%C2%A0+++%7D%0ANotice+that+it+checks+if+the+other+move+is+an+instance+of+the+same+move+type.+This+instanceof+check%0Ais+important+because+a+move+will+be+compared+to+a+move+with+another+move+type+if+you+have%0Amultiple+move+selectors.%0AImplement+the+toString%28%29+method+to+keep+Planner%E2%80%99s+logs+readable%3A%0A%C2%A0+++public+String+toString%28%29+%7B%0A%C2%A0+++++++return+cloudProcess+%2B+%22+%7B%22+%2B+cloudProcess.getComputer%28%29+%2B+%22+-%3E+%22+%2B%0AtoCloudComputer+%2B+%22%7D%22%3B%0A%C2%A0+++%7D%0A231%0ANow%2C+let%E2%80%99s+generate+instances+of+this+custom+Move+class.%0ACustom+MoveListFactory+and+MoveIteratorFactory+implementations+must+ensure%0A%EF%81%B1+that+they+do+not+move+immovable+entities.%0A8.7.4.+MoveListFactory%3A+the+Easy+Way+to+Generate+Custom+Moves%0AThe+easiest+way+to+generate+custom+moves+is+by+implementing+the+interface+MoveListFactory%3A%0Apublic+interface+MoveListFactory%3CSolution_%3E+%7B%0A%C2%A0+++List%3CMove%3E+createMoveList%28Solution_+solution%29%3B%0A%7D%0AFor+example%3A%0Apublic+class+CloudComputerChangeMoveFactory+implements+MoveListFactory%3CCloudBalance%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+List%3CCloudComputerChangeMove%3E+createMoveList%28CloudBalance+cloudBalance%29+%7B%0A%C2%A0+++++++List%3CCloudComputerChangeMove%3E+moveList+%3D+new+ArrayList%3C%3E%28%29%3B%0A%C2%A0+++++++List%3CCloudComputer%3E+cloudComputerList+%3D+cloudBalance.getComputerList%28%29%3B%0A%C2%A0+++++++for+%28CloudProcess+cloudProcess+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++for+%28CloudComputer+cloudComputer+%3A+cloudComputerList%29+%7B%0A%C2%A0+++++++++++++++moveList.add%28new+CloudComputerChangeMove%28cloudProcess%2C+cloudComputer%29%0A%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+moveList%3B%0A%C2%A0+++%7D%0A%7D%0ASimple+configuration+%28which+can+be+nested+in+a+unionMoveSelector+just+like+any+other+MoveSelector%29%3A%0A%C2%A0+++%3CmoveListFactory%3E%0A%C2%A0%0A%3CmoveListFactoryClass%3Eorg.optaplanner.examples.cloudbalancing.optional.move.CloudCompu%0AterChangeMoveFactory%3C%2FmoveListFactoryClass%3E%0A%C2%A0+++%3C%2FmoveListFactory%3E%0AAdvanced+configuration%3A%0A232%0A%C2%A0+++%3CmoveListFactory%3E%0A%C2%A0+++++...+%3C%21--+Normal+moveSelector+properties+--%3E%0A%C2%A0%0A%3CmoveListFactoryClass%3Eorg.optaplanner.examples.cloudbalancing.optional.move.CloudCompu%0AterChangeMoveFactory%3C%2FmoveListFactoryClass%3E%0A%C2%A0+++%3C%2FmoveListFactory%3E%0ABecause+the+MoveListFactory+generates+all+moves+at+once+in+a+List%3CMove%3E%2C+it+does+not+support%0AcacheType+JUST_IN_TIME.+Therefore%2C+moveListFactory+uses+cacheType+STEP+by+default+and+it+scales%0Abadly.%0A8.7.5.+MoveIteratorFactory%3A+Generate+Custom+Moves+Just+in+Time%0AUse+this+advanced+form+to+generate+custom+moves+Just+In+Time+by+implementing+the%0AMoveIteratorFactory+interface%3A%0Apublic+interface+MoveIteratorFactory%3CSolution_%3E+%7B%0A%C2%A0+++long+getSize%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Iterator%3CMove%3E+createOriginalMoveIterator%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%C2%A0+++Iterator%3CMove%3E+createRandomMoveIterator%28ScoreDirector%3CSolution_%3E+scoreDirector%2C%0ARandom+workingRandom%29%3B%0A%7D%0AThe+getSize%28%29+method+must+return+an+estimation+of+the+size.+It+doesn%E2%80%99t+need+to+be+correct%2C+but+it%E2%80%99s%0Abetter+too+big+than+too+small.+The+createOriginalMoveIterator+method+is+called+if+the+selectionOrder%0Ais+ORIGINAL+or+if+it+is+cached.+The+createRandomMoveIterator+method+is+called+for+selectionOrder%0ARANDOM+combined+with+cacheType+JUST_IN_TIME.%0ADon%E2%80%99t+create+a+collection+%28array%2C+list%2C+set+or+map%29+of+Moves+when+creating+the%0A%EF%81%AA+Iterator%3CMove%3E%3A+the+whole+purpose+of+MoveIteratorFactory+over+MoveListFactory+is%0Ato+create+a+Move+just+in+time+in+a+custom+Iterator.next%28%29.%0ASimple+configuration+%28which+can+be+nested+in+a+unionMoveSelector+just+like+any+other+MoveSelector%29%3A%0A%C2%A0+++%3CmoveIteratorFactory%3E%0A%C2%A0+++++%3CmoveIteratorFactoryClass%3E...%3C%2FmoveIteratorFactoryClass%3E%0A%C2%A0+++%3C%2FmoveIteratorFactory%3E%0AAdvanced+configuration%3A%0A233%0A%C2%A0+++%3CmoveIteratorFactory%3E%0A%C2%A0+++++...+%3C%21--+Normal+moveSelector+properties+--%3E%0A%C2%A0+++++%3CmoveIteratorFactoryClass%3E...%3C%2FmoveIteratorFactoryClass%3E%0A%C2%A0+++%3C%2FmoveIteratorFactory%3E%0A234%0AChapter+9.+Exhaustive+Search%0A9.1.+Overview%0AExhaustive+Search+will+always+find+the+global+optimum+and+recognize+it+too.+That+being+said%2C+it%0Adoesn%E2%80%99t+scale+%28not+even+beyond+toy+data+sets%29+and+is+therefore+mostly+useless.%0A9.2.+Brute+Force%0A9.2.1.+Algorithm+Description%0AThe+Brute+Force+algorithm+creates+and+evaluates+every+possible+solution.%0ANotice+that+it+creates+a+search+tree+that+explodes+exponentially+as+the+problem+size+increases%2C+so+it%0Ahits+a+scalability+wall.%0ABrute+Force+is+mostly+unusable+for+a+real-world+problem+due+to+time%0A%EF%81%AA+limitations%2C+as+shown+in+scalability+of+Exhaustive+Search.%0A235%0A9.2.2.+Configuration%0ASimplest+configuration+of+Brute+Force%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRUTE_FORCE%3C%2FexhaustiveSearchType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%3C%2Fsolver%3E%0A9.3.+Branch+And+Bound%0A9.3.1.+Algorithm+Description%0ABranch+And+Bound+also+explores+nodes+in+an+exponential+search+tree%2C+but+it+investigates+more%0Apromising+nodes+first+and+prunes+away+worthless+nodes.%0AFor+each+node%2C+Branch+And+Bound+calculates+the+optimistic+bound%3A+the+best+possible+score+to+which%0Athat+node+can+lead+to.+If+the+optimistic+bound+of+a+node+is+lower+or+equal+to+the+global+pessimistic%0Abound%2C+then+it+prunes+away+that+node+%28including+the+entire+branch+of+all+its+subnodes%29.%0AAcademic+papers+use+the+term+lower+bound+instead+of+optimistic+bound+%28and+the%0Aterm+upper+bound+instead+of+pessimistic+bound%29%2C+because+they+minimize+the+score.%0A%EF%81%9A+Planner+maximizes+the+score+%28because+it+supports+combining+negative+and+positive%0Aconstraints%29.+Therefore%2C+for+clarity%2C+it+uses+different+terms%2C+as+it+would+be+confusing%0Ato+use+the+term+lower+bound+for+a+bound+which+is+always+higher.%0AFor+example%3A+at+index+14%2C+it+sets+the+global+pessimistic+bound+to+-2.+Because+all+solutions+reachable%0Afrom+the+node+visited+at+index+11+will+have+a+score+lower+or+equal+to+-2+%28the+node%E2%80%99s+optimistic%0Abound%29%2C+they+can+be+pruned+away.%0A236%0ANotice+that+Branch+And+Bound+%28much+like+Brute+Force%29+creates+a+search+tree+that+explodes%0Aexponentially+as+the+problem+size+increases.+So+it+hits+the+same+scalability+wall%2C+only+a+little+bit+later.%0ABranch+And+Bound+is+mostly+unusable+for+a+real-world+problem+due+to+time%0A%EF%81%AA+limitations%2C+as+shown+in+scalability+of+Exhaustive+Search.%0A9.3.2.+Configuration%0ASimplest+configuration+of+Branch+And+Bound%3A%0A%3Csolver%3E%0A%C2%A0+...%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%3C%2Fsolver%3E%0AFor+the+pruning+to+work+with+the+default+ScoreBounder%2C+the+InitializingScoreTrend%0A%EF%81%AA+should+be+set.+Especially+an+InitializingScoreTrend+of+ONLY_DOWN+%28or+at+least+has%0AONLY_DOWN+in+the+leading+score+levels%29+prunes+a+lot.%0AAdvanced+configuration%3A%0A237%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EDEPTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0AThe+nodeExplorationType+options+are%3A%0A%E2%80%A2+DEPTH_FIRST+%28default%29%3A+Explore+deeper+nodes+first+%28and+then+a+better+score+and+then+a+better%0Aoptimistic+bound%29.+Deeper+nodes+%28especially+leaf+nodes%29+often+improve+the+pessimistic+bound.+A%0Abetter+pessimistic+bound+allows+pruning+more+nodes+to+reduce+the+search+space.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EDEPTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+BREADTH_FIRST+%28not+recommended%29%3A+Explore+nodes+layer+by+layer+%28and+then+a+better+score+and%0Athen+a+better+optimistic+bound%29.+Scales+terribly+in+memory+%28and+usually+in+performance+too%29.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EBREADTH_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+SCORE_FIRST%3A+Explore+nodes+with+a+better+score+first+%28and+then+a+better+optimistic+bound+and%0Athen+deeper+nodes+first%29.+Might+scale+as+terribly+as+BREADTH_FIRST+in+some+cases.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3ESCORE_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0A%E2%80%A2+OPTIMISTIC_BOUND_FIRST%3A+Explore+nodes+with+a+better+optimistic+bound+first+%28and+then+a+better%0Ascore+and+then+deeper+nodes+first%29.+Might+scale+as+terribly+as+BREADTH_FIRST+in+some+cases.%0A%C2%A0+%3CexhaustiveSearch%3E%0A%C2%A0+++%3CexhaustiveSearchType%3EBRANCH_AND_BOUND%3C%2FexhaustiveSearchType%3E%0A%C2%A0+++%3CnodeExplorationType%3EOPTIMISTIC_BOUND_FIRST%3C%2FnodeExplorationType%3E%0A%C2%A0+%3C%2FexhaustiveSearch%3E%0AThe+entitySorterManner+options+are%3A%0A238%0A%E2%80%A2+DECREASING_DIFFICULTY%3A+Initialize+the+more+difficult+planning+entities+first.+This+usually+increases%0Apruning+%28and+therefore+improves+scalability%29.+Requires+the+model+to+support+planning+entity%0Adifficulty+comparison.%0A%E2%80%A2+DECREASING_DIFFICULTY_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+entity+difficulty%0Acomparison%2C+behave+like+DECREASING_DIFFICULTY%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Initialize+the+planning+entities+in+original+order.%0AThe+valueSorterManner+options+are%3A%0A%E2%80%A2+INCREASING_STRENGTH%3A+Evaluate+the+planning+values+in+increasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+INCREASING_STRENGTH_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+value+strength%0Acomparison%2C+behave+like+INCREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+DECREASING_STRENGTH%3A+Evaluate+the+planning+values+in+decreasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+DECREASING_STRENGTH_IF_AVAILABLE%3A+If+the+model+supports+planning+value+strength+comparison%2C%0Abehave+like+DECREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Try+the+planning+values+in+original+order.%0A9.4.+Scalability+of+Exhaustive+Search%0AExhaustive+Search+variants+suffer+from+two+big+scalability+issues%3A%0A%E2%80%A2+They+scale+terribly+memory+wise.%0A%E2%80%A2+They+scale+horribly+performance+wise.%0AAs+shown+in+these+time+spent+graphs+from+the+Benchmarker%2C+Brute+Force+and+Branch+And+Bound%0Aboth+hit+a+performance+scalability+wall.+For+example%2C+on+N+queens+it+hits+wall+at+a+few+dozen%0Aqueens%3A%0A239%0AIn+most+use+cases%2C+such+as+Cloud+Balancing%2C+the+wall+appears+out+of+thin+air%3A%0A240%0AExhaustive+Search+hits+this+wall+on+small+datasets+already%2C+so+in+production+these%0Aoptimizations+algorithms+are+mostly+useless.+Use+Construction+Heuristics+with+Local+Search%0Ainstead%3A+those+can+handle+thousands+of+queens%2Fcomputers+easily.%0AThrowing+hardware+at+these+scalability+issues+has+no+noticeable+impact.+Newer%0A%EF%81%9A+and+more+hardware+are+just+a+drop+in+the+ocean.+Moore%E2%80%99s+law+cannot+win+against%0Athe+onslaught+of+a+few+more+planning+entities+in+the+dataset.%0A241%0AChapter+10.+Construction+Heuristics%0A10.1.+Overview%0AA+construction+heuristic+builds+a+pretty+good+initial+solution+in+a+finite+length+of+time.+Its+solution%0Aisn%E2%80%99t+always+feasible%2C+but+it+finds+it+fast+so+metaheuristics+can+finish+the+job.%0AConstruction+heuristics+terminate+automatically%2C+so+there%E2%80%99s+usually+no+need+to+configure+a%0ATermination+on+the+construction+heuristic+phase+specifically.%0A10.2.+First+Fit%0A10.2.1.+Algorithm+Description%0AThe+First+Fit+algorithm+cycles+through+all+the+planning+entities+%28in+default+order%29%2C+initializing+one%0Aplanning+entity+at+a+time.+It+assigns+the+planning+entity+to+the+best+available+planning+value%2C+taking%0Athe+already+initialized+planning+entities+into+account.+It+terminates+when+all+planning+entities+have%0Abeen+initialized.+It+never+changes+a+planning+entity+after+it+has+been+assigned.%0ANotice+that+it+starts+with+putting+Queen+A+into+row+0+%28and+never+moving+it+later%29%2C+which+makes+it%0Aimpossible+to+reach+the+optimal+solution.+Suffixing+this+construction+heuristic+with+metaheuristics%0Acan+remedy+that.%0A242%0A10.2.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.3.+First+Fit+Decreasing%0A10.3.1.+Algorithm+Description%0ALike+First+Fit%2C+but+assigns+the+more+difficult+planning+entities+first%2C+because+they+are+less+likely+to+fit%0Ain+the+leftovers.+So+it+sorts+the+planning+entities+on+decreasing+difficulty.%0A243%0ARequires+the+model+to+support+planning+entity+difficulty+comparison.%0AOne+would+expect+that+this+algorithm+has+better+results+than+First+Fit.+That%E2%80%99s%0A%EF%81%9A+usually+the+case%2C+but+not+always.%0A10.3.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A244%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.4.+Weakest+Fit%0A10.4.1.+Algorithm+Description%0ALike+First+Fit%2C+but+uses+the+weaker+planning+values+first%2C+because+the+strong+planning+values+are%0Amore+likely+to+be+able+to+accommodate+later+planning+entities.+So+it+sorts+the+planning+values+on%0Aincreasing+strength.%0ARequires+the+model+to+support+planning+value+strength+comparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit.+That%E2%80%99s+often%0A%EF%81%9A+not+the+case.%0A10.4.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.5.+Weakest+Fit+Decreasing%0A10.5.1.+Algorithm+Description%0ACombines+First+Fit+Decreasing+and+Weakest+Fit.+So+it+sorts+the+planning+entities+on+decreasing%0Adifficulty+and+the+planning+values+on+increasing+strength.%0ARequires+the+model+to+support+planning+entity+difficulty+comparison+and+planning+value+strength%0Acomparison.%0A245%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+Decreasing.%0A%EF%81%9A+That%E2%80%99s+often+not+the+case.+However%2C+it+is+usually+better+than+Weakest+Fit.%0A10.5.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EWEAKEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.6.+Strongest+Fit%0A10.6.1.+Algorithm+Description%0ALike+First+Fit%2C+but+uses+the+strong+planning+values+first%2C+because+the+strong+planning+values+are+more%0Alikely+to+have+a+lower+soft+cost+to+use.+So+it+sorts+the+planning+values+on+decreasing+strength.%0ARequires+the+model+to+support+planning+value+strength+comparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+or+Weakest+Fit.%0A%EF%81%9A+That%E2%80%99s+often+not+the+case.%0A10.6.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A246%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A10.7.+Strongest+Fit+Decreasing%0A10.7.1.+Algorithm+Description%0ACombines+First+Fit+Decreasing+and+Strongest+Fit.+So+it+sorts+the+planning+entities+on+decreasing%0Adifficulty+and+the+planning+values+on+decreasing+strength.%0ARequires+the+model+to+support+planning+entity+difficulty+comparison+and+planning+value+strength%0Acomparison.%0ADo+not+presume+that+this+algorithm+has+better+results+than+First+Fit+Decreasing+or%0A%EF%81%9A+Weakest+Fit+Decreasing.+That%E2%80%99s+often+not+the+case.+However%2C+it+is+usually+better+than%0AStrongest+Fit.%0A10.7.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ESTRONGEST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0AEntity+From+Queue.%0A247%0A10.8.+Allocate+Entity+From+Queue%0A10.8.1.+Algorithm+Description%0AAllocate+Entity+From+Queue+is+a+versatile%2C+generic+form+of+First+Fit%2C+First+Fit+Decreasing%2C+Weakest+Fit%2C%0AWeakest+Fit+Decreasing%2C+Strongest+Fit+and+Strongest+Fit+Decreasing.+It+works+like+this%3A%0A1.+Put+all+entities+in+a+queue.%0A2.+Assign+the+first+entity+%28from+that+queue%29+to+the+best+value.%0A3.+Repeat+until+all+entities+are+assigned.%0A10.8.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_ENTITY_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_ENTITY_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+entitySorterManner+options+are%3A%0A%E2%80%A2+DECREASING_DIFFICULTY%3A+Initialize+the+more+difficult+planning+entities+first.+This+usually+increases%0Apruning+%28and+therefore+improves+scalability%29.+Requires+the+model+to+support+planning+entity%0Adifficulty+comparison.%0A%E2%80%A2+DECREASING_DIFFICULTY_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+entity+difficulty%0Acomparison%2C+behave+like+DECREASING_DIFFICULTY%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Initialize+the+planning+entities+in+original+order.%0AThe+valueSorterManner+options+are%3A%0A%E2%80%A2+INCREASING_STRENGTH%3A+Evaluate+the+planning+values+in+increasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A%E2%80%A2+INCREASING_STRENGTH_IF_AVAILABLE+%28default%29%3A+If+the+model+supports+planning+value+strength%0Acomparison%2C+behave+like+INCREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+DECREASING_STRENGTH%3A+Evaluate+the+planning+values+in+decreasing+strength.+Requires+the+model+to%0Asupport+planning+value+strength+comparison.%0A248%0A%E2%80%A2+DECREASING_STRENGTH_IF_AVAILABLE%3A+If+the+model+supports+planning+value+strength+comparison%2C%0Abehave+like+DECREASING_STRENGTH%2C+else+like+NONE.%0A%E2%80%A2+NONE%3A+Try+the+planning+values+in+original+order.%0AAdvanced+configuration+with+Weakest+Fit+Decreasing+for+a+single+entity+class+with+one+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0APer+step%2C+the+QueuedEntityPlacer+selects+one+uninitialized+entity+from+the+EntitySelector+and+applies%0Athe+winning+Move+%28out+of+all+the+moves+for+that+entity+generated+by+the+MoveSelector%29.+The+mimic%0Aselection+ensures+that+the+winning+Move+changes+only+the+selected+entity.%0ATo+customize+the+entity+or+value+sorting%2C+see+sorted+selection.+For+scaling+out%2C+see+scaling%0Aconstruction+heuristics.%0AIf+there+are+multiple+planning+variables%2C+there%E2%80%99s+one+ChangeMoveSelector+per+planning+variable%2C%0Awhich+are+either+in+a+cartesian+product+or+in+sequential+steps%2C+similar+to+the+less+verbose%0Aconfiguration.%0A10.8.3.+Multiple+Entity+Classes%0AThe+easiest+way+to+deal+with+multiple+entity+classes+is+to+run+a+separate+Construction+Heuristic+for%0Aeach+entity+class%3A%0A249%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CentityClass%3E...DogEntity%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedEntityPlacer%3E%0A%C2%A0+++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CentityClass%3E...CatEntity%3C%2FentityClass%3E%0A%C2%A0+++++%3C%2FentitySelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+mimicSelectorRef%3D%22placerEntitySelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedEntityPlacer%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.8.4.+Pick+Early+Type%0AThere+are+several+pick+early+types+for+Construction+Heuristics%3A%0A%E2%80%A2+NEVER%3A+Evaluate+all+the+selected+moves+to+initialize+the+variable%28s%29.+This+is+the+default+if+the%0AInitializingScoreTrend+is+not+ONLY_DOWN.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3ENEVER%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%E2%80%A2+FIRST_NON_DETERIORATING_SCORE%3A+Initialize+the+variable%28s%29+with+the+first+move+that+doesn%E2%80%99t%0Adeteriorate+the+score%2C+ignore+the+remaining+selected+moves.+This+is+the+default+if+the%0AInitializingScoreTrend+is+ONLY_DOWN.%0A250%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_NON_DETERIORATING_SCORE%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AIf+there+are+only+negative+constraints%2C+but+the+InitializingScoreTrend+is+strictly%0Anot+ONLY_DOWN%2C+it+can+sometimes+make+sense+to+apply%0A%EF%81%9A+FIRST_NON_DETERIORATING_SCORE.+Use+the+Benchmarker+to+decide+if+the%0Ascore+quality+loss+is+worth+the+time+gain.%0A%E2%80%A2+FIRST_FEASIBLE_SCORE%3A+Initialize+the+variable%28s%29+with+the+first+move+that+has+a+feasible+score.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_FEASIBLE_SCORE%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AIf+the+InitializingScoreTrend+is+ONLY_DOWN%2C+use+FIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%0Ainstead%2C+because+that%E2%80%99s+faster+without+any+disadvantages.%0A%E2%80%A2+FIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%3A+Initialize+the+variable%28s%29+with+the+first+move%0Athat+doesn%E2%80%99t+deteriorate+the+feasibility+of+the+score+any+further.%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_FEASIBLE_SCORE_OR_NON_DETERIORATING_HARD%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.9.+Allocate+To+Value+From+Queue%0A10.9.1.+Algorithm+Description%0AAllocate+To+Value+From+Queue+works+like+this%3A%0A1.+Put+all+values+in+a+round-robin+queue.%0A2.+Assign+the+best+entity+to+the+first+value+%28from+that+queue%29.%0A3.+Repeat+until+all+entities+are+assigned.%0A251%0A10.9.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3E%0AALLOCATE_TO_VALUE_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3E%0AALLOCATE_TO_VALUE_FROM_QUEUE%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration+for+a+single+entity+class+with+a+single+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CqueuedValuePlacer%3E%0A%C2%A0+++++%3CvalueSelector+id%3D%22placerValueSelector%22%3E%0A%C2%A0+++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector+mimicSelectorRef%3D%22placerValueSelector%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FqueuedValuePlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.%0A10.10.+Cheapest+Insertion%0A10.10.1.+Algorithm+Description%0AThe+Cheapest+Insertion+algorithm+cycles+through+all+the+planning+values+for+all+the+planning%0Aentities%2C+initializing+one+planning+entity+at+a+time.+It+assigns+a+planning+entity+to+the+best+available%0A252%0Aplanning+value+%28out+of+all+the+planning+entities+and+values%29%2C+taking+the+already+initialized+planning%0Aentities+into+account.+It+terminates+when+all+planning+entities+have+been+initialized.+It+never%0Achanges+a+planning+entity+after+it+has+been+assigned.%0A%EF%81%9A+Cheapest+Insertion+scales+considerably+worse+than+First+Fit%2C+etc.%0A10.10.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ECHEAPEST_INSERTION%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AAdvanced+configuration%3A%0A253%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3ECHEAPEST_INSERTION%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++%3C...MoveSelector%2F%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AFor+scaling+out%2C+see+scaling+construction+heuristics.+For+a+very+advanced+configuration%2C+see+Allocate%0Afrom+pool.%0A10.11.+Regret+Insertion%0A10.11.1.+Algorithm+Description%0AThe+Regret+Insertion+algorithm+behaves+like+the+Cheapest+Insertion+algorithm.+It+also+cycles+through%0Aall+the+planning+values+for+all+the+planning+entities%2C+initializing+one+planning+entity+at+a+time.+But%0Ainstead+of+picking+the+entity-value+combination+with+the+best+score%2C+it+picks+the+entity+which+has+the%0Alargest+score+loss+between+its+best+and+second+best+value+assignment.+It+then+assigns+that+entity+to+its%0Abest+value%2C+to+avoid+regretting+not+having+done+that.%0A10.11.2.+Configuration%0AThis+algorithm+has+not+been+implemented+yet.%0A10.12.+Allocate+From+Pool%0A10.12.1.+Algorithm+Description%0AAllocate+From+Pool+is+a+versatile%2C+generic+form+of+Cheapest+Insertion+and+Regret+Insertion.+It+works%0Alike+this%3A%0A1.+Put+all+entity-value+combinations+in+a+pool.%0A2.+Assign+the+best+entity+to+best+value.%0A3.+Repeat+until+all+entities+are+assigned.%0A10.12.2.+Configuration%0ASimple+configuration%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_FROM_POOL%3C%2FconstructionHeuristicType%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AVerbose+simple+configuration%3A%0A254%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EALLOCATE_FROM_POOL%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CentitySorterManner%3EDECREASING_DIFFICULTY_IF_AVAILABLE%3C%2FentitySorterManner%3E%0A%C2%A0+++%3CvalueSorterManner%3EINCREASING_STRENGTH_IF_AVAILABLE%3C%2FvalueSorterManner%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+entitySorterManner+and+valueSorterManner+options+are+described+in+Allocate+Entity+From+Queue.%0AAdvanced+configuration+with+Cheapest+Insertion+for+a+single+entity+class+with+a+single+variable%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CpooledEntityPlacer%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CentitySelector+id%3D%22placerEntitySelector%22%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EDECREASING_DIFFICULTY%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FentitySelector%3E%0A%C2%A0+++++++%3CvalueSelector%3E%0A%C2%A0+++++++++%3CcacheType%3EPHASE%3C%2FcacheType%3E%0A%C2%A0+++++++++%3CselectionOrder%3ESORTED%3C%2FselectionOrder%3E%0A%C2%A0+++++++++%3CsorterManner%3EINCREASING_STRENGTH%3C%2FsorterManner%3E%0A%C2%A0+++++++%3C%2FvalueSelector%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FpooledEntityPlacer%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0APer+step%2C+the+PooledEntityPlacer+applies+the+winning+Move+%28out+of+all+the+moves+for+that+entity%0Agenerated+by+the+MoveSelector%29.%0ATo+customize+the+entity+or+value+sorting%2C+see+sorted+selection.+Other+Selector+customization+%28such+as%0Afiltering+and+limiting%29+is+supported+too.%0AFor+scaling+out%2C+see+scaling+construction+heuristics.%0A10.13.+Scaling+Construction+Heuristics%0AIf+the+Construction+Heuristic+takes+a+long+time+to+solve+and+create+an+initial+solution%2C+there+is+too%0Alittle+time+left+for+Local+Search+to+reach+a+near+optimal+solution.%0AIdeally%2C+a+Construction+Heuristic+should+take+less+than+20+seconds+from+scratch+and+less+than+50%0Amilliseconds+in+real-time+planning%2C+so+there+is+plenty+of+time+left+for+Local+Search.+If+the%0ABenchmarker+proves+that+this+is+not+the+case%2C+there%E2%80%99s+a+number+of+improvements+that+can+be+done%3A%0A10.13.1.+InitializingScoreTrend+shortcuts%0AIf+the+InitializingScoreTrend+is+ONLY_DOWN%2C+a+Construction+Heuristic+algorithm+%28such+as+First+Fit%29+is%0Afaster%3A+for+an+entity%2C+it+picks+the+first+move+for+which+the+score+does+not+deteriorate+the+last+step%0A255%0Ascore%2C+ignoring+all+subsequent+moves+in+that+step.%0AIt+can+take+that+shortcut+without+reducing+solution+quality%2C+because+a+down+trend+guarantees+that%0Ainitializing+any+additional+planning+variable+can+only+make+the+score+the+same+or+worse.+So+if+a%0Amove+has+the+same+score+as+before+the+planning+variable+was+initialized%2C+then+no+other+move+can%0Ahave+a+better+score.%0A10.13.2.+Scaling+Multiple+Planning+Variables+in+Construction+Heuristics%0AThere+are+two+ways+to+deal+with+multiple+planning+variables%2C+depending+on+how+their+ChangeMoves%0Aare+combined%3A%0A%E2%80%A2+Cartesian+product+%28default%29%3A+All+variables+of+the+selected+entity+are+assigned+together.+This%0Ausually+results+in+a+better+solution+quality%2C+but+it+scales+poorly+because+it+tries+every%0Acombination+of+variables.+For+example%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A%E2%80%A2+Sequential%3A+One+variable+is+assigned+at+a+time.+Scales+better%2C+at+the+cost+of+solution+quality.+The%0Aorder+of+the+planning+variables+matters.+For+example%3A%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0AThe+second+way+scales+better%2C+so+it+can+be+worth+to+switch+to+it.+For+example%2C+in+a+course+scheduling%0Aexample+with+200+rooms+and+40+periods%2C+a+cartesian+product+selects+8%C2%A0000+moves+per+entity+%281+step%0Aper+entity%29.+On+the+other+hand%2C+a+sequential+approach+only+selects+240+moves+per+entity+%282+steps+per%0Aentity%29%2C+ending+the+Construction+Heuristic+3+times+faster.+Especially+for+three+or+more+planning%0Avariables%2C+the+scaling+difference+is+huge.+For+example%2C+with+three+variables+of+1%C2%A0000+values+each%2C+a%0Acartesian+product+selects+1%C2%A0000%C2%A0000%C2%A0000+moves+per+entity+%281+step+per+entity%29.+A+sequential+approach%0A256%0Aonly+selects+3%C2%A0000+moves+per+entity+%283+steps+per+entity%29%2C+ending+the+Construction+Heuristic+300%C2%A0000%0Atimes+faster.%0AThe+order+of+the+variables+is+important%2C+especially+in+the+sequential+technique.+In%0Athe+sequential+example+above%2C+it%E2%80%99s+better+to+select+the+period+first+and+the+room%0Asecond+%28instead+of+the+other+way+around%29%2C+because+there+are+more+hard+constraints%0A%EF%81%AA+that+do+not+involve+the+room%2C+such+as+no+teacher+should+teach+two+lectures+at+the%0Asame+time.%0ALet+the+Benchmarker+guide+you.%0AWith+three+or+more+variables%2C+it%E2%80%99s+possible+to+combine+the+cartesian+product+and+sequential%0Atechniques%3A%0A257%0A%C2%A0+%3CconstructionHeuristic%3E%0A%C2%A0+++%3CconstructionHeuristicType%3EFIRST_FIT_DECREASING%3C%2FconstructionHeuristicType%3E%0A%C2%A0+++%3CcartesianProductMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22period%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++++%3CchangeMoveSelector%3E%0A%C2%A0+++++++%3CvalueSelector+variableName%3D%22room%22%2F%3E%0A%C2%A0+++++%3C%2FchangeMoveSelector%3E%0A%C2%A0+++%3C%2FcartesianProductMoveSelector%3E%0A%C2%A0+++%3CchangeMoveSelector%3E%0A%C2%A0+++++%3CvalueSelector+variableName%3D%22teacher%22%2F%3E%0A%C2%A0+++%3C%2FchangeMoveSelector%3E%0A%C2%A0+%3C%2FconstructionHeuristic%3E%0A10.13.3.+Other+Scaling+Techniques+in+Construction+Heuristics%0APartitioned+Search+reduces+the+number+of+moves+per+step.+On+top+of+that%2C+it+runs+the+Construction%0AHeuristic+on+the+partitions+in+parallel.+It+is+supported+to+only+partition+the+Construction+Heuristic%0Aphase.%0AOther+Selector+customizations+can+also+reduce+the+number+of+moves+generated+by+step%3A%0A%E2%80%A2+Filtered+selection%0A%E2%80%A2+Limited+selection%0A258%0AChapter+11.+Local+Search%0A11.1.+Overview%0ALocal+Search+starts+from+an+initial+solution+and+evolves+that+single+solution+into+a+mostly+better+and%0Abetter+solution.+It+uses+a+single+search+path+of+solutions%2C+not+a+search+tree.+At+each+solution+in+this%0Apath+it+evaluates+a+number+of+moves+on+the+solution+and+applies+the+most+suitable+move+to+take+the%0Astep+to+the+next+solution.+It+does+that+for+a+high+number+of+iterations+until+it%E2%80%99s+terminated+%28usually%0Abecause+its+time+has+run+out%29.%0ALocal+Search+acts+a+lot+like+a+human+planner%3A+it+uses+a+single+search+path+and+moves+facts+around+to%0Afind+a+good+feasible+solution.+Therefore+it%E2%80%99s+pretty+natural+to+implement.%0ALocal+Search+needs+to+start+from+an+initialized+solution%2C+therefore+it%E2%80%99s+usually+required+to%0Aconfigure+a+Construction+Heuristic+phase+before+it.%0A11.2.+Local+Search+Concepts%0A11.2.1.+Step+by+Step%0AA+step+is+the+winning+Move.+Local+Search+tries+a+number+of+moves+on+the+current+solution+and+picks%0Athe+best+accepted+move+as+the+step%3A%0AFigure+6.+Decide+the+next+step+at+step+0+%28four+queens+example%29%0ABecause+the+move+B0+to+B3+has+the+highest+score+%28-3%29%2C+it+is+picked+as+the+next+step.+If+multiple+moves%0Ahave+the+same+highest+score%2C+one+is+picked+randomly%2C+in+this+case+B0+to+B3.+Note+that+C0+to+C3+%28not%0Ashown%29+could+also+have+been+picked+because+it+also+has+the+score+-3.%0AThe+step+is+applied+on+the+solution.+From+that+new+solution%2C+Local+Search+tries+every+move+again%2C+to%0Adecide+the+next+step+after+that.+It+continually+does+this+in+a+loop%2C+and+we+get+something+like+this%3A%0A259%0AFigure+7.+All+steps+%28four+queens+example%29%0ANotice+that+Local+Search+doesn%E2%80%99t+use+a+search+tree%2C+but+a+search+path.+The+search+path+is+highlighted%0Aby+the+green+arrows.+At+each+step+it+tries+all+selected+moves%2C+but+unless+it%E2%80%99s+the+step%2C+it+doesn%E2%80%99t%0Ainvestigate+that+solution+further.+This+is+one+of+the+reasons+why+Local+Search+is+very+scalable.%0AAs+shown+above%2C+Local+Search+solves+the+four+queens+problem+by+starting+with+the+starting+solution%0Aand+make+the+following+steps+sequentially%3A%0A1.+B0+to+B3%0A2.+D0+to+B2%0A3.+A0+to+B1%0A260%0ATurn+on+debug+logging+for+the+category+org.optaplanner+to+show+those+steps+in+the+log%3A%0AINFO++Solving+started%3A+time+spent+%280%29%2C+best+score+%28-6%29%2C+environment+mode%0A%28REPRODUCIBLE%29%2C+random+%28JDK+with+seed+0%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%2820%29%2C+score+%28-3%29%2C+new+best+score+%28-3%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-0+-%3E+Row-3%7D%29.%0ADEBUG+++++LS+step+%281%29%2C+time+spent+%2831%29%2C+score+%28-1%29%2C+new+best+score+%28-1%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-3+%7BRow-0+-%3E+Row-2%7D%29.%0ADEBUG+++++LS+step+%282%29%2C+time+spent+%2840%29%2C+score+%280%29%2C+new+best+score+%280%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-0+%7BRow-0+-%3E+Row-1%7D%29.%0AINFO++Local+Search+phase+%280%29+ended%3A+time+spent+%2841%29%2C+best+score+%280%29%2C+score+calculation%0Aspeed+%285000%2Fsec%29%2C+step+total+%283%29.%0AINFO++Solving+ended%3A+time+spent+%2841%29%2C+best+score+%280%29%2C+score+calculation+speed%0A%285000%2Fsec%29%2C+phase+total+%281%29%2C+environment+mode+%28REPRODUCIBLE%29.%0ANotice+that+a+log+message+includes+the+toString%28%29+method+of+the+Move+implementation+which+returns%0Afor+example+%22Queen-1+%7BRow-0+%E2%86%92+Row-3%7D%22.%0AA+naive+Local+Search+configuration+solves+the+four+queens+problem+in+three+steps%2C+by+evaluating%0Aonly+37+possible+solutions+%28three+steps+with+12+moves+each+%2B+one+starting+solution%29%2C+which+is+only%0Afraction+of+all+256+possible+solutions.+It+solves+16+queens+in+31+steps%2C+by+evaluating+only+7441+out+of%0A18446744073709551616+possible+solutions.+By+using+a+Construction+Heuristics+phase+first%2C+it%E2%80%99s+even+a%0Alot+more+efficient.%0A11.2.2.+Decide+the+Next+Step%0ALocal+Search+decides+the+next+step+with+the+aid+of+three+configurable+components%3A%0A%E2%80%A2+A+MoveSelector+which+selects+the+possible+moves+of+the+current+solution.+See+the+chapter+move%0Aand+neighborhood+selection.%0A%E2%80%A2+An+Acceptor+which+filters+out+unacceptable+moves.%0A%E2%80%A2+A+Forager+which+gathers+accepted+moves+and+picks+the+next+step+from+them.%0AThe+solver+phase+configuration+looks+like+this%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A261%0AIn+the+example+below%2C+the+MoveSelector+generated+the+moves+shown+with+the+blue+lines%2C+the+Acceptor%0Aaccepted+all+of+them+and+the+Forager+picked+the+move+B0+to+B3.%0ATurn+on+trace+logging+to+show+the+decision+making+in+the+log%3A%0AINFO++Solver+started%3A+time+spent+%280%29%2C+score+%28-6%29%2C+new+best+score+%28-6%29%2C+random+%28JDK%0Awith+seed+0%29.%0ATRACE+++++++++Move+index+%280%29+not+doable%2C+ignoring+move+%28Queen-0+%7BRow-0+-%3E+Row-0%7D%29.%0ATRACE+++++++++Move+index+%281%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-1%7D%29.%0ATRACE+++++++++Move+index+%282%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-2%7D%29.%0ATRACE+++++++++Move+index+%283%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-0+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%286%29%2C+score+%28-3%29%2C+accepted+%28true%29%2C+move+%28Queen-1+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%289%29%2C+score+%28-3%29%2C+accepted+%28true%29%2C+move+%28Queen-2+%7BRow-0+-%3E%0ARow-3%7D%29.%0A...%0ATRACE+++++++++Move+index+%2812%29%2C+score+%28-4%29%2C+accepted+%28true%29%2C+move+%28Queen-3+%7BRow-0+-%3E%0ARow-3%7D%29.%0ADEBUG+++++LS+step+%280%29%2C+time+spent+%286%29%2C+score+%28-3%29%2C+new+best+score+%28-3%29%2C%0Aaccepted%2Fselected+move+count+%2812%2F12%29%2C+picked+move+%28Queen-1+%7BRow-0+-%3E+Row-3%7D%29.%0A...%0ABecause+the+last+solution+can+degrade+%28for+example+in+Tabu+Search%29%2C+the+Solver+remembers+the+best%0Asolution+it+has+encountered+through+the+entire+search+path.+Each+time+the+current+solution+is+better%0Athan+the+last+best+solution%2C+the+current+solution+is+cloned+and+referenced+as+the+new+best+solution.%0A262%0A11.2.3.+Acceptor%0AAn+Acceptor+is+used+%28together+with+a+Forager%29+to+active+Tabu+Search%2C+Simulated+Annealing%2C+Late%0AAcceptance%2C+%E2%80%A6+For+each+move+it+checks+whether+it+is+accepted+or+not.%0ABy+changing+a+few+lines+of+configuration%2C+you+can+easily+switch+from+Tabu+Search+to+Simulated%0AAnnealing+or+Late+Acceptance+and+back.%0AYou+can+implement+your+own+Acceptor%2C+but+the+built-in+acceptors+should+suffice+for+most+needs.+You%0Acan+also+combine+multiple+acceptors.%0A11.2.4.+Forager%0AA+Forager+gathers+all+accepted+moves+and+picks+the+move+which+is+the+next+step.+Normally+it+picks%0Athe+accepted+move+with+the+highest+score.+If+several+accepted+moves+have+the+highest+score%2C+one+is%0Apicked+randomly+to+break+the+tie.+Breaking+ties+randomly+leads+to+better+results.%0A263%0AIt+is+possible+to+disable+breaking+ties+randomly+by+explicitly+setting%0AbreakTieRandomly+to+false%2C+but+that%E2%80%99s+almost+never+a+good+idea%3A%0A%EF%81%9A+%E2%80%A2+If+an+earlier+move+is+better+than+a+later+move+with+the+same+score%2C+the+scorecalculator+should+add+an+extra+softer+score+level+to+score+the+first+move+as%0Aslightly+better.+Don%E2%80%99t+rely+on+move+selection+order+to+enforce+that.%0A%E2%80%A2+Random+tie+breaking+does+not+affect+reproducibility.%0A11.2.4.1.+Accepted+Count+Limit%0AWhen+there+are+many+possible+moves%2C+it+becomes+inefficient+to+evaluate+all+of+them+at+every+step.%0ATo+evaluate+only+a+random+subset+of+all+the+moves%2C+use%3A%0A%E2%80%A2+An+acceptedCountLimit+integer%2C+which+specifies+how+many+accepted+moves+should+be+evaluated%0Aduring+each+step.+By+default%2C+all+accepted+moves+are+evaluated+at+every+step.%0A%C2%A0+%3Cforager%3E%0A%C2%A0+++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+%3C%2Fforager%3E%0AUnlike+the+n+queens+problem%2C+real+world+problems+require+the+use+of+acceptedCountLimit.+Start+from%0Aan+acceptedCountLimit+that+takes+a+step+in+less+than+two+seconds.+Turn+on+INFO+logging+to+see+the%0Astep+times.+Use+the+Benchmarker+to+tweak+the+value.%0AWith+a+low+acceptedCountLimit+%28so+a+fast+stepping+algorithm%29%2C+it+is+recommended+to%0Aavoid+using+selectionOrder+SHUFFLED+because+the+shuffling+generates+a+random%0A%EF%81%AA+number+for+every+element+in+the+selector%2C+taking+up+a+lot+of+time%2C+but+only+a+few%0Aelements+are+actually+selected.%0A11.2.4.2.+Pick+Early+Type%0AA+forager+can+pick+a+move+early+during+a+step%2C+ignoring+subsequent+selected+moves.+There+are+three%0Apick+early+types+for+Local+Search%3A%0A%E2%80%A2+NEVER%3A+A+move+is+never+picked+early%3A+all+accepted+moves+are+evaluated+that+the+selection+allows.%0AThis+is+the+default.%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3ENEVER%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%E2%80%A2+FIRST_BEST_SCORE_IMPROVING%3A+Pick+the+first+accepted+move+that+improves+the+best+score.+If+none%0Aimprove+the+best+score%2C+it+behaves+exactly+like+the+pickEarlyType+NEVER.%0A264%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_BEST_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%E2%80%A2+FIRST_LAST_STEP_SCORE_IMPROVING%3A+Pick+the+first+accepted+move+that+improves+the+last+step+score.%0AIf+none+improve+the+last+step+score%2C+it+behaves+exactly+like+the+pickEarlyType+NEVER.%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_LAST_STEP_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A11.3.+Hill+Climbing+%28Simple+Local+Search%29%0A11.3.1.+Algorithm+Description%0AHill+Climbing+tries+all+selected+moves+and+then+takes+the+best+move%2C+which+is+the+move+which+leads%0Ato+the+solution+with+the+highest+score.+That+best+move+is+called+the+step+move.+From+that+new%0Asolution%2C+it+again+tries+all+selected+moves+and+takes+the+best+move+and+continues+like+that+iteratively.%0AIf+multiple+selected+moves+tie+for+the+best+move%2C+one+of+them+is+randomly+chosen+as+the+best+move.%0ANotice+that+once+a+queen+has+moved%2C+it+can+be+moved+again+later.+This+is+a+good+thing%2C+because+in+an%0A265%0ANP-complete+problem+it%E2%80%99s+impossible+to+predict+what+will+be+the+optimal+final+value+for+a+planning%0Avariable.%0A11.3.2.+Stuck+in+Local+Optima%0AHill+Climbing+always+takes+improving+moves.+This+may+seem+like+a+good+thing%2C+but+it%E2%80%99s+not%3A+Hill%0AClimbing+can+easily+get+stuck+in+a+local+optimum.+This+happens+when+it+reaches+a+solution+for%0Awhich+all+the+moves+deteriorate+the+score.+Even+if+it+picks+one+of+those+moves%2C+the+next+step+might%0Ago+back+to+the+original+solution+and+which+case+chasing+its+own+tail%3A%0AImprovements+upon+Hill+Climbing+%28such+as+Tabu+Search%2C+Simulated+Annealing+and+Late+Acceptance%29%0Aaddress+the+problem+of+being+stuck+in+local+optima.+Therefore%2C+it%E2%80%99s+recommend+to+never+use+Hill%0AClimbing%2C+unless+you%E2%80%99re+absolutely+sure+there+are+no+local+optima+in+your+planning+problem.%0A11.3.3.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3EHILL_CLIMBING%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AAdvanced+configuration%3A%0A266%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CacceptorType%3EHILL_CLIMBING%3C%2FacceptorType%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.4.+Tabu+Search%0A11.4.1.+Algorithm+Description%0ATabu+Search+works+like+Hill+Climbing%2C+but+it+maintains+a+tabu+list+to+avoid+getting+stuck+in+local%0Aoptima.+The+tabu+list+holds+recently+used+objects+that+are+taboo+to+use+for+now.+Moves+that+involve%0Aan+object+in+the+tabu+list%2C+are+not+accepted.+The+tabu+list+objects+can+be+anything+related+to+the+move%2C%0Asuch+as+the+planning+entity%2C+planning+value%2C+move%2C+solution%2C+%E2%80%A6+Here%E2%80%99s+an+example+with+entity+tabu%0Afor+four+queens%2C+so+the+queens+are+put+in+the+tabu+list%3A%0A%EF%81%9A+It%E2%80%99s+called+Tabu+Search%2C+not+Taboo+Search.+There+is+no+spelling+error.%0A267%0AScientific+paper%3A+Tabu+Search+-+Part+1+and+Part+2+by+Fred+Glover+%281989+-+1990%29%0A11.4.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3ETABU_SEARCH%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AWhen+Tabu+Search+takes+steps+it+creates+one+or+more+tabu%E2%80%99s.+For+a+number+of+steps%2C+it+does+not%0Aaccept+a+move+if+that+move+breaks+tabu.+That+number+of+steps+is+the+tabu+size.+Advanced%0Aconfiguration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AA+Tabu+Search+acceptor+should+be+combined+with+a+high+acceptedCountLimit%2C+such%0A%EF%81%AA+as+1000.%0APlanner+implements+several+tabu+types%3A%0A%E2%80%A2+Planning+entity+tabu+%28recommended%29+makes+the+planning+entities+of+recent+steps+tabu.+For%0Aexample%2C+for+N+queens+it+makes+the+recently+moved+queens+tabu.+It%E2%80%99s+recommended+to+start+with%0Athis+tabu+type.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0ATo+avoid+hard+coding+the+tabu+size%2C+configure+a+tabu+ratio%2C+relative+to+the+number+of+entities%2C+for%0Aexample+2%25%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuRatio%3E0.02%3C%2FentityTabuRatio%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Planning+value+tabu+makes+the+planning+values+of+recent+steps+tabu.+For+example%2C+for+N+queens%0A268%0Ait+makes+the+recently+moved+to+rows+tabu.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CvalueTabuSize%3E7%3C%2FvalueTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0ATo+avoid+hard+coding+the+tabu+size%2C+configure+a+tabu+ratio%2C+relative+to+the+number+of+values%2C+for%0Aexample+2%25%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CvalueTabuRatio%3E0.02%3C%2FvalueTabuRatio%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Move+tabu+makes+recent+steps+tabu.+It+does+not+accept+a+move+equal+to+one+of+those+steps.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CmoveTabuSize%3E7%3C%2FmoveTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Undo+move+tabu+makes+the+undo+move+of+recent+steps+tabu.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CundoMoveTabuSize%3E7%3C%2FundoMoveTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%E2%80%A2+Solution+tabu+makes+recently+visited+solutions+tabu.+It+does+not+accept+a+move+that+leads+to+one%0Aof+those+solutions.+It+requires+that+the+Solution+implements+equals%28%29+and+hashCode%28%29+properly.+If%0Ayou+can+spare+the+memory%2C+don%E2%80%99t+be+cheap+on+the+tabu+size.%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsolutionTabuSize%3E1000%3C%2FsolutionTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0AFor+non-trivial+cases%2C+solution+tabu+is+usually+useless+because+the+search+space+size+makes+it%0Astatistically+highly+unlikely+to+reach+the+same+solution+twice.+Therefore+its+use+is+not%0Arecommended%2C+except+for+small+datasets.%0ASometimes+it%E2%80%99s+useful+to+combine+tabu+types%3A%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++++%3CvalueTabuSize%3E3%3C%2FvalueTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A269%0AIf+the+tabu+size+is+too+small%2C+the+solver+can+still+get+stuck+in+a+local+optimum.+On+the+other+hand%2C+if%0Athe+tabu+size+is+too+large%2C+the+solver+can+be+inefficient+by+bouncing+of+the+walls.+Use+the%0ABenchmarker+to+fine+tweak+your+configuration.%0A11.5.+Simulated+Annealing%0A11.5.1.+Algorithm+Description%0ASimulated+Annealing+evaluates+only+a+few+moves+per+step%2C+so+it+steps+quickly.+In+the+classic%0Aimplementation%2C+the+first+accepted+move+is+the+winning+step.+A+move+is+accepted+if+it+doesn%E2%80%99t%0Adecrease+the+score+or+-+in+case+it+does+decrease+the+score+-+it+passes+a+random+check.+The+chance+that%0Aa+decreasing+move+passes+the+random+check+decreases+relative+to+the+size+of+the+score+decrement%0Aand+the+time+the+phase+has+been+running+%28which+is+represented+as+the+temperature%29.%0ASimulated+Annealing+does+not+always+pick+the+move+with+the+highest+score%2C+neither+does+it+evaluate%0Amany+moves+per+step.+At+least+at+first.+Instead%2C+it+gives+non+improving+moves+also+a+chance+to+be%0Apicked%2C+depending+on+its+score+and+the+time+gradient+of+the+Termination.+In+the+end%2C+it+gradually%0Aturns+into+Hill+Climbing%2C+only+accepting+improving+moves.%0A11.5.2.+Configuration%0AStart+with+a+simulatedAnnealingStartingTemperature+set+to+the+maximum+score+delta+a+single+move%0Acan+cause.+Use+the+Benchmarker+to+tweak+the+value.+Advanced+configuration%3A%0A270%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsimulatedAnnealingStartingTemperature%3E%0A2hard%2F100soft%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ASimulated+Annealing+should+use+a+low+acceptedCountLimit.+The+classic+algorithm+uses+an%0AacceptedCountLimit+of+1%2C+but+often+4+performs+better.%0ASimulated+Annealing+can+be+combined+with+a+tabu+acceptor+at+the+same+time.+That+gives+Simulated%0AAnnealing+salted+with+a+bit+of+Tabu.+Use+a+lower+tabu+size+than+in+a+pure+Tabu+Search+configuration.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CsimulatedAnnealingStartingTemperature%3E%0A2hard%2F100soft%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++++%3CentityTabuSize%3E5%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.6.+Late+Acceptance%0A11.6.1.+Algorithm+Description%0ALate+Acceptance+%28also+known+as+Late+Acceptance+Hill+Climbing%29+also+evaluates+only+a+few+moves+per%0Astep.+A+move+is+accepted+if+it+does+not+decrease+the+score%2C+or+if+it+leads+to+a+score+that+is+at+least+the%0Alate+score+%28which+is+the+winning+score+of+a+fixed+number+of+steps+ago%29.%0A271%0AScientific+paper%3A+The+Late+Acceptance+Hill-Climbing+Heuristic+by+Edmund+K.+Burke%2C+Yuri+Bykov%0A%282012%29%0A11.6.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3ELATE_ACCEPTANCE%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ALate+Acceptance+accepts+any+move+that+has+a+score+which+is+higher+than+the+best+score+of+a+number%0Aof+steps+ago.+That+number+of+steps+is+the+lateAcceptanceSize.+Advanced+configuration%3A%0A272%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3ClateAcceptanceSize%3E400%3C%2FlateAcceptanceSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0ALate+Acceptance+should+use+a+low+acceptedCountLimit.%0ALate+Acceptance+can+be+combined+with+a+tabu+acceptor+at+the+same+time.+That+gives+Late%0AAcceptance+salted+with+a+bit+of+Tabu.+Use+a+lower+tabu+size+than+in+a+pure+Tabu+Search%0Aconfiguration.%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3ClateAcceptanceSize%3E400%3C%2FlateAcceptanceSize%3E%0A%C2%A0+++++%3CentityTabuSize%3E5%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0A11.7.+Step+Counting+Hill+Climbing%0A11.7.1.+Algorithm+Description%0AStep+Counting+Hill+Climbing+also+evaluates+only+a+few+moves+per+step.+For+a+number+of+steps%2C+it%0Akeeps+the+step+score+as+a+threshold.+A+move+is+accepted+if+it+does+not+decrease+the+score%2C+or+if+it+leads%0Ato+a+score+that+is+at+least+the+threshold+score.%0AScientific+paper%3A+An+initial+study+of+a+novel+Step+Counting+Hill+Climbing+heuristic+applied+to%0Atimetabling+problems+by+Yuri+Bykov%2C+Sanja+Petrovic+%282013%29%0A11.7.2.+Configuration%0AStep+Counting+Hill+Climbing+accepts+any+move+that+has+a+score+which+is+higher+than+a+threshold%0Ascore.+Every+number+of+steps+%28specified+by+stepCountingHillClimbingSize%29%2C+the+threshold+score+is+set%0Ato+the+step+score.%0A273%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CstepCountingHillClimbingSize%3E400%3C%2FstepCountingHillClimbingSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1%3C%2FacceptedCountLimit%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AStep+Counting+Hill+Climbing+should+use+a+low+acceptedCountLimit.%0AStep+Counting+Hill+Climbing+can+be+combined+with+a+tabu+acceptor+at+the+same+time%2C+similar+as%0Ashown+in+the+Late+Acceptance+section.%0A11.8.+Strategic+Oscillation%0A11.8.1.+Algorithm+Description%0AStrategic+Oscillation+is+an+add-on%2C+which+works+especially+well+with+Tabu+Search.+Instead+of+picking%0Athe+accepted+move+with+the+highest+score%2C+it+employs+a+different+mechanism%3A+If+there%E2%80%99s+an%0Aimproving+move%2C+it+picks+it.+If+there%E2%80%99s+no+improving+move+however%2C+it+prefers+moves+which+improve%0Aa+softer+score+level%2C+over+moves+which+break+a+harder+score+level+less.%0A11.8.2.+Configuration%0AConfigure+a+finalistPodiumType%2C+for+example+in+a+Tabu+Search+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CentityTabuSize%3E7%3C%2FentityTabuSize%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CacceptedCountLimit%3E1000%3C%2FacceptedCountLimit%3E%0A%C2%A0+++++%3CfinalistPodiumType%3ESTRATEGIC_OSCILLATION%3C%2FfinalistPodiumType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AThe+following+finalistPodiumTypes+are+supported%3A%0A%E2%80%A2+HIGHEST_SCORE+%28default%29%3A+Pick+the+accepted+move+with+the+highest+score.%0A%E2%80%A2+STRATEGIC_OSCILLATION%3A+Alias+for+the+default+strategic+oscillation+variant.%0A%E2%80%A2+STRATEGIC_OSCILLATION_BY_LEVEL%3A+If+there+is+an+accepted+improving+move%2C+pick+it.+If+no+such+move%0Aexists%2C+prefer+an+accepted+move+which+improves+a+softer+score+level+over+one+that+doesn%E2%80%99t+%28even%0Aif+it+has+a+better+harder+score+level%29.+A+move+is+improving+if+it%E2%80%99s+better+than+the+last+completed%0A274%0Astep+score.%0A%E2%80%A2+STRATEGIC_OSCILLATION_BY_LEVEL_ON_BEST_SCORE%3A+Like+STRATEGIC_OSCILLATION_BY_LEVEL%2C+but+define%0Aimproving+as+better+than+the+best+score+%28instead+of+the+last+completed+step+score%29.%0A11.9.+Variable+Neighborhood+Descent%0A11.9.1.+Algorithm+Description%0AVariable+Neighborhood+Descent+iteratively+tries+multiple+move+selectors+in+original+order+%28depleting%0Aeach+selector+entirely+before+trying+the+next+one%29%2C+picking+the+first+improving+move+%28which+also%0Aresets+the+iterator+back+to+the+first+move+selector%29.%0ADespite+that+VND+has+a+name+that+ends+with+descent+%28from+the+research+papers%29%2C%0A%EF%81%9A+the+implementation+will+ascend+to+a+higher+score+%28which+is+a+better+score%29.%0A11.9.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3ClocalSearchType%3EVARIABLE_NEIGHBORHOOD_DESCENT%3C%2FlocalSearchType%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AAdvanced+configuration%3A%0A%C2%A0+%3ClocalSearch%3E%0A%C2%A0+++%3CunionMoveSelector%3E%0A%C2%A0+++++%3CselectionOrder%3EORIGINAL%3C%2FselectionOrder%3E%0A%C2%A0+++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FunionMoveSelector%3E%0A%C2%A0+++%3Cacceptor%3E%0A%C2%A0+++++%3CacceptorType%3EHILL_CLIMBING%3C%2FacceptorType%3E%0A%C2%A0+++%3C%2Facceptor%3E%0A%C2%A0+++%3Cforager%3E%0A%C2%A0+++++%3CpickEarlyType%3EFIRST_LAST_STEP_SCORE_IMPROVING%3C%2FpickEarlyType%3E%0A%C2%A0+++%3C%2Fforager%3E%0A%C2%A0+%3C%2FlocalSearch%3E%0AVariable+Neighborhood+Descent+doesn%E2%80%99t+scale+well%2C+but+it+is+useful+in+some+use+cases+with+a+very%0Aerratic+score+landscape.%0A275%0A11.10.+Using+a+Custom+Termination%2C+MoveSelector%2C%0AEntitySelector%2C+ValueSelector+or+Acceptor%0APlug+in+a+custom+Termination%2C+MoveSelector%2C+EntitySelector%2C+ValueSelector+or+Acceptor+by+extending%0Athe+abstract+class+and+also+the+related+%5C*Config+class.%0AExtending+Config+classes+is+not+covered+by+the+backwards+compatbility+gaurantee.%0A%EF%81%AA+Whenever+possible%2C+it%E2%80%99s+better+to+just+use+custom+properties+instead.%0AFor+example%2C+to+use+a+custom+Termination%2C+extend+the+AbstractTermination+class%2C+extend+the%0ATerminationConfig+class+and+configure+it+in+the+solver+configuration.%0A%3Csolver%3E%0A%C2%A0+%3Ctermination+class%3D%22...MyTerminationConfig%22%3E%0A%C2%A0+++%3CmyProperty%3EmyValue%3C%2FmyProperty%3E%0A%C2%A0+%3C%2Ftermination%3E%0A%3C%2Fsolver%3E%0AIt%E2%80%99s+not+possible+to+inject+a+Termination%2C+%E2%80%A6+instance+directly+%28to+avoid+extending+a%0AConfig+class+too%29+because%3A%0A%E2%80%A2+A+SolverFactory+can+build+multiple+Solver+instances%2C+which+each+require+a%0Adistinct+Termination%2C+%E2%80%A6+instance.%0A%EF%81%9A+%E2%80%A2+A+solver+configuration+needs+to+be+serializable+from+and+to+XML.+This+makes%0Abenchmarking+with+PlannerBenchmark+particularly+easy+because+you+can%0Aconfigure+different+Solver+variants+in+XML.%0A%E2%80%A2+A+Config+class+is+often+easier+and+clearer+to+configure.+For+example%3A%0ATerminationConfig+translates+minutesSpentLimit+and+secondsSpentLimit+into%0AtimeMillisSpentLimit.%0AIf+you+write+a+custom+implementation+of+any+of+those+classes%2C+let+us+know+why+on+our+forum.+If+it%E2%80%99s%0Anot+domain+specific%2C+you+might+want+to+consider+contributing+it+back+as+a+pull+request+on+github%3A%0Awe%E2%80%99ll+optimize+it+and+take+it+along+in+future+refactorings.%0A276%0AChapter+12.+Evolutionary+Algorithms%0A12.1.+Overview%0AEvolutionary+Algorithms+work+on+a+population+of+solutions+and+evolve+that+population.%0A12.2.+Evolutionary+Strategies%0AThis+algorithm+has+not+been+implemented+yet.%0A12.3.+Genetic+Algorithms%0AThis+algorithm+has+not+been+implemented+yet.%0AA+good+Genetic+Algorithms+prototype+in+Planner+was+written+some+time+ago%2C+but+it%0Awasn%E2%80%99t+practical+to+merge+and+support+it+at+the+time.+The+results+of+Genetic%0AAlgorithms+were+consistently+and+seriously+inferior+to+all+the+Local+Search+variants%0A%EF%81%9A+%28except+Hill+Climbing%29+on+all+use+cases+tried.+Nevertheless%2C+a+future+version+of%0APlanner+will+add+support+for+Genetic+Algorithms%2C+so+you+can+easily+benchmark%0AGenetic+Algorithms+on+your+use+case+too.%0A277%0AChapter+13.+Hyperheuristics%0A13.1.+Overview%0AA+hyperheuristic+automates+the+decision+which+heuristic%28s%29+to+use+on+a+specific+data+set.%0AA+future+version+of+Planner+will+have+native+support+for+hyperheuristics.+Meanwhile%2C+it%E2%80%99s+possible+to%0Aimplement+it+yourself%3A+Based+on+the+size+or+difficulty+of+a+data+set+%28which+is+a+criterion%29%2C+use+a%0Adifferent+Solver+configuration+%28or+adjust+the+default+configuration+using+the+Solver+configuration%0AAPI%29.+The+Benchmarker+can+help+to+identify+such+criteria.%0A278%0AChapter+14.+Partitioned+Search%0A14.1.+Algorithm+Description%0AIt+is+often+more+efficient+to+partition+large+data+sets+%28usually+above+5000+planning+entities%29+into%0Asmaller+pieces+and+solve+them+separately.+Partition+Search+is+multithreaded%2C+so+it+provides+a%0Aperformance+boost+on+multi-core+machines+due+to+higher+CPU+utilization.+Additionally%2C+even+when%0Aonly+using+one+CPU%2C+it+finds+an+initial+solution+faster%2C+because+the+search+space+sum+of+a+partitioned%0AConstruction+Heuristic+is+far+less+than+its+non-partitioned+variant.%0AHowever%2C+partitioning+does+lead+to+suboptimal+results%2C+even+if+the+pieces+are+solved+optimally%2C+as%0Ashown+below%3A%0AIt+effectively+trades+a+short+term+gain+in+solution+quality+for+long+term+loss.+One+way+to+compensate%0Afor+this+loss%2C+is+to+run+a+non-partitioned+Local+Search+after+the+Partitioned+Search+phase.%0ANot+all+use+cases+can+be+partitioned.+Partitioning+only+works+for+use+cases+where%0A%EF%81%9A+the+planning+entities+and+value+ranges+can+be+split+into+n+partitions%2C+without+any+of%0Athe+constraints+crossing+boundaries+between+partitions.%0A279%0A14.2.+Configuration%0ASimplest+configuration%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AThere+are+several+ways+to+partition+a+solution.%0AAdvanced+configuration%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++...%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CrunnablePartThreadLimit%3E4%3C%2FrunnablePartThreadLimit%3E%0A%C2%A0+++%3CconstructionHeuristic%3E...%3C%2FconstructionHeuristic%3E%0A%C2%A0+++%3ClocalSearch%3E...%3C%2FlocalSearch%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AThe+runnablePartThreadLimit+allows+limiting+CPU+usage+to+avoid+hanging+your+machine%2C+see+below.%0ATo+run+in+an+environment+that+doesn%E2%80%99t+like+arbitrary+thread+creation%2C+plug+in+a+custom+thread%0Afactory.%0AA+logging+level+of+debug+or+trace+causes+congestion+in+multithreaded+Partitioned%0A%EF%81%AA+Search+and+slows+down+the+score+calculation+speed.%0AJust+like+a+%3Csolver%3E+element%2C+the+%3CpartitionedSearch%3E+element+can+contain+one+or+more+phases.+Each%0Aof+those+phases+will+be+run+on+each+partition.%0AA+common+configuration+is+to+first+run+a+Partitioned+Search+phase+%28which+includes+a+Construction%0AHeuristic+and+a+Local+Search%29+followed+by+a+non-partitioned+Local+Search+phase%3A%0A280%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++%3CsolutionPartitionerClass%3E...CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CconstructionHeuristic%2F%3E%0A%C2%A0+++%3ClocalSearch%3E%0A%C2%A0+++++%3Ctermination%3E%0A%C2%A0+++++++%3CsecondsSpentLimit%3E60%3C%2FsecondsSpentLimit%3E%0A%C2%A0+++++%3C%2Ftermination%3E%0A%C2%A0+++%3C%2FlocalSearch%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0A%C2%A0+%3ClocalSearch%2F%3E%0A14.3.+Partitioning+a+Solution%0A14.3.1.+Custom+SolutionPartitioner%0ATo+use+a+custom+SolutionPartitioner%2C+configure+one+on+the+Partitioned+Search+phase%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0%0A%3CsolutionPartitionerClass%3Eorg.optaplanner.examples.cloudbalancing.optional.partitioner%0A.CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0AImplement+the+SolutionPartitioner+interface%3A%0Apublic+interface+SolutionPartitioner%3CSolution_%3E+%7B%0A%C2%A0+++List%3CSolution_%3E+splitWorkingSolution%28ScoreDirector%3CSolution_%3E+scoreDirector%2C%0AInteger+runnablePartThreadLimit%29%3B%0A%7D%0AThe+size%28%29+of+the+returned+List+is+the+partCount+%28the+number+of+partitions%29.+This+can+be+decided%0Adynamically%2C+for+example%2C+based+on+the+size+of+the+non-partitioned+solution.+The+partCount+is%0Aunrelated+to+the+runnablePartThreadLimit.%0AFor+example%3A%0Apublic+class+CloudBalancePartitioner+implements+SolutionPartitioner%3CCloudBalance%3E+%7B%0A%C2%A0+++private+int+partCount+%3D+4%3B%0A%C2%A0+++private+int+minimumProcessListSize+%3D+75%3B%0A%C2%A0+++%40Override%0A%C2%A0+++public+List%3CCloudBalance%3E+splitWorkingSolution%28ScoreDirector%3CCloudBalance%3E%0A281%0AscoreDirector%2C+Integer+runnablePartThreadLimit%29+%7B%0A%C2%A0+++++++CloudBalance+originalSolution+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++List%3CCloudComputer%3E+originalComputerList+%3D+originalSolution.getComputerList%28%29%3B%0A%C2%A0+++++++List%3CCloudProcess%3E+originalProcessList+%3D+originalSolution.getProcessList%28%29%3B%0A%C2%A0+++++++int+partCount+%3D+this.partCount%3B%0A%C2%A0+++++++if+%28originalProcessList.size%28%29+%2F+partCount+%3C+minimumProcessListSize%29+%7B%0A%C2%A0+++++++++++partCount+%3D+originalProcessList.size%28%29+%2F+minimumProcessListSize%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++List%3CCloudBalance%3E+partList+%3D+new+ArrayList%3C%3E%28partCount%29%3B%0A%C2%A0+++++++for+%28int+i+%3D+0%3B+i+%3C+partCount%3B+i%2B%2B%29+%7B%0A%C2%A0+++++++++++CloudBalance+partSolution+%3D+new+CloudBalance%28originalSolution.getId%28%29%2C%0A%C2%A0+++++++++++++++++++new+ArrayList%3C%3E%28originalComputerList.size%28%29+%2F+partCount+%2B+1%29%2C%0A%C2%A0+++++++++++++++++++new+ArrayList%3C%3E%28originalProcessList.size%28%29+%2F+partCount+%2B+1%29%29%3B%0A%C2%A0+++++++++++partList.add%28partSolution%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++int+partIndex+%3D+0%3B%0A%C2%A0+++++++Map%3CLong%2C+Pair%3CInteger%2C+CloudComputer%3E%3E+idToPartIndexAndComputerMap+%3D+new%0AHashMap%3C%3E%28originalComputerList.size%28%29%29%3B%0A%C2%A0+++++++for+%28CloudComputer+originalComputer+%3A+originalComputerList%29+%7B%0A%C2%A0+++++++++++CloudBalance+part+%3D+partList.get%28partIndex%29%3B%0A%C2%A0+++++++++++CloudComputer+computer+%3D+new+CloudComputer%28%0A%C2%A0+++++++++++++++++++originalComputer.getId%28%29%2C%0A%C2%A0+++++++++++++++++++originalComputer.getCpuPower%28%29%2C+originalComputer.getMemory%28%29%2C%0A%C2%A0+++++++++++++++++++originalComputer.getNetworkBandwidth%28%29%2C+originalComputer.getCost%28%0A%29%29%3B%0A%C2%A0+++++++++++part.getComputerList%28%29.add%28computer%29%3B%0A%C2%A0+++++++++++idToPartIndexAndComputerMap.put%28computer.getId%28%29%2C+Pair.of%28partIndex%2C%0Acomputer%29%29%3B%0A%C2%A0+++++++++++partIndex+%3D+%28partIndex+%2B+1%29+%25+partList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++partIndex+%3D+0%3B%0A%C2%A0+++++++for+%28CloudProcess+originalProcess+%3A+originalProcessList%29+%7B%0A%C2%A0+++++++++++CloudBalance+part+%3D+partList.get%28partIndex%29%3B%0A%C2%A0+++++++++++CloudProcess+process+%3D+new+CloudProcess%28%0A%C2%A0+++++++++++++++++++originalProcess.getId%28%29%2C%0A%C2%A0+++++++++++++++++++originalProcess.getRequiredCpuPower%28%29%2C+originalProcess%0A.getRequiredMemory%28%29%2C%0A%C2%A0+++++++++++++++++++originalProcess.getRequiredNetworkBandwidth%28%29%29%3B%0A%C2%A0+++++++++++part.getProcessList%28%29.add%28process%29%3B%0A%C2%A0+++++++++++if+%28originalProcess.getComputer%28%29+%21%3D+null%29+%7B%0A%C2%A0+++++++++++++++Pair%3CInteger%2C+CloudComputer%3E+partIndexAndComputer+%3D%0AidToPartIndexAndComputerMap.get%28%0A%C2%A0+++++++++++++++++++++++originalProcess.getComputer%28%29.getId%28%29%29%3B%0A%C2%A0+++++++++++++++if+%28partIndexAndComputer+%3D%3D+null%29+%7B%0A%C2%A0+++++++++++++++++++throw+new+IllegalStateException%28%22The+initialized+process+%28%22+%2B%0AoriginalProcess%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+has+a+computer+%28%22+%2B+originalProcess.getComputer%28%29%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+which+doesn%27t+exist+in+the+originalSolution+%28%22+%2B%0AoriginalSolution+%2B+%22%29.%22%29%3B%0A282%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++++++if+%28partIndex+%21%3D+partIndexAndComputer.getLeft%28%29.intValue%28%29%29+%7B%0A%C2%A0+++++++++++++++++++throw+new+IllegalStateException%28%22The+initialized+process+%28%22+%2B%0AoriginalProcess%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+with+partIndex+%28%22+%2B+partIndex%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+has+a+computer+%28%22+%2B+originalProcess.getComputer%28%29%0A%C2%A0+++++++++++++++++++++++++++%2B+%22%29+which+belongs+to+another+partIndex+%28%22+%2B%0ApartIndexAndComputer.getLeft%28%29+%2B+%22%29.%22%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++++++process.setComputer%28partIndexAndComputer.getRight%28%29%29%3B%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++partIndex+%3D+%28partIndex+%2B+1%29+%25+partList.size%28%29%3B%0A%C2%A0+++++++%7D%0A%C2%A0+++++++return+partList%3B%0A%C2%A0+++%7D%0A%7D%0ATo+configure+values+of+a+SolutionPartitioner+dynamically+in+the+solver+configuration+%28so+the%0ABenchmarker+can+tweak+those+parameters%29%2C+add+the+solutionPartitionerCustomProperties+element%0Aand+use+custom+properties%3A%0A%C2%A0+%3CpartitionedSearch%3E%0A%C2%A0+++%3CsolutionPartitionerClass%3E...CloudBalancePartitioner%3C%2FsolutionPartitionerClass%3E%0A%C2%A0+++%3CsolutionPartitionerCustomProperties%3E%0A%C2%A0+++++%3CmyPartCount%3E8%3C%2FmyPartCount%3E%0A%C2%A0+++++%3CmyMinimumProcessListSize%3E100%3C%2FmyMinimumProcessListSize%3E%0A%C2%A0+++%3C%2FsolutionPartitionerCustomProperties%3E%0A%C2%A0+%3C%2FpartitionedSearch%3E%0A14.4.+Runnable+Part+Thread+Limit%0AWhen+running+a+multithreaded+solver%2C+such+as+Partitioned+Search%2C+CPU+power+can+quickly+become%0Aa+scarce+resource%2C+which+can+cause+other+processes+or+threads+to+hang+or+freeze.+However%2C+Planner%0Ahas+a+system+to+prevent+CPU+starving+of+other+processes+%28such+as+an+SSH+connection+in+production%0Aor+your+IDE+in+development%29+or+other+threads+%28such+as+the+servlet+threads+that+handle+REST%0Arequests%29.%0AAs+explained+in+sizing+hardware+and+software%2C+each+solver+%28including+each+child+solver%29+does+no+IO%0Aduring+solve%28%29+and+therefore+saturates+one+CPU+core+completely.+In+Partitioned+Search%2C+every%0Apartition+always+has+its+own+thread%2C+called+a+part+thread.+It+is+impossible+for+two+partitions+to+share%0Aa+thread%2C+because+of+asynchronous+termination%3A+the+second+thread+would+never+run.+Every+part%0Athread+will+try+to+consume+one+CPU+core+entirely%2C+so+if+there+are+more+partitions+than+CPU+cores%2C%0Athis+will+probably+hang+the+system.+Thread.setPriority%28%29+is+often+too+weak+to+solve+this+hogging%0Aproblem%2C+so+another+approach+is+used.%0AThe+runnablePartThreadLimit+parameter+specifies+how+many+part+threads+are+runnable+at+the+same%0Atime.+The+other+part+threads+will+temporarily+block+and+therefore+will+not+consume+any+CPU+power.%0A283%0AThis+parameter+basically+specifies+how+many+CPU+cores+are+donated+to+Planner.+All+part%0Athreads+share+the+CPU+cores+in+a+round-robin+manner+to+consume+%28more+or+less%29+the+same+number%0Aof+CPU+cycles%3A%0AThe+following+runnablePartThreadLimit+options+are+supported%3A%0A%E2%80%A2+UNLIMITED%3A+Allow+Planner+to+occupy+all+CPU+cores%2C+do+not+avoid+hogging.+Useful+if+a+no+hogging%0ACPU+policy+is+configured+on+the+OS+level.%0A%E2%80%A2+AUTO+%28default%29%3A+Let+Planner+decide+how+many+CPU+cores+to+occupy.+This+formula+is+based+on%0Aexperience.+It+does+not+hog+all+CPU+cores+on+a+multi-core+machine.%0A%E2%80%A2+Static+number%3A+The+number+of+CPU+cores+to+consume.+For+example%3A%0A%3CrunnablePartThreadLimit%3E2%3C%2FrunnablePartThreadLimit%3E%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+CPU+cores+to+occupy.+It+can+use+the+variable%0AavailableProcessorCount.+For+example%3A%0A%3CrunnablePartThreadLimit%3EavailableProcessorCount+-+2%3C%2FrunnablePartThreadLimit%3E%0A284%0AIf+the+runnablePartThreadLimit+is+equal+to+or+higher+than+the+number+of+available%0A%EF%81%B1+processors%2C+the+host+is+likely+to+hang+or+freeze%2C+unless+there+is+an+OS+specific+policy%0Ain+place+to+avoid+Planner+from+hogging+all+the+CPU+processors.%0A285%0AChapter+15.+Benchmarking+and+Tweaking%0A15.1.+Find+the+Best+Solver+Configuration%0APlanner+supports+several+optimization+algorithms%2C+so+you%E2%80%99re+probably+wondering+which+is+the+best%0Aone%3F+Although+some+optimization+algorithms+generally+perform+better+than+others%2C+it+really%0Adepends+on+your+problem+domain.+Most+solver+phases+have+parameters+which+can+be+tweaked.%0AThose+parameters+can+influence+the+results+a+lot%2C+even+though+most+solver+phases+work+pretty+well%0Aout-of-the-box.%0ALuckily%2C+Planner+includes+a+benchmarker%2C+which+allows+you+to+play+out+different+solver+phases+with%0Adifferent+settings+against+each+other+in+development%2C+so+you+can+use+the+best+configuration+for+your%0Aplanning+problem+in+production.%0A15.2.+Benchmark+Configuration%0A15.2.1.+Add+a+Dependency+on+optaplanner-benchmark%0AThe+benchmarker+is+in+a+separate+artifact+called+optaplanner-benchmark.%0AIf+you+use+Maven%2C+add+a+dependency+in+your+pom.xml+file%3A%0A286%0A%C2%A0+++%3Cdependency%3E%0A%C2%A0+++++%3CgroupId%3Eorg.optaplanner%3C%2FgroupId%3E%0A%C2%A0+++++%3CartifactId%3Eoptaplanner-benchmark%3C%2FartifactId%3E%0A%C2%A0+++%3C%2Fdependency%3E%0AThis+is+similar+for+Gradle%2C+Ivy+and+Buildr.+The+version+must+be+exactly+the+same+as+the+optaplanner-%0Acore+version+used+%28which+is+automatically+the+case+if+you+import+optaplanner-bom%29.%0AIf+you+use+ANT%2C+you%E2%80%99ve+probably+already+copied+the+required+jars+from+the+download+zip%E2%80%99s+binaries%0Adirectory.%0A15.2.2.+Run+a+Simple+Benchmark%0ATo+quickly+setup+a+benchmark%2C+create+a+PlannerBenchmarkFactory+from+your+SolverFactory%2C+load+a%0Afew+datasets+and+benchmark+them.+For+example%2C+with+3+datasets%3A%0A%C2%A0+++++++SolverFactory%3CCloudBalance%3E+solverFactory+%3D+SolverFactory%0A.createFromXmlResource%28...%29%3B%0A%C2%A0+++++++PlannerBenchmarkFactory+benchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromSolverFactory%28solverFactory%29%3B%0A%C2%A0+++++++CloudBalance+dataset1+%3D+...%3B%0A%C2%A0+++++++CloudBalance+dataset2+%3D+...%3B%0A%C2%A0+++++++CloudBalance+dataset3+%3D+...%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+benchmarkFactory.buildPlannerBenchmark%0A%28dataset1%2C+dataset2%2C+dataset3%29%3B%0A%C2%A0+++++++plannerBenchmark.benchmarkAndShowReportInBrowser%28%29%3B%0AThis+generates+a+benchmark+report+in+local%2FbenchmarkReport+and+shows+it+in+your+browser+when+it%E2%80%99s%0Afinished.+The+SolverFactory%E2%80%99s+solver+configuration+needs+a+termination+to+limit+how+long+each%0Adataset+runs.+To+configure+a+different+benchmark+directory%2C+pass+a+%60File+parameter+to%0AcreateFromSolverFactory%28%29.%0AThe+generated+benchmark+report+already+contains+interesting+information%2C+but+it+doesn%E2%80%99t+allow%0Acomparing+solver+configurations+to+find+the+best+algorithm.+To+do+that%2C+set+up+a+benchmark%0Aconfiguration%3A%0A15.2.3.+Configure+and+Run+an+Advanced+Benchmark%0ABuild+a+PlannerBenchmark+instance+with+a+PlannerBenchmarkFactory.+Configure+it+with+a+benchmark%0Aconfiguration+XML+file%2C+provided+as+a+classpath+resource%3A%0A287%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fbenchmark%2FnqueensBenchmarkConfig.xml%22%29%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+plannerBenchmarkFactory%0A.buildPlannerBenchmark%28%29%3B%0A%C2%A0+++++++plannerBenchmark.benchmark%28%29%3B%0AA+benchmark+configuration+file+looks+like+this%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fcloudbalancing%2Funsolved%2F100computers-%0A300processes.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fcloudbalancing%2Funsolved%2F200computers-%0A600processes.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Common+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ETabu+Search%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Tabu+Search+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ESimulated+Annealing%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Simulated+Annealing+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ELate+Acceptance%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%3C%21--+Late+Acceptance+specific+solver+configuration+--%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2FplannerBenchmark%3E%0AThis+PlannerBenchmark+will+try+three+configurations+%28Tabu+Search%2C+Simulated+Annealing+and+Late%0A288%0AAcceptance%29+on+two+data+sets+%28100computers-300processes+and+200computers-600processes%29%2C+so+it+will%0Arun+six+solvers.%0AEvery+%3CsolverBenchmark%3E+element+contains+a+solver+configuration+and+one+or+more%0A%3CinputSolutionFile%3E+elements.+It+will+run+the+solver+configuration+on+each+of+those+unsolved%0Asolution+files.+The+element+name+is+optional%2C+because+it+is+generated+if+absent.+The+inputSolutionFile%0Ais+read+by+a+SolutionFileIO+%28relative+to+the+working+directory%29.%0AUse+a+forward+slash+%28%2F%29+as+the+file+separator+%28for+example+in+the+element%0A%3CinputSolutionFile%3E%29.+That+will+work+on+any+platform+%28including+Windows%29.%0A%EF%81%9A%0ADo+not+use+backslash+%28%5C%29+as+the+file+separator%3A+that+breaks+portability+because+it%0Adoes+not+work+on+Linux+and+Mac.%0AThe+benchmark+report+will+be+written+in+the+directory+specified+by+the+%3CbenchmarkDirectory%3E%0Aelement+%28relative+to+the+working+directory%29.%0AIt%E2%80%99s+recommended+that+the+benchmarkDirectory+is+a+directory+ignored+for+source%0Acontrol+and+not+cleaned+by+your+build+system.+This+way+the+generated+files+are+not%0A%EF%81%9A+bloating+your+source+control+and+they+aren%E2%80%99t+lost+when+doing+a+build.+For+example%0Ain+git%2C+it+should+be+added+to+.gitignore.+Usually+that+directory+is+called+local.%0AIf+an+Exception+or+Error+occurs+in+a+single+benchmark%2C+the+entire+Benchmarker+will+not+fail-fast%0A%28unlike+everything+else+in+Planner%29.+Instead%2C+the+Benchmarker+will+continue+to+run+all+other%0Abenchmarks%2C+write+the+benchmark+report+and+then+fail+%28if+there+is+at+least+one+failing+single%0Abenchmark%29.+The+failing+benchmarks+will+be+clearly+marked+as+such+in+the+benchmark+report.%0A15.2.3.1.+Inherited+solver+benchmark%0ATo+lower+verbosity%2C+the+common+parts+of+multiple+%3CsolverBenchmark%3E+elements+are+extracted+to+the%0A%3CinheritedSolverBenchmark%3E+element.+Every+property+can+still+be+overwritten+per+%3CsolverBenchmark%3E%0Aelement.+Note+that+inherited+solver+phases+such+as+%3CconstructionHeuristic%3E+or+%3ClocalSearch%3E+are+not%0Aoverwritten+but+instead+are+added+to+the+tail+of+the+solver+phases+list.%0A15.2.4.+SolutionFileIO%3A+Input+And+Output+Of+Solution+Files%0A15.2.4.1.+SolutionFileIO+Interface%0AThe+benchmarker+needs+to+be+able+to+read+the+input+files+to+load+a+Solution.+Also%2C+it+optionally%0Awrites+the+best+Solution+of+each+benchmark+to+an+output+file.+It+does+that+through+the+SolutionFileIO%0Ainterface+which+has+a+read+and+write+method%3A%0A289%0Apublic+interface+SolutionFileIO%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++Solution_+read%28File+inputSolutionFile%29%3B%0A%C2%A0+++void+write%28Solution_+solution%2C+File+outputSolutionFile%29%3B%0A%7D%0AThe+SolutionFileIO+interface+is+in+the+optaplanner-persistence-common+jar+%28which+is+a+dependency+of%0Athe+optaplanner-benchmark+jar%29.+There+are+several+ways+to+serialize+a+solution%3A%0A15.2.4.2.+XStreamSolutionFileIO%3A+Serialize+To+And+From+An+XML+Format%0ATo+use+the+XStreamSolutionFileIO+instance+to+read+and+write+solutions%2C+configure+your+Solution+class%0Aas+an+xStreamAnnotatedClass%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++%3CxStreamAnnotatedClass%3E%0Aorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FxStreamAnnotatedClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F32queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AThose+input+files+need+to+have+been+written+with+a+XStreamSolutionFileIO+instance%2C+not+just+any%0AXStream+instance%2C+because+the+XStreamSolutionFileIO+uses+a+customized+XStream+instance.%0AThe+inputSolutionFile+needs+to+come+from+a+trusted+source%3A+if+it+contains+malicious%0Adata%2C+it+can+be+exploited.+The+XStreamSolutionFileIO+disables+the+XStream+security%0Aframework%2C+so+it+just+works+out+of+the+box.%0A%EF%81%AA%0AIf+you+expose+benchmarking+in+production%2C+use%0AXStreamSolutionFileIO.getXStream%28%29+to+enable+the+security+framework+and%0Aexplicitly+whitelist+all+marshalled+classes.%0AAdd+XStream+annotations+%28such+as+%40XStreamAlias%29+on+your+domain+classes+to+use+a+less+verbose+XML%0Aformat.+Regardless%2C+XML+is+still+a+very+verbose+format.+Reading+or+writing+large+datasets+in+this%0Aformat+can+cause+an+OutOfMemoryError%2C+StackOverflowError+or+large+performance+degradation.%0A15.2.4.3.+Custom+SolutionFileIO%3A+Serialize+To+And+From+A+Custom+Format%0AImplement+your+own+SolutionFileIO+implementation+and+configure+it+with+the+solutionFileIOClass%0Aelement+to+write+to+a+custom+format+%28such+as+a+txt+or+a+binary+format%29%3A%0A290%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0%0A%3CsolutionFileIOClass%3Eorg.optaplanner.examples.machinereassignment.persistence.MachineR%0AeassignmentFileIO%3C%2FsolutionFileIOClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3E%0Adata%2Fmachinereassignment%2Fimport%2Fmodel_a1_1.txt%3C%2FinputSolutionFile%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AIt%E2%80%99s+recommended+that+output+files+can+be+read+as+input+files%2C+which+implies+that%0AgetInputFileExtension%28%29+and+getOutputFileExtension%28%29+return+the+same+value.%0A%EF%81%B1+A+SolutionFileIO+implementation+must+be+thread-safe.%0A15.2.4.4.+Reading+An+Input+Solution+From+A+Database+%28Or+Other+Storage%29%0AThere+are+two+options+if+your+dataset+is+in+a+relational+database+or+another+type+of+repository%3A%0A%E2%80%A2+Extract+the+datasets+from+the+database+and+serialize+them+to+a+local+file+%28for+example+as+XML%0Awith+XStreamSolutionFileIO+if+XML+isn%E2%80%99t+too+verbose%29.+Then+use+those+files+in+%3CinputSolutionFile%3E%0Aelements.%0A%E2%97%A6+The+benchmarks+are+now+more+reliable+because+they+run+offline.%0A%E2%97%A6+Each+dataset+is+only+loaded+just+in+time.%0A%E2%80%A2+Load+all+the+datasets+in+advance+and+pass+them+to+the+buildPlannerBenchmark%28%29+method%3A%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+benchmarkFactory.buildPlannerBenchmark%0A%28dataset1%2C+dataset2%2C+dataset3%29%3B%0A15.2.5.+Warming+Up+The+HotSpot+Compiler%0AWithout+a+warm+up%2C+the+results+of+the+first+%28or+first+few%29+benchmarks+are+not+reliable%2C+because+they%0Awill+lose+CPU+time+on+HotSpot+JIT+compilation+%28and+possibly+DRL+compilation+too%29.%0ATo+avoid+that+distortion%2C+the+benchmarker+runs+some+of+the+benchmarks+for+30+seconds%2C+before%0Arunning+the+real+benchmarks.+That+default+warm+up+of+30+seconds+usually+suffices.+Change+it%2C+for%0Aexample+to+give+it+60+seconds%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CwarmUpSecondsSpentLimit%3E60%3C%2FwarmUpSecondsSpentLimit%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0ATurn+off+the+warm+up+phase+altogether+by+setting+it+to+zero%3A%0A291%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CwarmUpSecondsSpentLimit%3E0%3C%2FwarmUpSecondsSpentLimit%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+warm+up+time+budget+does+not+include+the+time+it+takes+to+load+the+datasets.%0A%EF%81%9A+With+large+datasets%2C+this+can+cause+the+warm+up+to+run+considerably+longer+than%0Aspecified+in+the+configuration.%0A15.2.6.+Benchmark+Blueprint%3A+A+Predefined+Configuration%0ATo+quickly+configure+and+run+a+benchmark+for+typical+solver+configs%2C+use+a%0AsolverBenchmarkBluePrint+instead+of+solverBenchmarks%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++%3CxStreamAnnotatedClass%3E%0Aorg.optaplanner.examples.nqueens.domain.NQueens%3C%2FxStreamAnnotatedClass%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F32queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++++%3CinputSolutionFile%3Edata%2Fnqueens%2Funsolved%2F64queens.xml%3C%2FinputSolutionFile%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3CscanAnnotatedClasses%2F%3E%0A%C2%A0+++++%3CscoreDirectorFactory%3E%0A%C2%A0+++++++%3CscoreDrl%3E%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fsolver%2FnQueensScoreRules.drl%3C%2FscoreDrl%3E%0A%C2%A0+++++++%3CinitializingScoreTrend%3EONLY_DOWN%3C%2FinitializingScoreTrend%3E%0A%C2%A0+++++%3C%2FscoreDirectorFactory%3E%0A%C2%A0+++++%3Ctermination%3E%0A%C2%A0+++++++%3CminutesSpentLimit%3E1%3C%2FminutesSpentLimit%3E%0A%C2%A0+++++%3C%2Ftermination%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+%3CsolverBenchmarkBluePrint%3E%0A%C2%A0%0A%3CsolverBenchmarkBluePrintType%3EEVERY_CONSTRUCTION_HEURISTIC_TYPE_WITH_EVERY_LOCAL_SEARC%0AH_TYPE%3C%2FsolverBenchmarkBluePrintType%3E%0A%C2%A0+%3C%2FsolverBenchmarkBluePrint%3E%0A%3C%2FplannerBenchmark%3E%0AThe+following+SolverBenchmarkBluePrintTypes+are+supported%3A%0A292%0A%E2%80%A2+EVERY_CONSTRUCTION_HEURISTIC_TYPE%3A+Run+every+Construction+Heuristic+type+%28First+Fit%2C+First+Fit%0ADecreasing%2C+Cheapest+Insertion%2C+%E2%80%A6%29.%0A%E2%80%A2+EVERY_LOCAL_SEARCH_TYPE%3A+Run+every+Local+Search+type+%28Tabu+Search%2C+Late+Acceptance%2C+%E2%80%A6%29+with%0Athe+default+Construction+Heuristic.%0A%E2%80%A2+EVERY_CONSTRUCTION_HEURISTIC_TYPE_WITH_EVERY_LOCAL_SEARCH_TYPE%3A+Run+every+Construction%0AHeuristic+type+with+every+Local+Search+type.%0A15.2.7.+Write+The+Output+Solution+Of+Benchmark+Runs%0AThe+best+solution+of+each+benchmark+run+can+be+written+in+the+benchmarkDirectory.+By+default%2C+this%0Ais+disabled%2C+because+the+files+are+rarely+used+and+considered+bloat.+Also%2C+on+large+datasets%2C+writing%0Athe+best+solution+of+each+single+benchmark+can+take+quite+some+time+and+memory+%28causing+an%0AOutOfMemoryError%29%2C+especially+in+a+verbose+format+like+XStream+XML.%0ATo+write+those+solutions+in+the+benchmarkDirectory%2C+enable+writeOutputSolutionEnabled%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CwriteOutputSolutionEnabled%3Etrue%3C%2FwriteOutputSolutionEnabled%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A15.2.8.+Benchmark+Logging%0ABenchmark+logging+is+configured+like+solver+logging.%0ATo+separate+the+log+messages+of+each+single+benchmark+run+into+a+separate+file%2C+use+the+MDC+with%0Akey+singleBenchmark.name+in+a+sifting+appender.+For+example+with+Logback+in+logback.xml%3A%0A%C2%A0+%3Cappender+name%3D%22fileAppender%22+class%3D%22ch.qos.logback.classic.sift.SiftingAppender%22%3E%0A%C2%A0+++%3Cdiscriminator%3E%0A%C2%A0+++++%3Ckey%3EsingleBenchmark.name%3C%2Fkey%3E%0A%C2%A0+++++%3CdefaultValue%3Eapp%3C%2FdefaultValue%3E%0A%C2%A0+++%3C%2Fdiscriminator%3E%0A%C2%A0+++%3Csift%3E%0A%C2%A0+++++%3Cappender+name%3D%22fileAppender.%24%7BsingleBenchmark.name%7D%22+class%3D%22...FileAppender%22%3E%0A%C2%A0+++++++%3Cfile%3Elocal%2Flog%2FoptaplannerBenchmark-%24%7BsingleBenchmark.name%7D.log%3C%2Ffile%3E%0A%C2%A0+++++++...%0A%C2%A0+++++%3C%2Fappender%3E%0A%C2%A0+++%3C%2Fsift%3E%0A%C2%A0+%3C%2Fappender%3E%0A15.3.+Benchmark+Report%0A293%0A15.3.1.+HTML+Report%0AAfter+running+a+benchmark%2C+an+HTML+report+will+be+written+in+the+benchmarkDirectory+with+the%0Aindex.html+filename.+Open+it+in+your+browser.+It+has+a+nice+overview+of+your+benchmark+including%3A%0A%E2%80%A2+Summary+statistics%3A+graphs+and+tables%0A%E2%80%A2+Problem+statistics+per+inputSolutionFile%3A+graphs+and+CSV%0A%E2%80%A2+Each+solver+configuration+%28ranked%29%3A+Handy+to+copy+and+paste%0A%E2%80%A2+Benchmark+information%3A+settings%2C+hardware%2C+%E2%80%A6%0A%EF%81%9A+Graphs+are+generated+by+the+excellent+JFreeChart+library.%0AThe+HTML+report+will+use+your+default+locale+to+format+numbers.+If+you+share+the+benchmark%0Areport+with+people+from+another+country%2C+consider+overwriting+the+locale+accordingly%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3Clocale%3Een_US%3C%2Flocale%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0A15.3.2.+Ranking+The+Solvers%0AThe+benchmark+report+automatically+ranks+the+solvers.+The+Solver+with+rank+0+is+called+the+favorite%0ASolver%3A+it+performs+best+overall%2C+but+it+might+not+be+the+best+on+every+problem.+It%E2%80%99s+recommended+to%0Ause+that+favorite+Solver+in+production.%0AHowever%2C+there+are+different+ways+of+ranking+the+solvers.+Configure+it+like+this%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingType%3ETOTAL_SCORE%3C%2FsolverRankingType%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+following+solverRankingTypes+are+supported%3A%0A%E2%80%A2+TOTAL_SCORE+%28default%29%3A+Maximize+the+overall+score%2C+so+minimize+the+overall+cost+if+all+solutions%0Awould+be+executed.%0A%E2%80%A2+WORST_SCORE%3A+Minimize+the+worst+case+scenario.%0A%E2%80%A2+TOTAL_RANKING%3A+Maximize+the+overall+ranking.+Use+this+if+your+datasets+differ+greatly+in+size+or%0Adifficulty%2C+producing+a+difference+in+Score+magnitude.%0A294%0ASolvers+with+at+least+one+failed+single+benchmark+do+not+get+a+ranking.+Solvers+with+not+fully%0Ainitialized+solutions+are+ranked+worse.%0ATo+use+a+custom+ranking%2C+implement+a+Comparator%3A%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingComparatorClass%3E%0A...TotalScoreSolverRankingComparator%3C%2FsolverRankingComparatorClass%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0AOr+by+implementing+a+weight+factory%3A%0A%C2%A0+%3CbenchmarkReport%3E%0A%C2%A0+++%3CsolverRankingWeightFactoryClass%3E%0A...TotalRankSolverRankingWeightFactory%3C%2FsolverRankingWeightFactoryClass%3E%0A%C2%A0+%3C%2FbenchmarkReport%3E%0A15.4.+Summary+Statistics%0A15.4.1.+Best+Score+Summary+%28Graph+And+Table%29%0AShows+the+best+score+per+inputSolutionFile+for+each+solver+configuration.%0AUseful+for+visualizing+the+best+solver+configuration.%0A295%0AFigure+8.+Best+Score+Summary+Statistic%0A15.4.2.+Best+Score+Scalability+Summary+%28Graph%29%0AShows+the+best+score+per+problem+scale+for+each+solver+configuration.%0AUseful+for+visualizing+the+scalability+of+each+solver+configuration.%0AThe+problem+scale+will+report+0+if+any+%40ValueRangeProvider+method+signature%0A%EF%81%9A+returns+ValueRange+%28instead+of+CountableValueRange+or+Collection%29.%0A15.4.3.+Best+Score+Distribution+Summary+%28Graph%29%0AShows+the+best+score+distribution+per+inputSolutionFile+for+each+solver+configuration.%0AUseful+for+visualizing+the+reliability+of+each+solver+configuration.%0A296%0AFigure+9.+Best+Score+Distribution+Summary+Statistic%0AEnable+statistical+benchmarking+to+use+this+summary.%0A15.4.4.+Winning+Score+Difference+Summary+%28Graph+And+Table%29%0AShows+the+winning+score+difference+per+inputSolutionFile+for+each+solver+configuration.+The%0Awinning+score+difference+is+the+score+difference+with+the+score+of+the+winning+solver+configuration%0Afor+that+particular+inputSolutionFile.%0AUseful+for+zooming+in+on+the+results+of+the+best+score+summary.%0A15.4.5.+Worst+Score+Difference+Percentage+%28ROI%29+Summary+%28Graph+and%0ATable%29%0AShows+the+return+on+investment+%28ROI%29+per+inputSolutionFile+for+each+solver+configuration+if+you%E2%80%99d%0Aupgrade+from+the+worst+solver+configuration+for+that+particular+inputSolutionFile.%0AUseful+for+visualizing+the+return+on+investment+%28ROI%29+to+decision+makers.%0A15.4.6.+Score+Calculation+Speed+Summary+%28Graph+and+Table%29%0AShows+the+score+calculation+speed%3A+a+count+per+second+per+problem+scale+for+each+solver%0Aconfiguration.%0A297%0AUseful+for+comparing+different+score+calculators+and%2For+score+rule+implementations+%28presuming%0Athat+the+solver+configurations+do+not+differ+otherwise%29.+Also+useful+to+measure+the+scalability+cost+of%0Aan+extra+constraint.%0A15.4.7.+Time+Spent+Summary+%28Graph+And+Table%29%0AShows+the+time+spent+per+inputSolutionFile+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+visualizing+the+performance+of+construction+heuristics+%28presuming+that+no+other+solver%0Aphases+are+configured%29.%0A15.4.8.+Time+Spent+Scalability+Summary+%28Graph%29%0AShows+the+time+spent+per+problem+scale+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+extrapolating+the+scalability+of+construction+heuristics+%28presuming+that+no+other+solver%0Aphases+are+configured%29.%0A15.4.9.+Best+Score+Per+Time+Spent+Summary+%28Graph%29%0AShows+the+best+score+per+time+spent+for+each+solver+configuration.+This+is+pointless+if+it%E2%80%99s%0Abenchmarking+against+a+fixed+time+limit.%0AUseful+for+visualizing+trade-off+between+the+best+score+versus+the+time+spent+for+construction%0Aheuristics+%28presuming+that+no+other+solver+phases+are+configured%29.%0A15.5.+Statistic+Per+Dataset+%28Graph+And+CSV%29%0A15.5.1.+Enable+A+Problem+Statistic%0AThe+benchmarker+supports+outputting+problem+statistics+as+graphs+and+CSV+%28comma+separated%0Avalues%29+files+to+the+benchmarkDirectory.+To+configure+one+or+more%2C+add+a+problemStatisticType+line%0Afor+each+one%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%2Fsolved%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++++%3CproblemStatisticType%3ESCORE_CALCULATION_SPEED%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0A298%0AThese+problem+statistics+can+slow+down+the+solvers+noticeably%2C+which+affects+the%0Abenchmark+results.+That%E2%80%99s+why+they+are+optional+and+only+BEST_SCORE+is+enabled+by%0Adefault.+To+disable+that+one+too%2C+use+problemStatisticEnabled%3A%0A%EF%81%9A+%C2%A0+++%3CproblemBenchmarks%3E%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticEnabled%3Efalse%3C%2FproblemStatisticEnabled%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0AThe+summary+statistics+do+not+slow+down+the+solver+and+are+always+generated.%0AThe+following+types+are+supported%3A%0A15.5.2.+Best+Score+Over+Time+Statistic+%28Graph+And+CSV%29%0AShows+how+the+best+score+evolves+over+time.+It+is+run+by+default.+To+run+it+when+other+statistics+are%0Aconfigured%2C+also+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A299%0AFigure+10.+Best+Score+Over+Time+Statistic%0AA+time+gradient+based+algorithm+%28such+as+Simulated+Annealing%29+will+have+a%0Adifferent+statistic+if+it%E2%80%99s+run+with+a+different+time+limit+configuration.+That%E2%80%99s%0A%EF%81%9A+because+this+Simulated+Annealing+implementation+automatically+determines+its%0Avelocity+based+on+the+amount+of+time+that+can+be+spent.+On+the+other+hand%2C+for+the%0ATabu+Search+and+Late+Acceptance%2C+what+you+see+is+what+you%E2%80%99d+get.%0AThe+best+score+over+time+statistic+is+very+useful+to+detect+abnormalities%2C+such+as+a+potential%0Ascore+trap+which+gets+the+solver+temporarily+stuck+in+a+local+optima.%0A300%0A15.5.3.+Step+Score+Over+Time+Statistic+%28Graph+And+CSV%29%0ATo+see+how+the+step+score+evolves+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3ESTEP_SCORE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A301%0AFigure+11.+Step+Score+Over+Time+Statistic%0ACompare+the+step+score+statistic+with+the+best+score+statistic+%28especially+on+parts+for+which+the+best%0Ascore+flatlines%29.+If+it+hits+a+local+optima%2C+the+solver+should+take+deteriorating+steps+to+escape+it.+But+it%0Ashouldn%E2%80%99t+deteriorate+too+much+either.%0AThe+step+score+statistic+has+been+seen+to+slow+down+the+solver+noticeably+due+to+GC%0A%EF%81%B1+stress%2C+especially+for+fast+stepping+algorithms+%28such+as+Simulated+Annealing+and%0ALate+Acceptance%29.%0A15.5.4.+Score+Calculation+Speed+Statistic+%28Graph+And+CSV%29%0ATo+see+how+fast+the+scores+are+calculated%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3ESCORE_CALCULATION_SPEED%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A302%0AFigure+12.+Score+Calculation+Speed+Statistic%0AThe+initial+high+calculation+speed+is+typical+during+solution+initialization%3A+it%E2%80%99s+far%0Aeasier+to+calculate+the+score+of+a+solution+if+only+a+handful+planning+entities+have%0A%EF%81%9A+been+initialized%2C+than+when+all+the+planning+entities+are+initialized.%0AAfter+those+few+seconds+of+initialization%2C+the+calculation+speed+is+relatively+stable%2C%0Aapart+from+an+occasional+stop-the-world+garbage+collector+disruption.%0A15.5.5.+Best+Solution+Mutation+Over+Time+Statistic+%28Graph+And+CSV%29%0ATo+see+how+much+each+new+best+solution+differs+from+the+previous+best+solution%2C+by+counting+the%0Anumber+of+planning+variables+which+have+a+different+value+%28not+including+the+variables+that+have%0Achanged+multiple+times+but+still+end+up+with+the+same+value%29%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EBEST_SOLUTION_MUTATION%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A303%0AFigure+13.+Best+Solution+Mutation+Over+Time+Statistic%0AUse+Tabu+Search+-+an+algorithm+that+behaves+like+a+human+-+to+get+an+estimation+on+how+difficult+it%0Awould+be+for+a+human+to+improve+the+previous+best+solution+to+that+new+best+solution.%0A15.5.6.+Move+Count+Per+Step+Statistic+%28Graph+And+CSV%29%0ATo+see+how+the+selected+and+accepted+move+count+per+step+evolves+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EMOVE_COUNT_PER_STEP%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A304%0AFigure+14.+Move+Count+Per+Step+Statistic%0AThis+statistic+has+been+seen+to+slow+down+the+solver+noticeably+due+to+GC+stress%2C%0A%EF%81%B1+especially+for+fast+stepping+algorithms+%28such+as+Simulated+Annealing+and+Late%0AAcceptance%29.%0A15.5.7.+Memory+Use+Statistic+%28Graph+And+CSV%29%0ATo+see+how+much+memory+is+used%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3EMEMORY_USE%3C%2FproblemStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A305%0AFigure+15.+Memory+Use+Statistic%0A%EF%81%B1+The+memory+use+statistic+has+been+seen+to+affect+the+solver+noticeably.%0A15.6.+Statistic+Per+Single+Benchmark+%28Graph+And+CSV%29%0A15.6.1.+Enable+A+Single+Statistic%0AA+single+statistic+is+static+for+one+dataset+for+one+solver+configuration.+Unlike+a+problem+statistic%2C+it%0Adoes+not+aggregate+over+solver+configurations.%0AThe+benchmarker+supports+outputting+single+statistics+as+graphs+and+CSV+%28comma+separated+values%29%0Afiles+to+the+benchmarkDirectory.+To+configure+one%2C+add+a+singleStatisticType+line%3A%0A306%0A%3CplannerBenchmark%3E%0A%C2%A0+%3CbenchmarkDirectory%3Elocal%2Fdata%2Fnqueens%2Fsolved%3C%2FbenchmarkDirectory%3E%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CproblemStatisticType%3E...%3C%2FproblemStatisticType%3E%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_BEST_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AMultiple+singleStatisticType+elements+are+allowed.%0AThese+statistic+per+single+benchmark+can+slow+down+the+solver+noticeably%2C+which%0A%EF%81%9A+affects+the+benchmark+results.+That%E2%80%99s+why+they+are+optional+and+not+enabled+by%0Adefault.%0AThe+following+types+are+supported%3A%0A15.6.2.+Constraint+Match+Total+Best+Score+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+constraints+are+matched+in+the+best+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3ECONSTRAINT_MATCH_TOTAL_BEST_SCORE%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A307%0AFigure+16.+Constraint+Match+Total+Best+Score+Diff+Over+Time+Statistic%0ARequires+the+score+calculation+to+support+constraint+matches.+Drools+score+calculation+supports%0Aconstraint+matches+automatically%2C+but+incremental+Java+score+calculation+requires+more+work.%0A%EF%81%B1+The+constraint+match+total+statistics+affect+the+solver+noticeably.%0A15.6.3.+Constraint+Match+Total+Step+Score+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+constraints+are+matched+in+the+step+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3ECONSTRAINT_MATCH_TOTAL_STEP_SCORE%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A308%0AFigure+17.+Constraint+Match+Total+Step+Score+Diff+Over+Time+Statistic%0AAlso+requires+the+score+calculation+to+support+constraint+matches.%0A%EF%81%B1+The+constraint+match+total+statistics+affect+the+solver+noticeably.%0A15.6.4.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+which+move+types+improve+the+best+score+%28and+how+much%29+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_BEST_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A309%0AFigure+18.+Picked+Move+Type+Best+Score+Diff+Over+Time+Statistic%0A15.6.5.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic+%28Graph+And%0ACSV%29%0ATo+see+how+much+each+winning+step+affects+the+step+score+over+time%2C+add%3A%0A%C2%A0+++%3CproblemBenchmarks%3E%0A%C2%A0+++++...%0A%C2%A0+++++%3CsingleStatisticType%3EPICKED_MOVE_TYPE_STEP_SCORE_DIFF%3C%2FsingleStatisticType%3E%0A%C2%A0+++%3C%2FproblemBenchmarks%3E%0A310%0AFigure+19.+Picked+Move+Type+Step+Score+Diff+Over+Time+Statistic%0A15.7.+Advanced+Benchmarking%0A15.7.1.+Benchmarking+Performance+Tricks%0A15.7.1.1.+Parallel+Benchmarking+On+Multiple+Threads%0AIf+you+have+multiple+processors+available+on+your+computer%2C+you+can+run+multiple+benchmarks+in%0Aparallel+on+multiple+threads+to+get+your+benchmarks+results+faster%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CparallelBenchmarkCount%3EAUTO%3C%2FparallelBenchmarkCount%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0ARunning+too+many+benchmarks+in+parallel+will+affect+the+results+of+benchmarks%0A%EF%81%B1+negatively.+Leave+some+processors+unused+for+garbage+collection+and+other%0Aprocesses.%0AThe+following+parallelBenchmarkCounts+are+supported%3A%0A311%0A%E2%80%A2+1+%28default%29%3A+Run+all+benchmarks+sequentially.%0A%E2%80%A2+AUTO%3A+Let+Planner+decide+how+many+benchmarks+to+run+in+parallel.+This+formula+is+based+on%0Aexperience.+It%E2%80%99s+recommended+to+prefer+this+over+the+other+parallel+enabling+options.%0A%E2%80%A2+Static+number%3A+The+number+of+benchmarks+to+run+in+parallel.%0A%3CparallelBenchmarkCount%3E2%3C%2FparallelBenchmarkCount%3E%0A%E2%80%A2+JavaScript+formula%3A+Formula+for+the+number+of+benchmarks+to+run+in+parallel.+It+can+use+the%0Avariable+availableProcessorCount.+For+example%3A%0A%3CparallelBenchmarkCount%3E%28availableProcessorCount+%2F+2%29+%2B+1%3C%2FparallelBenchmarkCount%3E%0AThe+parallelBenchmarkCount+is+always+limited+to+the+number+of+available%0A%EF%81%9A+processors.+If+it%E2%80%99s+higher%2C+it+will+be+automatically+decreased.%0AIf+you+have+a+computer+with+slow+or+unreliable+cooling%2C+increasing+the%0AparallelBenchmarkCount+above+one+%28even+on+AUTO%29+may+overheat+your+CPU.%0A%EF%81%9A+The+sensors+command+can+help+you+detect+if+this+is+the+case.+It+is+available+in+the%0Apackage+lm_sensors+or+lm-sensors+in+most+Linux+distributions.+There+are+several%0Afreeware+tools+available+for+Windows+too.%0AThe+benchmarker+uses+a+thread+pool+internally%2C+but+you+can+optionally+plug+in+a+custom%0AThreadFactory%2C+for+example+when+running+benchmarks+on+an+application+server+or+a+cloud%0Aplatform%3A%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CthreadFactoryClass%3E...MyCustomThreadFactory%3C%2FthreadFactoryClass%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AIn+the+future%2C+we+will+also+support+multi-JVM+benchmarking.+This+feature+is%0A%EF%81%9A+independent+of+multithreaded+solving+or+multi-JVM+solving.%0A15.7.2.+Statistical+Benchmarking%0ATo+minimize+the+influence+of+your+environment+and+the+Random+Number+Generator+on+the%0Abenchmark+results%2C+configure+the+number+of+times+each+single+benchmark+run+is+repeated.+The%0Aresults+of+those+runs+are+statistically+aggregated.+Each+individual+result+is+also+visible+in+the+report%2C%0Aas+well+as+plotted+in+the+best+score+distribution+summary.%0AJust+add+a+%3CsubSingleCount%3E+element+to+an+%3CinheritedSolverBenchmark%3E+element+or+in+a%0A%3CsolverBenchmark%3E+element%3A%0A312%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++...%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+++%3CsubSingleCount%3E10%3C%2FsubSingleCount%3E%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%C2%A0+...%0A%3C%2FplannerBenchmark%3E%0AThe+subSingleCount+defaults+to+1+%28so+no+statistical+benchmarking%29.%0AIf+subSingleCount+is+higher+than+1%2C+the+benchmarker+will+automatically+use+a%0A%EF%81%9A+differentRandom+seed+for+every+sub+single+run%2C+without+losing+reproducibility+%28for%0Aeach+sub+single+index%29+in+EnvironmentModeREPRODUCIBLE+and+lower.%0A15.7.3.+Template+Based+Benchmarking+And+Matrix+Benchmarking%0AMatrix+benchmarking+is+benchmarking+a+combination+of+value+sets.+For+example%3A+benchmark+four%0AentityTabuSize+values+%285%2C+7%2C+11+and+13%29+combined+with+three+acceptedCountLimit+values+%28500%2C+1000+and%0A2000%29%2C+resulting+in+12+solver+configurations.%0ATo+reduce+the+verbosity+of+such+a+benchmark+configuration%2C+you+can+use+a+Freemarker+template+for%0Athe+benchmark+configuration+instead%3A%0A313%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%3C%23list+%5B5%2C+7%2C+11%2C+13%5D+as+entityTabuSize%3E%0A%3C%23list+%5B500%2C+1000%2C+2000%5D+as+acceptedCountLimit%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ETabu+Search+entityTabuSize+%24%7BentityTabuSize%7D+acceptedCountLimit%0A%24%7BacceptedCountLimit%7D%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3ClocalSearch%3E%0A%C2%A0+++++++%3CunionMoveSelector%3E%0A%C2%A0+++++++++%3CchangeMoveSelector%2F%3E%0A%C2%A0+++++++++%3CswapMoveSelector%2F%3E%0A%C2%A0+++++++%3C%2FunionMoveSelector%3E%0A%C2%A0+++++++%3Cacceptor%3E%0A%C2%A0+++++++++%3CentityTabuSize%3E%24%7BentityTabuSize%7D%3C%2FentityTabuSize%3E%0A%C2%A0+++++++%3C%2Facceptor%3E%0A%C2%A0+++++++%3Cforager%3E%0A%C2%A0+++++++++%3CacceptedCountLimit%3E%24%7BacceptedCountLimit%7D%3C%2FacceptedCountLimit%3E%0A%C2%A0+++++++%3C%2Fforager%3E%0A%C2%A0+++++%3C%2FlocalSearch%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2F%23list%3E%0A%3C%2F%23list%3E%0A%3C%2FplannerBenchmark%3E%0ATo+configure+Matrix+Benchmarking+for+Simulated+Annealing+%28or+any+other+configuration+that%0Ainvolves+a+Score+template+variable%29%2C+use+the+replace%28%29+method+in+the+solver+benchmark+name%0Aelement%3A%0A314%0A%3CplannerBenchmark%3E%0A%C2%A0+...%0A%C2%A0+%3CinheritedSolverBenchmark%3E%0A%C2%A0+++...%0A%C2%A0+%3C%2FinheritedSolverBenchmark%3E%0A%3C%23list+%5B%221hard%2F10soft%22%2C+%221hard%2F20soft%22%2C+%221hard%2F50soft%22%2C+%221hard%2F70soft%22%5D+as%0AstartingTemperature%3E%0A%C2%A0+%3CsolverBenchmark%3E%0A%C2%A0+++%3Cname%3ESimulated+Annealing+startingTemperature+%24%7BstartingTemperature%3Freplace%28%22%2F%22%2C%0A%22_%22%29%7D%3C%2Fname%3E%0A%C2%A0+++%3Csolver%3E%0A%C2%A0+++++%3ClocalSearch%3E%0A%C2%A0+++++++%3Cacceptor%3E%0A%C2%A0+++++++++%3CsimulatedAnnealingStartingTemperature%3E%0A%24%7BstartingTemperature%7D%3C%2FsimulatedAnnealingStartingTemperature%3E%0A%C2%A0+++++++%3C%2Facceptor%3E%0A%C2%A0+++++%3C%2FlocalSearch%3E%0A%C2%A0+++%3C%2Fsolver%3E%0A%C2%A0+%3C%2FsolverBenchmark%3E%0A%3C%2F%23list%3E%0A%3C%2FplannerBenchmark%3E%0AA+solver+benchmark+name+doesn%E2%80%99t+allow+some+characters+%28such+a+%2F%29+because+the%0A%EF%81%9A+name+is+also+used+a+file+name.%0AAnd+build+it+with+the+class+PlannerBenchmarkFactory%3A%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromFreemarkerXmlResource%28%0A%C2%A0%0A%22org%2Foptaplanner%2Fexamples%2Fcloudbalancing%2Foptional%2Fbenchmark%2FcloudBalancingBenchmarkCon%0AfigTemplate.xml.ftl%22%29%3B%0A%C2%A0+++++++PlannerBenchmark+plannerBenchmark+%3D+plannerBenchmarkFactory%0A.buildPlannerBenchmark%28%29%3B%0A15.7.4.+Benchmark+Report+Aggregation%0AThe+BenchmarkAggregator+takes+one+or+more+existing+benchmarks+and+merges+them+into+new%0Abenchmark+report%2C+without+actually+running+the+benchmarks+again.%0A315%0AThis+is+useful+to%3A%0A%E2%80%A2+Report+on+the+impact+of+code+changes%3A+Run+the+same+benchmark+configuration+before+and%0Aafter+the+code+changes%2C+then+aggregate+a+report.%0A%E2%80%A2+Report+on+the+impact+of+dependency+upgrades%3A+Run+the+same+benchmark+configuration%0Abefore+and+after+upgrading+the+dependency%2C+then+aggregate+a+report.%0A%E2%80%A2+Condense+a+too+verbose+report%3A+Select+only+the+interesting+solver+benchmarks+from+the%0Aexisting+report.+This+especially+useful+on+template+reports+to+make+the+graphs+readable.%0A%E2%80%A2+Partially+rerun+a+benchmark%3A+Rerun+part+of+an+existing+report+%28for+example+only+the+failed+or%0Ainvalid+solvers%29%2C+then+recreate+the+original+intended+report+with+the+new+values.%0ATo+use+it%2C+provide+a+PlannerBenchmarkFactory+to+the+BenchmarkAggregatorFrame+to+display+the+GUI%3A%0A%C2%A0+++public+static+void+main%28String%5B%5D+args%29+%7B%0A%C2%A0+++++++PlannerBenchmarkFactory+plannerBenchmarkFactory+%3D+PlannerBenchmarkFactory%0A.createFromXmlResource%28%0A%C2%A0+++++++++++++++%22%0Aorg%2Foptaplanner%2Fexamples%2Fnqueens%2Fbenchmark%2FnqueensBenchmarkConfig.xml%22%29%3B%0A%C2%A0+++++++BenchmarkAggregatorFrame.createAndDisplay%28plannerBenchmarkFactory%29%3B%0A%C2%A0+++%7D%0A316%0ADespite+that+it+uses+a+benchmark+configuration+as+input%2C+it+ignores+all+elements+of%0A%EF%81%B1+that+configuration%2C+except+for+the+elements+%3CbenchmarkDirectory%3E+and%0A%3CbenchmarkReport%3E.%0AIn+the+GUI%2C+select+the+interesting+benchmarks+and+click+the+button+to+generate+the+report.%0AAll+the+input+reports+which+are+being+merged+should+have+been+generated+with+the%0Asame+Planner+version+%28excluding+hotfix+differences%29+as+the+BenchmarkAggregator.%0A%EF%81%9A+Using+reports+from+different+Planner+major+or+minor+versions+are+not+guaranteed%0Ato+succeed+and+deliver+correct+information%2C+because+the+benchmark+report+data%0Astructure+often+changes.%0A317%0AChapter+16.+Repeated+Planning%0A16.1.+Introduction+to+Repeated+Planning%0AThe+problem+facts+used+to+create+a+solution+may+change+before+or+during+the+execution+of+that%0Asolution.+Delaying+planning+in+order+to+lower+the+risk+of+problem+facts+changing+is+not+ideal%2C+as+an%0Aincomplete+plan+is+preferable+to+no+plan.%0AThe+following+examples+demonstrate+situations+where+planning+solutions+need+to+be+altered+due+to%0Aunpredictable+changes%3A%0A%E2%80%A2+Unforeseen+fact+changes%0A%E2%97%A6+An+employee+assigned+to+a+shift+calls+in+sick.%0A%E2%97%A6+An+airplane+scheduled+to+take+off+has+a+technical+delay.%0A%E2%97%A6+One+of+the+machines+or+vehicles+break+down.%0AUnforeseen+fact+changes+benefit+from+using+backup+planning.%0A%E2%80%A2+Cannot+assign+all+entities+immediately%0ALeave+some+unassigned.+For+example%3A%0A%E2%97%A6+There+are+10+shifts+at+the+same+time+to+assign+but+only+nine+employees+to+handle+shifts.%0AFor+this+type+of+planning%2C+use+overconstrained+planning.%0A%E2%80%A2+Unknown+long+term+future+facts%0AFor+example%3A%0A%E2%97%A6+Hospital+admissions+for+the+next+two+weeks+are+reliable%2C+but+those+for+week+three+and+four%0Aare+less+reliable%2C+and+for+week+five+and+beyond+are+not+worth+planning+yet.%0AThis+problem+benefits+from+continuous+planning.%0A%E2%80%A2+Constantly+changing+problem+facts%0AUse+real-time+planning.%0AMore+CPU+time+results+in+a+better+planning+solution.%0APlanner+allows+you+to+start+planning+earlier%2C+despite+unforeseen+changes%2C+as+the+optimization%0Aalgorithms+support+planning+a+solution+that+has+already+been+partially+planned.+This+is+known+as%0Arepeated+planning.%0A16.2.+Backup+Planning%0ABackup+planning+adds+extra+score+constraints+to+create+space+in+the+planning+for+when+things+go%0A318%0Awrong.+That+creates+a+backup+plan+within+the+plan+itself.%0AAn+example+of+backup+planning+is+as+follows%3A%0A1.+Create+an+extra+score+constraint.+For+example%3A%0A%E2%97%A6+Assign+an+employee+as+the+spare+employee+%28one+for+every+10+shifts+at+the+same+time%29.%0A%E2%97%A6+Keep+one+hospital+bed+open+in+each+department.%0A2.+Change+the+planning+problem+when+an+unforeseen+event+occurs.%0AFor+example%2C+if+an+employee+calls+in+sick%3A%0A%E2%97%A6+Delete+the+sick+employee+and+leave+their+shifts+unassigned.%0A%E2%97%A6+Restart+the+planning%2C+starting+from+that+solution%2C+which+now+has+a+different+score.%0AThe+construction+heuristics+fills+in+the+newly+created+gaps+%28probably+with+the+spare+employee%29+and%0Athe+metaheuristics+will+improve+it+even+further.%0A16.3.+Overconstrained+Planning%0AWhen+there+is+no+feasible+solution+to+assign+all+planning+entities%2C+it+is+preferable+to+assign+as+many%0Aentities+as+possible+without+breaking+hard+constraints.+This+is+called+overconstrained+planning.%0ABy+default%2C+Planner+assigns+all+planning+entities%2C+overloads+the+planning+values%2C+and+therefore%0Abreaks+hard+constraints.+There+are+two+ways+to+avoid+this%3A%0A%E2%80%A2+Use+nullable+planning+variables%2C+so+that+some+entities+are+unassigned.%0A%E2%80%A2+Add+virtual+values+to+catch+the+unassigned+entities.%0A16.3.1.+Overconstrained+Planning+with+Nullable+Variables%0AIf+we+handle+overconstrained+planning+with+nullable+variables%2C+the+overload+entities+will+be+left%0Aunassigned%3A%0A319%0ATo+implement+this%3A%0A1.+Add+an+additional+score+level+%28usually+a+medium+level+between+the+hard+and+soft+level%29+by%0Aswitching+Score+type.%0A2.+Make+the+planning+variable+nullable.%0A3.+Add+a+score+constraint+on+the+new+level+%28usually+a+medium+constraint%29+to+penalize+the+number%0Aof+unassigned+entities+%28or+a+weighted+sum+of+them%29.%0A16.3.2.+Overconstrained+Planning+with+Virtual+Values%0AIn+overconstrained+planning+it+is+often+useful+to+know+which+resources+are+lacking.+In%0Aoverconstrained+planning+with+virtual+values%2C+the+solution+indicates+which+resources+to+buy.%0ATo+implement+this%3A%0A1.+Add+an+additional+score+level+%28usually+a+medium+level+between+the+hard+and+soft+level%29+by%0Aswitching+Score+type.%0A2.+Add+a+number+of+virtual+values.+It+can+be+difficult+to+determine+a+good+formula+to+calculate+that%0Anumber%3A%0A%E2%97%A6+Do+not+add+too+many%2C+as+that+will+decrease+solver+efficiency.%0A%E2%97%A6+Importantly%2C+do+not+add+too+few+as+that+will+lead+to+an+infeasible+solution.%0A3.+Add+a+score+constraint+on+the+new+level+%28usually+a+medium+constraint%29+to+penalize+the+number%0A320%0Aof+virtual+assigned+entities+%28or+a+weighted+sum+of+them%29.%0A4.+Optionally%2C+change+all+soft+constraints+to+ignore+virtual+assigned+entities.%0A16.4.+Continuous+Planning+%28Windowed+Planning%29%0AContinuous+planning+is+the+technique+of+planning+one+or+more+upcoming+planning+periods+at+the%0Asame+time+and+repeating+that+process+monthly%2C+weekly%2C+daily%2C+hourly%2C+or+even+more+frequently.%0AHowever%2C+as+time+is+infinite%2C+planning+all+future+time+periods+is+impossible.%0AIn+the+employee+rostering+example+above%2C+we+re-plan+every+four+days.+Each+time%2C+we+actually+plan+a%0Awindow+of+12+days%2C+but+we+only+publish+the+first+four+days%2C+which+is+stable+enough+to+share+with+the%0Aemployees%2C+so+they+can+plan+their+social+life+accordingly.%0A321%0AIn+the+hospital+bed+planning+example+above%2C+notice+the+difference+between+the+original+planning+of%0ANovember+1st+and+the+new+planning+of+November+5th%3A+some+problem+facts+%28F%2C+H%2C+I%2C+J%2C+K%29+changed+in%0Athe+meantime%2C+which+results+in+unrelated+planning+entities+%28G%29+changing+too.%0AThe+planning+window+can+be+split+up+in+several+stages%3A%0A%E2%80%A2+History%0AImmutable+past+time+periods.+It+contains+only+immovable+entities.%0A%E2%97%A6+Recent+historic+entities+can+also+affect+score+constraints+that+apply+to+movable+entities.+For%0Aexample%2C+in+nurse+rostering%2C+a+nurse+that+has+worked+the+last+three+historic+weekends+in+a%0Arow+should+not+be+assigned+to+three+more+weekends+in+a+row%2C+because+she+requires+a+one%0Afree+weekend+per+month.%0A%E2%97%A6+Do+not+load+all+historic+entities+in+memory%3A+even+though+immovable+entities+do+not+affect%0Asolving+performance%2C+they+can+cause+out+of+memory+problems+when+the+data+grows+to+years.%0AOnly+load+those+that+might+still+affect+the+current+constraints+with+a+good+safety+margin.%0A%E2%80%A2+Published%0AUpcoming+time+periods+that+have+been+published.+They+contain+only+Immovable+and%2For+semi-%0Aimmovable+planning+entities.%0A%E2%97%A6+The+published+schedule+has+been+shared+with+the+business.+For+example%2C+in+nurse+rostering%2C%0Athe+nurses+will+use+this+schedule+to+plan+their+personal+lives%2C+so+they+require+a+publish+notice%0A322%0Aof+for+example+3+weeks+in+advance.+Normal+planning+will+not+change+that+part+of+schedule.%0AChanging+that+schedule+later+is+disruptive%2C+but+were+exceptions+force+us+to+do+them+anyway%0A%28for+example+someone+calls+in+sick%29%2C+do+change+this+part+of+the+planning+while+minimizing%0Adisruption+with+non-disruptive+replanning.%0A%E2%80%A2+Draft%0AUpcoming+time+periods+after+the+published+time+periods+that+can+change+freely.+They+contain%0Amovable+planning+entities%2C+except+for+any+that+are+immovable+for+other+reasons+%28such+as+being%0Apinned+by+a+user%29.%0A%E2%97%A6+The+first+part+of+the+draft%2C+called+the+final+draft%2C+will+be+published%2C+so+these+planning+entities%0Acan+change+one+last+time.+The+publishing+frequency%2C+for+example+once+per+week%2C+determines%0Athe+number+of+time+periods+that+change+from+draft+to+published.%0A%E2%97%A6+The+latter+time+periods+of+the+draft+are+likely+change+again+in+later+planning+efforts%2C%0Aespecially+if+some+of+the+problem+facts+change+by+then+%28for+example+nurse+Ann+doesn%E2%80%99t+want%0Ato+work+on+one+of+those+days%29.%0ADespite+that+these+latter+planning+entities+might+still+change+a+lot%2C+we+can%E2%80%99t+leave+them+out%0Afor+later%2C+because+we+would+risk+painting+ourselves+in+a+corner.+For+example%2C+in+employee%0Arostering+we+could+have+all+our+rare+skilled+employees+working+the+last+5+days+of+the+week%0Athat+gets+published%2C+which+won%E2%80%99t+reduce+the+score+of+that+week%2C+but+will+make+it+impossible%0Afor+us+to+deliver+a+feasible+schedule+the+next+week.+So+the+draft+length+needs+to+be+longer%0Athan+the+part+that+will+be+published+first.%0A%E2%97%A6+That+draft+part+is+usually+not+shared+with+the+business+yet%2C+because+it+is+too+volatile+and+it%0Awould+only+raise+false+expectations.+However%2C+it+is+stored+in+the+database+and+used+as+a%0Astarting+point+for+the+next+solver.%0A%E2%80%A2+Unplanned+%28out+of+scope%29%0APlanning+entities+that+are+not+in+the+current+planning+window.%0A%E2%97%A6+If+the+planning+window+is+too+small+to+plan+all+entities%2C+you%E2%80%99re+dealing+with+overconstrained%0Aplanning.%0A%E2%97%A6+If+time+is+a+planning+variable%2C+the+size+of+the+planning+window+is+determined+dynamically%2C+in%0Awhich+case+the+unplanned+stage+is+not+applicable.%0A323%0A16.4.1.+Immovable+Planning+Entities%0AAn+immovable+planning+entity+doesn%E2%80%99t+change+during+solving.+This+is+commonly+used+by+users+to%0Apin+down+one+or+more+specific+assignments+and+force+Planner+to+schedule+around+those+fixed%0Aassignments.%0A16.4.1.1.+Pin+Down+Planning+Entities+with+%40PlanningPin%0ATo+make+some+planning+entities+immovable%2C+add+an+%40PlanningPin+annotation+on+a+boolean+getter+or%0Afield+of+the+planning+entity+class.+That+boolean+is+true+if+the+entity+is+immovable+%28pinned+down+to+its%0Acurrent+planning+values%29+and+false+otherwise.%0A1.+Add+the+%40PlanningPin+annotation+on+a+boolean%3A%0A324%0A%40PlanningEntity%0Apublic+class+Lecture+%7B%0A%C2%A0+++private+boolean+pinned%3B%0A%C2%A0+++...%0A%C2%A0+++%40PlanningPin%0A%C2%A0+++public+boolean+isPinned%28%29+%7B%0A%C2%A0+++++++return+pinned%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0AIn+the+example+above%2C+if+pinned+is+true%2C+the+lecture+will+not+be+assigned+to+another+period+or+room%0A%28even+if+the+current+period+and+rooms+fields+are+null%29.%0A16.4.1.2.+Configure+a+Movable+EntitySelectionFilter%0AAlternatively%2C+to+make+some+planning+entities+immovable%2C+add+an+entity+SelectionFilter+that%0Areturns+true+if+an+entity+is+movable%2C+and+false+if+it+is+immovable.+This+is+more+flexible+and+more%0Averbose+than+the+%40PlanningPin+approach.%0AFor+example+on+the+nurse+rostering+example%3A%0A1.+Add+the+SelectionFilter%3A%0Apublic+class+MovableShiftAssignmentSelectionFilter+implements+SelectionFilter%0A%3CNurseRoster%2C+ShiftAssignment%3E+%7B%0A%C2%A0+++%40Override%0A%C2%A0+++public+boolean+accept%28ScoreDirector%3CNurseRoster%3E+scoreDirector%2C+ShiftAssignment%0AshiftAssignment%29+%7B%0A%C2%A0+++++++NurseRoster+nurseRoster+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++ShiftDate+shiftDate+%3D+shiftAssignment.getShift%28%29.getShiftDate%28%29%3B%0A%C2%A0+++++++return+nurseRoster.getNurseRosterInfo%28%29.isInPlanningWindow%28shiftDate%29%3B%0A%C2%A0+++%7D%0A%7D%0A2.+Configure+the+SelectionFilter%3A%0A%40PlanningEntity%28movableEntitySelectionFilter+%3D%0AMovableShiftAssignmentSelectionFilter.class%29%0Apublic+class+ShiftAssignment+%7B%0A%C2%A0+++...%0A%7D%0A325%0A16.4.2.+Nonvolatile+Replanning+to+Minimize+Disruption+%28Semi-movable%0APlanning+Entities%29%0AReplanning+an+existing+plan+can+be+very+disruptive.+If+the+plan+affects+humans+%28such+as+employees%2C%0Adrivers%2C+%E2%80%A6%29%2C+very+disruptive+changes+are+often+undesirable.+In+such+cases%2C+nonvolatile+replanning%0Ahelps+by+restricting+planning+freedom%3A+the+gain+of+changing+a+plan+must+be+higher+than+the%0Adisruption+it+causes.+This+is+usually+implemented+by+taxing+all+planning+entities+that+change.%0AIn+the+machine+reassignment+example%2C+the+entity+has+both+the+planning+variable+machine+and+its%0Aoriginal+value+originalMachine%3A%0A326%0A%40PlanningEntity%28...%29%0Apublic+class+ProcessAssignment+%7B%0A%C2%A0+++private+MrProcess+process%3B%0A%C2%A0+++private+Machine+originalMachine%3B%0A%C2%A0+++private+Machine+machine%3B%0A%C2%A0+++public+Machine+getOriginalMachine%28%29+%7B...%7D%0A%C2%A0+++%40PlanningVariable%28...%29%0A%C2%A0+++public+Machine+getMachine%28%29+%7B...%7D%0A%C2%A0+++public+boolean+isMoved%28%29+%7B%0A%C2%A0+++++++return+originalMachine+%21%3D+null+%26%26+originalMachine+%21%3D+machine%3B%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0ADuring+planning%2C+the+planning+variable+machine+changes.+By+comparing+it+with+the+originalMachine%2C%0Aa+change+in+plan+can+be+penalized%3A%0Arule+%22processMoved%22%0A%C2%A0+++when%0A%C2%A0+++++++ProcessAssignment%28moved+%3D%3D+true%29%0A%C2%A0+++then%0A%C2%A0+++++++scoreHolder.addSoftConstraintMatch%28kcontext%2C+-1000%29%3B%0Aend%0AThe+soft+penalty+of+-1000+means+that+a+better+solution+is+only+accepted+if+it+improves+the+soft+score%0Afor+at+least+1000+points+per+variable+changed+%28or+if+it+improves+the+hard+score%29.%0A16.5.+Real-time+Planning%0ATo+do+real-time+planning%2C+combine+the+following+planning+techniques%3A%0A%E2%80%A2+Backup+planning+-+adding+extra+score+constraints+to+allow+for+unforeseen+changes.%0A%E2%80%A2+Continuous+planning+-+planning+for+one+or+more+future+planning+periods.%0A%E2%80%A2+Short+planning+windows.%0AThis+lowers+the+burden+of+real-time+planning.%0AAs+time+passes%2C+the+problem+itself+changes.+Consider+the+vehicle+routing+use+case%3A%0A327%0AIn+the+example+above%2C+three+customers+are+added+at+different+times+%2807%3A56%2C+08%3A02+and+08%3A45%29%2C+after%0Athe+original+customer+set+finished+solving+at+07%3A55%2C+and+in+some+cases%2C+after+the+vehicles+already+left.%0APlanner+can+handle+such+scenarios+with+ProblemFactChange+%28in+combination+with+immovable%0Aplanning+entities%29.%0A16.5.1.+ProblemFactChange%0AWhile+the+Solver+is+solving%2C+one+of+the+problem+facts+may+be+changed+by+an+outside+event.+For%0Aexample%2C+an+airplane+is+delayed+and+needs+the+runway+at+a+later+time.%0ADo+not+change+the+problem+fact+instances+used+by+the+Solver+while+it+is+solving%0A%EF%81%AA+%28from+another+thread+or+even+in+the+same+thread%29%2C+as+that+will+corrupt+it.%0AAdd+a+ProblemFactChange+to+the+Solver%2C+which+it+executes+in+the+solver+thread+as+soon+as+possible.+For%0Aexample%3A%0A328%0Apublic+interface+Solver%3CSolution_%3E+%7B%0A%C2%A0+++...%0A%C2%A0+++boolean+addProblemFactChange%28ProblemFactChange%3CSolution_%3E+problemFactChange%29%3B%0A%C2%A0+++boolean+isEveryProblemFactChangeProcessed%28%29%3B%0A%C2%A0+++...%0A%7D%0Apublic+interface+ProblemFactChange%3CSolution_%3E+%7B%0A%C2%A0+++void+doChange%28ScoreDirector%3CSolution_%3E+scoreDirector%29%3B%0A%7D%0AThe+ScoreDirector+must+be+updated+with+any+change+on+the+problem+facts+of%0A%EF%81%B1+planning+entities+in+a+ProblemFactChange.%0ATo+write+a+ProblemFactChange+correctly%2C+it+is+important+to+understand+the+behavior+of+a+planning%0Aclone.%0AA+planning+clone+of+a+solution+must+fulfill+these+requirements%3A%0A%E2%80%A2+The+clone+must+represent+the+same+planning+problem.+Usually+it+reuses+the+same+instances+of%0Athe+problem+facts+and+problem+fact+collections+as+the+original.%0A%E2%80%A2+The+clone+must+use+different%2C+cloned+instances+of+the+entities+and+entity+collections.+Changes+to%0Aan+original+Solution+entity%E2%80%99s+variables+must+not+affect+its+clone.%0A16.5.1.1.+Cloud+Balancing+ProblemFactChange+Example%0AConsider+the+following+example+of+a+ProblemFactChange+implementation+in+the+cloud+balancing+use%0Acase%3A%0A329%0A%C2%A0+++public+void+deleteComputer%28final+CloudComputer+computer%29+%7B%0A%C2%A0+++++++solver.addProblemFactChange%28scoreDirector+-%3E+%7B%0A%C2%A0+++++++++++CloudBalance+cloudBalance+%3D+scoreDirector.getWorkingSolution%28%29%3B%0A%C2%A0+++++++++++CloudComputer+workingComputer+%3D+scoreDirector.lookUpWorkingObject%28%0Acomputer%29%3B%0A%C2%A0+++++++++++%2F%2F+First+remove+the+problem+fact+from+all+planning+entities+that+use+it%0A%C2%A0+++++++++++for+%28CloudProcess+process+%3A+cloudBalance.getProcessList%28%29%29+%7B%0A%C2%A0+++++++++++++++if+%28process.getComputer%28%29+%3D%3D+workingComputer%29+%7B%0A%C2%A0+++++++++++++++++++scoreDirector.beforeVariableChanged%28process%2C+%22computer%22%29%3B%0A%C2%A0+++++++++++++++++++process.setComputer%28null%29%3B%0A%C2%A0+++++++++++++++++++scoreDirector.afterVariableChanged%28process%2C+%22computer%22%29%3B%0A%C2%A0+++++++++++++++%7D%0A%C2%A0+++++++++++%7D%0A%C2%A0+++++++++++%2F%2F+A+SolutionCloner+does+not+clone+problem+fact+lists+%28such+as%0AcomputerList%29%0A%C2%A0+++++++++++%2F%2F+Shallow+clone+the+computerList+so+only+workingSolution+is+affected%2C+not%0AbestSolution+or+guiSolution%0A%C2%A0+++++++++++ArrayList%3CCloudComputer%3E+computerList+%3D+new+ArrayList%3C%3E%28cloudBalance%0A.getComputerList%28%29%29%3B%0A%C2%A0+++++++++++cloudBalance.setComputerList%28computerList%29%3B%0A%C2%A0+++++++++++%2F%2F+Remove+the+problem+fact+itself%0A%C2%A0+++++++++++scoreDirector.beforeProblemFactRemoved%28workingComputer%29%3B%0A%C2%A0+++++++++++computerList.remove%28workingComputer%29%3B%0A%C2%A0+++++++++++scoreDirector.afterProblemFactRemoved%28workingComputer%29%3B%0A%C2%A0+++++++++++scoreDirector.triggerVariableListeners%28%29%3B%0A%C2%A0+++++++%7D%29%3B%0A%C2%A0+++%7D%0A1.+Any+change+in+a+ProblemFactChange+must+be+done+on+the+Solution+instance+of%0AscoreDirector.getWorkingSolution%28%29.%0A2.+The+workingSolution+is+a+planning+clone+of+the+BestSolutionChangedEvent%27s+bestSolution.%0A%E2%97%A6+The+workingSolution+in+the+Solver+is+never+the+same+instance+as+the+Solution+in+the+rest+of%0Ayour+application%3A+it+is+a+planning+clone.%0A%E2%97%A6+A+planning+clone+also+clones+the+planning+entities+and+planning+entity+collections.%0ASo+any+change+on+the+planning+entities+must+happen+on+the+instances+held+by%0AscoreDirector.getWorkingSolution%28%29.%0A3.+Use+the+method+ScoreDirector.lookUpWorkingObject%28%29+to+translate+and+retrieve+the+working%0Asolution%E2%80%99s+instance+of+an+object.%0A4.+A+planning+clone+does+not+clone+the+problem+facts%2C+nor+the+problem+fact+collections.+Therefore%0Athe+workingSolution+and+the+bestSolution+share+the+same+problem+fact+instances+and+the+same%0Aproblem+fact+list+instances.%0AAny+problem+fact+or+problem+fact+list+changed+by+a+ProblemFactChange+must+be+problem+cloned%0Afirst+%28which+can+imply+rerouting+references+in+other+problem+facts+and+planning+entities%29.%0AOtherwise%2C+if+the+workingSolution+and+bestSolution+are+used+in+different+threads+%28for+example+a%0A330%0Asolver+thread+and+a+GUI+event+thread%29%2C+a+race+condition+can+occur.%0A16.5.1.2.+Cloning+Solutions+to+Avoid+Race+Conditions+in+Real-time+Planning%0AMany+types+of+changes+can+leave+a+planning+entity+uninitialized%2C+resulting+in+a+partially+initialized%0Asolution.+This+is+acceptable%2C+provided+the+first+solver+phase+can+handle+it.%0AAll+construction+heuristics+solver+phases+can+handle+a+partially+initialized+solution%2C+so+it+is%0Arecommended+to+configure+such+a+solver+phase+as+the+first+phase.%0AThe+process+occurs+as+follows%3A%0A1.+The+Solver+stops.%0A2.+Runs+the+ProblemFactChange.%0A3.+restarts.%0AThis+is+a+warm+start+because+its+initial+solution+is+the+adjusted+best+solution+of+the+previous+run.%0A4.+Each+solver+phase+runs+again.%0AThis+implies+the+construction+heuristic+runs+again%2C+but+because+little+or+no+planning+variables%0Aare+uninitialized+%28unless+you+have+a+nullable+planning+variable%29%2C+it+finishes+much+quicker+than%0Ain+a+cold+start.%0A331%0A5.+Each+configured+Termination+resets+%28both+in+solver+and+phase+configuration%29%2C+but+a+previous+call%0Ato+terminateEarly%28%29+is+not+undone.%0ATermination+is+not+usually+configured+%28except+in+daemon+mode%29%3B+instead%2C%0ASolver.terminateEarly%28%29+is+called+when+the+results+are+needed.+Alternatively%2C+configure+a%0ATermination+and+use+the+daemon+mode+in+combination+with+BestSolutionChangedEvent+as%0Adescribed+in+the+following+section.%0A16.5.2.+Daemon%3A+solve%28%29+Does+Not+Return%0AIn+real-time+planning%2C+it+is+often+useful+to+have+a+solver+thread+wait+when+it+runs+out+of+work%2C+and%0Aimmediately+resume+solving+a+problem+once+new+problem+fact+changes+are+added.+Putting+the%0ASolver+in+daemon+mode+has+the+following+effects%3A%0A%E2%80%A2+If+the+Solver%27s+Termination+terminates%2C+it+does+not+return+from+solve%28%29%2C+but+blocks+its+thread%0Ainstead+%28which+frees+up+CPU+power%29.%0A%E2%97%A6+Except+for+terminateEarly%28%29%2C+which+does+make+it+return+from+solve%28%29%2C+freeing+up+system%0Aresources+and+allowing+an+application+to+shutdown+gracefully.%0A%E2%97%A6+If+a+Solver+starts+with+an+empty+planning+entity+collection%2C+it+waits+in+the+blocked+state%0Aimmediately.%0A%E2%80%A2+If+a+ProblemFactChange+is+added%2C+it+goes+into+the+running+state%2C+applies+the+ProblemFactChange+and%0Aruns+the+Solver+again.%0ATo+use+the+Solver+in+daemon+mode%3A%0A1.+Enable+daemon+mode+on+the+Solver%3A%0A%3Csolver%3E%0A%C2%A0+%3Cdaemon%3Etrue%3C%2Fdaemon%3E%0A%C2%A0+...%0A%3C%2Fsolver%3E%0ADo+not+forget+to+call+Solver.terminateEarly%28%29+when+your+application+needs+to%0A%EF%81%B1+shutdown+to+avoid+killing+the+solver+thread+unnaturally.%0A2.+Subscribe+to+the+BestSolutionChangedEvent+to+process+new+best+solutions+found+by+the+solver%0Athread.%0AA+BestSolutionChangedEvent+does+not+guarantee+that+every+ProblemFactChange+has+been+processed%0Aalready%2C+nor+that+the+solution+is+initialized+and+feasible.%0A3.+To+ignore+BestSolutionChangedEvents+with+such+invalid+solutions%2C+do+the+following%3A%0A332%0A%C2%A0+++public+void+bestSolutionChanged%28BestSolutionChangedEvent%3CCloudBalance%3E+event%29+%7B%0A%C2%A0+++++++if+%28event.isEveryProblemFactChangeProcessed%28%29%0A%C2%A0+++++++++++++++%2F%2F+Ignore+infeasible+%28including+uninitialized%29+solutions%0A%C2%A0+++++++++++++++%26%26+event.getNewBestSolution%28%29.getScore%28%29.isFeasible%28%29%29+%7B%0A%C2%A0+++++++++++...%0A%C2%A0+++++++%7D%0A%C2%A0+++%7D%0A4.+Use+Score.isSolutionInitialized%28%29+instead+of+Score.isFeasible%28%29+to+only+ignore+uninitialized%0Asolutions%2C+but+do+accept+infeasible+solutions+too.%0A333%0AChapter+17.+Integration%0A17.1.+Overview%0APlanner%E2%80%99s+input+and+output+data+%28the+planning+problem+and+the+best+solution%29+are+plain+old%0AJavaBeans+%28POJO%E2%80%99s%29%2C+so+integration+with+other+Java+technologies+is+straightforward.+For+example%3A%0A%E2%80%A2+To+read+a+planning+problem+from+the+database+%28and+store+the+best+solution+in+it%29%2C+annotate+the%0Adomain+POJO%E2%80%99s+with+JPA+annotations.%0A%E2%80%A2+To+read+a+planning+problem+from+an+XML+file+%28and+store+the+best+solution+in+it%29%2C+annotate+the%0Adomain+POJO%E2%80%99s+with+XStream+or+JAXB+annotations.%0A%E2%80%A2+To+expose+the+Solver+as+a+REST+Service+that+reads+the+planning+problem+and+responds+with+the%0Abest+solution%2C+annotate+the+domain+POJO%E2%80%99s+with+XStream%2C+JAXB+or+Jackson+annotations+and+hook%0Athe+Solver+in+Camel+or+RESTEasy.%0A17.2.+Persistent+Storage%0A17.2.1.+Database%3A+JPA+and+Hibernate%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+JPA+annotations+to+store+them+in+a%0Adatabase+by+calling+EntityManager.persist%28%29.%0A334%0ADo+not+confuse+JPA%E2%80%99s+%40Entity+annotation+with+Planner%E2%80%99s+%40PlanningEntity%0Aannotation.+They+can+appear+both+on+the+same+class%3A%0A%EF%81%9A+%40PlanningEntity+%2F%2F+OptaPlanner+annotation%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Talk+%7B...%7D%0AAdd+a+dependency+to+the+optaplanner-persistence-jpa+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.1.1.+JPA+and+Hibernate%3A+Persisting+a+Score%0AWhen+a+Score+is+persisted+into+a+relational+database%2C+JPA+and+Hibernate+will+default+to+Java%0Aserializing+it+to+a+BLOB+column.+This+has+several+disadvantages%3A%0A%E2%80%A2+The+Java+serialization+format+of+Score+classes+is+currently+not+backwards+compatible.+Upgrading%0Ato+a+newer+Planner+version+can+break+reading+an+existing+database.%0A%E2%80%A2+The+score+is+not+easily+readable+for+a+query+executed+in+the+database+console.+This+is+annoying%0Aduring+development.%0A%E2%80%A2+The+score+cannot+be+used+in+a+SQL+or+JPA-QL+query+to+efficiently+filter+the+results%3A+for+example+to%0Aquery+all+infeasible+schedules.%0ATo+avoid+these+issues%2C+configure+it+to+instead+use+INTEGER+%28or+other%29+columns%2C+by+using+the%0Aappropriate+*ScoreHibernateType+for+your+Score+type%2C+for+example+for+a+HardSoftScore%3A%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+HardSoftScore.class%2C+typeClass+%3D+HardSoftScoreHibernateType%0A.class%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%40Column%28name+%3D+%22initScore%22%29%2C+%40Column%28name+%3D+%22hardScore%22%29%2C%0A%40Column%28name+%3D+%22softScore%22%29%7D%29%0A%C2%A0+++protected+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AConfigure+the+same+number+of+%40Column+annotations+as+the+number+of+score+levels%0A%EF%81%9A+in+the+score+plus+one+%28for+the+initScore%29%2C+otherwise+Hibernate+will+fail+fast+because%0Aa+property+mapping+has+the+wrong+number+of+columns.%0AIn+this+case%2C+the+DDL+will+look+like+this%3A%0A335%0ACREATE+TABLE+CloudBalance%28%0A%C2%A0+++...%0A%C2%A0+++initScore+INTEGER%2C%0A%C2%A0+++hardScore+INTEGER%2C%0A%C2%A0+++softScore+INTEGER%0A%29%3B%0AWhen+using+a+BigDecimal+based+Score%2C+specify+the+precision+and+scale+of+the+columns+to+avoid+silent%0Arounding%3A%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+HardSoftBigDecimalScore.class%2C+typeClass+%3D%0AHardSoftBigDecimalScoreHibernateType.class%29%0Apublic+class+CloudBalance%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%0A%C2%A0+++++++++++%40Column%28name+%3D+%22initScore%22%29%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hardScore%22%2C+precision+%3D+10%2C+scale+%3D+5%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22softScore%22%2C+precision+%3D+10%2C+scale+%3D+5%29%7D%29%0A%C2%A0+++protected+HardSoftBigDecimalScore+score%3B%0A%C2%A0+++...%0A%7D%0AIn+this+case%2C+the+DDL+will+look+like+this%3A%0ACREATE+TABLE+CloudBalance%28%0A%C2%A0+++...%0A%C2%A0+++initScore+INTEGER%2C%0A%C2%A0+++hardScore+DECIMAL%2810%2C+5%29%2C%0A%C2%A0+++softScore+DECIMAL%2810%2C+5%29%0A%29%3B%0AWhen+using+any+type+of+bendable+Score%2C+specify+the+hard+and+soft+level+sizes+as+parameters%3A%0A336%0A%40PlanningSolution%0A%40Entity%0A%40TypeDef%28defaultForType+%3D+BendableScore.class%2C+typeClass+%3D+BendableScoreHibernateType%0A.class%2C+parameters+%3D+%7B%0A%C2%A0+++++++%40Parameter%28name+%3D+%22hardLevelsSize%22%2C+value+%3D+%223%22%29%2C%0A%C2%A0+++++++%40Parameter%28name+%3D+%22softLevelsSize%22%2C+value+%3D+%222%22%29%7D%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40Columns%28columns+%3D+%7B%0A%C2%A0+++++++++++%40Column%28name+%3D+%22initScore%22%29%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard0Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard1Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22hard2Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22soft0Score%22%29%2C%0A%C2%A0+++++++++++%40Column%28name+%3D+%22soft1Score%22%29%7D%29%0A%C2%A0+++protected+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AAll+this+support+is+Hibernate+specific+because+currently+JPA+2.1%E2%80%99s+converters+do+not+support%0Aconverting+to+multiple+columns.%0A17.2.1.2.+JPA+and+Hibernate%3A+Planning+Cloning%0AIn+JPA+and+Hibernate%2C+there+is+usually+a+%40ManyToOne+relationship+from+most+problem+fact+classes+to%0Athe+planning+solution+class.+Therefore%2C+the+problem+fact+classes+reference+the+planning+solution%0Aclass%2C+which+implies+that+when+the+solution+is+planning+cloned%2C+they+need+to+be+cloned+too.+Use+an%0A%40DeepPlanningClone+on+each+such+problem+fact+class+to+enforce+that%3A%0A%40PlanningSolution+%2F%2F+OptaPlanner+annotation%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Conference+%7B%0A%C2%A0+++%40OneToMany%28mappedBy%3D%22conference%22%29%0A%C2%A0+++private+List%3CRoom%3E+roomList%3B%0A%C2%A0+++...%0A%7D%0A337%0A%40DeepPlanningClone+%2F%2F+OptaPlanner+annotation%3A+Force+the+default+planning+cloner+to%0Aplanning+clone+this+class+too%0A%40Entity+%2F%2F+JPA+annotation%0Apublic+class+Room+%7B%0A%C2%A0+++%40ManyToOne%0A%C2%A0+++private+Conference+conference%3B+%2F%2F+Because+of+this+reference%2C+this+problem+fact%0Aneeds+to+be+planning+cloned+too%0A%7D%0ANeglecting+to+do+this+can+lead+to+persisting+duplicate+solutions%2C+JPA+exceptions+or+other+side+effects.%0A17.2.2.+XML+or+JSON%3A+XStream%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+XStream+annotations+to+serialize%0Athem+to%2Ffrom+XML+or+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-xstream+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.2.1.+XStream%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to+XML+or+JSON+by+the+default+XStream+configuration%2C+it%E2%80%99s+verbose+and%0Augly.+To+fix+that%2C+configure+the+appropriate+ScoreXStreamConverter%3A%0A%40PlanningSolution%0A%40XStreamAlias%28%22CloudBalance%22%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XStreamConverter%28HardSoftScoreXStreamConverter.class%29%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+pretty+XML%3A%0A%3CCloudBalance%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E0hard%2F-200soft%3C%2Fscore%3E%0A%3C%2FCloudBalance%3E%0AThe+same+applies+for+a+bendable+score%3A%0A338%0A%40PlanningSolution%0A%40XStreamAlias%28%22Schedule%22%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XStreamConverter%28BendableScoreXStreamConverter.class%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate%3A%0A%3CSchedule%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%3C%2Fscore%3E%0A%3C%2FSchedule%3E%0AWhen+reading+a+bendable+score+from+an+XML+element%2C+the+implied+hardLevelsSize+and%0AsoftLevelsSize+must+always+be+in+sync+with+those+in+the+solver.%0A17.2.3.+XML+or+JSON%3A+JAXB%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+JAXB+annotations+to+serialize+them%0Ato%2Ffrom+XML+or+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-jaxb+jar+to+take+advantage+of+these+extra%0Aintegration+features%3A%0A17.2.3.1.+JAXB%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to+XML+or+JSON+by+the+default+JAXB+configuration%2C+it%E2%80%99s+corrupted.+To+fix%0Athat%2C+configure+the+appropriate+ScoreJaxbXmlAdapter%3A%0A%40PlanningSolution%0A%40XmlRootElement+%40XmlAccessorType%28XmlAccessType.FIELD%29%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XmlJavaTypeAdapter%28HardSoftScoreJaxbXmlAdapter.class%29%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+pretty+XML%3A%0A339%0A%3CcloudBalance%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E0hard%2F-200soft%3C%2Fscore%3E%0A%3C%2FcloudBalance%3E%0AThe+same+applies+for+a+bendable+score%3A%0A%40PlanningSolution%0A%40XmlRootElement+%40XmlAccessorType%28XmlAccessType.FIELD%29%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++%40XmlJavaTypeAdapter%28BendableScoreJaxbXmlAdapter.class%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+with+a+hardLevelsSize+of+2+and+a+softLevelsSize+of+3%2C+that+will+generate%3A%0A%3Cschedule%3E%0A%C2%A0++...%0A%C2%A0++%3Cscore%3E%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%3C%2Fscore%3E%0A%3C%2Fschedule%3E%0AThe+hardLevelsSize+and+softLevelsSize+implied%2C+when+reading+a+bendable+score+from+an+XML%0Aelement%2C+must+always+be+in+sync+with+those+in+the+solver.%0A17.2.4.+JSON%3A+Jackson%0AEnrich+domain+POJO%E2%80%99s+%28solution%2C+entities+and+problem+facts%29+with+Jackson+annotations+to+serialize%0Athem+to%2Ffrom+JSON.%0AAdd+a+dependency+to+the+optaplanner-persistence-jackson+jar+and+register%0AOptaPlannerJacksonModule%3A%0AObjectMapper+objectMapper+%3D+new+ObjectMapper%28%29%3B%0AobjectMapper.registerModule%28OptaPlannerJacksonModule.createModule%28%29%29%3B%0A17.2.4.1.+Jackson%3A+Marshalling+a+Score%0AWhen+a+Score+is+marshalled+to%2Ffrom+JSON+by+the+default+Jackson+configuration%2C+it+fails.+The%0AOptaPlannerJacksonModule+fixes+that%2C+by+using+HardSoftScoreJacksonJsonSerializer%2C%0AHardSoftScoreJacksonJsonDeserializer%60%2C+etc.%0A340%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+HardSoftScore+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+this+JSON%3A%0A%7B%0A%C2%A0++%22score%22%3A%220hard%2F-200soft%22%0A%C2%A0++...%0A%7D%0AWhen+reading+a+BendableScore%2C+the+hardLevelsSize+and+softLevelsSize+implied+in%0Athe+JSON+element%2C+must+always+be+in+sync+with+those+defined+in+the+%40PlanningScore%0Aannotation+in+the+solution+class.+For+example%3A%0A%7B%0A%C2%A0++%22score%22%3A%22%5B0%2F0%5Dhard%2F%5B-100%2F-20%2F-3%5Dsoft%22%0A%C2%A0++...%0A%7D%0AThis+JSON+implies+the+hardLevelsSize+is+2+and+thet+softLevelsSize+is+3%2C+which+must%0A%EF%81%9A+be+in+sync+with+the+%40PlanningScore+annotation%3A%0A%40PlanningSolution%0Apublic+class+Schedule+%7B%0A%C2%A0+++%40PlanningScore%28bendableHardLevelsSize+%3D+2%2C+bendableSoftLevelsSize+%3D%0A3%29%0A%C2%A0+++private+BendableScore+score%3B%0A%C2%A0+++...%0A%7D%0AWhen+a+field+is+the+Score+supertype+%28instead+of+a+specific+type+such+as+HardSoftScore%29%2C+it+uses%0APolymorphicScoreJacksonJsonSerializer+and+PolymorphicScoreJacksonJsonDeserializer+to+record+the%0Ascore+type+in+JSON+too%2C+otherwise+it+would+be+impossible+to+deserialize+it%3A%0A341%0A%40PlanningSolution%0Apublic+class+CloudBalance+%7B%0A%C2%A0+++%40PlanningScore%0A%C2%A0+++private+Score+score%3B%0A%C2%A0+++...%0A%7D%0AFor+example%2C+this+will+generate+this+JSON%3A%0A%7B%0A%C2%A0++%22score%22%3A%7B%22HardSoftScore%22%3A%220hard%2F-200soft%22%7D%0A%C2%A0++...%0A%7D%0A17.3.+SOA+and+ESB%0A17.3.1.+Camel+and+Karaf%0ACamel+is+an+enterprise+integration+framework+which+includes+support+for+Planner+%28starting+from%0ACamel+2.13%29.+It+can+expose+a+use+case+as+a+REST+service%2C+a+SOAP+service%2C+a+JMS+service%2C+%E2%80%A6%0ARead+the+documentation+for+the+camel-optaplanner+component.+That+component+works+in+Karaf%0Atoo.%0A17.4.+Other+Environments%0A17.4.1.+JBoss+Modules%2C+WildFly+and+JBoss+EAP%0ABecause+of+JBoss+Modules%27+ClassLoader+magic%2C+provide+the+ClassLoader+of+your+classes+during+the%0ASolverFactory+creation%2C+so+it+can+find+the+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s%0Aand+domain+classes%29+in+your+jars.%0AIt%E2%80%99s+also+recommended+to+plug+in+WildFly%E2%80%99s+thread+factory%2C+especially+with+multithreaded+solving.%0A17.4.1.1.+Logging+on+WildFly+and+JBoss+EAP%0ATo+get+decent+logging+of+the+solver%28s%29%2C+create+a+file+src%2Fmain%2Fresources%2Fjboss-log4j.xml+%28so+it+ends+up%0Ain+the+war+as+WEB-INF%2Fclasses%2Fjboss-log4j.xml%29+with+this+content%3A%0A342%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Clog4j%3Aconfiguration+xmlns%3Alog4j%3D%22http%3A%2F%2Fjakarta.apache.org%2Flog4j%2F%22+debug%3D%22false%22%3E%0A%C2%A0+%3Cappender+name%3D%22consoleAppender%22+class%3D%22org.apache.log4j.ConsoleAppender%22%3E%0A%C2%A0+++%3Clayout+class%3D%22org.apache.log4j.PatternLayout%22%3E%0A%C2%A0+++++%3Cparam+name%3D%22ConversionPattern%22+value%3D%22%25d%7BHH%3Amm%3Ass.SSS%7D+%25-5p+%5B%25t%5D+%25m%25n%22%2F%3E%0A%C2%A0+++%3C%2Flayout%3E%0A%C2%A0+%3C%2Fappender%3E%0A%C2%A0+%3Clogger+name%3D%22org.optaplanner%22%3E%0A%C2%A0+++%3Clevel+value%3D%22debug%22%2F%3E%0A%C2%A0+%3C%2Flogger%3E%0A%C2%A0+%3Croot%3E%0A%C2%A0+++%3Clevel+value%3D%22warn%22+%2F%3E%0A%C2%A0+++%3Cappender-ref+ref%3D%22consoleAppender%22%2F%3E%0A%C2%A0+%3C%2Froot%3E%0A%3C%2Flog4j%3Aconfiguration%3E%0A17.4.1.2.+Skinny+war+on+WildFly+and+JBoss+EAP%0ATo+deploy+an+Planner+web+application+on+WildFly%2C+simply+include+the+optaplanner+dependency+jars%0Ain+the+war+file%E2%80%99s+WEB-INF%2Flib+directory+%28just+like+any+other+dependency%29+as+shown+in+the+optaplanner-%0Awebexamples-*.war.+However%2C+in+this+approach+the+war+file+can+easily+grow+to+several+MB+in+size%2C%0Awhich+is+fine+for+a+one-time+deployment%2C+but+too+heavyweight+for+frequent+redeployments%0A%28especially+over+a+slow+network+connection%29.%0AThe+remedy+is+to+use+deliver+the+optaplanner+jars+in+a+JBoss+module+to+WildFly+and+create+a+skinny%0Awar.+Let%E2%80%99s+create+an+module+called+org.optaplanner%3A%0A1.+Navigate+to+the+directory+%24%7BWILDFLY_HOME%7D%2Fmodules%2Fsystem%2Flayers%2Fbase%2F.+This+directory+contains%0Athe+JBoss+modules+of+WildFly.+Create+directory+structure+org%2Foptaplanner%2Fmain+for+our+new%0Amodule.%0Aa.+Copy+optaplanner-core-%24%7Bversion%7D.jar+and+all+its+direct+and+transitive+dependency+jars+into%0Athat+new+directory.+Use+%22mvn+dependency%3Atree%22+on+each+optaplanner+artifact+to+discover+all%0Adependencies.%0Ab.+Create+the+file+module.xml+in+that+new+directory.+Give+it+this+content%3A%0A343%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%0A%3Cmodule+xmlns%3D%22urn%3Ajboss%3Amodule%3A1.3%22+name%3D%22org.optaplanner%22%3E%0A%C2%A0+%3Cresources%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22kie-api-%24%7Bversion%7D.jar%22%2F%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22optaplanner-core-%24%7Bversion%7D.jar%22%2F%3E%0A%C2%A0+++...%0A%C2%A0+++%3Cresource-root+path%3D%22.%22%2F%3E%0A%C2%A0+%3C%2Fresources%3E%0A%C2%A0+%3Cdependencies%3E%0A%C2%A0+++%3Cmodule+name%3D%22javaee.api%22%2F%3E%0A%C2%A0+%3C%2Fdependencies%3E%0A%3C%2Fmodule%3E%0A2.+Navigate+to+the+deployed+war+file.%0Aa.+Remove+optaplanner-core-%24%7Bversion%7D.jar+and+all+its+direct+and+transitive+dependency+jars%0Afrom+the+WEB-INF%2Flib+directory+in+the+war+file.%0Ab.+Create+the+file+jboss-deployment-structure.xml+in+the+WEB-INF%2Flib+directory.+Give+it+this%0Acontent%3A%0A%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22+%3F%3E%0A%3Cjboss-deployment-structure%3E%0A%C2%A0++%3Cdeployment%3E%0A%C2%A0+++++%3Cdependencies%3E%0A%C2%A0++++++++%3Cmodule+name%3D%22org.optaplanner%22+export%3D%22true%22%2F%3E%0A%C2%A0+++++%3C%2Fdependencies%3E%0A%C2%A0++%3C%2Fdeployment%3E%0A%3C%2Fjboss-deployment-structure%3E%0A17.4.2.+Spring+Boot%0ANormally+Planner+just+works+on+Spring+Boot%2C+simply+add+the+optaplanner-core+dependency.+If+it+has%0Atrouble+finding+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s+and+domain+classes%29%2C%0Aprovide+the+ClassLoader+of+your+classes+during+the+SolverFactory+creation.%0A17.4.3.+Java+Platform+Module+System+%28Jigsaw%29%0AWhen+using+Planner+from+code+on+the+modulepath+%28Java+9+and+higher%29%2C+open+your+packages+that%0Acontain+your+domain+objects%2C+DRL+files+and+solver+configuration+in+your+module-info.java+file%3A%0A344%0Amodule+org.optaplanner.cloudbalancing+%7B%0A%C2%A0+++requires+org.optaplanner.core%3B%0A%C2%A0+++...%0A%C2%A0+++opens+org.optaplanner.examples.cloudbalancing.domain%3B+%2F%2F+Domain+classes%0A%C2%A0+++opens+org.optaplanner.examples.cloudbalancing.solver%3B+%2F%2F+DRL+file+and+solver%0Aconfiguration%0A%C2%A0+++...%0A%7D%0AOtherwise+Planner+can%E2%80%99t+reach+those+classes+or+files%2C+even+if+they+are+exported.%0A17.4.4.+OSGi%0AThe+optaplanner-core+jar+includes+OSGi+metadata+in+its+MANIFEST.MF+file+to+function+properly+in+an%0AOSGi+environment+too.+Furthermore%2C+the+maven+artifact+kie-karaf-features+contains+a+features.xml%0Afile+that+supports+the+OSGi-feature+optaplanner-engine.%0ABecause+of+the+OSGi%E2%80%99s+ClassLoader+magic%2C+provide+the+ClassLoader+of+your+classes+during+the%0ASolverFactory+creation%2C+so+it+can+find+the+classpath+resources+%28such+as+the+solver+config%2C+score+DRL%E2%80%99s%0Aand+domain+classes%29+in+your+jars.%0APlanner+does+not+require+OSGi.+It+works+perfectly+fine+in+a+normal+Java%0A%EF%81%9A+environment+too.%0A17.4.5.+Android%0AAndroid+is+not+a+complete+JVM+%28because+some+JDK+libraries+are+missing%29%2C+but+Planner+works+on%0AAndroid+with+easy+Java+or+incremental+Java+score+calculation.+The+Drools+rule+engine+does+not+work%0Aon+Android+yet%2C+so+Drools+score+calculation+doesn%E2%80%99t+work+on+Android+and+its+dependencies+need+to%0Abe+excluded.%0AWorkaround+to+use+Planner+on+Android%3A%0A1.+Add+a+dependency+to+the+build.gradle+file+in+your+Android+project+to+exclude+org.drools+and%0Axmlpull+dependencies%3A%0Adependencies+%7B%0A%C2%A0+++...%0A%C2%A0+++compile%28%27org.optaplanner%3Aoptaplanner-core%3A...%27%29+%7B%0A%C2%A0+++++++exclude+group%3A+%27xmlpull%27%0A%C2%A0+++++++exclude+group%3A+%27org.drools%27%0A%C2%A0+++%7D%0A%C2%A0+++...%0A%7D%0A345%0A17.5.+Integration+with+Human+Planners+%28Politics%29%0AA+good+Planner+implementation+beats+any+good+human+planner+for+non-trivial+datasets.+Many%0Ahuman+planners+fail+to+accept+this%2C+often+because+they+feel+threatened+by+an+automated+system.%0ABut+despite+that%2C+both+can+benefit+if+the+human+planner+becomes+the+supervisor+of+Planner%3A%0A%E2%80%A2+The+human+planner+defines%2C+validates+and+tweaks+the+score+function.%0A%E2%97%A6+Some+examples+expose+a+Parametrization+object%2C+which+defines+the+weight+for+each+score%0Aconstraint.+The+human+planner+can+then+tweak+those+weights+at+runtime.%0A%E2%97%A6+When+the+business+changes%2C+the+score+function+often+needs+to+change+too.+The+human%0Aplanner+can+notify+the+developers+to+add%2C+change+or+remove+score+constraints.%0A%E2%80%A2+The+human+planner+is+always+in+control+of+Planner.%0A%E2%97%A6+As+shown+in+the+course+scheduling+example%2C+the+human+planner+can+pin+down+one+or+more%0Aplanning+variables+to+a+specific+planning+value.+Because+they+are+immovable%2C+Planner+does%0Anot+change+them%3A+it+optimizes+the+planning+around+the+enforcements+made+by+the+human.+If%0Athe+human+planner+pins+down+all+planning+variables%2C+he%2Fshe+sidelines+Planner+completely.%0A%E2%97%A6+In+a+prototype+implementation%2C+the+human+planner+occasionally+uses+pinning+to+intervene%2C%0Abut+as+the+implementation+matures%2C+this+should+become+obsolete.+The+feature+should+be+kept%0Aavailable+as+a+reassurance+for+the+humans%2C+and+in+the+event+that+the+business+changes%0Adramatically+before+the+score+constraints+are+adjusted+accordingly.%0AFor+this+reason%2C+it+is+recommended+the+human+planner+is+actively+involved+in+your+project.%0A346%0A347%0A17.6.+Sizing+Hardware+and+Software%0ABefore+sizing+a+Planner+service%2C+first+understand+the+typical+behaviour+of+a+Solver.solve%28%29+call%3A%0AUnderstand+these+guidelines+to+decide+the+hardware+for+a+Planner+service%3A%0A%E2%80%A2+RAM+memory%3A+Provision+plenty%2C+but+no+need+to+provide+more.%0A%E2%97%A6+The+problem+dataset%2C+loaded+before+Planner+is+called%2C+often+consumes+the+most+memory.+It%0Adepends+on+the+problem+scale.%0A%E2%96%AA+For+example%2C+in+the+Machine+Reassignment+example+some+datasets+use+over+1GB+in%0Amemory.+But+in+most+examples%2C+they+use+just+a+few+MB.%0A%E2%96%AA+If+this+is+a+problem%2C+review+the+domain+class+structure%3A+remove+classes+or+fields+that%0APlanner+doesn%E2%80%99t+need+during+solving.%0A%E2%96%AA+Planner+usually+has+up+to+three+solution+instances%3A+the+internal+working+solution%2C+the%0Abest+solution+and+the+old+best+solution+%28when+it%E2%80%99s+being+replaced%29.+However%2C+these+are+all%0Aa+planning+clone+of+each+other%2C+so+many+problem+fact+instances+are+shared+between%0Athose+solution+instances.%0A%E2%97%A6+During+solving%2C+the+memory+is+very+volatile%2C+because+solving+creates+many+short-lived%0Aobjects.+The+Garbage+Collector+deletes+these+in+bulk+and+therefore+needs+some+heap+space+as%0Aa+buffer.%0A%E2%97%A6+The+maximum+size+of+the+JVM+heap+space+can+be+in+three+states%3A%0A348%0A%E2%96%AA+Insufficient%3A+An+OutOfMemoryException+is+thrown+%28often+because+the+Garbage+Collector+is%0Ausing+more+than+98%25+of+the+CPU+time%29.%0A%E2%96%AA+Narrow%3A+The+heap+buffer+for+those+short-lived+instances+is+too+small%2C+therefore+the%0AGarbage+Collector+needs+to+run+more+than+it+would+like+to%2C+which+causes+a+performance%0Aloss.%0A%E2%96%AA+Profiling+shows+that+in+the+heap+chart%2C+the+used+heap+space+frequently+touches+the%0Amax+heap+space+during+solving.+It+also+shows+that+the+Garbage+Collector+has+a%0Asignificant+CPU+usage+impact.%0A%E2%96%AA+Adding+more+heap+space+increases+the+score+calculation+speed.%0A%E2%96%AA+Plenty%3A+There+is+enough+heap+space.+The+Garbage+Collector+is+active%2C+but+its+CPU+usage+is%0Alow.%0A%E2%96%AA+Adding+more+heap+space+does+not+increase+performance.%0A%E2%96%AA+Usually%2C+this+is+around+300+to+500MB+above+the+dataset+size%2C+regardless+of+the+problem%0Ascale+%28except+with+nearby+selection+and+caching+move+selector%2C+neither+are+used+by%0Adefault%29.%0A%E2%80%A2+CPU+power%3A+More+is+better.%0A%E2%97%A6+Improving+CPU+speed+directly+increases+the+score+calculation+speed.%0A%E2%96%AA+If+the+CPU+power+is+twice+as+fast%2C+it+takes+half+the+time+to+find+the+same+result.+However%2C%0Athis+does+not+guarantee+that+it+finds+a+better+result+in+the+same+time%2C+nor+that+it+finds+a%0Asimilar+result+for+a+problem+twice+as+a+big+in+the+same+time.%0A%E2%96%AA+Increasing+CPU+power+usually+does+not+resolve+scaling+issues%2C+because+planning%0Aproblems+scale+exponentially.+Power+tweaking+the+solver+configuration+has+far+better%0Aresults+for+scaling+issues+than+throwing+hardware+at+it.%0A%E2%97%A6+During+the+solve%28%29+method%2C+the+CPU+power+will+max+out+until+it+returns+%28except+in+daemon%0Amode+or+if+your+SolverEventListener+writes+the+best+solution+to+disk+or+the+network%29.%0A%E2%80%A2+Number+of+CPU+cores%3A+one+CPU+core+per+active+Solver%2C+plus+at+least+one+one+for+the+operating%0Asystem.%0A%E2%97%A6+So+in+a+multitenant+application%2C+which+has+one+Solver+per+tenant%2C+this+means+one+CPU+core%0Aper+tenant%2C+unless+the+number+of+solver+threads+is+limited%2C+as+that+limits+the+number+of%0Atenants+being+solved+in+parallel.%0A%E2%97%A6+With+Partitioned+Search%2C+presume+one+CPU+core+per+partition+%28per+active+tenant%29%2C+unless+the%0Anumber+of+partition+threads+is+limited.%0A%E2%96%AA+To+reduce+the+number+of+used+cores%2C+it+can+be+better+to+reduce+the+partition+threads+%28so%0Asolve+some+partitions+sequentially%29+than+to+reduce+the+number+of+partitions.%0A%E2%97%A6+In+use+cases+with+many+tenants+%28such+as+scheduling+Software+as+a+Service%29+or+many%0Apartitions%2C+it+might+not+be+affordable+to+provision+that+many+CPUs.%0A%E2%96%AA+Reduce+the+number+of+active+Solvers+at+a+time.+For+example%3A+give+each+tenant+only+one%0Aminute+of+machine+time+and+use+a+ExecutorService+with+a+fixed+thread+pool+to+queue%0Arequests.%0A%E2%96%AA+Distribute+the+Solver+runs+across+the+day+%28or+night%29.+This+is+especially+an+opportunity+in%0ASaaS+that%E2%80%99s+used+across+the+globe%2C+due+to+timezones%3A+UK+and+India+can+use+the+same+CPU%0A349%0Acore+when+scheduling+at+night.%0A%E2%97%A6+The+SolverManager+will+take+care+of+the+orchestration%2C+especially+in+those+underfunded%0Aenvironments+in+which+solvers+%28and+partitions%29+are+forced+to+share+CPU+cores+or+wait+in+line.%0A%E2%80%A2+I%2FO+%28network%2C+disk%2C+%E2%80%A6%29%3A+Not+used+during+solving.%0A%E2%97%A6+Planner+is+not+a+web+server%3A+a+solver+thread+does+not+block+%28unlike+a+servlet+thread%29%2C+each%0Aone+fully+drains+a+CPU.%0A%E2%96%AA+A+web+server+can+handle+24+active+servlets+threads+with+eight+cores+without%0Aperformance+loss%2C+because+most+servlets+threads+are+blocking+on+I%2FO.%0A%E2%96%AA+However%2C+24+active+solver+threads+with+eight+cores+will+cause+each+solver%E2%80%99s+score%0Acalculation+speed+to+be+three+times+slower%2C+causing+a+big+performance+loss.%0A%E2%97%A6+Note+that+calling+any+I%2FO+during+solving%2C+for+example+a+remote+service+in+your+score%0Acalculation%2C+causes+a+huge+performance+loss+because+it%E2%80%99s+called+thousands+of+times+per%0Asecond%2C+so+it+should+complete+in+microseconds.+So+no+good+implementation+does+that.%0AKeep+these+guidelines+in+mind+when+selecting+and+configuring+the+software.+See+our+blog+archive%0Afor+the+details+of+our+experiments%2C+which+use+our+diverse+set+of+examples.+Your+mileage+may+vary.%0A%E2%80%A2+Operating+System%0A%E2%97%A6+No+experimentally+proven+advice+yet+%28but+prefer+Linux+anyway%29.%0A%E2%80%A2+JDK%0A%E2%97%A6+Version%3A+Java+7+can+be+between+10%25+and+25%25+faster+than+Java+6.+But+Java+8+however+is%0Ausually+not+significantly+faster+than+Java+7.%0A%E2%97%A6+Garbage+Collector%3A+ParallelGC+%28the+default+in+Java+8%29+can+be+potentially+between+5%25+and+35%25%0Afaster+than+G1GC+%28the+default+in+Java+9%29.+Unlike+web+servers%2C+Planner+needs+a+GC+focused+on%0Athroughput%2C+not+latency.+Use+-XX%3A%2BUseParallelGC+to+turn+on+ParallelGC.%0A%E2%80%A2+Logging+can+have+a+severe+impact+on+performance.%0A%E2%97%A6+Debug+logging+org.drools+can+reduce+performance+by+a+factor+of+7.%0A%E2%97%A6+Debug+logging+org.optaplanner+can+be+between+0%25+and+15%25+slower+than+info+logging.+Trace%0Alogging+can+be+between+5%25+and+70%25+slower+than+info+logging.%0A%E2%97%A6+Synchronous+logging+to+a+file+has+an+additional+significant+impact+for+debug+and+trace%0Alogging+%28but+not+for+info+logging%29.%0A%E2%80%A2+Avoid+a+cloud+environment+in+which+you+share+your+CPU+core%28s%29+with+other+virtual+machines+or%0Acontainers.+Performance+%28and+therefore+solution+quality%29+can+be+unreliable+when+the+available%0ACPU+power+varies+greatly.%0AKeep+in+mind+that+the+perfect+hardware%2Fsoftware+environment+will+probably+not+solve+scaling%0Aissues+%28even+Moore%E2%80%99s+law+is+too+slow%29.+There+is+no+need+to+follow+these+guidelines+to+the+letter.%0A350%0AChapter+18.+Design+Patterns%0A18.1.+Design+Patterns+Introduction%0AThese+design+patterns+list+and+solve+common+design+challenges.%0A18.2.+Domain+Modeling+Guide%0AA+good+model+can+greatly+improve+the+success+of+your+planning+implementation.+These+guidelines%0Ahelp+to+design+a+good+model%3A%0A1.+Draw+a+class+diagram+of+your+domain+model.+Normalize+it+get+rid+of+duplicate+data.%0A%E2%97%A6+Write+down+some+sample+instances+for+each+class.%0A%E2%96%AA+For+example+in+employee+rostering%2C+the+samples+for+the+Employee+class+are+Ann%2C+Bert+and%0ACarl.%0A2.+Determine+which+relationships+%28or+fields%29+change+during+planning.+Color+them+orange.+Often%0Athere+is+only+one+such+relationship+%28or+field%29.+One+side+of+these+relationships+will+become+a%0Aplanning+variable+later+on.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+Shift+to+Employee+relationship+changes+during%0Aplanning%2C+so+it+is+orange.+Other+relationships%2C+such+as+from+Employee+to+Skill%2C+are+immutable%0Aduring+planning+because+Planner+can%E2%80%99t+decide+to+give+an+employee+an+extra+skill.%0A3.+If+there+are+multiple+relationships+%28or+fields%29%3A+check+for+shadow+variables.+A+shadow+variable%0Adoes+change+during+planning%2C+but+its+value+can+be+calculated+based+on+one+or+more+genuine%0Aplanning+variables%2C+without+dispute.+Color+those+shadow+relationships+%28or+fields%29+purple.%0A%E2%97%A6+Only+one+side+of+a+bi-directional+relationship+can+be+a+genuine+planning+variable%2C+the+other%0Aside+will+become+an+inverse+relation+shadow+variable+later+on.+Keep+those+relationships+in%0Aorange.%0A4.+Check+for+chained+planning+variables.+In+a+chained+variable+design%2C+the+focus+lies+on+deciding%0Athe+order+of+a+set+planning+entity+instances%2C+instead+of+assigning+them+to+a+date%2Ftime+%28although%0Athere+can+be+an+assigned+date%2Ftime+as+a+shadow+variable%29.+A+typical+use+case+is+vehicle+routing.%0A5.+If+there+is+an+orange+many+to+many+relationship%2C+replace+that+many+to+many+relationship+with%0Aa+one+to+many+and+a+many+to+one+relationship+to+a+new+intermediate+class.%0A%E2%97%A6+Planner+currently+doesn%E2%80%99t+support+a+%40PlanningVariable+on+a+collection.+Although+a+future%0Aversion+will+support+it+for+flexibility+reasons%2C+it+probably+has+an+inherit+performance+and%0Acomplexity+cost%2C+so+it+might+be+better+to+avoid+it+anyway.%0A%E2%97%A6+For+example+in+employee+rostering+the+ShiftAssignment+class+is+the+many+to+many%0Arelationship+between+the+Shift+and+Employee.+It%E2%80%99s+effectively+every+spot+that+needs+to+be+filled%0Awith+an+employee.%0A351%0A6.+In+a+many+to+one+relationship%2C+usually+the+many+side+is+the+planning+entity+class+with+the%0Aplanning+variable.+Annotate+it+with+a+%40PlanningEntity+annotation.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+has+an+%40PlanningEntity%0Aannotation.%0A%E2%97%A6+If+it%E2%80%99s+a+bi-directional+relationship%2C+both+sides+are+a+planning+entity+class%2C+but+usually+the%0Amany+side+has+the+planning+variable+and+the+one+side+the+shadow+variable.%0A7.+The+planning+entity+class+should+have+at+least+one+problem+property.+So+a+planning+entity%0Aclass+cannot+consist+out+of+only+planning+variables+%28or+even+an+id+and+only+planning+variables%29.%0ARemove+a+surplus+%40PlanningVariable+so+it+becomes+a+problem+property.+This+heavily+decreases%0Athe+search+space+size+and+heavily+increases+solving+efficiency.%0A%E2%97%A6+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+should+not+annotate+both+the%0Ashift+and+employee+relationship+with+%40PlanningVariable.%0A%E2%97%A6+When+all+planning+variables+are+null+%28which+occurs+when+the+planning+solution+is+still%0Auninitialized%29%2C+a+planning+entity+instance+should+still+be+describable+to+the+business+people.%0A%E2%96%AA+So+a+surrogate+ID+does+not+suffice+as+the+required+minimum+of+one+problem+property.%0A%E2%97%A6+This+way%2C+there+is+no+need+to+add+a+hard+constraint+to+assure+that+two+planning+entities+are%0Adifferent%3A+they+are+already+different+due+to+their+problem+properties.%0A%E2%97%A6+In+some+cases%2C+multiple+planning+entity+instances+have+the+same+set+of+problem+properties.%0AIn+such+cases%2C+it+can+be+useful+to+create+an+extra+problem+property+to+distinguish+them.%0A%E2%96%AA+For+example+in+employee+rostering%2C+the+ShiftAssignment+class+has+besides+the+problem%0Aproperty+Shift+also+the+problem+property+indexInShift+%28which+is+an+int%29.%0A352%0A8.+Choose+the+model+in+which+the+number+of+planning+entities+is+fixed+during+planning.%0A%E2%97%A6+For+example+in+employee+rostering%2C+it%E2%80%99s+impossible+to+know+in+advance+how+many+shifts%0Aeach+employee+will+have+before+Planner+solves+it+%28and+it+can+even+differ+per+best+solution%0Afound%29.+On+the+other+hand%2C+the+number+of+employees+per+shift+is+known+in+advance%2C+so+it%E2%80%99s%0Abetter+to+make+the+Shift+relationship+a+problem+property+and+the+Employee+relationship+a%0Aplanning+variable.%0AFor+inspiration%2C+take+a+look+at+how+the+examples+modeled+their+domain%3A%0A353%0A%EF%81%9A+Vehicle+routing+is+special%2C+because+it+uses+a+chained+planning+variable.%0A18.3.+Assigning+Time+to+Planning+Entities%0ADealing+with+time+and+dates+in+planning+problems+may+be+problematic+because+it+is+dependent+on%0Athe+needs+of+your+use+case.%0AThere+are+several+representations+of+timestamps%2C+dates%2C+durations+and+periods+in+Java.+Choose+the%0Aright+representation+type+for+your+use+case%3A%0A%E2%80%A2+java.util.Date+%28deprecated%29%3A+a+slow%2C+error-prone+way+to+represent+timestamps.+Do+not+use.%0A%E2%80%A2+java.time.LocalDateTime%2C+LocalDate%2C+DayOfWeek%2C+Duration%2C+Period%2C+%E2%80%A6%3A+an+accurate+way+to+represent%0Aand+calculate+with+timestamps%2C+dates%2C+%E2%80%A6%0A%E2%97%A6+Supports+timezones+and+DST+%28Daylight+Saving+Time%29.%0A%E2%97%A6+Requires+Java+8+or+higher.%0A%E2%80%A2+int+or+long%3A+Caches+a+timestamp+as+a+simplified+number+of+coarse-grained+time+units+%28such+as%0Aminutes%29+from+the+start+of+the+global+planning+time+window+or+the+epoch.%0A%E2%97%A6+For+example%3A+a+LocalDateTime+of+1-JAN+08%3A00%3A00+becomes+an+int+of+400+minutes.+Similarly+1-%0AJAN+09%3A00%3A00+becomes+460+minutes.%0A%E2%97%A6+It+often+represents+an+extra+field+in+a+class%2C+alongside+the+LocalDateTime+field+from+which+it%0A354%0Awas+calculated.+The+LocalDateTime+is+used+for+user+visualization%2C+but+the+int+is+used+in+the%0Ascore+constraints.%0A%E2%97%A6+It+is+faster+in+calculations%2C+which+is+especially+useful+in+the+TimeGrain+pattern.%0A%E2%97%A6+Do+not+use+if+timezones+or+DST+affect+the+score+constraints.%0AThere+are+also+several+designs+for+assigning+a+planning+entity+to+a+starting+time+%28or+date%29%3A%0A%E2%80%A2+The+starting+time+is+fixed+beforehand.+It+is+not+a+planning+variable+%28in+such+solver%29.%0A%E2%97%A6+For+example%2C+in+the+hospital+bed+planning+example%2C+the+arrival+day+of+each+patient+is+fixed%0Abeforehand.%0A%E2%97%A6+This+is+common+in+multi+stage+planning%2C+when+the+starting+time+has+been+decided+already+in%0Aan+earlier+planning+stage.%0A%E2%80%A2+The+starting+time+is+not+fixed%2C+it+is+a+planning+variable+%28genuine+or+shadow%29.%0A%E2%97%A6+If+all+planning+entities+have+the+same+duration%2C+use+the+Timeslot+pattern.%0A%E2%96%AA+For+example+in+course+scheduling%2C+all+lectures+take+one+hour.+Therefore%2C+each+timeslot+is%0Aone+hour.%0A%E2%97%A6+If+the+duration+differs+and+time+is+rounded+to+a+specifc+time+granularity+%28for+example+5%0Aminutes%29+use+the+TimeGrain+pattern.%0A%E2%96%AA+For+example+in+meeting+scheduling%2C+all+meetings+start+at+15+minute+intervals.+All%0Ameetings+take+15%2C+30%2C+45%2C+60%2C+90+or+120+minutes.%0A%E2%97%A6+If+the+duration+differs+and+one+task+starts+immediately+after+the+previous+task+%28assigned+to%0Athe+same+executor%29+finishes%2C+use+the+Chained+Through+Time+pattern.%0A%E2%96%AA+For+example+in+time+windowed+vehicle+routing%2C+each+vehicle+departs+immediately+to+the%0Anext+customer+when+the+delivery+for+the+previous+customer+finishes.%0AChoose+the+right+pattern+depending+on+the+use+case%3A%0A355%0A18.3.1.+Timeslot+Pattern%3A+Assign+to+a+Fixed-Length+Timeslot%0AIf+all+planning+entities+have+the+same+duration+%28or+can+be+inflated+to+the+same+duration%29%2C+the%0ATimeslot+pattern+is+useful.+The+planning+entities+are+assigned+to+a+timeslot+rather+than+time.+For%0Aexample+in+course+timetabling%2C+all+lectures+take+one+hour.%0AThe+timeslots+can+start+at+any+time.+For+example%2C+the+timeslots+start+at+8%3A00%2C+9%3A00%2C+10%3A15+%28after+a+15-%0Aminute+break%29%2C+11%3A15%2C+%E2%80%A6+They+can+even+overlap%2C+but+that+is+unusual.%0AIt+is+also+usable+if+all+planning+entities+can+be+inflated+to+the+same+duration.+For+example+in+exam%0Atimetabling%2C+some+exams+take+90+minutes+and+others+120+minutes%2C+but+all+timeslots+are+120+minutes.%0AWhen+an+exam+of+90+minutes+is+assigned+to+a+timeslot%2C+for+the+remaining+30+minutes%2C+its+seats+are%0Aoccupied+too+and+cannot+be+used+by+another+exam.%0AUsually+there+is+a+second+planning+variable%2C+for+example+the+room.+In+course+timetabling%2C+two%0Alectures+are+in+conflict+if+they+share+the+same+room+at+the+same+timeslot.+However%2C+in+exam%0Atimetabling%2C+that+is+allowed%2C+if+there+is+enough+seating+capacity+in+the+room+%28although+mixed+exam%0Adurations+in+the+same+room+do+inflict+a+soft+score+penalty%29.%0A18.3.2.+TimeGrain+Pattern%3A+Assign+to+a+Starting+TimeGrain%0AAssigning+humans+to+start+a+meeting+at+four+seconds+after+9+o%E2%80%99clock+is+pointless+because+most%0Ahuman+activities+have+a+time+granularity+of+five+minutes+or+15+minutes.+Therefore+it+is+not%0Anecessary+to+allow+a+planning+entity+to+be+assigned+subsecond%2C+second+or+even+one+minute+accuracy.%0A356%0AThe+five+minute+or+15+minutes+accuracy+suffices.+The+TimeGrain+pattern+models+such+time%0Aaccuracy+by+partitioning+time+as+time+grains.+For+example+in+meeting+scheduling%2C+all+meetings%0Astart%2Fend+in+hour%2C+half+hour%2C+or+15-minute+intervals+before+or+after+each+hour%2C+therefore+the+optimal%0Asettings+for+time+grains+is+15+minutes.%0AEach+planning+entity+is+assigned+to+a+start+time+grain.+The+end+time+grain+is+calculated+by+adding+the%0Aduration+in+grains+to+the+starting+time+grain.+Overlap+of+two+entities+is+determined+by+comparing%0Atheir+start+and+end+time+grains.%0AThis+pattern+also+works+well+with+a+coarser+time+granularity+%28such+as+days%2C+half+days%2C+hours%2C+%E2%80%A6%29.%0AWith+a+finer+time+granularity+%28such+as+seconds%2C+milliseconds%2C+%E2%80%A6%29+and+a+long+time+window%2C+the+value%0Arange+%28and+therefore+the+search+space%29+can+become+too+high%2C+which+reduces+efficiency+and%0Ascalability.+However%2C+such+solution+is+not+impossible%2C+as+shown+in+cheap+time+scheduling.%0A18.3.3.+Chained+Through+Time+Pattern%3A+Assign+in+a+Chain+that+Determines%0AStarting+Time%0AIf+a+person+or+a+machine+continuously+works+on+one+task+at+a+time+in+sequence%2C+which+means%0Astarting+a+task+when+the+previous+is+finished+%28or+with+a+deterministic+delay%29%2C+the+Chained+Through%0ATime+pattern+is+useful.+For+example%2C+in+the+vehicle+routing+with+time+windows+example%2C+a+vehicle%0Adrives+from+customer+to+customer+%28thus+it+handles+one+customer+at+a+time%29.%0AIn+this+pattern%2C+the+planning+entities+are+chained.+The+anchor+determines+the+starting+time+of+its%0Afirst+planning+entity.+The+second+entity%E2%80%99s+starting+time+is+calculated+based+on+the+starting+time+and%0Aduration+of+the+first+entity.+For+example%2C+in+task+assignment%2C+Beth+%28the+anchor%29+starts+working+at%0A8%3A00%2C+thus+her+first+task+starts+at+8%3A00.+It+lasts+52+mins%2C+therefore+her+second+task+starts+at+8%3A52.+The%0Astarting+time+of+an+entity+is+usually+a+shadow+variable.%0AAn+anchor+has+only+one+chain.+Although+it+is+possible+to+split+up+the+anchor+into+two+separate%0Aanchors%2C+for+example+split+up+Beth+into+Beth%E2%80%99s+left+hand+and+Beth%E2%80%99s+right+hand+%28because+she+can+do%0Atwo+tasks+at+the+same+time%29%2C+this+model+makes+pooling+resources+difficult.+Consequently%2C+using+this%0Amodel+in+the+exam+scheduling+example+to+allow+two+or+more+exams+to+use+the+same+room+at+the%0Asame+time+is+problematic.%0ABetween+planning+entities%2C+there+are+three+ways+to+create+gaps%3A%0A%E2%80%A2+No+gaps%3A+This+is+common+when+the+anchor+is+a+machine.+For+example%2C+a+build+server+always%0Astarts+the+next+job+when+the+previous+finishes%2C+without+a+break.%0A%E2%80%A2+Only+deterministic+gaps%3A+This+is+common+for+humans.+For+example%2C+any+task+that+crosses+the%0A10%3A00+barrier+gets+an+extra+15+minutes+duration+so+the+human+can+take+a+break.%0A%E2%97%A6+A+deterministic+gap+can+be+subjected+to+complex+business+logic.+For+example+in+vehicle%0Arouting%2C+a+cross-continent+truck+driver+needs+to+rest+15+minutes+after+two+hours+of+driving%0A%28which+may+also+occur+during+loading+or+unloading+time+at+a+customer+location%29+and+also%0Aneeds+to+rest+10+hours+after+14+hours+of+work.%0A%E2%80%A2+Planning+variable+gaps%3A+This+is+uncommon%2C+because+an+extra+planning+variable+%28which+impacts%0Athe+search+space%29+reduces+efficiency+and+scalability.%0A357%0A18.4.+Multi-stage+planning%0AFor+practical+or+organizational+reasons+%28such+as+Conway%E2%80%99s+law%29%2C+complex+planning+problems+are%0Aoften+broken+down+in+multiple+stages.+A+typical+example+is+train+scheduling%2C+where+one+department%0Adecides+where+and+when+a+train+will+arrive+or+depart%2C+and+another+departments+assigns+the%0Aoperators+to+the+actual+train+cars%2Flocomotives.%0AEach+stage+has+its+own+solver+configuration+%28and+therefore+its+own+SolverFactory%29.+Do+not+confuse+it%0Awith+multi-phase+solving+which+uses+a+one-solver+configuration.%0ASimilarly+to+Partitioned+Search%2C+multi-stage+planning+leads+to+suboptimal+results.+Nevertheless%2C+it%0Amay+be+beneficial+in+order+to+simplify+the+maintenance%2C+ownership%2C+and+help+to+start+a+project.%0A358%0AChapter+19.+Development%0A19.1.+Methodology+Overview%0AThe+diagram+below+explains+the+overall+structure+of+the+OptaPlanner+source+code%3A%0AIn+the+diagram+above%2C+it%E2%80%99s+important+to+understand+the+clear+separation+between+the+configuration%0Aand+runtime+classes.%0AThe+development+philosophy+includes%3A%0A%E2%80%A2+Reuse%3A+The+examples+are+reused+as+integration+tests%2C+stress+tests+and+demo%E2%80%99s.+The+documentation%0Aimages+are+reused+as+slides.%0A%E2%80%A2+Consistent+terminology%3A+Each+example+has+a+class+App+%28executable+class%29+and+Panel+%28swing+UI%29.%0A%E2%80%A2+Consistent+structure%3A+Each+example+has+the+same+packages%3A+domain%2C+persistence%2C+app%2C+solver+and%0Aswingui.%0A%E2%80%A2+Real+world+usefulness%3A+Every+feature+is+used+in+an+example.+Most+examples+are+real+world+use%0Acases+with+real+world+constraints%2C+often+with+real+world+data.%0A%E2%80%A2+Automated+testing%3A+There+are+unit+tests%2C+integration+tests%2C+performance+regressions+tests+and%0Astress+tests.+The+test+coverage+is+high.%0A%E2%80%A2+Fail+fast+with+an+understandable+error+message%3A+Invalid+states+are+checked+as+early+as%0A359%0Apossible.%0A19.2.+Development+guidelines%0A1.+Fail+fast.+There+are+several+levels+of+fail+fast%2C+from+better+to+worse%3A%0Aa.+Fail+Fast+at+compile+time.+For+example%3A+Don%E2%80%99t+accept+an+Object+as+parameter+if+it+needs+to+be%0Aa+String+or+an+Integer.%0Ab.+Fail+Fast+at+startup+time.+For+example%3A+if+the+configuration+parameter+needs+to+be+a+positive%0Aint+and+it%E2%80%99s+negative%2C+fail+fast%0Ac.+Fail+Fast+at+runtime.+For+example%3A+if+the+request+needs+to+contain+a+double+between+0.0+and%0A1.0+and+it%E2%80%99s+bigger+than+1.0%2C+fail+fast.%0Ad.+Fail+Fast+at+runtime+in+assertion+mode+if+the+detection+performance+cost+is+high.+For%0Aexample%3A+If%2C+after+every+low+level+iteration%2C+the+variable+A+needs+to+be+equal+to+the+square%0Aroot+of+B%2C+check+it+if+and+only+if+an+assert+flag+is+set+to+true+%28usually+controlled+by+the%0AEnvironmentMode%29.%0A2.+Exception+messages%0Aa.+The+Exception+message+must+include+the+name+and+state+of+each+relevant+variable.+For%0Aexample%3A%0Aif+%28fooSize+%3C+0%29+%7B%0A%C2%A0+++throw+new+IllegalArgumentException%28%22The+fooSize+%28%22+%2B+fooSize+%2B+%22%29+of+bar+%28%22%0A%2B+this+%2B+%22%29+must+be+positive.%22%29%3B%0A%7D%0ANotice+that+the+output+clearly+explains+what%E2%80%99s+wrong%3A%0AException+in+thread+%22main%22+java.lang.IllegalArgumentException%3A+The+fooSize+%28-5%29%0Aof+bar+%28myBar%29+must+be+positive.%0A%C2%A0+++at+...%0Ab.+Whenever+possible%2C+the+Exception+message+must+include+context.%0Ac.+Whenever+the+fix+is+not+obvious%2C+the+Exception+message+should+include+advice.+Advice%0Anormally+starts+with+the+word+maybe+on+a+new+line%3A%0AException+in+thread+%22main%22+java.lang.IllegalStateException%3A+The%0AvalueRangeDescriptor+%28fooRange%29+is+nullable%2C+but+not+countable+%28false%29.%0AMaybe+the+member+%28getFooRange%29+should+return+CountableValueRange.%0A%C2%A0+++at+...%0AThe+word+maybe+is+to+indicate+that+the+advice+is+not+guaranteed+to+be+right+in+all+cases.%0A3.+Generics.+The+Solution+class+is+often+passed+as+a+generic+type+parameter+to+subsystems.+The%0APlanningEntity+class%28es%29+are+rarely+passed+as+a+generic+type+parameter.%0A360%0A
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1876)
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1474)
	at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
	at com.passer.web.servlet.TranslateServlet.service(TranslateServlet.java:63)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:467)
	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:392)
	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:311)
	at com.passer.web.servlet.UploadServlet.service(UploadServlet.java:96)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:624)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1441)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

